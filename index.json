[{"categories":["Technology"],"content":"A Chrome extension is a small software program that is designed to add functionality to the Google Chrome web browser. Extensions can be developed using web technologies such as HTML, CSS, and JavaScript. Therefore, JavaScript is often used in the development of Chrome extensions to add interactivity and to implement the logic of the extension. ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:0:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Introduction Github Project https://github.com/Jerrysmd/weibo-content-filter This is a Chrome extension that serves as a new version of the Weibo plugin. It removes recommended, promoted, and advertisement Weibo from the timeline. With this extension, users can enjoy a cleaner and more streamlined Weibo experience. The extension is designed to improve the userâ€™s browsing experience by removing unnecessary content and focusing on the content that the user wants to see. It is a simple and easy-to-use tool that can greatly enhance the way users interact with Weibo. ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:1:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Requirements analysis In order to develop a Chrome extension that effectively removes recommended, promoted, and advertisement Weibo from the timeline, we conducted a thorough requirements analysis to identify the needs and expectations of the target audience. This included gathering feedback from potential users, researching similar extensions on the market, and analyzing the technical requirements for implementing the desired functionality. Based on this analysis, we identified the following functional requirements for the extension: The extension should be able to identify and remove recommended, promoted, and advertisement Weibo from the timeline. The extension should allow the user to customize which types of Weibo they want to remove (e.g. recommended only, promoted only, both recommended and promoted). The extension should have a user-friendly interface that allows the user to easily enable or disable the extension. In addition to these functional requirements, we also identified the following non-functional requirements: The extension should be lightweight and not significantly impact the performance of the browser. The extension should be compatible with the latest version of Google Chrome. The extension should be easy to install and use for the average user. By considering these requirements, we were able to create a clear vision for the extension and develop a plan for its development. ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:2:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Design In order to meet the requirements and deliver a high-quality Chrome extension, we have developed the following design for the extension: User interface: The extension will have a simple and intuitive user interface that allows the user to easily enable or disable the extension, as well as customize the types of Weibo that they want to remove. The interface will consist of a toggle button and a drop-down menu, both of which can be accessed from the extension icon in the Chrome toolbar. Weibo identification: To identify recommended, promoted, and advertisement Weibo, the extension will use a combination of CSS selectors and JavaScript code. The selectors will be used to locate the relevant elements on the page, and the JavaScript code will be used to determine whether the elements should be removed based on the userâ€™s preferences. Performance optimization: To ensure that the extension does not significantly impact the performance of the browser, we will optimize the code for efficiency and minimize the number of DOM manipulations. We will also implement caching and other performance-enhancing techniques as necessary. Overall, our design aims to create a simple and effective tool that improves the userâ€™s experience on Weibo by removing unwanted content from the timeline. ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:3:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Implementation manifest.jsonï¼šChrome extension settings { \"name\": \"å¤§çœ¼å¤¹ï¼ˆæ–°ç‰ˆå¾®åšï¼‰\", \"short_name\": \"å¤§çœ¼å¤¹\", \"version\": \"0.1\", \"manifest_version\": 3, \"description\": \"æ–°ç‰ˆå¾®åšéå®˜æ–¹æ’ä»¶ï¼Œå»é™¤æ—¶é—´çº¿ä¸Šçš„æ¨èã€æ¨å¹¿å’Œå¹¿å‘Šå¾®åšã€‚\", \"icons\": { \"48\": \"weiboFilter.png\", \"128\": \"weiboFilter.large.png\" }, \"content_scripts\": [ { \"matches\": [ \"https://weibo.com/*\", \"https://www.weibo.com/*\", \"https://d.weibo.com/*\", \"http://d.weibo.com/*\", \"http://weibo.com/*\", \"http://www.weibo.com/*\" ], \"js\": [\"main.js\"], \"run_at\": \"document_end\" } ], \"web_accessible_resources\": [{ \"resources\": [\"weiboClean.js\"], \"matches\": [\"\u003call_urls\u003e\"] }], \"permissions\": [ \"storage\" ] } main.js // å€ŸåŠ©è‡ªå®šä¹‰äº‹ä»¶å®ç°page scriptï¼ˆæ³¨å…¥é¡µé¢çš„ä¸»ç¨‹åºï¼‰ä¸content scriptï¼ˆè¿è¡Œåœ¨æ²™ç®±ä¸­ï¼‰ // ä¹‹é—´çš„å¼‚æ­¥é€šè®¯ï¼Œä½¿å‰è€…å¯ä»¥é—´æ¥è°ƒç”¨chrome.* APIå’ŒGM_* API console.log('I am in weiboFilter.js'); document.addEventListener('wbpGet', function (event) { event.stopPropagation(); var name = event.detail.name; var post = function (value) { // æ³¨æ„ï¼šä¸èƒ½åœ¨æ­¤å¤„ç›´æ¥è°ƒç”¨callbackï¼Œå¦åˆ™å›è°ƒå‡½æ•°å°†åœ¨æœ¬ç¨‹åºæ‰€åœ¨çš„æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œï¼Œåœ¨Chrome 27åŠæ›´é«˜ç‰ˆæœ¬ä¸‹ä¼šå‡ºé”™ // åœ¨Greasemonkeyï¼ˆFirefoxæ‰©å±•ï¼‰ç¯å¢ƒä¸‹ä¹Ÿä¸èƒ½é€šè¿‡detailç›´æ¥ä¼ å¯¹è±¡ï¼Œåªèƒ½é€stringæˆ–array // è¯¦è§https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent#Specification document.dispatchEvent(new CustomEvent('wbpPost', { detail: event.detail.id + '=' + (value || '') })); }; if (event.detail.sync) { // ä¸€æ¬¡æ€§è¯»å–æ‰€æœ‰è®¾ç½® chrome.storage.sync.get(null, function (items) { var i = 0, value = ''; while ((name + '_' + i) in items) { value += items[name + '_' + (i++)]; } post(i ? value : event.detail.defVal); }); } else { // æ³¨æ„ï¼šä½¿ç”¨chrome.storage.StorageArea.get()æ—¶ï¼Œå¦‚æœé€šè¿‡{name:defVal}çš„å½¢å¼ä¼ é€é»˜è®¤å€¼ï¼Œ // ä¸”defValä¸ºnullæˆ–undefinedï¼Œå³ä½¿nameå­˜åœ¨ä¹Ÿä¼šè¿”å›ç©ºå¯¹è±¡{}ï¼Œè¯¦è§crbug.com/145081 chrome.storage.local.get(name, function (items) { post(name in items ? items[name] : event.detail.defVal); }); } }); document.addEventListener('wbpSet', function (event) { event.stopPropagation(); var data = {}, name = event.detail.name, value = event.detail.value; data[name] = value; if (event.detail.sync) { // å°†è®¾ç½®ä¿å­˜åˆ°åŒæ­¥å­˜å‚¨ // ä¸€æ¬¡æ€§è¯»å–æ‰€æœ‰è®¾ç½® chrome.storage.sync.get(null, function (items) { var data = {}, i = 0, errorHandler = function () { if (chrome.runtime \u0026\u0026 chrome.runtime.lastError) { console.error('Error writing to storage.sync: ' + chrome.runtime.lastError.message); } }, partLength = Math.round(chrome.storage.sync.QUOTA_BYTES_PER_ITEM * 0.8); // chrome.storage.syncçš„å­˜å‚¨æ¡æ•°ï¼ˆMAX_ITEMS=512ï¼‰ä¸å•æ¡é•¿åº¦ï¼ˆQUOTA_BYTES_PER_ITEM=4,096ï¼‰ // å‡å—é™åˆ¶ï¼Œå½“è®¾ç½®è¿‡é•¿æ—¶éœ€è¦æ‹†åˆ†ï¼›chrome.storage.storageArea.set()ä¼šå¯¹è¾“å…¥é¡¹ // åšä¸€æ¬¡JSON.stringify()ï¼Œä¸”Unicodeå­—ç¬¦å°†è¢«è½¬æ¢ä¸º\\uXXXXçš„è½¬ä¹‰å½¢å¼ï¼Œéƒ½ä¼šå¯¼è‡´å­—ç¬¦ä¸²è†¨èƒ€ // å› æ­¤æ‹†åˆ†æ—¶éœ€è¦äº‹å…ˆç•™å‡ºä¸€å®šè£•åº¦ï¼ˆæ­¤å¤„ä¿ç•™20%ï¼‰ï¼Œå¹¶å°†å­—ç¬¦ä¸²è½¬ä¸ºUnicodeè½¬ä¹‰æ ¼å¼ for (var j = 0, l = 0, s = '', u; j \u003c value.length; ++j) { if (value.charCodeAt(j) \u003c 0x80) { // ASCIIå­—ç¬¦ s += value.charAt(j); ++l; } else { // Unicodeå­—ç¬¦ u = value.charCodeAt(j).toString(16); s += '\\\\u' + (u.length === 2 ? '00' + u : u.length === 3 ? '0' + u : u); l += 6; } if (l \u003e= partLength) { data[name + '_' + (i++)] = s; l = 0; s = ''; } } if (l \u003e 0) { data[name + '_' + (i++)] = s; } // ä¿å­˜æ–°çš„è®¾ç½® chrome.storage.sync.set(data, errorHandler); // æ¸…é™¤å¤šä½™çš„æ—§è®¾ç½®å— var keys = []; while ((name + '_' + i) in items) { keys.push(name + '_' + (i++)); } chrome.storage.sync.remove(keys, errorHandler); }); } else { // å°†è®¾ç½®ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ chrome.storage.local.set(data); } }); //#endif // å°†è„šæœ¬æ³¨å…¥é¡µé¢ç¯å¢ƒ var script = document.createElement('script'); script.setAttribute('type', 'text/javascript'); script.src = chrome.runtime.getURL(\"/weiboClean.js\"); document.head.appendChild(script); weiboClean.js document.addEventListener('DOMNodeInserted', function (event) { var node = event.target; if (node.tagName !== 'DIV') { return; } document.querySelectorAll('#scroller \u003e div.vue-recycle-scroller__item-wrapper \u003e div').forEach(function (div) { //console.log(div); if(div.querySelectorAll('i[title=\"è´Ÿåé¦ˆ\"').length \u003e 0){ div.style.display = 'none'; }else{ div.style.display = ''; } }); }); ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:4:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Testing Detecting the GUCCI advertisingï¼Œadd the attribute of display: none Test ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:5:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Deployment Deployment ","date":"2022-09-29","objectID":"/20220929_chrome-extension-project/:6:0","tags":["JavaScript","Browser Extension"],"title":"Chrome Extension Project: Weibo Advertising Filter","uri":"/20220929_chrome-extension-project/"},{"categories":["Technology"],"content":"Spring MVC is a module in the Spring framework that helps you build web applications. It is a framework that helps you build web applications in a clean and modular way, by providing a structure for request handling and a model-view-controller design pattern. ","date":"2022-09-14","objectID":"/20220914_springmvc-intro/:0:0","tags":["Java","Spring","SpringMVC"],"title":"SpringMVC Introduction","uri":"/20220914_springmvc-intro/"},{"categories":["Technology"],"content":"SpringMVC ","date":"2022-09-14","objectID":"/20220914_springmvc-intro/:1:0","tags":["Java","Spring","SpringMVC"],"title":"SpringMVC Introduction","uri":"/20220914_springmvc-intro/"},{"categories":["Technology"],"content":"å¯¹æ¯” Servlet å¯¹æ¯” SpringMVC å’Œ Servletï¼Œå®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚ å®ç°å¯¹ User æ¨¡å—å¢åˆ æ”¹æŸ¥çš„æ¨¡æ‹Ÿæ“ä½œã€‚ Servlet å®ç° com.jerry.servlet.UserSaveServlet.java: package com.jerry.servlet; import ...; @WebServlet(\"/user/save\") public class UserSaveServlet extends HttpServlet{ @Override protected void doGet(HttpServletRequest req, HeepServletResponse resp) throws ServletException, IOException{ String name = req.getParameter(\"name\"); println(\"servlet save nameï¼š\" + name); resp.setContenType(\"text/json;charset=utf-8\"); PrintWriter pw = resp.getWriter(); pw.write(\"{'module':'servlet save'}\"); } @Override protected void doPost(HttpServletRequest req, HeepServletResponse resp) throws ServletException, IOException{ this.doGet(req,resp); } } com.jerry.servlet.UserSelectServlet.java: å’Œ Save åŠŸèƒ½ç±»ä¼¼å®ç°æ–¹å¼ com.jerry.servlet.UserUpdateServlet.java: å’Œ Save åŠŸèƒ½ç±»ä¼¼å®ç°æ–¹å¼ com.jerry.servlet.UserDeleteServlet.java: å’Œ Save åŠŸèƒ½ç±»ä¼¼å®ç°æ–¹å¼ SpringMVC å®ç° com.jerry.springmvc.UserController.java: package com.jerry.springmvc; import ...; @Controller public class UserController{ @RequestMapping(\"/save\") @ResponseBody public String save(String name){ println(\"springmvc save nameï¼š\" + name); } @RequestMapping(\"/select\") @ResponseBody public String select(String name){ println(\"springmvc select nameï¼š\" + name); } @RequestMapping(\"/update\") @ResponseBody public String update(String name){ println(\"springmvc update nameï¼š\" + name); } @RequestMapping(\"/delete\") @ResponseBody public String delete(String name){ println(\"springmvc delete nameï¼š\" + name); } } ","date":"2022-09-14","objectID":"/20220914_springmvc-intro/:1:1","tags":["Java","Spring","SpringMVC"],"title":"SpringMVC Introduction","uri":"/20220914_springmvc-intro/"},{"categories":["Technology"],"content":"æ¦‚è¿° SpringMVC ä¸ Servlet æŠ€æœ¯åŠŸèƒ½ç­‰åŒï¼Œéƒ½å±äº web å±‚å¼€å‘æŠ€æœ¯ ä¼˜ç‚¹ ä½¿ç”¨ç®€å•ï¼Œç›¸æ¯” Servlet å¼€å‘ä¾¿æ· çµæ´»æ€§å¼º ","date":"2022-09-14","objectID":"/20220914_springmvc-intro/:1:2","tags":["Java","Spring","SpringMVC"],"title":"SpringMVC Introduction","uri":"/20220914_springmvc-intro/"},{"categories":["Technology"],"content":"Spring makes programming Java quicker, easier, and safer. Springâ€™s focus on speed, simplicity, and productivity has made it the worldâ€™s most popular Java framework. Spring works on microservices, reactive, cloud, web apps, serverless, event driven, and batch services. ","date":"2022-08-05","objectID":"/20220805_spring-intro/:0:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Framework spring-overview ä¸Šå±‚ä¾èµ–äºä¸‹å±‚ Core Container æ ¸å¿ƒå®¹å™¨ï¼Œç®¡ç†å¯¹è±¡ AOP é¢å‘åˆ‡é¢ç¼–ç¨‹ Aspects AOP æ€æƒ³å®ç° Data Access / Integration æ•°æ®è®¿é—® / é›†æˆ Transactions äº‹åŠ¡ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:1:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"æ ¸å¿ƒå®¹å™¨ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:2:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"IoC \u0026 DI IoC (Inversion of Control) æ§åˆ¶åè½¬ DI (Dependency Injection) ä¾èµ–æ³¨å…¥ åœºæ™¯ï¼š //ä¸šåŠ¡å±‚å®ç° public class ServiceImpl implements Service{ //æ•°æ®å±‚æ›´æ–°ï¼Œä¸šåŠ¡å±‚ä¹Ÿéœ€æ›´æ–°ã€‚ç„¶åé‡æ–°ç¼–è¯‘ï¼Œé‡æ–°æµ‹è¯•ï¼Œé‡æ–°éƒ¨ç½²ï¼Œé‡æ–°å‘å¸ƒã€‚ private Dao dao = new DaoImpl(); public void save(){ bookDao.save(); } } //æ•°æ®å±‚å®ç° public class DaoImpl implements Dao{ public void save(){ //...method1 } } public class DaoImpl2 implements Dao{ public void save(){ //...method2 } } ç°çŠ¶ï¼šè€¦åˆåº¦é«˜ã€‚æ•°æ®å±‚æ›´æ–°ï¼Œä¸šåŠ¡å±‚ä¹Ÿéœ€æ›´æ–°ã€‚ç„¶åé‡æ–°ç¼–è¯‘ï¼Œé‡æ–°æµ‹è¯•ï¼Œé‡æ–°éƒ¨ç½²ï¼Œé‡æ–°å‘å¸ƒã€‚ è§£å†³æ–¹æ¡ˆï¼š IoC (Inversion of Control) æ§åˆ¶åè½¬ ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œåœ¨ç¨‹åºä¸­ä¸è¦ä¸»åŠ¨ä½¿ç”¨ new äº§ç”Ÿå¯¹è±¡ï¼Œè½¬æ¢ç”±å¤–éƒ¨æä¾›å¯¹è±¡ã€‚æ­¤æ€æƒ³ç§°ä¸ºæ§åˆ¶åè½¬ IoCã€‚ Spring å¯¹ IoC æ€æƒ³è¿›è¡Œäº†å®ç°ï¼š Spring æä¾›äº†ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸º IoC å®¹å™¨ï¼Œç”¨æ¥ä½œä¸ºæä¾›å¯¹è±¡çš„**â€œå¤–éƒ¨â€**ã€‚å°±æ˜¯ Spring Framework ä¸­çš„æ ¸å¿ƒå®¹å™¨ã€‚ IoC å®¹å™¨è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºï¼Œåˆå§‹åŒ–ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œè¢«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡åœ¨ IoC å®¹å™¨ä¸­ç»Ÿç§°ä¸º Beanã€‚ DI (Dependency Injection) ä¾èµ–æ³¨å…¥ åœ¨å®¹å™¨ä¸­å»ºç«‹ bean ä¸ bean ä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚ æ€»ç»“ ç›®æ ‡ï¼šå……åˆ†è§£è€¦ ä½¿ç”¨ IoC å®¹å™¨ç®¡ç† bean ï¼ˆIoCï¼‰ åœ¨ IoC å®¹å™¨å†…å°†æœ‰ä¾èµ–å…³ç³»çš„ bean è¿›è¡Œå…³ç³»ç»‘å®šï¼ˆDIï¼‰ æœ€ç»ˆæ•ˆæœ ä½¿ç”¨å¯¹è±¡æ—¶ä¸ä»…å¯ä»¥ç›´æ¥ IoC Intro Case IoC ç®¡ç†ä»€ä¹ˆï¼Ÿï¼ˆServiceã€Daoã€Serviceå’ŒDao å…³ç³»ï¼‰ å¦‚ä½•å°†è¢«ç®¡ç†çš„å¯¹è±¡å‘ŠçŸ¥ IoC å®¹å™¨ï¼Ÿï¼ˆé…ç½®ï¼‰ è¢«ç®¡ç†çš„å¯¹è±¡äº¤ç»™ IoC å®¹å™¨ï¼Œå¦‚ä½•è·å–åˆ° IoC å®¹å™¨ï¼Ÿï¼ˆæ¥å£ï¼‰ IoC å®¹å™¨å¾—åˆ°åï¼Œå¦‚ä½•ä»å®¹å™¨ä¸­è·å– beanï¼Ÿï¼ˆæ¥å£æ–¹æ³•ï¼‰ IoC Intro Case æ­¥éª¤ï¼ˆXMLï¼‰ ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥ spring-context \u003c!--Mavernæ–‡ä»¶ï¼špom.xml--\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.springframework\u003c/groupId\u003e \u003cartifactId\u003espring-context\u003c/artifactId\u003e \u003cversion\u003e*.*.*.RELEASE\u003c/version\u003e \u003c/dependency\u003e ç¬¬äºŒæ­¥ï¼šå®šä¹‰ Spring ç®¡ç†çš„ç±»å’Œæ¥å£ public interface BookService{ public void save(); } public class BookServiceImpl implements BookService{ private BookDao bookDao = new BookDaoImpl(); public void save(){ bookDao.save(); } } ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º Spring é…ç½®æ–‡ä»¶ï¼Œé…ç½®å¯¹åº”ç±»ä½œä¸º Spring ç®¡ç†çš„ bean \u003c!--é…ç½®æ–‡ä»¶ï¼šapplicationContext.xml--\u003e \u003c!--ç¬¬ä¸‰æ­¥ï¼šæ–°å»º applicationContext.xml æ–‡ä»¶ï¼Œé…ç½® bean: bean æ ‡ç­¾æ ‡è¯†é…ç½® bean id å±æ€§æ ‡ç¤º bean çš„åå­— class å±æ€§æ ‡ç¤ºç»™ bean å®šä¹‰ç±»å‹--\u003e \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"/\u003e \u003cbean id=\"bookService\" class=\"com.jerry.service.impl.BookServiceImpl\"/\u003e ç¬¬å››æ­¥ï¼šåˆå§‹åŒ– IoC å®¹å™¨ï¼ˆSpring å®¹å™¨ï¼‰ï¼Œé€šè¿‡å®¹å™¨è·å– bean //App2.java package com.jerry; public class App2{ public static void main(String[] args){ // è·å– IoC å®¹å™¨ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶åˆ›å»º IoC ApplicationContext ctx = new ClassPathXmlApplicationContext(\"applicationContext.xml\"); // è·å– beanï¼Œä¸é…ç½®æ–‡ä»¶çš„ id å¯¹åº” BookService bookService = (BookService) ctx.getBean(\"bookService\"); bookService.save();// Serviceå±‚æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªDaoå±‚æ“ä½œç»„æˆçš„ã€‚ } } DI Intro Case åŸºäº IoC ç®¡ç† beanï¼ˆåŸºäº IoC Intro Caseï¼‰ Service ä¸­ä½¿ç”¨ new å½¢å¼åˆ›å»º Dao å¯¹è±¡ï¼Ÿï¼ˆå¦ï¼Œä½¿ç”¨ new è€¦åˆæ€§ä»ç„¶å¾ˆé«˜ï¼‰ Service ä¸­éœ€è¦çš„ Dao å¯¹è±¡å¦‚ä½•è¿›å…¥åˆ° Service ä¸­ï¼Ÿï¼ˆæä¾›æ–¹æ³•ï¼‰ Service ä¸ Dao é—´çš„å…³ç³»å¦‚ä½•æè¿°ï¼ŒSpring å¦‚ä½•çŸ¥é“è¯¥å…³ç³»ï¼Ÿï¼ˆé…ç½®ï¼‰ DI Intro Case æ­¥éª¤ï¼ˆXMLï¼‰ ç¬¬ä¸€æ­¥ï¼šåˆ é™¤ä¸šåŠ¡å±‚ä¸­ä½¿ç”¨ new çš„æ–¹å¼åˆ›å»ºçš„ dao å¯¹è±¡ï¼Œæä¾›ä¾èµ–å¯¹è±¡å¯¹åº”çš„ setter æ–¹æ³• public class BookServiceImpl implements BookService{ // 5.åˆ é™¤ä¸šåŠ¡å±‚ä¸­ä½¿ç”¨ new çš„æ–¹å¼åˆ›å»ºçš„ dao å¯¹è±¡ private BookDao bookDao; public void save(){ bookDao.save(); } // 6.æä¾›å¯¹åº”çš„ set æ–¹æ³• public void setBookDao(bookDao bookDao){ this.bookDao = bookDao; } } ç¬¬äºŒæ­¥ï¼šé…ç½® service ä¸ dao ä¹‹é—´çš„å…³ç³» \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"/\u003e \u003cbean id=\"bookService\" class=\"com.jerry.service.impl.BookServiceImpl\"\u003e \u003c!--7.é…ç½® server ä¸ dao çš„å…³ç³»--\u003e \u003c!--name å±æ€§è¡¨ç¤ºé…ç½®å“ªä¸€ä¸ªå…·ä½“çš„å±æ€§--\u003e \u003c!--ref å±æ€§è¡¨ç¤ºå‚ç…§å“ªä¸€ä¸ª beanï¼Œä¸ bean id å¯¹åº”--\u003e \u003cproperty name=\"bookDao\" ref=\"bookDao\"\u003e\u003c/property\u003e \u003c/bean\u003e ","date":"2022-08-05","objectID":"/20220805_spring-intro/:2:1","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Bean Bean é…ç½® bean åŸºç¡€é…ç½® ç±»åˆ« æè¿° å±æ€§åˆ—è¡¨ idï¼šä½¿ç”¨å®¹å™¨å¯ä»¥é€šè¿‡ id è·å–å¯¹åº”çš„ bean classï¼šbean çš„ç±»å‹ï¼Œå³é…ç½® bean çš„å…¨è·¯å¾„ç±»å èŒƒä¾‹ \u003cbean id=â€œbookDaoâ€ class=â€œcom.jerry.dao.impl.BookDaoImplâ€/\u003e\u003cbean id=â€œbookServiceâ€ class=â€œcom.jerry.service.impl.BookServiceImplâ€/\u003e bean ä½œç”¨èŒƒå›´é…ç½® ç±»åˆ« æè¿° å±æ€§ scope åŠŸèƒ½ å®šä¹‰ bean çš„ä½œç”¨èŒƒå›´ï¼Œå¯é€‰èŒƒå›´å¦‚ä¸‹ 1. singletonï¼šå•ä¾‹ï¼ˆé»˜è®¤ï¼‰ 2. prototypeï¼šéå•ä¾‹ èŒƒä¾‹ \u003cbean id=â€œbookDaoâ€ class=â€œcom.jerry.dao.impl.BookDaoImplâ€/\u003e ä¸ºä»€ä¹ˆ bean é»˜è®¤ä¸ºå•ä¾‹ï¼Ÿ è¿™äº›å¯¹è±¡å¤ç”¨æ²¡æœ‰é—®é¢˜ï¼Œæ‰€ä»¥é»˜è®¤ä¸ºå•ä¾‹ï¼ŒèŠ‚çœå†…å­˜ã€‚ é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„ bean é€‚åˆäº¤ç»™å®¹å™¨ç®¡ç†çš„ bean ä¸é€‚åˆäº¤ç»™å®¹å™¨ç®¡ç†çš„ bean è¡¨ç°å±‚å¯¹è±¡ å°è£…å®ä½“çš„åŸŸå¯¹è±¡ï¼ˆè®°å½•æˆå‘˜å˜é‡çš„å¯¹è±¡ï¼‰ ä¸šåŠ¡å±‚å¯¹è±¡ æ•°æ®å±‚å¯¹è±¡ å·¥å…·ç±»å¯¹è±¡ Bean å®ä¾‹åŒ– Bean çš„å››ç§å®ä¾‹åŒ– æ–¹æ³•ä¸€ï¼šæ„é€ æ–¹æ³•å®ä¾‹åŒ–ï¼ˆå¸¸ç”¨ï¼‰ æä¾›å¯è®¿é—®çš„æ„é€ æ–¹æ³• public class BookDaoImpl implements BookDao{ public BookDaoImpl(){ print(\"book constructor is running\"); } public void save(){ print(\"book dao save\"); } } é…ç½® \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"\u003e\u003c/bean\u003e æ— å‚æ„é€ æ–¹æ³•å¦‚æœä¸å­˜åœ¨ï¼Œå°†æŠ›å‡ºå¼‚å¸¸ BeanCreateionException æ–¹æ³•äºŒï¼šé™æ€å·¥å‚å®ä¾‹åŒ– é™æ€å·¥å‚ public class OrderDaoFactory{ public static OrderDao getOrderDao(){ return new OrderDaoImpl(); } } é…ç½® \u003cbean id=\"orderDao\" class=\"com.jerry.factory.OrderDaoFactory\" factory-method=\"getOrderDao\"\u003e\u003c/bean\u003e ä½¿ç”¨ main(){ UserDaoFactory userDaoFactory = new UserDaoFactory(); UserDao userDao = userDaoFactory.getUserDao(); userDao.save(); } æ–¹æ³•ä¸‰ï¼šä½¿ç”¨å®ä¾‹å·¥å‚å®ä¾‹åŒ– å®ä¾‹å·¥å‚ public class UserDaoFactory{ public UserDao getUserDao(){ return new UserDaoImpl(); } } é…ç½® \u003cbean id=\"userFactory\" class=\"com.jerry.factory.UserDaoFactory\"\u003e\u003c/bean\u003e \u003cbean id=\"userDao\" factory-method=\"getUserDao\" factory-bean=\"userFactory\"\u003e\u003c/bean\u003e æ–¹æ³•å››ï¼šä½¿ç”¨ FactoryBean å®ä¾‹åŒ– beanï¼ˆé‡è¦ï¼‰ FactoryBean public class UserDaoFactoryBean implements FactoryBean\u003cUserDao\u003e{ //ä»£æ›¿åŸå§‹å®ä¾‹å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³• public UserDao getObject() throws Exception{ return new UserDaoImpl(); } public Class\u003c?\u003e getObjectType(){ return UserDao.class; } public boolean isSingleton(){ return true; } } é…ç½® \u003cbean id=\"userDao\" class=\"com.jerry.factory.UserDaoFactoryBean\"\u003e\u003c/bean\u003e Bean çš„ç”Ÿå‘½å‘¨æœŸ bean ç”Ÿå‘½å‘¨æœŸæ§åˆ¶æ–¹æ³• æ–¹æ³•ä¸€ï¼šé…ç½®æ–‡ä»¶ç®¡ç†æ§åˆ¶æ–¹æ³• \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\" init-method=\"init\" destroy-method=\"destory\"\u003e\u003c/bean\u003e æ–¹æ³•äºŒï¼šä½¿ç”¨æ¥å£æ§åˆ¶ï¼ˆäº†è§£ï¼‰ //å®ç° InitializingBeanï¼ŒDisposableBean æ¥å£ public class BookServiceImpl implements BookService, InitializingBean, DisposableBean{ public void save(){} public void afterPropertiesSet() throws Exception{} public void destroy() throws Exception{} } ç”Ÿå‘½å‘¨æœŸ åˆå§‹åŒ–å®¹å™¨ åˆ›å»ºå¯¹è±¡ï¼ˆå†…å­˜åˆ†é…ï¼‰ æ‰§è¡Œæ„é€ æ–¹æ³• æ‰§è¡Œå±æ€§æ³¨å…¥ï¼ˆset æ“ä½œï¼‰ æ‰§è¡Œ bean åˆå§‹åŒ–æ–¹æ³• ä½¿ç”¨ bean æ‰§è¡Œä¸šåŠ¡æ“ä½œ é”€æ¯å®¹å™¨ æ‰§è¡Œ bean é”€æ¯æ–¹æ³• å…³é—­å®¹å™¨ ConfigurableApplicationContext close() registerShutdownHook() ä¾èµ–æ³¨å…¥æ–¹å¼ å‘ä¸€ä¸ªç±»ä¸­ä¼ é€’æ•°æ®çš„æ–¹å¼æœ‰å‡ ç§ï¼Ÿ æ™®é€šæ–¹æ³•ï¼ˆset æ–¹æ³•ï¼‰ æ„é€ æ–¹æ³• ä¾èµ–æ³¨å…¥æè¿°äº†åœ¨å®¹å™¨ä¸­å»ºç«‹ bean ä¸ bean ä¹‹é—´ä¾èµ–å…³ç³»çš„è¿‡ç¨‹ï¼Œå¦‚æœ bean è¿è¡Œéœ€è¦çš„æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²å‘¢ï¼Ÿ å¼•ç”¨ç±»å‹ ç®€å•ç±»å‹ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ä¸ Stringï¼‰ ä¾èµ–æ³¨å…¥æ–¹å¼ setter æ³¨å…¥ ç®€å•ç±»å‹ å¼•ç”¨ç±»å‹ æ„é€ å™¨æ³¨å…¥ ç®€å•ç±»å‹ å¼•ç”¨ç±»å‹ Setter æ³¨å…¥ - å¼•ç”¨ç±»å‹ åœ¨ bean ä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„ set æ–¹æ³• public class BookServiceImpl implements BookService { private BookDao bookDao; public void setBookDao(BookDao bookDao){ this.bookDao = bookDao; } } é…ç½®ä¸­ä½¿ç”¨ property æ ‡ç­¾ ref å±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"/\u003e \u003cbean id=\"bookService\" class=\"com.jerry.service.impl.BookServiceImpl\"\u003e \u003c!--é…ç½® server ä¸ dao çš„å…³ç³»--\u003e \u003c!--name å±æ€§è¡¨ç¤ºé…ç½®å“ªä¸€ä¸ªå…·ä½“çš„å±æ€§--\u003e \u003c!--ref å±æ€§è¡¨ç¤ºå‚ç…§å“ªä¸€ä¸ª beanï¼Œä¸ bean id å¯¹åº”--\u003e \u003cproperty name=\"bookDao\" ref=\"bookDao\"\u003e\u003c/property\u003e \u003c/bean\u003e Setter æ³¨å…¥ - ç®€å•ç±»å‹ é…ç½®æ–‡ä»¶æ³¨å…¥å€¼ \u003cbean id=\"userkDao\" class=\"com.jerry.dao.impl.UserDaoImpl\"/\u003e \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"\u003e \u003cproperty name=\"databaseName\" value=\"mysql\"\u003e\u003c/property\u003e \u003cproperty name=\"connectionNum\" value=\"10\"\u003e\u003c/property\u003e \u003c/bean\u003e \u003cbean id=\"bookService\" class=\"com.jerry.service.impl.BookServiceImpl\"\u003e \u003cproperty name=\"bookDao\" ref=\"bookDao\"\u003e\u003c/property\u003e \u003cproperty name=\"userDao\" ref=\"userDao\"\u003e\u003c/property\u003e \u003c/bean\u003e åœ¨ bean ä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„ set æ–¹æ³• public class BookDaoImpl implements BookDao{ private int connectionNum; private String databaseName; public void setConnectionNum(int connectionNum){ this.connectionNum = connectionNum; } public void setDatabaseName(String databaseName){ this.databaseName = databaseName; } public void save(){ System.out.println(\"book dao save\" + databaseName + connectionNum); } } æ„é€ å™¨æ³¨å…¥ - å¼•ç”¨ç±»å‹ï¼ˆäº†è§£ï¼‰ åœ¨ bean ä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„æ„é€ æ–¹æ³• é…ç½®ä¸­ä½¿ç”¨ constructor-arg æ ‡ç­¾ ref å±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ ä¾èµ–æ³¨å…¥æ–¹å¼é€‰æ‹© ä½¿ç”¨ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:2:2","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"æ ¸å¿ƒå®¹å™¨æ€»ç»“ å®¹å™¨ç›¸å…³ï¼š BeanFactory æ˜¯ IoC å®¹å™¨çš„é¡¶å±‚æ¥å£ï¼Œåˆå§‹åŒ– BeanFactory å¯¹è±¡æ—¶ï¼ŒåŠ è½½çš„ bean å»¶è¿ŸåŠ è½½ ApplicationContext æ¥å£æ˜¯ Spring å®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œåˆå§‹åŒ–æ—¶ bean ç«‹å³åŠ è½½ ApplicationContext æ¥å£æä¾›åŸºç¡€çš„ bean æ“ä½œç›¸å…³æ–¹æ³•ï¼Œé€šè¿‡å…¶ä»–æ¥å£æ‰©å±•å…¶åŠŸèƒ½ ApplicationContext æ¥å£å¸¸ç”¨åˆå§‹åŒ–ç±» ClassPathXmlApplicationContext FileSystemXmlApplicationContext Bean ç›¸å…³ï¼š \u003cbean /\u003e id bean çš„ id name bean åˆ«å class bean ç±»å‹ï¼Œé™æ€å·¥å‚ç±»ï¼ŒFactoryBean ç±» scope æ§åˆ¶ bean çš„å®ä¾‹æ•°é‡ init-method ç”Ÿå‘½å‘¨æœŸåˆå§‹åŒ–æ–¹æ³• destroy-method ç”Ÿå‘½å‘¨æœŸé”€æ¯æ–¹æ³• autowire è‡ªåŠ¨è£…é…ç±»å‹ factory-method bean å·¥å‚æ–¹æ³•ï¼Œåº”ç”¨äºé™æ€å·¥å‚æˆ–å®ä¾‹å·¥å‚ factory-bean å®ä¾‹å·¥å‚ bean lazy-init æ§åˆ¶ bean å»¶è¿ŸåŠ è½½ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:2:3","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"æ³¨è§£ @Component(\"bookDao\") public class BookDaoImpl implements BookDao{ public void save(){ print(\"boook dao save\"); } } \u003ccontext:component-scan base-package=\"com.jerry\"/\u003e \u003c!--æ‰«æ com.jerry ä¸‹çš„æ‰€æœ‰çš„åŒ…--\u003e @Component æ³¨è§£ä»£è¡¨äº†åŸæ¥ä½¿ç”¨ applicationContext.xml ä¸­çš„ \u003cbean id=\"bookDao\" class=\"com.jerry.dao.impl.BookDaoImpl\"/\u003e ","date":"2022-08-05","objectID":"/20220805_spring-intro/:3:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"è¡ç”Ÿæ³¨è§£å®šä¹‰ bean Spring æä¾› @Component æ³¨è§£çš„ä¸‰ä¸ªè¡ç”Ÿæ³¨è§£ï¼Œå’Œ @Component åŠŸèƒ½ä¸€æ ·ï¼Œåªæ˜¯æ–¹ä¾¿ç†è§£ã€‚ @Controllerï¼šç”¨äºè¡¨ç°å±‚ bean å®šä¹‰ @Serviceï¼šç”¨äºä¸šåŠ¡å±‚ bean å®šä¹‰ @Repositoryï¼šç”¨äºæ•°æ®å±‚ bean å®šä¹‰ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:3:1","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"çº¯æ³¨è§£å¼€å‘ Spring 3.0 å¼€å§‹äº†çº¯æ³¨è§£å¼€å‘æ¨¡å¼ï¼Œä½¿ç”¨ Java ç±»æ›¿ä»£é…ç½®æ–‡ä»¶ï¼Œå¼€å¯äº† Spring å¿«é€Ÿå¼€å‘ Java ç±»ä»£æ›¿ Spring æ ¸å¿ƒé…ç½®æ–‡ä»¶ @Configuration @ComponentScan(\"com.jerry\") public class SpringConfig{...} ä¸¤ä¸ªæ³¨è§£å®Œå…¨ä»£æ›¿äº†åŸæœ¬çš„ applicationContext.xml æ–‡ä»¶ï¼Œä¸éœ€å†ä½¿ç”¨é…ç½®æ–‡ä»¶ è¯»å– Spring æ ¸å¿ƒé…ç½®æ–‡ä»¶åˆå§‹åŒ–å®¹å™¨å¯¹è±¡åˆ‡æ¢ä¸ºè¯»å– Java é…ç½®ç±»åˆå§‹åŒ–å®¹å™¨å¯¹è±¡ ApplicationContext ctx = new ClassPathXmlApplicationContext(\"applicationContext.xml\"); ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class); Bean çš„ä½œç”¨èŒƒå›´ ä½¿ç”¨ @Scope å®šä¹‰ bean ä½œç”¨èŒƒå›´ ä½¿ç”¨ @PostConstructã€@PreDestroy å®šä¹‰ bean ç”Ÿå‘½å‘¨æœŸ @Repository @Scope(\"singletion\") public class BookDaoImpl implements BookDao{ public BookDaoImpl(){print(\"...\")} @PostConstruct public void init(){print(\"...\")} @PreDestroy public void destroy(){print(\"...\")} } ä¾èµ–æ³¨å…¥ ä½¿ç”¨ @Autowired æ³¨è§£å¼€å¯è‡ªåŠ¨è£…é…æ¨¡å¼ï¼ˆæŒ‰ç±»å‹ï¼‰ @Service public class BookServiceImpl implements BookService{ //////////////////////////////// @Autowired private BookDao bookDao; //@Autowired ä»£æ›¿äº† setter æ–¹æ³• //public void setBookDao(BookDao bookDao){ // this.bookDao = bookDao; //} //////////////////////////////// public void save(){ bookDao.save(); } } æ³¨æ„ï¼š è‡ªåŠ¨è£…é…åŸºäºåå°„è®¾è®¡åˆ›å»ºå¯¹è±¡å¹¶æš´åŠ›åå°„å¯¹åº”å±æ€§ä¸ºç§æœ‰å±æ€§åˆå§‹åŒ–æ•°æ®ï¼Œå› æ­¤æ— éœ€æä¾› setter æ–¹æ³• è‡ªåŠ¨è£…é…å»ºè®®ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆé»˜è®¤ï¼‰ï¼Œå¦‚æœä¸æä¾›å¯¹åº”æ„é€ æ–¹æ³•ï¼Œè¯·æä¾›å”¯ä¸€çš„æ„é€ æ–¹æ³• ä½¿ç”¨ @Qualifier æ³¨è§£å¼€å¯æŒ‡å®šåç§°è£…é… bean @Autowired @Qualifier(\"bookDao\") private BookDao bookDao; ä½¿ç”¨ @Value å®ç°ç®€å•ç±»å‹æ³¨å…¥ @Repository(\"bookDao\") public class BookDaoImpl implements BookDao{ @Value(\"100\") private String connectionNum; } @Repository(\"bookDao\") public class BookDaoImpl implements BookDao{ @Value(\"${connectionNum}\") private String connectionNum; } ç¬¬ä¸‰æ–¹ bean ç®¡ç† å°†ç‹¬ç«‹çš„é…ç½®ç±»åŠ å…¥æ ¸å¿ƒé…ç½® å¯¼å…¥å¼ public class JdbcConfig{ @Bean public DataSource dataSource(){ DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® return ds; } } ä½¿ç”¨ @Import æ³¨è§£æ‰‹åŠ¨åŠ å…¥é…ç½®ç±»åˆ°æ ¸å¿ƒé…ç½®ï¼Œæ­¤æ³¨è§£åªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ä½¿ç”¨æ•°ç»„æ ¼å¼ @Configuration @Import(JdbcConfig.class) public class SpringConfig{} ç¬¬ä¸‰æ–¹ bean ä¾èµ–æ³¨å…¥ ç®€å•ç±»å‹ä¾èµ–æ³¨å…¥ public class JdbcConfig{ @Value(\"com.mysql.jdbc.Driver\") private String driver; @Value(\"jdbc:mysql://localhost:3306/spring_db\") private String url; //... @Bean public DataSource dataSource(){ DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); return ds; } } å¼•ç”¨ç±»å‹ä¾èµ–æ³¨å…¥ @Bean public DataSource dataSource(BookService bookService){ print(bookService); DruidDataSource ds = new DruidDataSource(); //å±æ€§è®¾ç½® return ds; } å¼•ç”¨ç±»å‹æ³¨å…¥åªéœ€è¦ä¸º bean å®šä¹‰æ–¹æ³•è®¾ç½®å½¢å‚å³å¯ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…å¤‡å¯¹è±¡ã€‚ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:3:2","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"æ³¨è§£æ€»ç»“ XML é…ç½®å¯¹æ¯”æ³¨è§£é…ç½® åŠŸèƒ½ XML é…ç½® æ³¨è§£ å®šä¹‰ bean bean æ ‡ç­¾ * id å±æ€§ * class å±æ€§ @Component * @Controller * @Service * @Repository @ComponentScan è®¾ç½®ä¾èµ–æ³¨å…¥ setter æ³¨å…¥ï¼ˆset æ–¹æ³•ï¼‰ * å¼•ç”¨ / ç®€å• æ„é€ å™¨æ³¨å…¥ï¼ˆæ„é€ æ–¹æ³•ï¼‰ * å¼•ç”¨ / ç®€å• è‡ªåŠ¨è£…é… @Autowired * @Qualifier @Value é…ç½®ç¬¬ä¸‰æ–¹ bean bean æ ‡ç­¾ é™æ€å·¥å‚ã€å®ä¾‹å·¥å‚ã€FactoryBean @Bean ä½œç”¨èŒƒå›´ scope å±æ€§ @Scope ç”Ÿå‘½å‘¨æœŸ æ ‡å‡†æ¥å£ * init-method * destroy-method @PostConstructor @PreDestroy ","date":"2022-08-05","objectID":"/20220805_spring-intro/:3:3","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Spring æ•´åˆ MyBatis MyBatis is a popular, open-source persistence framework for Java that simplifies the process of working with databases. MyBatis ç¨‹åºæ ¸å¿ƒå¯¹è±¡åˆ†æ //1. åˆ›å»º SqlSessionFactoryBuilder å¯¹è±¡ SQLSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder(); //2. åŠ è½½ SqlMapConfig.xml é…ç½®æ–‡ä»¶ InputStream inputStream = Resources.getResourceAsStream(\"SqlMapConfig.xml\"); //3. åˆ›å»º SqlSessionFactory å¯¹è±¡ SqlSessionFactory sqlSessionFactory = sqlSeeesionFactoryBuilder.build(inputStream); //4. è·å– SqlSession SqlSession sqlSession = sqlSessionFactory.openSession(); //5. æ‰§è¡Œ SqlSession å¯¹è±¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–ç»“æœ User AccountDao accountDao = sqlSession.getMapper(AccountDao.class); Account ac = accountDao.findById(2); println(ac); //6. é‡Šæ”¾èµ„æº sqlSession.cloase(); ä½¿ç”¨ bean æ›¿æ¢åŸå§‹çš„ mybatis-config.xml ä¸­çš„ç¯å¢ƒé…ç½® @Bean public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource){ SqlSesssionFactoryBean ssfb = new SqlSessionFactoryBean(); ssfb.setTypeAliasesPackage(\"com.jerry.domain\"); ssfb.setDataSource(dataSource); return ssfb; } ä½¿ç”¨ bean æ›¿æ¢åŸå§‹çš„ mybatis-config.xml ä¸­çš„ mapper é…ç½® @Bean public MapperScannerConfigurer mapperScannerConfigurer(){ MapperScannerConfigurer msc = new MapperScannerConfigurer(); msc.setBasePackage(\"com.jerry.dao\"); return msc; } ","date":"2022-08-05","objectID":"/20220805_spring-intro/:4:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Spring æ•´åˆ JUnit ä½¿ç”¨ Spring æ•´åˆ JUnit ä¸“ç”¨çš„ç±»åŠ è½½å™¨ @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(classes = SpringConfig.class) public class BookServiceTest{ @Autowired private BookService bookService; @Test public void testSave(){ bookService.save(); } } ","date":"2022-08-05","objectID":"/20220805_spring-intro/:5:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"AOP AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡ŒåŠŸèƒ½å¢å¼º Spring ç†å¿µï¼šæ— ä¾µå…¥å¼ AOP æ ¸å¿ƒæ¦‚å¿µ è¿æ¥ç‚¹ï¼ˆJoinPointï¼‰ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„ä½ç½®ï¼Œç²’åº¦ä¸ºæ‰§è¡Œæ–¹æ³•ã€æŠ›å‡ºå¼‚å¸¸ã€è®¾ç½®å˜é‡ç­‰ åœ¨ SpringAOP ä¸­ï¼Œç†è§£ä¸ºæ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­ åœ¨ SpringAOP ä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹å¯ä»¥åªæè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªæ–¹æ³• ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼šcom.jerry.dao åŒ…ä¸‹çš„ BookDao æ¥å£ä¸­çš„æ— å½¢å‚æ— è¿”å›å€¼çš„ save æ–¹æ³• åŒ¹é…å¤šä¸ªæ–¹æ³•ï¼šæ‰€æœ‰çš„ save æ–¹æ³•ï¼Œæ‰€æœ‰çš„ get å¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥ Dao ç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦ä¸€ä¸ªå‚æ•°çš„æ–¹æ³• é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ åœ¨ SpringAOP ä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç° é€šçŸ¥ç±»ï¼šå®šä¹‰é€šçŸ¥çš„ç±» åˆ‡é¢ï¼ˆAspectï¼‰ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³» ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"å®ä¾‹ æ¡ˆä¾‹è®¾å®šï¼šæµ‹å®šæ¥å£æ‰§è¡Œæ•ˆç‡ ç®€åŒ–è®¾å®šï¼šåœ¨æ¥å£æ‰§è¡Œå‰è¾“å‡ºå½“å‰ç³»ç»Ÿæ—¶é—´ å¼€å‘æ¨¡å¼ï¼šXML æˆ– æ³¨è§£ æ€è·¯åˆ†æï¼š å¯¼å…¥åæ ‡ï¼ˆpom.xmlï¼‰ åˆ¶ä½œè¿æ¥ç‚¹æ–¹æ³•ï¼ˆåŸå§‹æ“ä½œï¼ŒDao æ¥å£ä¸å®ç°ç±»ï¼‰ åˆ¶ä½œå…±æ€§åŠŸèƒ½ï¼ˆé€šçŸ¥ç±»ä¸é€šçŸ¥ï¼‰ å®šä¹‰åˆ‡å…¥ç‚¹ ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»ï¼ˆåˆ‡é¢ï¼‰ public class MyAdvice{ @Pointcut(\"execution(void com.jerry.dao.BookDao.update())\") private void pt(){} @Before(\"pt()\") public void before(){ println(\"before the func\"); } } ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:1","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"AOP å·¥ä½œæµç¨‹ Spring å®¹å™¨å¯åŠ¨ è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹ åˆå§‹åŒ– beanï¼Œåˆ¤å®š bean å¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹ åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºå¯¹è±¡ åŒ¹é…æˆåŠŸï¼Œåˆ›å»ºåŸå§‹å¯¹è±¡ï¼ˆç›®æ ‡å¯¹è±¡ï¼‰çš„ä»£ç†å¯¹è±¡ è·å– bean æ‰§è¡Œæ–¹æ³• è·å– beanï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ è·å–çš„ bean æ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºçš„å†…å®¹ï¼Œå®Œæˆæ“ä½œ SpringAOPæœ¬è´¨ï¼šä»£ç†æ¨¡å¼ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:2","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"AOP åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:3","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"AOP é€šçŸ¥ç±»å‹ AOP é€šçŸ¥å…±åˆ†ä¸º 5 ç§ç±»å‹ å‰ç½®é€šçŸ¥ åç½®é€šçŸ¥ ç¯ç»•é€šçŸ¥ï¼ˆé‡ç‚¹ï¼‰ è¿”å›åé€šçŸ¥ï¼ˆäº†è§£ï¼‰ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼ˆäº†è§£ï¼‰ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:4","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Demo ç»Ÿè®¡æ‰§è¡Œæ—¶é—´ ç»Ÿè®¡ä¸€ä¸ªæ–¹æ³•ä¸‡æ¬¡æ‰§è¡Œæ—¶é—´ @Aspect public class ProjectAdvice{ @Pointcut(\"execution(* com.jerry.service.*Service.*(..))\") private void servicePt(){} @Around(\"servicePt()\") public void runSpeed(ProceedingJoinPoint pjp) throws Throwable{ //è·å–æ‰§è¡Œç­¾åä¿¡æ¯ Signature signature = pjp.getSignature(); //é€šè¿‡ç­¾åè·å–æ‰§è¡Œç±»å‹ï¼ˆæ¥å£åï¼‰ String className = signature.getDeclaringTypeName(); //é€šè¿‡ç­¾åè·å–æ‰§è¡Œæ“ä½œåç§°ï¼ˆæ–¹æ³•åï¼‰ String methodName = signature.getName(); long start = System.currentTimeMillis(); for(int i = 0; i \u003c 10000; i++){ pjp.proceed(); } long end = System.currentTimeMillis(); println(\"ä¸šåŠ¡å±‚æ¥å£ä¸‡æ¬¡æ‰§è¡Œæ—¶é—´ï¼š\"+ className + methodName + \"ï¼š\" + (end - start) + \"ms\"); } } ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:5","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"AOP é€šçŸ¥è·å–æ•°æ® è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ProceedJoinPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹è¿”å›å€¼ è¿”å›åé€šçŸ¥ ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ ","date":"2022-08-05","objectID":"/20220805_spring-intro/:6:6","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"äº‹åŠ¡ äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæ—¶æˆåŠŸåŒæ—¶å¤±è´¥ Spring äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–ä¸šåŠ¡å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæ—¶æˆåŠŸåŒæ—¶å¤±è´¥ public interface PlatformTransactionManager{ void commit(TransactionStatus status) throws TransactionException; void roolback(TransactionStatus status) throws TransactionException; } public class DataSourceTransactionManager{ //... } ","date":"2022-08-05","objectID":"/20220805_spring-intro/:7:0","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Demo é“¶è¡Œè½¬è´¦ æ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œï¼ŒæŒ‡å®šè´¦æˆ·å‡é’±ï¼ˆoutMoneyï¼‰ï¼ŒæŒ‡å®šè´¦æˆ·åŠ é’±ï¼ˆinMoneyï¼‰ ä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œï¼ˆtransferï¼‰ï¼Œè°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ åŸºäº Spring æ•´åˆ MyBatista ç¯å¢ƒæ­å»º æ­¥éª¤ï¼š åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸Šæ·»åŠ äº‹åŠ¡ç®¡ç† public interface AccountService{ @Transactional public void transer(String out, String in, Double money); } æ³¨æ„äº‹é¡¹ Spring æ³¨è§£å¼äº‹åŠ¡é€šå¸¸æ·»åŠ åœ¨ä¸šåŠ¡å±‚æ¥å£ä¸­è€Œä¸ä¼šæ·»åŠ åˆ°ä¸šåŠ¡å±‚å®ç°ç±»ä¸­ï¼Œé™ä½è€¦åˆ è®¾ç½®äº‹åŠ¡ç®¡ç†å™¨ @Bean public PlatformTransactionManager transactionManager(DataSource dataSource){ DataSourceTransactionManager ptm = new DataSourceTransactionManager(); ptm.setDataSource(dataSource); return ptm; } æ³¨æ„äº‹é¡¹ äº‹åŠ¡ç®¡ç†å™¨è¦æ ¹æ®å®ç°æŠ€æœ¯è¿›è¡Œé€‰æ‹© MyBatisæ¡†æ¶ä½¿ç”¨çš„æ˜¯ JDBC äº‹åŠ¡ å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨ @Configuration @ComponentScan(\"com.jerry\") @PropertySource(\"classpath:jdbc.properties\") @Import({JdbcConfig.class, MybatisConfig.class}) @EnableTransactionMangement public class SpringConfig{} ","date":"2022-08-05","objectID":"/20220805_spring-intro/:7:1","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"äº‹åŠ¡ä¼ æ’­è¡Œä¸º åœºæ™¯ï¼šäº¤æ˜“è®°å½•åå¹¶å†™å…¥æ—¥å¿—ã€‚ é—®é¢˜ï¼šå› ä¸ºäº¤æ˜“å’Œå†™å…¥æ—¥å¿—é»˜è®¤ä¸ºåŒä¸€äº‹åŠ¡ï¼Œå¦‚æœäº¤æ˜“å‡ºé”™ï¼Œä¹Ÿä¸ä¼šå†™å…¥æ—¥å¿—ã€‚ è§£å†³ï¼šç»™äº‹åŠ¡æ·»åŠ ä¼ æ’­å±æ€§ï¼Œè®©å…¶å½¢æˆæ–°äº‹åŠ¡ã€‚ @Transactional(æ·»åŠ ä¼ æ’­å±æ€§) ä¼ æ’­å±æ€§ äº‹åŠ¡ç®¡ç†å‘˜ äº‹åŠ¡åè°ƒå‘˜ REQUIREDï¼ˆé»˜è®¤ï¼‰ å¼€å¯T åŠ å…¥T æ—  æ–°å»ºT2 REQUIRES_NEW å¼€å¯T æ–°å»ºT2 æ—  æ–°å»ºT2 SUPPORTS å¼€å¯T åŠ å…¥T æ—  æ—  NOT_SUPPORTED å¼€å¯T æ—  æ—  æ—  MANDATORY å¼€å¯T åŠ å…¥T æ—  ERROR NEVER å¼€å¯T ERROR æ—  æ—  NESTED è®¾ç½® savePointï¼Œ ç”±å®¢æˆ·å“åº”æäº¤ / å›æ»š ","date":"2022-08-05","objectID":"/20220805_spring-intro/:7:2","tags":["Java","Spring"],"title":"Spring Framework Introduction","uri":"/20220805_spring-intro/"},{"categories":["Technology"],"content":"Spark SQL is the top active component in spark 3.0 release. Most of the resolved tickets are for Spark SQL. These enhancements benefit all the higher-level libraries, including structured streaming and MLlib, and higher level APIs, including SQL and DataFrames. Various related optimizations are added in latest release. ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:0:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"Explain æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:1:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"è¯­æ³• .explain(mode=\"xxx\") explain(mode=\"simple\"): åªå±•ç¤ºç‰©ç†æ‰§è¡Œè®¡åˆ’ explain(mode=\"extended\"): å±•ç¤ºç‰©ç†è®¡åˆ’å’Œé€»è¾‘æ‰§è¡Œè®¡åˆ’ \"codegen\": å±•ç¤º codegen ç”Ÿæˆçš„å¯æ‰§è¡Œ Java ä»£ç  \"cost\": å±•ç¤ºä¼˜åŒ–åçš„é€»è¾‘æ‰§è¡Œè®¡åˆ’ä»¥åŠç›¸å…³çš„ç»Ÿè®¡ \"formatted\": åˆ†éš”è¾“å‡ºï¼Œè¾“å‡ºæ›´æ˜“è¯»çš„ç‰©ç†æ‰§è¡Œè®¡åˆ’å¹¶å±•ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:1:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ‰§è¡Œè®¡åˆ’å¤„ç†æµç¨‹ å¤„ç†æµç¨‹ æ ¸å¿ƒè¿‡ç¨‹ ğŸ”´Unresolved é€»è¾‘æ‰§è¡Œè®¡åˆ’ï¼š== Parsed Logical Plan == Parser ç»„ä»¶æ£€æŸ¥ SQL è¯­æ³•æ˜¯å¦æœ‰é—®é¢˜ï¼Œç„¶åç”Ÿæˆ Unresolved çš„é€»è¾‘è®¡åˆ’ï¼Œä¸æ£€æŸ¥è¡¨åã€ä¸æ£€æŸ¥åˆ—æ˜ ğŸŸ Resolved é€»è¾‘æ‰§è¡Œè®¡åˆ’ï¼š==Analyzed Logical Plan == Spark ä¸­çš„ Catalog å­˜å‚¨åº“æ¥è§£æéªŒè¯è¯­ä¹‰ã€åˆ—åã€ç±»å‹ã€è¡¨åç­‰ ğŸŸ¡ä¼˜åŒ–åçš„é€»è¾‘æ‰§è¡Œè®¡åˆ’ï¼š== Optimized Logical Plan == Catalyst ä¼˜åŒ–å™¨æ ¹æ®å„ç§è§„åˆ™è¿›è¡Œä¼˜åŒ– ğŸŸ¢ç‰©ç†æ‰§è¡Œè®¡åˆ’ï¼š== Physical Plan == HashAggregate è¿ç®—ç¬¦è¡¨ç¤ºæ•°æ®èšåˆï¼Œä¸€èˆ¬ HashAggregate æ˜¯æˆå¯¹å‡ºç°ï¼Œç¬¬ä¸€ä¸ª HashAggregate æ˜¯å°†æ‰§è¡ŒèŠ‚ç‚¹æœ¬åœ°çš„æ•°æ®è¿›è¡Œå±€éƒ¨èšåˆï¼Œå¦ä¸€ä¸ª HashAggregate æ˜¯å°†å„ä¸ªåˆ†åŒºçš„æ•°æ®è¿›è¡Œèšåˆè®¡ç®— Exchange è¿ç®—ç¬¦å…¶å®å°±æ˜¯ shuffleï¼Œè¡¨ç¤ºéœ€è¦åœ¨é›†ç¾¤ä¸Šç§»åŠ¨æ•°æ®ã€‚å¾ˆå¤šæ—¶å€™ HashAggregate ä¼šä»¥ Exchange åˆ†éš”å¼€ Projectè¿ç®—ç¬¦æ˜¯ SQL ä¸­çš„é€‰æ‹©åˆ—ï¼Œselect name, age BroadcastHashJoinè¡¨ç¤ºé€šè¿‡åŸºäºå¹¿æ’­æ–¹å¼è¿›è¡Œ HashJoin LocalTableScan è¡¨ç¤ºå…¨è¡¨æ‰«ææœ¬åœ°çš„è¡¨ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:1:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"èµ„æºè°ƒä¼˜ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:2:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"èµ„æºè§„åˆ’ èµ„æºè®¾å®šè€ƒè™‘ æ€»ä½“åŸåˆ™ å•å°æœåŠ¡å™¨ 128G å†…å­˜ï¼Œ32çº¿ç¨‹ã€‚ å…ˆè®¾å®šå•ä¸ª Executor æ ¸æ•°ï¼Œæ ¹æ® Yarn é…ç½®å¾—å‡ºæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šçš„ Executor æ•°é‡ï¼Œ(Yarn æ€»æ ¸æ•° / æ¯ä¸ªexecutoræ ¸æ•°(é€šå¸¸ä¸º4)) = å•ä¸ªèŠ‚ç‚¹çš„executoræ•°é‡ï¼› 28 / 4 = 7 å•ä¸ªèŠ‚ç‚¹çš„executoræ•°é‡ï¼› æ€»çš„ executor æ•° = å•èŠ‚ç‚¹executoræ•°é‡ * nmèŠ‚ç‚¹æ•°ã€‚ å…·ä½“æäº¤å‚æ•° executor-cores æ¯ä¸ª executor çš„æœ€å¤§æ ¸æ•°ã€‚3 ~ 6 ä¹‹é—´æ¯”è¾ƒåˆç†ï¼Œé€šå¸¸ä¸º4 num-executors num-executors = æ¯ä¸ªèŠ‚ç‚¹çš„ executor æ•° * work èŠ‚ç‚¹æ•°ï¼› æ¯ä¸ª node çš„ executor æ•° = å•èŠ‚ç‚¹ yarn æ€»æ ¸æ•° / æ¯ä¸ª executor çš„æœ€å¤§ cpu æ ¸æ•°ï¼› 32çº¿ç¨‹æœ‰28çº¿ç¨‹ç”¨åœ¨ Yarn ä¸Šï¼› é‚£ä¹ˆæ¯ä¸ª node çš„ executor æ•° = 28 / 4 = 7ï¼› å‡è®¾é›†ç¾¤èŠ‚ç‚¹ä¸º10ï¼› é‚£ä¹ˆ num-executors = 7 * 10 = 70ã€‚ executor-memoryâ­ executor-memory = Yarn å†…å­˜ / å•ä¸ªèŠ‚ç‚¹çš„executoræ•°é‡ï¼› 100G(æ€»128G, 100G ç»™ Yarn) / 7 = 14G; å†…å­˜è®¾ç½® ä¸€ä¸ª executor å†…éƒ¨ å †å†…å­˜æ¨¡å‹ ğŸŸ¢ä¼°ç®— Other å†…å­˜ = è‡ªå®šä¹‰æ•°æ®ç»“æ„ * æ¯ä¸ª Executor æ ¸æ•° ğŸ”µä¼°ç®— Storage å†…å­˜ = å¹¿æ’­å˜é‡ + cache/Executor æ•°é‡ ğŸŸ£ä¼°ç®— Executor å†…å­˜ = æ¯ä¸ª Executor æ ¸æ•° * (æ•°æ®é›†å¤§å°/å¹¶è¡Œåº¦) Sparksql å¹¶è¡Œåº¦é»˜è®¤ä¸º 200ï¼Œå¹¶è¡Œåº¦å³ä¸º Task æ•°é‡ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:2:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æŒä¹…åŒ–å’Œåºåˆ—åŒ– RDD Kryo åºåˆ—åŒ–ç¼“å­˜ ä½¿ç”¨ï¼š sparkConf æŒ‡å®š kryo åºåˆ—åŒ–å™¨ sparkConf æ³¨å†Œæ ·ä¾‹ç±» new SparkConf() ... .set(\"spark.serializer\",\"...kryoSerializer\") .registerKryoClasses(Array(classOf[...])) result.persist(StorageLevel.MEMORY_ONLY_SER) æµ‹è¯•ï¼š 2G çš„ HIVE å…ƒæ•°æ®ï¼Œä½¿ç”¨ RDD ç¼“å­˜ï¼Œå®Œæˆ 100% Fraction Cached éœ€è¦ 7 Gå·¦å³å†…å­˜ï¼Œä½¿ partition å¾ˆå®¹æ˜“æŒ‚æ‰ã€‚ä½¿ç”¨ Kryo åºåˆ—å™¨å®Œæˆ Cached éœ€è¦ 1 Gå†…å­˜ã€‚ DFã€DS cache é»˜è®¤ä½¿ç”¨ MEMORY_AND_DISKç¼“å­˜ Note åºåˆ—åŒ–å™¨(Java, Kryo)æ˜¯é’ˆå¯¹ RDD è€Œè¨€çš„ï¼›è€Œ DFã€DS æ˜¯ç”± encoder é€‰æ‹©çš„ã€‚ encoder ç”± SparkSql è‡ªå·±å®ç°çš„ï¼Œä¹Ÿæœ‰å¯èƒ½ä½¿ç”¨ kryo çš„æ–¹å¼ã€‚ å¯¹ DFã€DSä½¿ç”¨åºåˆ—åŒ–å·®åˆ«ä¸å¤§ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:2:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"CPUä¼˜åŒ– CPU ä½æ•ˆåŸå›  å¹¶è¡Œåº¦ å¹¶è¡Œåº¦å°±æ˜¯ Task æ•°é‡ã€‚ ğŸŸ RDD å¹¶è¡Œåº¦å‚æ•°ï¼š spark.default.parallelism ä¸è®¾ç½®æ—¶ï¼Œé»˜è®¤ç”± joinã€reduceByKey å’Œ parallelize ç­‰è½¬æ¢å†³å®šã€‚ ğŸŸ¡SparkSQL å¹¶è¡Œåº¦å‚æ•°ï¼šä¸ RDD å¹¶è¡Œåº¦äº’ä¸å½±å“ spark.sql.shuffle.partitions é»˜è®¤æ˜¯ 200ï¼Œåªèƒ½æ§åˆ¶ SparkSQLã€DataFrameã€Dataset åˆ†åŒºä¸ªæ•°ã€‚ å¹¶å‘åº¦ å¹¶å‘åº¦ï¼šåŒæ—¶æ‰§è¡Œçš„ Task æ•°é‡ã€‚ CPU ä½æ•ˆåŸå›  å¹¶è¡Œåº¦è¾ƒä½ã€æ•°æ®åˆ†ç‰‡è¾ƒå¤§å®¹æ˜“å¯¼è‡´ CPU çº¿ç¨‹æŒ‚èµ·ï¼› å¹¶è¡Œåº¦è¿‡é«˜ã€æ•°æ®è¿‡äºåˆ†æ•£ä¼šè®©è°ƒåº¦å¼€é”€æ›´å¤šï¼› CPU èµ„æºè°ƒæ•´ spark-submit --master yarn --deploy-mode client --driver-memory 1g --num-executors 3 --executor-cores 4 --executor-memory 6g --class com.jar ğŸŸ£å®˜æ–¹æ¨èå¹¶è¡Œåº¦ï¼ˆTask æ•°ï¼‰è®¾ç½®æˆå¹¶å‘åº¦ï¼ˆvcore æ•°ï¼‰çš„ 2 å€åˆ° 3 å€ã€‚ ä¾‹ï¼šå¦‚æœä»¥ç›®å‰çš„èµ„æºï¼ˆ3 ä¸ª executorï¼‰å»æäº¤ï¼Œæ¯ä¸ª executor æœ‰ä¸¤ä¸ªæ ¸ï¼Œæ€»å…± 6 ä¸ªæ ¸ï¼Œåˆ™å¹¶è¡Œåº¦è®¾ç½®ä¸º 12 ~ 18ã€‚ SparkConf() ... .set(\"spark.sql.shuffle.partitions\", \"18\") ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:2:3","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"SparkSQL è¯­æ³•ä¼˜åŒ– ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:3:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"åŸºäº RBO ä¼˜åŒ– è°“è¯ä¸‹æ¨ //=============Inner on å·¦è¡¨============= spark.sqlContext.sql( \"\"\" |select | l.id, | l.name, | r.id, | r.name |from course l join student r | on l.id=r.id and l.dt=r.dt and l.dn=r.dn |on l.id\u003c2 |\"\"\".stripMargin) //=============Inner where å·¦è¡¨============= spark.sqlContext.sql( \"\"\" |select | l.id, | l.name, | r.id, | r.name |from course l join student r | on l.id=r.id and l.dt=r.dt and l.dn=r.dn |where l.id\u003c2 |\"\"\".stripMargin) inner join æ— è®ºæ˜¯ ON è¿˜æ˜¯ WHEREï¼Œæ— è®ºæ¡ä»¶æ˜¯å³è¡¨è¿˜æ˜¯å·¦è¡¨ã€‚ä» logic plan -\u003e Analyzed logical plan åˆ° optimized logical planï¼ŒsparkSQL éƒ½ä¼šä¼˜åŒ–å…ˆè¿‡æ»¤æ•°æ®å†è¿›è¡Œ join è¿æ¥ï¼Œè€Œä¸”å…¶ä¸­ä¸€è¡¨è¿‡æ»¤ï¼Œå¦ä¸€è¡¨ä¹Ÿä¼˜åŒ–æå‰è¿‡æ»¤ï¼ˆæœ€ç»ˆè¦è¿‡æ»¤æ•°æ®ï¼Œå¦ä¸€è¡¨ä¹Ÿæ²¡æœ‰å­˜åœ¨çš„å¿…è¦ï¼‰ left join æ¡ä»¶åœ¨ å·¦è¡¨ æ¡ä»¶åœ¨ å³è¡¨ æ¡ä»¶åœ¨ on å åªä¸‹æ¨å³è¡¨ åªä¸‹æ¨å³è¡¨ æ¡ä»¶åœ¨ where å ä¸¤è¡¨éƒ½ä¸‹æ¨ ä¸¤è¡¨éƒ½ä¸‹æ¨ æ³¨æ„ï¼šå¤–å…³è”æ—¶ï¼Œè¿‡æ»¤æ¡ä»¶åœ¨ on ä¸ whereï¼Œè¯­ä¹‰æ˜¯ä¸åŒçš„ï¼Œç»“æœä¹Ÿæ˜¯ä¸åŒçš„ã€‚ åˆ—è£å‰ª æ‰«ææ•°æ®æºçš„æ—¶å€™ï¼Œåªè¯»å–é‚£äº›ä¸æŸ¥è¯¢ç›¸å…³çš„å­—æ®µã€‚ å¸¸é‡æ›¿æ¢ Catalyst ä¼šä½¿ç”¨ constantFolding è§„åˆ™ï¼Œè‡ªåŠ¨ç”¨è¡¨è¾¾å¼çš„ç»“æœè¿›è¡Œæ›¿æ¢ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:3:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"åŸºäº CBO ä¼˜åŒ– Statistics æ”¶é›† éœ€è¦å…ˆæ‰§è¡Œç‰¹å®šçš„ SQL è¯­å¥æ¥æ”¶é›†æ‰€éœ€çš„è¡¨å’Œåˆ—çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ ğŸ”µ ç”Ÿæˆè¡¨çº§åˆ«ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ‰«è¡¨ï¼‰ï¼š ANALYZE TABLE è¡¨æ˜ COMPUTE STATISTICS ä½¿ç”¨ CBO é€šè¿‡ spark.sql.cbo.enabled æ¥å¼€å¯ï¼Œé»˜è®¤æ˜¯ falseã€‚CBO ä¼˜åŒ–å™¨å¯ä»¥åŸºäºè¡¨å’Œåˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œé€‰æ‹©å‡ºæœ€ä¼˜çš„æŸ¥è¯¢è®¡åˆ’ã€‚æ¯”å¦‚ï¼šBuild ä¾§é€‰æ‹©ã€ä¼˜åŒ– Join ç±»å‹ã€ä¼˜åŒ–å¤šè¡¨ Join é¡ºåºã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:3:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"å¹¿æ’­ Join é€šè¿‡å‚æ•°æŒ‡å®šè‡ªåŠ¨å¹¿æ’­ å¹¿æ’­ join é»˜è®¤å€¼ä¸º 10MBï¼Œç”± spark.sql.autoBroadcastJoinThresholdå‚æ•°æ§åˆ¶ã€‚ æŒ‡å®šå¹¿æ’­ sparkSQL åŠ  HINT æ–¹å¼ ä½¿ç”¨ function._ broadcast API ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:3:3","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"SMB Join å¤§è¡¨ JOIN å¤§è¡¨ï¼Œè¿›è¡Œ SMBï¼ˆsort merge bucketï¼‰æ“ä½œï¼š éœ€è¦è¿›è¡Œåˆ†æ¡¶ï¼Œé¦–å…ˆä¼šè¿›è¡Œæ’åºï¼Œç„¶åæ ¹æ® key å€¼åˆå¹¶ï¼ŒæŠŠç›¸åŒ key çš„æ•°æ®æ”¾åˆ°åŒä¸€ä¸ª bucket ä¸­ï¼ˆæŒ‰ç…§ key è¿›è¡Œ hashï¼‰ã€‚åˆ†æ¡¶çš„ç›®çš„å°±æ˜¯æŠŠå¤§è¡¨åŒ–æˆå°è¡¨ã€‚ç›¸åŒçš„ key çš„æ•°æ®éƒ½åœ¨åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œå†è¿›è¡Œ join æ“ä½œï¼Œé‚£ä¹ˆåœ¨è”åˆçš„æ—¶å€™å°±ä¼šå¤§å¹…åº¦çš„å‡å°æ— å…³é¡¹çš„æ‰«æã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:3:4","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ•°æ®å€¾æ–œ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"ç°è±¡ ç»å¤§å¤šæ•° Task ä»»åŠ¡è¿è¡Œé€Ÿåº¦å¾ˆå¿«ï¼Œä½†å‡ ä¸ª Task ä»»åŠ¡è¿è¡Œé€Ÿåº¦æå…¶ç¼“æ…¢ï¼Œæ…¢æ…¢çš„å¯èƒ½æ¥ç€æŠ¥å†…å­˜æº¢å‡ºçš„é—®é¢˜ã€‚ Taskæ•°æ®å€¾æ–œ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"åŸå›  æ•°æ®å€¾æ–œå‘ç”Ÿåœ¨ shuffle ç±»çš„ç®—å­ï¼Œæ¯”å¦‚ distinctã€groupByKeyã€reduceByKeyã€aggregateByKeyã€joinã€cogroup ç­‰ï¼Œæ¶‰åŠåˆ°æ•°æ®é‡åˆ†åŒºï¼Œå¦‚æœå…¶ä¸­æŸä¸€ä¸ª key æ•°é‡ç‰¹åˆ«å¤§ï¼Œå°±å‘ç”Ÿäº†æ•°æ®å€¾æ–œã€‚éœ€è¦å…ˆå¯¹å¤§ Key è¿›è¡Œå®šä½ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ•°æ®å€¾æ–œå¤§ key å®šä½ ä½¿ç”¨æŠ½å–é‡‡æ ·æ–¹æ³• val top10key = df .select(keyColumn).sample(false, 0.1).rdd //æŠ½å– 10% .map(k =\u003e (k, 1)).reduceByKey(_+_) .map(k =\u003e (k._2, k._1)).sortByKey(false) //æŒ‰ç»Ÿè®¡çš„keyè¿›è¡Œæ’åº .take(10) ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:3","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"å•è¡¨æ•°æ®å€¾æ–œä¼˜åŒ– å•è¡¨ä¼˜åŒ– ä¸ºäº†å‡å°‘ shuffle ä»¥åŠ reduce ç«¯çš„å‹åŠ›ï¼ŒSparkSQL ä¼šåœ¨ map ç«¯ä¼šåšä¸€ä¸ª partial aggregateï¼ˆé¢„èšåˆæˆ–è€…åèšåˆï¼‰ï¼Œå³åœ¨ shuffle å‰å°†åŒä¸€åˆ†åŒºå†…æ‰€å±åŒ key çš„è®°å½•å…ˆè¿›è¡Œä¸€ä¸ªé¢„ç»“ç®—ï¼Œå†å°†ç»“æœè¿›è¡Œ shuffleï¼Œå‘é€åˆ° reduce ç«¯åšä¸€ä¸ªæ±‡æ€»ï¼Œç±»ä¼¼ MR çš„æå‰ Combinerï¼Œæ‰€ä»¥æ‰§è¡Œè®¡åˆ’ä¸­ Hashaggregate é€šå¸¸æˆå¯¹å‡ºç°ã€‚ äºŒæ¬¡èšåˆ select id, sum(course) total from ( select remove_random_prefix(random_courseid) courseid, course from ( select random_id, sum(sellmoney) course from ( select random_prefix(id, 6) random_id, sellmoney from doubleAggre )t1 group by random_id )t2 )t3 group by id def randomPrefixUDF(value, num):String = { new Random().nextInt(num).toString + \"_\" + value } def removeRandomPrefixUDF(value):String = { value.toString.split(\"_\")(1) } ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:4","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"Joinæ•°æ®å€¾æ–œä¼˜åŒ– å¹¿æ’­Join é€šè¿‡å‚æ•°æŒ‡å®šè‡ªåŠ¨å¹¿æ’­ å¹¿æ’­ join é»˜è®¤å€¼ä¸º 10MBï¼Œç”± spark.sql.autoBroadcastJoinThresholdå‚æ•°æ§åˆ¶ã€‚ æŒ‡å®šå¹¿æ’­ sparkSQL åŠ  HINT æ–¹å¼ ä½¿ç”¨ function._ broadcast API æ‹†åˆ†å¤§ key æ‰“æ•£å¤§è¡¨ æ‰©å®¹å°è¡¨ ä¸å•è¡¨æ•°æ®å€¾æ–œä¼˜åŒ–çš„äºŒæ¬¡èšåˆä¸åŒï¼Œjoin æ•°æ®å€¾æ–œè°ƒä¼˜è¦å¯¹ä¸¤è¡¨éƒ½è¿›è¡Œè°ƒæ•´ã€‚ å› ä¸ºå¤§è¡¨ä¸ºäº†åˆ†åŒºåŠ å…¥äº†å‰ç¼€ï¼Œä¸ºäº†å’Œå°è¡¨åŒ¹é…ä¸Šï¼Œå°è¡¨ä¹Ÿåº”å»ºç«‹å¯¹åº”çš„å‰ç¼€ä¸ä¹‹åŒ¹é…ã€‚å¦‚ï¼šï¼ˆå‡è®¾æœ‰3ä¸ª taskï¼ŒæŠŠå¤§keyé‡æ–°æ‰“æ•£åˆ°æ‰€æœ‰taskä¸Šï¼‰ 1 1 1 1 1 1 1 1 2 3 Join 1 2 3 æ‹†åˆ†å¤§ key æ‰“æ•£å¤§è¡¨ æ‰©å®¹å°è¡¨ â€”\u003e 0_1 1_1 2_1 0_1 1_1 2_1 0_1 1_1 Join 0_1 1_1 2_1 2 3 Union 2 3 Join 1 2 3 æ‹†åˆ†å€¾æ–œçš„ keyï¼šæ ¹æ® key è¿‡æ»¤å‡ºå€¾æ–œçš„æ•°æ®å’Œé™¤å€¾æ–œå¤–çš„å…¶ä»–æ•°æ®ï¼› å°†åˆ‡æ–œçš„ key æ‰“æ•£ï¼šæ‰“æ•£æˆ task æ•°é‡çš„ä»½æ•°(æ¯”å¦‚æœ‰36ä¸ªtask)ï¼Œkey å€¼å‰åŠ (0 ~ 36)éšæœºæ•°ï¼› å°è¡¨è¿›è¡Œæ‰©å®¹ï¼šæ‰©å¤§æˆ task æ•°é‡çš„ä»½æ•°ï¼Œkey å€¼ç”¨ flatmap ç”Ÿæˆ 36 ä»½ï¼Œi + \"_\" + key å€¾æ–œçš„å¤§ key ä¸æ‰©å®¹åçš„è¡¨è¿›è¡Œjoinï¼› æ²¡æœ‰å€¾æ–œçš„ keyä¸åŸæ¥çš„è¡¨è¿›è¡Œjoinï¼› å°†å€¾æ–œ key join åçš„ç»“æœä¸æ™®é€š key join åçš„ç»“æœï¼Œunionèµ·æ¥ã€‚ ä»£ä»·ï¼šshuffle æ¬¡æ•°å¢å¤šäº†ï¼Œä½†æ˜¯æ¯æ¬¡ shuffle æ•°æ®æ›´å‡åŒ€äº†ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:4:5","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"Job ä¼˜åŒ– ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:5:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"Map ç«¯ä¼˜åŒ– Map ç«¯èšåˆ parkSQL ä¼šåœ¨ map ç«¯ä¼šåšä¸€ä¸ª partial aggregateï¼ˆé¢„èšåˆæˆ–è€…åèšåˆï¼‰ï¼Œå³åœ¨ shuffle å‰å°†åŒä¸€åˆ†åŒºå†…æ‰€å±åŒ key çš„è®°å½•å…ˆè¿›è¡Œä¸€ä¸ªé¢„ç»“ç®—ï¼Œå†å°†ç»“æœè¿›è¡Œ shuffleï¼Œå‘é€åˆ° reduce ç«¯åšä¸€ä¸ªæ±‡æ€»ï¼Œç±»ä¼¼ MR çš„æå‰ Combinerï¼Œæ‰€ä»¥æ‰§è¡Œè®¡åˆ’ä¸­ Hashaggregate é€šå¸¸æˆå¯¹å‡ºç°ã€‚ SparkSQL æœ¬èº«çš„ Hashaggregate å°±ä¼šå®ç°æœ¬åœ°é¢„èšåˆ + å…¨å±€èšåˆã€‚ è¯»å–å°æ–‡ä»¶çš„ä¼˜åŒ– HIVE çš„ CombineHiveInputformat è¾“å…¥æ ¼å¼ä¼šå°†å°æ–‡ä»¶è¯»åˆ°åŒä¸€ä¸ª Map ç«¯é‡Œé¢å»ã€‚ SparkSQL ä¸­ä¹Ÿä¼šè‡ªåŠ¨åˆå¹¶ï¼Œå‚æ•°å¦‚ä¸‹ï¼š spark.sql.files.maxPartitionBytes=128MB #é»˜è®¤ 128m spark.files.openCostInBytes=4194304 #é»˜è®¤ 4m åˆ‡ç‰‡å¤§å° = Math.min(defaultMaxSplitBytes, Math.max(openCostInBytes, bytesPerCore)) bytesPerCore = totalBytes / defaultParallelism è®¡ç®— totalBytes æ—¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½è¦åŠ ä¸Šä¸€ä¸ª open å¼€é”€ï¼š å½“ (æ–‡ä»¶1å¤§å° + openCostInBytes) + (æ–‡ä»¶2å¤§å° + openCostInBytes)+â€¦ \u003c= maxPartitionBytes æ—¶ï¼Œnä¸ªæ–‡ä»¶å¯ä»¥è¯»å…¥åŒä¸€åˆ†åŒºã€‚ å¢å¤§ map æº¢å†™æ—¶è¾“å‡ºæµ buffer SortShuffle æºç ç†è§£ï¼š /** * Spills the current in-memory collection to disk if needed. Attempts to acquire more * memory before spilling. * * @param collection collection to spill to disk * @param currentMemory estimated size of the collection in bytes * @return true if `collection` was spilled to disk; false otherwise */ protected def maybeSpill(collection: C, currentMemory: Long): Boolean = { var shouldSpill = false if (elementsRead % 32 == 0 \u0026\u0026 currentMemory \u003e= myMemoryThreshold) { // Claim up to double our current memory from the shuffle memory pool val amountToRequest = 2 * currentMemory - myMemoryThreshold val granted = acquireMemory(amountToRequest) myMemoryThreshold += granted // If we were granted too little memory to grow further (either tryToAcquire returned 0, // or we already had more memory than myMemoryThreshold), spill the current collection shouldSpill = currentMemory \u003e= myMemoryThreshold } shouldSpill = shouldSpill || _elementsRead \u003e numElementsForceSpillThreshold // Actually spill if (shouldSpill) { _spillCount += 1 logSpillage(currentMemory) spill(collection) _elementsRead = 0 _memoryBytesSpilled += currentMemory releaseMemory() } shouldSpill } map ç«¯ Shuffle Write æœ‰ä¸€ä¸ªç¼“å†²åŒºï¼Œåˆå§‹é˜ˆå€¼ 5mï¼Œè¶…è¿‡é˜ˆå€¼å°è¯•å¢åŠ åˆ° 2*å½“å‰ä½¿ç”¨å†…å­˜ï¼Œè‡ªåŠ¨æ‰©å®¹ã€‚å¦‚æœç”³è¯·ä¸åˆ°å†…å­˜ï¼Œåˆ™è¿›è¡Œæº¢å†™ã€‚è¿™ä¸ªå‚æ•°æ˜¯ internalï¼ŒæŒ‡å®šæ— æ•ˆã€‚ æº¢å†™æ—¶ä½¿ç”¨è¾“å‡ºæµç¼“å†²åŒºé»˜è®¤ 32kï¼Œè¿™äº›ç¼“å†²åŒºå‡å°‘äº†ç£ç›˜æœç´¢å’Œç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ï¼Œé€‚å½“æé«˜å¯ä»¥æå‡æº¢å†™æ•ˆç‡ã€‚ Property Name Default Meaning spark.shuffle.file.buffer 32k Size of the in-memory buffer for each shuffle file output stream, in KiB unless otherwise specified. These buffers reduce the number of disk seeks and system calls made in creating intermediate shuffle files. Shuffle æ–‡ä»¶æ¶‰åŠåˆ°åºåˆ—åŒ–ï¼Œæ˜¯é‡‡ç”¨æ‰¹çš„æ–¹å¼è¯»å†™ï¼Œé»˜è®¤æ²¡æ‰¹æ¬¡ 1 ä¸‡æ¡å»è¯»å†™ï¼Œè®¾ç½®å¾—å¤ªä½ä¼šå¯¼è‡´åœ¨åºåˆ—åŒ–æ—¶è¿‡åº¦å¤åˆ¶ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:5:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"Reduce ç«¯ä¼˜åŒ– åˆç†è®¾ç½® Reduce æ•°é‡ Reduce çš„æ•°é‡ = shuffle åçš„åˆ†åŒºæ•° = ä¹Ÿå°±æ˜¯ Task æ•°é‡ = ä¹Ÿå°±æ˜¯å¹¶è¡Œåº¦ = spark.sql.shuffle.partitions é»˜è®¤çš„200ã€‚ å¹¶å‘åº¦æ˜¯æ•´ä¸ªé›†ç¾¤ spark çš„æ ¸æ•°ï¼Œå¦‚å¹¶å‘åº¦æ˜¯12ï¼Œå¹¶è¡Œåº¦ä¸ºå¹¶å‘åº¦çš„ 3~6 å€ï¼Œè®¾ç½®ä¸º 36 è¿‡å¤šçš„ CPU èµ„æºå‡ºç°ç©ºè½¬æµªè´¹ï¼Œè¿‡å°‘å½±å“ä»»åŠ¡æ€§èƒ½ã€‚ è¾“å‡ºäº§ç”Ÿå°æ–‡ä»¶ä¼˜åŒ– Joinåçš„ç»“æœæ’å…¥æ–°è¡¨ join ç»“æœæ’å…¥æ–°è¡¨ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ•°ç­‰äº shuffle å¹¶è¡Œåº¦ï¼Œé»˜è®¤å°±æ˜¯ 200 ä»½æ’å…¥åˆ° hdfs ä¸Šã€‚ è§£å†³æ–¹å¼ä¸€ï¼šåœ¨æ’å…¥è¡¨æ•°æ®å‰è¿›è¡Œç¼©å°åˆ†åŒºæ“ä½œæ¥è§£å†³å°æ–‡ä»¶è¿‡å¤šé—®é¢˜ï¼Œå¦‚ coalesceã€repartition ç®—å­ã€‚ è§£å†³æ–¹å¼äºŒï¼šè°ƒæ•´å¹¶è¡Œåº¦ã€‚ åŠ¨æ€åˆ†åŒºæ’å…¥æ•°æ® æ²¡æœ‰ shuffle çš„æƒ…å†µä¸‹ã€‚æœ€å·®çš„æƒ…å†µã€‚æ¯ä¸ª Task ä¸­éƒ½æœ‰å„ä¸ªåˆ†åŒºçš„è®°å½•ï¼Œé‚£æœ€ç»ˆæ–‡ä»¶æ•°è¾¾åˆ° Task æ•°é‡ * è¡¨åˆ†åŒºæ•°ã€‚è¿™ç§æƒ…å†µææ˜“äº§ç”Ÿå°æ–‡ä»¶ã€‚ INSERT overwrite table A partition (aa) SELECT * FROM B; åŠ¨æ€åˆ†åŒºæ’å…¥-æ²¡æœ‰shuffle æœ‰ shuffle çš„æƒ…å†µä¸‹ã€‚ä¸Šé¢çš„ Task æ•°é‡å°±å˜æˆäº† 200ã€‚é‚£ä¹ˆæœ€å·®æƒ…å†µå°±ä¼šæœ‰ 200 * è¡¨åˆ†åŒºæ•°ã€‚ å½“ shuffle.partitions è®¾ç½®å¤§äº†å°æ–‡ä»¶é—®é¢˜å°±äº§ç”Ÿäº†ï¼Œè®¾ç½®å°äº†ï¼Œä»»åŠ¡çš„å¹¶è¡Œåº¦å°±ä¸‹é™äº†ï¼Œæ€§èƒ½éšä¹‹å—åˆ°å½±å“ã€‚ æœ€ç†æƒ³çš„æƒ…å†µæ˜¯æ ¹æ®åˆ†åŒºå­—æ®µè¿›è¡Œ shuffleï¼Œåœ¨ä¸Šé¢çš„ SQL ä¸­åŠ å…¥ distribute by aaã€‚æŠŠåŒä¸€åˆ†åŒºçš„è®°å½•éƒ½å“ˆå¸Œåˆ°åŒä¸€åˆ†åŒºä¸­å»ï¼Œç”±ä¸€ä¸ª Spark çš„ Task è¿›è¡Œå†™å…¥ï¼Œè¿™æ ·åªä¼šäº§ç”Ÿ N ä¸ªæ–‡ä»¶ï¼Œä½†è¿™ç§æƒ…å†µä¹Ÿå®¹æ˜“å‡ºç°æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚ åŠ¨æ€åˆ†åŒºæ’å…¥-shuffle æ•°æ®å€¾æ–œè§£å†³æ€è·¯ï¼š ç»“åˆä¹‹å‰è§£å†³æ•°æ®å€¾æ–œçš„æ€è·¯ï¼Œåœ¨ç¡®å®šå“ªä¸ªåˆ†åŒºé”®å€¾æ–œçš„æƒ…å†µä¸‹ï¼Œå°†å€¾æ–œçš„åˆ†åŒºé”®å•ç‹¬æ‹¿å‡ºï¼š å°†å…¥åº“çš„ SQL æ‹†æˆï¼ˆwhere åˆ†åŒº != å€¾æ–œåˆ†åŒºé”®ï¼‰å’Œï¼ˆwhere åˆ†åŒº = å€¾æ–œåˆ†åŒºé”®ï¼‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œéå€¾æ–œåˆ†åŒºé”®çš„éƒ¨åˆ†æ­£å¸¸ distribute by åˆ†åŒºå­—æ®µï¼Œå€¾æ–œåˆ†åŒºé”®çš„éƒ¨åˆ† distribute by éšæœºæ•°ï¼š #1.éå€¾æ–œéƒ¨åˆ† INSERT overwrite table A partition (aa) SELECT * FROM B where aa != å¤§key distribute by aa; #ä¸»åŠ¨äº§ç”Ÿ shuffleï¼Œå°†åŒä¸€ä¸ªåˆ†åŒºçš„æ•°æ®æ”¾åˆ°ä¸€ä¸ª task ä¸­ï¼Œå†æ‰§è¡Œå†™å…¥ #2.å€¾æ–œé”®éƒ¨åˆ† INSERT overwrite table A partition (aa) SELECT * FROM B where aa = å¤§key distribute by cast(rand() * 5 as int); #æ‰“æ•£æˆ5ä»½ï¼Œ5ä¸ªtaskï¼Œå†™å…¥5ä¸ªæ–‡ä»¶ å¢å¤§ reduce ç¼“å†²åŒºï¼Œå‡å°‘æ‹‰å»æ¬¡æ•° ä¸€èˆ¬ä¸ä¼šè°ƒæ•´ï¼ŒShuffleReader.scalaï¼Œé»˜è®¤å€¼ reduce ä¸€æ¬¡è¯»å– 48Mã€‚ è°ƒèŠ‚ reduce ç«¯æ‹‰å–æ•°æ®é‡è¯•æ¬¡æ•° ä¸€èˆ¬ä¸ä¼šè°ƒæ•´ï¼Œé»˜è®¤ä¸º 3 æ¬¡ã€‚ è°ƒèŠ‚ reduce ç«¯æ‹‰å–æ•°æ®ç­‰å¾…é—´éš” ä¸€èˆ¬ä¸ä¼šè°ƒæ•´ï¼Œé»˜è®¤ä¸º 5 ç§’ã€‚ åˆç†åˆ©ç”¨ bypass Property Name Default Meaning spark.shuffle.sort.bypassMergeThreshold 200 (Advanced) In the sort-based shuffle manager, avoid merge-sorting data if there is no map-side aggregation and there are at most this many reduce partitions. å½“ shuffleManager ä¸º SortShuffleManager æ—¶ï¼Œå¦‚æœ shuffle read task çš„æ•°é‡å°äºè¿™ä¸ªé˜ˆå€¼ï¼ˆé»˜è®¤200ï¼‰ä¸”ä¸éœ€è¦ map ç«¯è¿›è¡Œåˆå¹¶æ“ä½œï¼ˆä½¿ç”¨ groupbyã€sum èšåˆç®—å­ä¼šé¢„èšåˆï¼Œä»æ‰§è¡Œè®¡åˆ’å¯ä»¥å¾—çŸ¥æœ‰ä¸€ä¸ª hashaggregate -\u003e exchange -\u003e hashaggregateï¼‰ï¼Œåˆ™shuffle write è¿‡ç¨‹ä¸ä¼šè¿›è¡Œæ’åºï¼Œä½¿ç”¨ BypassMergeSortShuffleWriter å»å†™æ•°æ®ï¼Œä½†æœ€åä¼šå°†æ¯ä¸ª task äº§ç”Ÿçš„æ‰€æœ‰ä¸´æ—¶ç£ç›˜æ–‡ä»¶éƒ½åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¼šåˆ›å»ºå•ç‹¬çš„ç´¢å¼•æ–‡ä»¶ã€‚ å½“ä½¿ç”¨ shuffleManager æ—¶ï¼Œå¦‚æœç¡®å®ä¸éœ€è¦æ’åºæ“ä½œï¼Œé‚£ä¹ˆå»ºè®®å°†è¿™ä¸ªå‚æ•°è°ƒå¤§ä¸€äº›ï¼Œå¤§äº shuffle read task çš„æ•°é‡ã€‚é‚£ä¹ˆæ­¤æ—¶å°±ä¼šè‡ªåŠ¨å¯åŠ¨ bypass æœºåˆ¶ï¼Œmap-side å°±ä¸ä¼šè¿›è¡Œæ’åºäº†ï¼Œå‡å°‘äº†æ’åºçš„æ€§èƒ½å¼€é”€ã€‚ä½†è¿™ç§æ–¹å¼ä¸‹ï¼Œä¾ç„¶ä¼šäº§ç”Ÿå¤§é‡çš„ç£ç›˜æ–‡ä»¶ï¼Œå› æ­¤ shuffle write æ€§èƒ½æœ‰å¾…æé«˜ã€‚ /** * Register a shuffle with the manager and obtain a handle for it to pass to tasks. */ override def registerShuffle[K, V, C]( shuffleId: Int, numMaps: Int, dependency: ShuffleDependency[K, V, C]): ShuffleHandle = { if (SortShuffleWriter.shouldBypassMergeSort(SparkEnv.get.conf, dependency)) { // If there are fewer than spark.shuffle.sort.bypassMergeThreshold partitions and we don't // need map-side aggregation, then write numPartitions files directly and just concatenate // them at the end. This avoids doing serialization and deserialization twice to merge // together the spilled files, which would happen with the normal code path. The downside is // having multiple files open at a time and thus more memory allocated to buffers. new BypassMergeSortShuffleHandle[K, V]( shuffleId, numMaps, dependency.asInstanceOf[ShuffleDependency[K, V, V]]) } else if (SortShuffleManager.canUseSerializedShuffle(dependency)) { // Otherwise, try to buffer map outputs in a serialized form, since this is more efficient: new SerializedShuffleHandle[K, V]( shuffleId, numMaps, dependency.asInstanceOf[ShuffleDependency[K, V, V]]) } else { // Otherwise, buffer map outputs in a deserialized form: new BaseShuffleHandle(shuffleId, numMaps, dependency) } } ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:5:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ•´ä½“ä¼˜åŒ– è°ƒèŠ‚æ•°æ®æœ¬åœ°åŒ–ç­‰å¾…æ—¶é•¿ åœ¨ Spark é¡¹ç›®å¼€å‘é˜¶æ®µï¼Œå¯ä»¥ä½¿ç”¨ client æ¨¡å¼å¯¹ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°æ¯”è¾ƒå…¨çš„æ—¥å¿—ä¿¡æ¯ï¼Œæ—¥å¿—ä¿¡æ¯ä¸­æœ‰æ˜ç¡®çš„ task æ•°æ®æœ¬åœ°åŒ–çš„çº§åˆ«ï¼Œå¦‚æœå¤§éƒ¨åˆ†éƒ½æ˜¯ Process_LOCAL(è¿›ç¨‹æœ¬åœ°åŒ–: æ•°æ®å’Œè®¡ç®—æ˜¯åœ¨åŒä¸€ä¸ªJVMè¿›ç¨‹é‡Œé¢)ã€NODE_LOCAL(èŠ‚ç‚¹æœ¬åœ°åŒ–: æ•°æ®å’Œè®¡ç®—æ˜¯åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š)ï¼Œé‚£ä¹ˆå°±æ— éœ€è¿›è¡Œè°ƒèŠ‚ï¼Œä½†å¦‚æœå¾ˆå¤šæ˜¯ RACK_LOCAL(æœºæ¶æœ¬åœ°åŒ–: æ•°æ®å’Œè®¡ç®—æ˜¯åœ¨åŒä¸€ä¸ªæœºæ¶ä¸Š)ã€ANYï¼Œé‚£ä¹ˆéœ€è¦å¯¹æœ¬åœ°åŒ–çš„ç­‰å¾…æ—¶é•¿è¿›è¡Œè°ƒèŠ‚ï¼Œæ…¢æ…¢è°ƒæ•´å¤§ä¸€äº›ï¼Œåº”è¯¥æ˜¯åå¤è°ƒèŠ‚ï¼Œæ¯æ¬¡è°ƒèŠ‚åè§‚å¯Ÿè¿è¡Œæ—¥å¿—ï¼Œçœ‹çœ‹å¤§éƒ¨åˆ†çš„ task çš„æœ¬åœ°åŒ–çº§åˆ«æœ‰æ²¡æœ‰æå‡ï¼Œè§‚å¯Ÿæ•´ä¸ª spark ä½œä¸šçš„è¿è¡Œæ—¶é—´æœ‰æ²¡æœ‰ç¼©çŸ­ã€‚ ä½¿ç”¨å †å¤–å†…å­˜ å †å¤–å†…å­˜å¯ä»¥å‡è½»åƒåœ¾å›æ”¶çš„å·¥ä½œï¼Œä¹ŸåŠ å¿«äº†å¤åˆ¶çš„é€Ÿåº¦ã€‚ å½“éœ€è¦ç¼“å­˜éå¸¸å¤§çš„æ•°æ®é‡æ—¶ï¼Œè™šæ‹Ÿæœºå°†æ‰¿å—éå¸¸å¤§çš„ GC å‹åŠ›ï¼Œå› ä¸ºè™šæ‹Ÿæ¥å¿…é¡»æ£€æŸ¥æ¯ä¸ªå¯¹è±¡æ˜¯å¦å¯ä»¥æ‰‹æœºå¹¶å¿…é¡»è®¿é—®æ‰€æœ‰å†…å­˜ä¹Ÿï¼Œæœ¬åœ°ç¼“å­˜æ˜¯æœ€å¿«çš„ï¼Œä½†ä¼šç»™è™šæ‹Ÿæœºå¸¦æ¥ GC å‹åŠ›ï¼Œæ‰€ä»¥å½“éœ€è¦å¤„ç†éå¸¸å¤šçš„æ•°æ®é‡æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨å †å¤–å†…å­˜æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå› ä¸ºè¿™ä¸ä¼šç»™ Java GC å¸¦æ¥ä»»ä½•å‹åŠ›ï¼Œè®© Java GC ä¸ºå¼•ç”¨ç¨‹åºå®Œæˆå·¥ä½œï¼Œç¼“å­˜æ“ä½œäº¤ç»™å †å¤–ã€‚ result.persist(StorageLevel.OFF_HEAP) è°ƒèŠ‚è¿æ¥ç­‰å¾…æ—¶é•¿ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:5:3","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ•…éšœæ’é™¤ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:6:0","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"æ§åˆ¶ reduce ç«¯ç¼“å†²å¤§å°ä»¥é¿å… OOM reduce ç¼“å†²åŒºé»˜è®¤ 48 mï¼Œè°ƒå¤§æ˜¯ä»¥æ€§èƒ½æ¢æ‰§è¡Œã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:6:1","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"JVM GC å¯¼è‡´çš„ shuffle æ–‡ä»¶æ‹‰å–å¤±è´¥ GC å¯¼è‡´è¿æ¥åœæ»ï¼Œè¿æ¥åœæ»å¯¼è‡´ timeoutã€‚æé«˜é‡è¯•æ¬¡æ•°å’Œç­‰å¾…æ—¶é•¿ã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:6:2","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Technology"],"content":"å„ç§åºåˆ—åŒ–å¯¼è‡´çš„æŠ¥é”™ ä¸å¯ä»¥åœ¨ RDD çš„å…ƒç´ ç±»å‹ã€ç®—å­å‡½æ•°é‡Œä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸æ”¯æŒåºåˆ—åŒ–çš„ç±»å‹ï¼Œä¾‹å¦‚ connectionã€‚ ","date":"2022-07-19","objectID":"/20220719_spark-optimization/:6:3","tags":["Tuning","Spark","SQL","Hive"],"title":"Spark Performance Tuning","uri":"/20220719_spark-optimization/"},{"categories":["Life"],"content":"Nonviolent Communication is about connecting with ourselves and others from the heart. Itâ€™s about seeing the humanity in all of us. Itâ€™s about recognizing our commonalities and differences and finding ways to make life wonderful for all of us. ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:0:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"éæš´åŠ›æ²Ÿé€š ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:1:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"éæš´åŠ›æ²Ÿé€šå››è¦ç´  è¦ç´ ä¸€ï¼šå®¢è§‚æè¿°äº‹ç‰©ï¼Œä¸å¤¹æ‚ä»»ä½•è¯„åˆ¤ Tip æˆ‘ä»¬çš„æŒ‘æˆ˜åœ¨äºä¸å¤¹æ‚ä»»ä½•è¯„åˆ¤ï¼Œæ— è®ºå–œæ¬¢ä¸å¦ï¼Œæˆ‘ä»¬åªæ˜¯è¯´å‡ºäººä»¬åšäº†ä»€ä¹ˆã€‚ è¦ç´ äºŒï¼šè¡¨è¾¾å‡ºæˆ‘ä»¬çœ‹åˆ°è¿™äº›è¡Œä¸ºæ—¶çš„æ„Ÿå— Question æ˜¯æ„Ÿåˆ°ä¼¤å¿ƒã€å®³æ€•ã€å–œæ‚¦ã€æœ‰è¶£è¿˜æ˜¯å¿ƒçƒ¦å‘¢? è¦ç´ ä¸‰ï¼šè¡¨è¾¾å‡ºæˆ‘ä»¬æ„Ÿå—çš„åŸå›  è¦ç´ å››ï¼šæå‡ºä¸€ä¸ªå…·ä½“çš„è¯·æ±‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:1:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å››è¦ç´ çš„ä½¿ç”¨ä¸¾ä¾‹ Quote å¦‚ï¼š â€œè²åˆ©å…‹æ–¯ï¼Œçœ‹åˆ°å’–å•¡æ¡Œä¸‹çš„ä¸¤å›¢è„è¢œå­å’Œç”µè§†æœºæ—è¾¹çš„ä¸‰å›¢è„è¢œå­ï¼Œ æˆ‘å¾ˆç”Ÿæ°”ï¼Œ å› ä¸ºæˆ‘å¸Œæœ›åœ¨æˆ‘ä»¬å…±ç”¨çš„ç©ºé—´é‡Œèƒ½å¤šäº›æ•´æ´ã€‚ ä½ æ„¿æ„æŠŠä½ çš„è¢œå­æ”¾åœ¨ä½ æˆ¿é—´æˆ–æ”¾è¿›æ´—è¡£æœºé‡Œå—ï¼Ÿâ€ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:1:2","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å››è¦ç´ çš„é‡è¦æ€§ å¯¹è¿™å››ä¸ªè¦ç´ çš„æ¸…æ™°è¡¨è¾¾ï¼Œè¡¨è¾¾çš„å½¢å¼ä¹Ÿä¸æ‹˜æ³¥äºè¯­è¨€ã€‚è€Œå¦ä¸€éƒ¨åˆ†åˆ™æ˜¯ä»å¯¹æ–¹çš„è¡¨è¾¾ä¸­äº†è§£è¿™å››ä¸ªè¦ç´ ã€‚æˆ‘ä»¬é€šè¿‡æ„ŸçŸ¥å¯¹æ–¹æ­¤åˆ»çš„è§‚å¯Ÿã€æ„Ÿå—å’Œéœ€è¦ï¼Œä¸ä»–ä»¬å»ºç«‹è¿ç»“ï¼Œè¿›è€Œè†å¬ä»–ä»¬çš„è¯·æ±‚ï¼Œæ¥æ‰¾åˆ°é€šè¿‡ä»€ä¹ˆæ–¹å¼è®©ä»–ä»¬çš„ç”Ÿå‘½å˜å¾—æ›´ä¸°å¯Œã€‚ å½“æˆ‘ä»¬å°†æ³¨æ„åŠ›æŒç»­èšç„¦åœ¨ä»¥ä¸Šå‡ ä¸ªæ–¹é¢ï¼Œå¹¶ååŠ©å¯¹æ–¹ä¹Ÿè¿™æ ·åšï¼Œæˆ‘ä»¬ä¾¿åœ¨å½¼æ­¤çš„æ²Ÿé€šä¸­åˆ›é€ äº†ä¸€ç§æµåŠ¨ï¼Œå¦‚æ­¤ä½ æ¥æˆ‘å¾€ï¼Œæœ€ç»ˆåŒæ–¹éƒ½èƒ½è‡ªç„¶è€Œç„¶åœ°å±•ç°å–„æ„ï¼š æˆ‘æ­¤åˆ»çš„è§‚å¯Ÿã€æ„Ÿå—å’Œéœ€è¦æ˜¯ä»€ä¹ˆï¼› ä¸ºäº†è®©æˆ‘çš„ç”Ÿå‘½æ›´ç¾å¥½ï¼Œæˆ‘çš„è¯·æ±‚æ˜¯ä»€ä¹ˆï¼› ä½ æ­¤åˆ»çš„è§‚å¯Ÿã€æ„Ÿå—å’Œéœ€è¦æ˜¯ä»€ä¹ˆï¼› ä¸ºäº†è®©ä½ çš„ç”Ÿå‘½æ›´ç¾å¥½ï¼Œä½ çš„è¯·æ±‚æ˜¯ä»€ä¹ˆã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:1:3","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"ç–ç¦»ç”Ÿå‘½çš„è¨€è¯­ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:2:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"é“å¾·è¯„åˆ¤ å½“ä»–äººçš„è¡Œä¸ºä¸æˆ‘ä»¬çš„ä»·å€¼è§‚ä¸ç¬¦ï¼Œæˆ‘ä»¬ä¾¿è®¤ä¸ºè¿™ä¸ªäººæ˜¯é”™çš„æˆ–æ˜¯æ¶çš„ã€‚ä¾‹å¦‚ï¼š â€œä½ çš„é—®é¢˜å°±æ˜¯å¤ªè‡ªç§äº†ã€‚â€ â€œä»–ä»¬æœ‰åè§ã€‚â€ â€œè¿™æ ·åšä¸æ°å½“ã€‚â€ å½“æˆ‘ä»¬åœ¨åˆ†æå’Œè¯„åˆ¤æ—¶ï¼Œå…¶å®éƒ½æ˜¯åœ¨è¡¨è¾¾è‡ªèº«çš„ä»·å€¼è§‚å’Œéœ€è¦ï¼Œä½†è¿™æ ·çš„è¡¨è¾¾æ–¹å¼å´æ˜¯æ‚²å‰§æ€§çš„ï¼Œå¼•å‘çš„æ˜¯å¯¹æ–¹çš„é˜²å«ä¸æŠ—æ‹’ã€‚å°±ç®—ä»–äººéµä»äº†æˆ‘ä»¬ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯å‡ºäºææƒ§ã€å†…ç–šæˆ–ç¾æ„§ï¼Œè€Œéå‘è‡ªå†…å¿ƒã€‚è€ŒåŒæ—¶ï¼Œäººä»¬è¿™æ ·åšå…¶å®æ„å‘³ç€ä»–ä»¬æ¥å—äº†æˆ‘ä»¬çš„è¯„åˆ¤ï¼ŒçœŸæ˜¯ä¸¤è´¥ä¿±ä¼¤ã€‚è¿Ÿæ—©æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¯¹æ–¹ä¸å†é‚£ä¹ˆå‹å¥½ï¼Œå› ä¸ºç”±äºå†…éƒ¨æˆ–å¤–éƒ¨å‹åŠ›è€Œå±ˆæœçš„äººä»¬ä¸€å®šä¼šå¿ƒæ€€æ€¨æ¨ï¼Œä»–ä»¬ç”±æ­¤å¤±å»å°Šä¸¥ï¼Œåœ¨æƒ…ç»ªä¸Šä»˜å‡ºä»£ä»·ï¼Œæ›´ä¸å¯èƒ½æ€€ç€å–„æ„å›åº”æˆ‘ä»¬çš„éœ€è¦å’Œä»·å€¼è§‚ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:2:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"æ¨å¸è´£ä»» æ¯ä¸ªäººéƒ½å¯¹è‡ªå·±çš„æ€æƒ³ã€æƒ…æ„Ÿä¸è¡Œä¸ºè´Ÿè´£ï¼Œè‹¥æ— æ³•æ„è¯†åˆ°è¿™ç‚¹ï¼Œæ²Ÿé€šä¹Ÿä¼šç–ç¦»ä¸ç”Ÿå‘½çš„è¿ç»“ã€‚ Quote ä¸€ä½è€å¸ˆè¡¨ç¤ºï¼šâ€œæˆ‘åŒæ¶æ‰“åˆ†ã€‚æˆ‘è®¤ä¸ºè¿™å¯¹å­¦ç”Ÿæ²¡ä»€ä¹ˆå¥½å¤„ï¼Œåè€Œä¸ºä»–ä»¬å¸¦æ¥ç„¦è™‘ã€‚ä½†æˆ‘ä¸å¾—ä¸æ‰“åˆ†ï¼Œè¿™æ˜¯å­¦åŒºçš„è§„å®šã€‚â€äºæ˜¯ï¼Œæˆ‘å»ºè®®é‚£ä½è€å¸ˆç»ƒä¹ å°†â€œæˆ‘ä¸å¾—ä¸æ‰“åˆ†ï¼Œå› ä¸ºè¿™æ˜¯å­¦åŒºçš„è§„å®šâ€è½¬æ¢ä¸ºâ€œæˆ‘é€‰æ‹©æ‰“åˆ†ï¼Œå› ä¸ºæˆ‘æƒ³è¦â€¦â€¦â€å¥¹è„±å£è€Œå‡ºå›ç­”ï¼šâ€œæˆ‘é€‰æ‹©æ‰“åˆ†ï¼Œå› ä¸ºæˆ‘æƒ³ä¿ä½è¿™ä»½å·¥ä½œã€‚â€ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:2:2","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"ä¸å¸¦è¯„è®ºçš„è§‚å¯Ÿ éæš´åŠ›æ²Ÿé€šçš„ç¬¬ä¸€ä¸ªè¦ç´ æ˜¯åŒºåˆ†è§‚å¯Ÿä¸è¯„è®ºã€‚ å½“æˆ‘ä»¬æƒ³è¦æ¸…æ™°ä¸”è¯šæ³åœ°å‘ä»–äººè¡¨è¾¾æˆ‘ä»¬çš„çŠ¶æ€æ—¶ï¼Œâ€œè§‚å¯Ÿâ€æ˜¯ä¸€ä¸ªé‡è¦çš„è¦ç´ ã€‚å¦‚æœæˆ‘ä»¬åœ¨è§‚å¯Ÿä¸­å¤¹æ‚ç€è¯„è®ºï¼Œäººä»¬ä¾¿ä¸é‚£ä¹ˆå®¹æ˜“çœŸæ­£å¬è§æˆ‘ä»¬æƒ³è¦è¡¨è¾¾çš„å†…å®¹ï¼Œåè€Œä¼šå¬åˆ°æ‰¹è¯„ï¼Œç”šè‡³äº§ç”ŸæŠ—æ‹’å¿ƒç†ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:3:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"åŒºåˆ†è§‚å¯Ÿå’Œè¯„è®º è¡¨è¾¾æ–¹å¼ æ··æ·†è§‚å¯Ÿå’Œè¯„è®º åŒºåˆ†è§‚å¯Ÿå’Œè¯„è®º 1.æœªå¯¹è‡ªå·±çš„è¯„è®ºè´Ÿè´£ â€œä½ å¤ªå¤§æ–¹äº†â€ â€œå½“æˆ‘çœ‹åˆ°ä½ å°†åˆé¤é’±éƒ½ç»™äº†åˆ«äººï¼Œæˆ‘è®¤ä¸ºä½ è¿™æ ·åšå¤ªå¤§æ–¹äº†â€ 2.ä½¿ç”¨çš„åŠ¨è¯æš—å«è¯„è®º â€œä½ çˆ±æ‹–å»¶â€ â€œä½ åªåœ¨è€ƒè¯•å‰ä¸€ç¢—å­¦ä¹ â€ 3.æ¨æ–­ä»–äººçš„æƒ³æ³•ã€æ„Ÿå—æˆ–æ„¿æœ›æ—¶ï¼Œæš—ç¤ºè¿™æ˜¯å”¯ä¸€çš„å¯èƒ½ â€œå¥¹æ— æ³•å®Œæˆå·¥ä½œâ€ â€œæˆ‘ä¸è®¤ä¸ºå¥¹èƒ½å®Œæˆå·¥ä½œâ€ 4.æŠŠé¢„æµ‹å½“åšç¡®å®šçš„äº‹å® â€œå¦‚æœä½ çš„é¥®é£Ÿä¸å‡è¡¡ï¼Œå¥åº·å°±ä¼šå‡ºé—®é¢˜â€ â€œå¦‚æœä½ çš„é¥®é£Ÿä¸å‡è¡¡ï¼Œæˆ‘æ‹…å¿ƒä½ çš„å¥åº·ä¼šå‡ºé—®é¢˜â€ 5.æŒ‡ä»£ä¸å…·ä½“ â€œè¿™æˆ·ç§»æ°‘å®¶åº­ç…§é¡¾ä¸å¥½è‡ªå·±çš„åé™¢â€ â€œæˆ‘æ²¡æœ‰çœ‹åˆ°ä½åœ¨ç½—æ–¯è·¯1679å·çš„é‚£æˆ·ç§»æ°‘å®¶åº­é“²è·¯è¾¹çš„é›ªâ€ 6.åœ¨æè¿°ä»–äººèƒ½åŠ›æ—¶ï¼Œå¹¶æœªè¡¨æ˜é‚£åªæ˜¯è‡ªå·±æ‰€åšçš„è¯„è®º â€œå²å¯†æ–¯æ˜¯ä¸ªç³Ÿç³•çš„è¶³çƒè¿åŠ¨å‘˜â€ â€œå²å¯†æ–¯åœ¨20åœºçƒèµ›ä¸­æœªèƒ½è¿›ä¸€ä¸ªçƒâ€ 7.ä½¿ç”¨å«æœ‰è¯„è®ºæ„å‘³çš„å½¢å®¹è¯å’Œå‰¯è¯ â€œåº“å…‹é•¿å¾—éš¾çœ‹â€ â€œåº“å…‹çš„é•¿ç›¸å¯¹æˆ‘æ²¡æœ‰å¸å¼•åŠ›â€ æ³¨æ„ï¼šæ€»æ˜¯ã€æ°¸è¿œã€ä»æ¥ã€æ¯æ¬¡ ä¹‹ç±»çš„è¯è¯­ã€‚è¿™äº›è¯åœ¨è´Ÿé¢è¡¨è¾¾ä¸­ç»å¸¸ä¼šå¼•å‘ä»–äººçš„é€†åå¿ƒç†ï¼Œè€Œéæ…ˆæ‚²ä¹‹æƒ…ã€‚â€œç»å¸¸â€ã€â€œå¾ˆå°‘â€è¿™æ ·çš„è¯ä¹Ÿå¯èƒ½æ··æ·†è§‚å¯Ÿå’Œè¯„è®ºã€‚ è¯„è®º è§‚å¯Ÿ ä½ å¾ˆå°‘é…åˆæˆ‘ ä¸Šä¸€æ¬¡å½“æˆ‘æè®®ä¸€é¡¹æ´»åŠ¨æ—¶ï¼Œä½ è¯´ä½ ä¸æƒ³åš ä»–æ—¶å¸¸æ—·è¯¾ ä»–ä¸Šä¸ªæœˆæ¯å‘¨è‡³å°‘ä¸‰æ¬¡æ—·è¯¾ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:3:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"ä½“ä¼šä¸è¡¨è¾¾æ„Ÿå— ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:4:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å‹æŠ‘æ„Ÿå—çš„ä»£ä»· Quote ç±»ä¼¼â€œæˆ‘è§‰å¾—æˆ‘å°±åƒå«ç»™äº†ä¸€å µå¢™â€è¿™æ ·çš„è¯ï¼Œä¸å¤ªå¯èƒ½è®©å¥¹çš„å…ˆç”Ÿæ˜ç™½å¥¹çš„æ„Ÿå—ä¸æ¸´æœ›ï¼Œåè€Œæ›´å®¹æ˜“è®¤ä¸ºå¥¹åœ¨æ‰¹è¯„ä»–ã€‚å¹¶ä¸”ï¼Œè¿™ç±»è¯è¯­æœ€åå¾€å¾€ä¼šçœŸçš„åº”éªŒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å…ˆç”Ÿå¬åˆ°å¤ªå¤ªæ‰¹è¯„ä»–â€œåƒä¸€å µå¢™â€æ—¶ï¼Œä¼šæ„Ÿåˆ°å§”å±ˆå’Œæ°”é¦ï¼Œå› è€Œä¸æ„¿æ„åšå‡ºå›åº”ã€‚è¿™æ ·ä¸€æ¥ï¼Œå…ˆç”Ÿåƒæ˜¯ä¸€å µå¢™çš„å°è±¡ä¾¿ä¼šåœ¨å¤ªå¤ªå¿ƒä¸­è¿›ä¸€æ­¥å¾—åˆ°å¼ºåŒ–ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:4:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"åŒºåˆ†æ„Ÿå—ä¸æƒ³æ³• åœ¨éæš´åŠ›æ²Ÿé€šä¸­ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†ï¼šæˆ‘ä»¬æ˜¯åœ¨è¡¨è¾¾è‡ªå·±çš„æ„Ÿå—ï¼Œè¿˜æ˜¯åœ¨è¡¨è¾¾å¯¹è‡ªå·±çš„æƒ³æ³•æˆ–è¯‰æ±‚ã€‚ Tip æˆ‘ä»¬ä½¿ç”¨è¯­è¨€çš„ä¹ æƒ¯æ—¶å¸¸ä¼šå¼•å‘è¿™æ ·ä¸€ä¸ªæ··æ·†ï¼Œåœ¨ä½¿ç”¨â€œè§‰å¾—ï¼æ„Ÿåˆ°ï¼æ„Ÿè§‰â€è¿™ç±»è¯æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰åœ¨è¡¨è¾¾æ„Ÿå—ã€‚ä¾‹å¦‚ï¼Œåœ¨â€œæˆ‘è§‰å¾—æ²¡æœ‰å¾—åˆ°å…¬å¹³å¯¹å¾…â€è¿™å¥è¯ä¸­ï¼Œå°†â€œæˆ‘è§‰å¾—â€æ¢æˆâ€œæˆ‘è®¤ä¸ºâ€ä¹Ÿè®¸æ›´æ°å½“ã€‚åœ¨ä»¥ä¸‹ä¾‹å­ä¸­ï¼Œè¯´è¯è€…åœ¨ä½¿ç”¨â€œè§‰å¾—â€æ—¶éƒ½å¹¶æœªå‡†ç¡®åœ°è¡¨è¾¾è‡ªå·±çš„æ„Ÿå—ã€‚ ä»¥ä¸‹ä¾‹å­éƒ½å¹¶æœªå‡†ç¡®åœ°è¡¨è¾¾è‡ªå·±çš„æ„Ÿå—ï¼š åœ¨â€œæˆ‘æ„Ÿåˆ°/è§‰å¾—â€ååŠ ä¸Šä¸€å¥è¯æˆ–ç±»ä¼¼â€œå°±åƒâ€â€œå¥½ä¼¼â€è¿™æ ·çš„è¯ï¼š â€œæˆ‘è§‰å¾—ä½ åº”è¯¥æ›´æ‡‚äº‹ã€‚â€ â€œæˆ‘è§‰å¾—è‡ªå·±å°±åƒä¸ªå¤±è´¥è€…ã€‚â€ â€œæˆ‘è§‰å¾—å¥½åƒåœ¨å’Œä¸€å µå¢™ç”Ÿæ´»ã€‚â€ åœ¨â€œæˆ‘æ„Ÿåˆ°/è§‰å¾—â€åå¸¦ä¸Šâ€œæˆ‘ã€ä½ ã€ä»–ã€å¥¹æˆ–è€…åè¯â€è¿™äº›äººç§°ã€‚ â€œæˆ‘è§‰å¾—è‡ªå·±ä¸€ç›´åœ¨è¢«ä½¿å”¤ã€‚â€ â€œæˆ‘è§‰å¾—è¿™æ ·åšæ˜¯æ²¡æœ‰ç”¨çš„ã€‚â€ â€œæˆ‘è§‰å¾—è‰¾ç±³æŒºè´Ÿè´£çš„ã€‚â€ â€œæˆ‘è§‰å¾—æˆ‘çš„ä¸Šå¸å¾ˆçˆ±æ§åˆ¶äººã€‚â€ â€œæˆ‘æ„Ÿè§‰ä½ ä¸çˆ±æˆ‘äº†ã€‚â€ â€œä½ ä¸çˆ±æˆ‘â€æ˜¯å¯¹ä»–äººå¦‚ä½•æ„Ÿå—çš„åˆ¤æ–­ï¼Œè€Œä¸æ˜¯æ„Ÿå—ã€‚åœ¨â€œæˆ‘æ„Ÿåˆ°â€ä¹‹åå¦‚æœè·Ÿéšçš„æ˜¯æˆ‘ã€ä½ ã€ä»–ã€å¥¹ã€ä»–ä»¬ã€å®ƒã€åƒã€å¥½ä¼¼â€¦â€¦é€šå¸¸éƒ½ä¸æ˜¯åœ¨è¡¨è¾¾æ„Ÿå—ã€‚ ç›¸åï¼Œå®é™…åœ¨è¡¨è¾¾æ„Ÿå—æ—¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥å®Œå…¨ä¸ä½¿ç”¨â€œæ„Ÿåˆ°/è§‰å¾—â€è¿™ä¸ªè¯ã€‚æˆ‘ä»¬å¯ä»¥è¯´â€œæˆ‘è§‰å¾—å¾ˆæ¼ç«â€ï¼Œä¹Ÿå¯ä»¥ç®€å•åœ°è¯´â€œæˆ‘å¾ˆæ¼ç«â€ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:4:2","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å»ºç«‹æ„Ÿå—è¯æ±‡è¡¨ ä½¿ç”¨å…·ä½“è€Œéæ¨¡ç³Šæˆ–ç¬¼ç»Ÿçš„æƒ…ç»ªè¯æ±‡ï¼Œæœ‰åŠ©äºæˆ‘ä»¬è¡¨è¾¾æ„Ÿå—ã€‚ é€šè¿‡å»ºç«‹è¡¨è¾¾æ„Ÿå—çš„è¯æ±‡è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ™°æ˜ç¡®åœ°ä½“ä¼šå’Œè¡¨è¾¾æ„Ÿå—ï¼Œä»è€Œæ›´å¥½åœ°ä¸ä»–äººå»ºç«‹è¿ç»“ã€‚å…è®¸è‡ªå·±è¡¨è¾¾æ„Ÿå—ã€è¢’éœ²è„†å¼±ï¼Œä¹Ÿä¼šæœ‰åŠ©äºåŒ–è§£å†²çªã€‚ å½“éœ€è¦å¾—åˆ°æ»¡è¶³æ—¶ï¼Œæˆ‘ä»¬çš„æ„Ÿå—å¯èƒ½æ˜¯ï¼š æ„Ÿå— Feel æ„Ÿå— Feel æ„Ÿå— Feel å…¨ç¥è´¯æ³¨ absorbed èšç²¾ä¼šç¥ engrossed æ„ŸåŠ¨ moved æ–°å¥‡ adventurous æ´»è·ƒ enlivened ä¹è§‚ optimistic æ·±æƒ… affectionate çƒ­æƒ… enthusiastic å¤§å–œ over-joyed æœºæ• alert æ¿€åŠ¨ excited å—å® è‹¥æƒŠ overwhelmed æœ‰æ´»åŠ› alive å…´å¥‹ exhilarated å®é™ peaceful æƒŠå¥‡ amazed å¼€æœ— expansive æ´»æ³¼ perky å¼€æ€€ amused æœŸç›¼ expectant æ„‰å¿« pleasant ç”Ÿæœºå‹ƒå‹ƒ animated å…´é«˜é‡‡çƒˆ exultant å¼€å¿ƒ pleased æ„Ÿæ¿€ appreciative ç€è¿· fascinated è‡ªè±ª proud çƒ­å¿ƒ ardent è‡ªåœ¨ free å®‰é™ quiet æŒ¯ä½œ aroused å‹å–„ friendly å®¹å…‰ç„•å‘ radiant æƒŠè®¶ astonished æ»¡è¶³ fulfilled ç—´è¿· rapturous æä¸ºå¹¸ç¦ blissful é«˜å…´ glad ç¥æ¸…æ°”çˆ½ refreshed å±æ°”æ•›æ¯ breathless æ¬¢æ¬£é›€è·ƒ gleeful æ”¾æ¾ relaxed å¿«æ´» buoyant æ˜åªš glorious å¦‚é‡Šé‡è´Ÿ relieved å¹³é™ calm çƒ­æƒ…æ´‹æº¢ glowing æ»¡æ„ satisfied æ— å¿§æ— è™‘ carefree å¿«ä¹ good-humored å®‰å…¨ secure å¼€å¿ƒ cheerful æ„Ÿè°¢ grateful æ•æ„Ÿ sensitive èˆ’é€‚ comfortable å¿ƒæ»¡æ„è¶³ gratified å®‰è¯¦ serene å¾—æ„ complacent å¹¸ç¦ happy å…¥è¿· spellbound é•‡é™ composed çƒ­å¿ƒ helpful å¿ƒèŠ±æ€’æ”¾ splendid å…³åˆ‡ concerned æ»¡æ€€å¸Œæœ› hopeful æ¿€åŠ± stimulated è‡ªä¿¡ confident æ„Ÿå…´è¶£ inquisitive æƒŠå–œ surprised æƒ¬æ„ contented å—å¯è¿ª inspired æŸ”è½¯ tender å†·é™ cool çƒ­åˆ‡ intense æ¬£æ…° thankful å¥½å¥‡ curious è¶£å‘³ interested ä¹ä¸å¯æ”¯ thrilled å€¾å€’ dazzled è¿·ä½ intrigued è§¦åŠ¨ touched æ„‰æ‚¦ delighted ç²¾ç¥ç„•å‘ invigorated æ¬é™ tranquil çƒ­å¿± eager çƒ­è¡· involved æ»¡æ€€ä¿¡ä»» trusting å¥”æ”¾ ebullient æ¬¢ä¹ joyous, joyful ä¹è§‚å¼€æœ— upbeat æ¬£å–œè‹¥ç‹‚ ecstatic æ¬¢è…¾ jubilant æ¸©æš– warm å…´é«˜é‡‡çƒˆ effervescent äº¢å¥‹ keyed-up æ¸…é†’ wide-awake æ¬¢æ¬£é¼“èˆ elated æœ‰çˆ±å¿ƒ loving ç¾å¦™ wonderful é™¶é†‰ enchanted ç”œç¾ mellow çƒ­æƒ…é«˜æ¶¨ zestful å—é¼“èˆ encouraged è½»å¿« merry ç²¾åŠ›å……æ²› energetic æ¬¢å–œ mirthful å½“éœ€è¦æ²¡æœ‰å¾—åˆ°æ»¡è¶³æ—¶ï¼Œæˆ‘ä»¬çš„æ„Ÿå—å¯èƒ½æ˜¯ï¼š æ„Ÿå— Feel æ„Ÿå— Feel æ„Ÿå— Feel ç•æƒ§ afraid çƒ¦èº edgy ç´§ç»· overwhelmed æ°”æ¼ aggravated æƒ­æ„§ embarrassed æƒŠæ…Œå¤±æª panicky ç„¦èº agitated æ„¤æ¨ embittered è¢«åŠ¨ passive æƒŠæ…Œ alarmed æ¼ç« exasperated è¿·èŒ« perplexed å†·æ¼  aloof è€—å°½ exhausted æ‚²è§‚ pessimistic æ„¤æ€’ angry ç²¾ç–²åŠ›ç«­ fatigued è‹¦æ€å†¥æƒ³ puzzled ç—›è‹¦ anguished æ‹…å¿§ fearful å……æ»¡æ•Œæ„ rancorous çƒ¦æ‰° annoyed åç«‹ä¸å®‰ fidgety è¿Ÿç–‘ reluctant ç„¦è™‘ anxious æ„è‹¦ forlorn æ’æ–¥ repelled å†·æ·¡ apathetic æƒŠå“ frightened ä»‡æ¨ resentful æ‹…å¿ƒ apprehensive æ‡Šæ¼ frustrated èºåŠ¨ restless åˆºæ¿€ aroused å¤§æ€’ furious éš¾è¿‡ sad ç¾æ„§ ashamed ä½è½ gloomy å®³æ€• scared ä¸§æ°” beat å†…ç–š guilty æ•æ„Ÿ sensitive è¿·æƒ‘ bewildered é€¼è¿« harried é¢¤æŠ– shaky è‹¦æ¶© bitter æ²‰é‡ heavy éœ‡æƒŠ shocked ä¹å‘³ blah æ— åŠ© helpless æ‰¹åˆ¤ skeptical å¿§éƒ blue çŠ¹è±« hesitant å›°ä¹ sleepy æ— èŠ bored ææƒ§ horrified å“€ç—› sorrowful å¿ƒç¢ brokenhearted æ•Œå¯¹ hostile æ­‰æ„ sorry å±ˆè¾± chagrined ç¼çƒ­ hot æ²¡æœ‰æ–—å¿— spiritless å¯’å†· cold å•è°ƒ humdrum å¤±é­‚è½é­„ startled å¿§è™‘ concerned å—ä¼¤ hurt æƒŠè®¶ surprised å›°æƒ‘ confused ä¸è€çƒ¦ impatient æ€€ç–‘ suspicious å†·é…· cool ä¸åœ¨ä¹ indifferent ä¸å†·ä¸çƒ­ tepid ç”Ÿæ°” cross æ¿€çƒˆ intense æƒŠæ terrified ä½è½ dejected æ€’æ°” irate åŠ³ç´¯ tired æŠ‘éƒ depressed æ¼æ€’ irked çƒ¦æ¼ troubled ç»æœ› despairing æ¿€æ€’ irritated ä¸é€‚ uncomfortable æ²®ä¸§ despondent å«‰å¦’ jealous ä¸æ„Ÿå…´è¶£ unconcerned æŠ½ç¦» detached ç´§å¼ ä¸å®‰ jittery å¿ƒç¥ä¸å® uneasy ä¸æ»¡ disaffected æ¿€åŠ¨ä¸å®‰ keyed-up å¿ƒçƒ¦æ„ä¹± unglued å¤±æœ› disappointed æ‡’æ•£ lazy ä¸å¼€å¿ƒ unhappy æŒ«è´¥ discouraged ç–‘è™‘ leery æ°”é¦ unnerved å¹»ç­ disenchanted å€¦æ€  lethargic ä¸ç¨³å®š unsteady ä¸é«˜å…´ disgruntled æ— ç²¾æ‰“é‡‡ listless çƒ¦ä¹± upset åŒæ¶ disgusted å­¤ç‹¬ lonely æ‹˜è°¨ uptight ç°å¿ƒ disheartened æ°”æ„¤ mad æ£˜æ‰‹ vexed æƒŠæ„• dismay æ±—é¢œ mean åŒå€¦ weary ä¸å¿« displeased éƒé—· miserable ä¼¤æ„Ÿ wistful ä¸å®‰ disquieted æ˜æ²‰ mopey é€€ç¼© withdrawn è‹¦æ¼ distressed é˜´éƒ morose æ‚²ä¼¤ woeful éº»çƒ¦ disturbed å“€æ‚¼ mournful ç€æ€¥ worried å‚å¤´ä¸§æ°” downcast ç´§å¼  nervous ç³Ÿç³• wretched æ¶ˆæ²‰ downhearted å¿ƒä¹±å¦‚éº» nettled æ²‰é—· dull éº»æœ¨ numb ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:4:3","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"ä¸ºè‡ªå·±çš„æ„Ÿå—è´Ÿè´£ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:5:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å¬åˆ°ä¸ä¸­å¬çš„è¯æœ‰å››ç§é€‰æ‹© ç¬¬ä¸€ç§é€‰æ‹©æ˜¯æŒ‡è´£è‡ªå·±ï¼Œå°†é”™è¯¯å½’å’åˆ°è‡ªå·±èº«ä¸Šã€‚ä¾‹å¦‚ï¼Œæœ‰äººæ°”æ„¤åœ°è¯´ï¼šâ€œæˆ‘ä»æ²¡è§è¿‡åƒä½ è¿™ä¹ˆè‡ªç§çš„äººï¼â€å¦‚æœé€‰æ‹©è®¤åŒå¯¹æ–¹çš„è¯„åˆ¤å¹¶ä¸”è‡ªæˆ‘æŒ‡è´£ï¼Œæˆ‘ä»¬ä¹Ÿè®¸å°±ä¼šè¡¨ç¤ºï¼šâ€œå“¦ï¼Œæˆ‘åº”è¯¥æ›´ä½“è´´ä¸€ç‚¹ã€‚â€å¦‚æ­¤è¿™èˆ¬å¸¦ç»™æˆ‘ä»¬çš„æ„Ÿå—æ˜¯å†…ç–šã€ç¾æ„§å’Œå‹æŠ‘ï¼Œæˆ‘ä»¬çš„è‡ªå°Šå¿ƒä¹Ÿä¼šå—åˆ°ä¼¤å®³ã€‚ ç¬¬äºŒç§é€‰æ‹©æ˜¯æŒ‡è´£å¯¹æ–¹ï¼Œå°†é”™è¯¯å½’å’åˆ°å¯¹æ–¹èº«ä¸Šã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè®¸ä¼šåé©³å¯¹æ–¹è¯´ï¼šâ€œä½ æ²¡æœ‰èµ„æ ¼è¿™ä¹ˆè¯´ï¼æˆ‘æ€»æ˜¯è€ƒè™‘ä½ çš„éœ€è¦ï¼Œä½ æ‰è‡ªç§å‘¢ï¼â€æ­¤æ—¶æˆ‘ä»¬é€šå¸¸ä¼šæ„Ÿåˆ°æ„¤æ€’ã€‚ ç¬¬ä¸‰ç§é€‰æ‹©æ˜¯å…³æ³¨æˆ‘ä»¬è‡ªå·±çš„æ„Ÿå—å’Œéœ€è¦ã€‚æˆ‘ä»¬ä¼šæ„Ÿåˆ°ä¼¤å¿ƒï¼Œå¹¶å‘ç°ä¼¤å¿ƒçš„æ„Ÿå—æ¥è‡ªå†…åœ¨çš„éœ€è¦â€”â€”æ¸´æœ›è‡ªå·±çš„ä»˜å‡ºå¾—åˆ°è‚¯å®šã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè®¸ä¼šå›åº”ï¼šâ€œå¬åˆ°ä½ è¯´â€˜æˆ‘ä»æ²¡è§è¿‡åƒä½ è¿™ä¹ˆè‡ªç§çš„äººâ€™ï¼Œæˆ‘æ„Ÿåˆ°ä¼¤å¿ƒï¼Œå› ä¸ºæˆ‘æ¸´æœ›å¾—åˆ°è®¤å¯ã€‚æˆ‘ä¹Ÿåœ¨åŠªåŠ›ä½“è´´ä½ ï¼Œå¸Œæœ›è¿™ä¸€ç‚¹èƒ½å¾—åˆ°ä½ çš„è®¤å¯ã€‚â€ ç¬¬å››ç§é€‰æ‹©æ˜¯å…³æ³¨å¯¹æ–¹æƒ³è¦è¡¨è¾¾çš„æ„Ÿå—å’Œéœ€è¦ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé—®å¯¹æ–¹ï¼šâ€œä½ æ„Ÿåˆ°ä¼¤å¿ƒï¼Œå¸Œæœ›ä½ çš„å–œå¥½èƒ½å¾—åˆ°ç…§é¡¾ï¼Œæ˜¯å—ï¼Ÿâ€ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:5:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"éœ€è¦ï¼šæ„Ÿå—çš„æ ¹æº å½“æˆ‘ä»¬è¯„åˆ¤ã€æ‰¹è¯„ã€åˆ†ææˆ–åˆ¤æ–­ä»–äººçš„è¨€è¡Œæ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨ç”¨ç–ç¦»ç”Ÿå‘½çš„æ–¹å¼è¡¨è¾¾è‡ªå·±çš„éœ€è¦ã€‚å¦‚æœæœ‰äººè¯´ï¼šâ€œä½ ä»ä¸æ‡‚æˆ‘ã€‚â€ä»–çœŸæ­£çš„å¿ƒå£°æ˜¯æ¸´æœ›å¾—åˆ°ç†è§£ã€‚å¦‚æœå¤ªå¤ªè¯´ï¼šâ€œè¿™æ˜ŸæœŸä½ æ¯å¤©éƒ½å·¥ä½œåˆ°å¾ˆæ™šï¼Œç›¸æ¯”æˆ‘ï¼Œä½ æ›´çˆ±å·¥ä½œï¼â€é‚£å¥¹åœ¨è¯‰è¯´çš„æ˜¯ï¼Œäº²å¯†çš„éœ€è¦æœªèƒ½å¾—åˆ°æ»¡è¶³ã€‚ Success å½“æˆ‘ä»¬é€šè¿‡è¯„åˆ¤ã€åˆ¤æ–­å’Œæƒ³è±¡ç­‰æ–¹å¼é—´æ¥åœ°è¡¨è¾¾è‡ªå·±çš„éœ€è¦æ—¶ï¼Œä»–äººå¾ˆå®¹æ˜“è®¤ä¸ºæˆ‘ä»¬åœ¨æ‰¹è¯„ä»–ä»¬ï¼Œå¹¶éšä¹‹å¯åŠ¨è‡ªæˆ‘è¾©æŠ¤å’ŒåæŠ—ã€‚æˆ‘ä»¬è¶Šèƒ½ç›´æ¥è¯´å‡ºæ„Ÿå—ä»¥åŠç›¸å…³è”çš„éœ€è¦ï¼Œä»–äººä¹Ÿè¶Šæœ‰å¯èƒ½å¯¹æˆ‘ä»¬åšå‡ºå–„æ„çš„å›åº”ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:5:2","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"æ­£ç¡®çš„æå‡ºè¯·æ±‚ ä½¿ç”¨æ­£å‘ã€å…·ä½“çš„è¯­è¨€ å…ˆè¡¨è¾¾æ„Ÿå—ä¸éœ€è¦ï¼Œå†æå‡ºè¯·æ±‚ è¯·æ±‚å¯¹æ–¹é‡è¿°ä½ çš„è¯ è¯·æ±‚è¯šå®è¡¨è¾¾ åŒºåˆ†è¯·æ±‚ä¸è¦æ±‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:6:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"çˆ±è‡ªå·± æ¯ä¸ªäººéƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ é¢å¯¹è‡ªå·±çš„ä¸å®Œç¾ è½¬åŒ–è‡ªæˆ‘è¯„åˆ¤å’Œè‡ªæˆ‘è¦æ±‚ ä¸åšä»»ä½•æ²¡æœ‰ä¹è¶£çš„äº‹ï¼ â€œä¸å¾—ä¸â€è½¬åŒ–ä¸ºâ€œæˆ‘é€‰æ‹©â€ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:7:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"å……åˆ†è¡¨è¾¾æ„¤æ€’ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:8:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"è¡¨è¾¾æ„¤æ€’çš„å››ä¸ªæ­¥éª¤ åœä¸‹æ¥ï¼Œæ·±å‘¼å¸ã€‚ çœ‹çœ‹æˆ‘ä»¬æœ‰å“ªäº›è¯„åˆ¤æ€§çš„æƒ³æ³•ã€‚ ä¸æˆ‘ä»¬çš„éœ€è¦è¿ç»“ã€‚ è¡¨è¾¾æˆ‘ä»¬çš„æ„Ÿå—å’Œæœªè¢«æ»¡è¶³çš„éœ€è¦ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:8:1","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Life"],"content":"åŒ–è§£å†²çª é¦–å…ˆè¡¨è¾¾è‡ªå·±çš„éœ€è¦ã€‚ å…¶æ¬¡æ— è®ºå¯¹æ–¹è¯´ä»€ä¹ˆï¼Œè®¾æ³•æ‰¾å‡ºä»–ä»¬çœŸæ­£çš„éœ€è¦ã€‚å¦‚æœä»–ä»¬è¡¨è¾¾çš„æ˜¯æƒ³æ³•ã€è¯„åˆ¤æˆ–åˆ†æè€Œä¸æ˜¯éœ€è¦ï¼Œå¯ä»¥ç»§ç»­å¯»æ‰¾èƒŒåçš„éœ€è¦ã€‚ ç¡®è®¤æˆ‘ä»¬éƒ½å‡†ç¡®ç†è§£å½¼æ­¤çš„éœ€è¦ï¼Œå¦åˆ™ç»§ç»­å¯»æ‰¾èƒŒåçš„éœ€è¦ã€‚ å°½å¯èƒ½åœ°åŒç†å¯¹æ–¹ï¼Œä»¥ä¾¿è®©åŒæ–¹éƒ½èƒ½ç¡®åˆ‡äº†è§£å½¼æ­¤çš„éœ€è¦ã€‚ å½“åŒæ–¹éƒ½æ¾„æ¸…äº†äº‹ä»¶ä¸­çš„éœ€è¦åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ­£å‘çš„æè¿°æå‡ºåŒ–è§£å†²çªçš„ç­–ç•¥ã€‚ ","date":"2022-07-06","objectID":"/20220706_nonviolent-communication/:9:0","tags":["Life","Book"],"title":"Nonviolent Communication","uri":"/20220706_nonviolent-communication/"},{"categories":["Technology"],"content":"There is a problem about word segmentation when I use Chinese in ES. Elasticsearch is the distributed, restful search and analytics engine. You can use Elasticsearch to store, search, and manage data for Logsï¼ŒMetricsï¼ŒA search backendï¼ŒApplication monitoringï¼ŒEndpoint security. ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:0:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"é—®é¢˜æè¿° Question ES ä½¿ç”¨ wildcard è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæœ‰äº›æƒ…å†µæ¨¡ç³ŠæŸ¥è¯¢å¤±è´¥ï¼Œå¦‚ï¼š\"*æ—¥æœ¬*\"ï¼Œä½†æµ‹è¯•åˆ«çš„æ•°æ®ï¼Œå¦‚ â€œ*192.168*â€ å¯ä»¥æ¨¡ç³ŠåŒ¹é…ã€‚è¿™æ˜¯å› ä¸º ES å¯¹æŸ¥è¯¢æ–‡æœ¬åˆ†è¯é€ æˆçš„ç»“æœã€‚ ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:1:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"matchï¼šåˆ†è¯æ¨¡ç³ŠæŸ¥è¯¢ æ¯”å¦‚â€œEverything will be OK, All is wellâ€ï¼Œä¼šè¢«åˆ†è¯ä¸€ä¸ªä¸€ä¸ªå•è¯ï¼ˆä¸æ˜¯å•ä¸ªå­—æ¯ï¼‰ { \"from\": 0, \"size\": 20, \"query\": { \"bool\": { \"should\": [{ \"term\": { \"form_name\": \"will\" } } ] } } } ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:2:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"match_phrase ï¼šçŸ­è¯­æ¨¡ç³ŠæŸ¥è¯¢ match_phraseæ˜¯çŸ­è¯­æœç´¢ï¼Œå³å®ƒä¼šå°†ç»™å®šçš„çŸ­è¯­ï¼ˆphraseï¼‰å½“æˆä¸€ä¸ªå®Œæ•´çš„æŸ¥è¯¢æ¡ä»¶ã€‚ æ¯”å¦‚æŸ¥è¯¢ â€œEverything willâ€ï¼Œä¼šå½“æˆä¸€ä¸ªå®Œæ•´çš„çŸ­è¯­è¿›è¡ŒæŸ¥è¯¢ï¼Œ ä¼šæŸ¥å‡ºå«æœ‰è¯¥æŸ¥è¯¢æ¡ä»¶çš„å†…å®¹ã€‚ GET /basic_index*/_search { \"from\": 0, \"size\": 20, \"query\": { \"bool\": { \"should\": [{ \"match\": { \"form_name\": \"Everything will\" } } ] } } } å¦‚æœæ˜¯æŸ¥è¯¢å•ä¸ªå­—æ¯ï¼Œmatchå°±ä¸ç®¡ç”¨äº†ã€‚ ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:3:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"wildcardï¼šé€šé…ç¬¦æ¨¡ç³ŠæŸ¥è¯¢ ? åŒ¹é…ä»»æ„å­—ç¬¦ * åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ GET /basic_index*/_search { \"size\": 20, \"from\": 0, \"query\": { \"bool\": { \"should\": [{ \"wildcard\": { \"form_name\": \"*very* } }] } } } è®°å½•æ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŸ¥å‡ºæ¥ï¼Ÿ å› ä¸ºåˆ†è¯çš„å½±å“ï¼Œæ·»åŠ keyword è¿›è¡Œå¤„ç† { \"wildcard\": { \"form_name.keyword\": \"*very*\" } } Wildcard æ€§èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚å¦‚æœéå¿…è¦ï¼Œå°½é‡é¿å…åœ¨å¼€å¤´åŠ é€šé…ç¬¦ ? æˆ–è€… *ï¼Œè¿™æ ·ä¼šæ˜æ˜¾é™ä½æŸ¥è¯¢æ€§èƒ½ å¦‚æœæŸ¥è¯¢çš„å†…å®¹éç©ºï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ ç›´æ¥ç”¨** { \"wildcard\": { \"form_name\": \"*\" } } ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:4:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"æ€»ç»“ Es æ¨¡ç³ŠæŸ¥è¯¢ï¼Œ åˆ†è¯çš„ç”¨matchï¼› çŸ­è¯­çš„ç”¨match_phraseï¼›æŸ¥è¯¢ä»»æ„çš„ï¼Œç”¨wildcardé€šé…ç¬¦ï¼Œæ³¨æ„æŸ¥è¯¢çš„å†…å®¹æ˜¯å¦åˆ†è¯ï¼Œåˆ†è¯çš„æ·»åŠ keywordï¼ŒæŸ¥è¯¢éç©ºçš„æƒ…å†µï¼Œç”¨\"**\"ã€‚ ","date":"2022-05-12","objectID":"/20220512_es-wildcard-search/:5:0","tags":["Java","ElasticSearch"],"title":"Elasticsearch Wildcard Search","uri":"/20220512_es-wildcard-search/"},{"categories":["Technology"],"content":"Article description.","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"CAPTCHA stands for â€˜Completely Automated Public Turing test to tell Computers and Humans Apartâ€™. Itâ€™s already possible to solve it with the rise of deep learning and computer vision. ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:0:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æ€»ä½“æµç¨‹ æŠ“å–éªŒè¯ç  ç»™éªŒè¯ç æ‰“æ ‡ç­¾ å›¾ç‰‡é¢„å¤„ç† ä¿å­˜æ•°æ®é›† æ„å»ºæ¨¡å‹è®­ç»ƒ æå–æ¨¡å‹ä½¿ç”¨ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:1:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æŠ“å–éªŒè¯ç  ä¸‹è½½æ•°æ®é›†ï¼Œä¸‹è½½äº† 750 å¼ éªŒè¯ç ï¼Œç”¨ 500 å¼ åšè®­ç»ƒï¼Œå‰©ä¸‹ 250 å¼ éªŒè¯æ¨¡å‹æ•ˆæœã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:2:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"ç»™éªŒè¯ç æ‰“æ ‡ç­¾ è¿™é‡Œçš„éªŒè¯ç æœ‰750å¼ ï¼Œè¦ç»™æ¯å¼ éªŒè¯ç æ ‡ç­¾ï¼Œè‡ªå·±æ‰‹å·¥æ‰“ã€ä¹°äººå·¥è¯†åˆ«çš„æœåŠ¡æˆ–ç›´æ¥å‡†å¤‡å¸¦æœ‰æ ‡ç­¾çš„éªŒè¯ç ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:3:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"å›¾ç‰‡é¢„å¤„ç† å›¾ç‰‡ä¿¡æ¯ï¼š æ­¤éªŒè¯ç æ˜¯ 68x23ï¼ŒJPGæ ¼å¼ äºŒå€¼åŒ–ï¼š æˆ‘ç¡®ä¿¡è¿™ä¸ªéªŒè¯ç è¶³å¤Ÿç®€å•ï¼Œåœ¨ä¸¢å¤±å›¾ç‰‡çš„é¢œè‰²ä¿¡æ¯åä»ç„¶èƒ½è¢«å¾ˆå¥½çš„è¯†åˆ«ã€‚å¹¶ä¸”å¯ä»¥é™ä½æ¨¡å‹å¤æ‚åº¦ï¼Œå› æ­¤å¯ä»¥å°†å›¾ç‰‡äºŒå€¼åŒ–ã€‚å³åªæœ‰ä¸¤ä¸ªé¢œè‰²ï¼Œå…¨é»‘æˆ–è€…å…¨ç™½ã€‚ åˆ‡å‰²éªŒè¯ç ï¼š è§‚å¯ŸéªŒè¯ç ï¼Œæ²¡æœ‰ç‰¹åˆ«æ‰­æ›²æˆ–è€…ç²˜è¿ï¼Œæ‰€ä»¥å¯ä»¥æŠŠéªŒè¯ç å¹³å‡åˆ‡å‰²æˆ4å—ï¼Œåˆ†åˆ«è¯†åˆ«ï¼Œè¿™æ ·å›¾ç‰‡è¯†åˆ«æ¨¡å‹å°±åªéœ€è¦å¤„ç†10ä¸ªåˆ†ç±»ï¼ˆå¦‚æœæœ‰å­—æ¯é‚£å°†æ˜¯36ä¸ªåˆ†ç±»è€Œå·²ï¼‰ç”±äºéªŒè¯ç å¤–é¢æœ‰ä¸€åœˆè¾¹æ¡†ï¼Œæ‰€ä»¥é¡ºå¸¦æŠŠè¾¹æ¡†ä¹Ÿå»æ‰äº†ã€‚ å¤„ç†ç»“æœï¼š 16x21ï¼Œé»‘ç™½2ä½ ä»£ç ï¼š img = Image.open(file).convert('L') # è¯»å–å›¾ç‰‡å¹¶ç°åº¦åŒ– img = img.crop((2, 1, 66, 22)) # è£æ‰è¾¹å˜æˆ 64x21 # åˆ†ç¦»æ•°å­— img1 = img.crop((0, 0, 16, 21)) img2 = img.crop((16, 0, 32, 21)) img3 = img.crop((32, 0, 48, 21)) img4 = img.crop((48, 0, 64, 21)) img1 = np.array(img1).flatten() # æ‰å¹³åŒ–ï¼ŒæŠŠäºŒç»´å¼„æˆä¸€ç»´ img1 = list(map(lambda x: 1 if x \u003c= 180 else 0, img1)) # äºŒå€¼åŒ– img2 = np.array(img2).flatten() img2 = list(map(lambda x: 1 if x \u003c= 180 else 0, img2)) img3 = np.array(img3).flatten() img3 = list(map(lambda x: 1 if x \u003c= 180 else 0, img3)) img4 = np.array(img4).flatten() img4 = list(map(lambda x: 1 if x \u003c= 180 else 0, img4)) ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:4:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"ä¿å­˜æ•°æ®é›† æ•°æ®é›†æœ‰è¾“å…¥è¾“å…¥æ•°æ®å’Œæ ‡ç­¾æ•°æ®ï¼Œè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ã€‚ å› ä¸ºæ•°æ®é‡ä¸å¤§ï¼Œç®€ä¾¿èµ·è§ï¼Œç›´æ¥æŠŠæ•°æ®å­˜æˆpythonæ–‡ä»¶ï¼Œä¾›æ¨¡å‹è°ƒç”¨ã€‚å°±ä¸ä¿å­˜ä¸ºå…¶ä»–æ–‡ä»¶ï¼Œç„¶åç”¨ pandas ä»€ä¹ˆçš„æ¥è¯»å–äº†ã€‚ æœ€ç»ˆè¾“å…¥æ¨¡å‹çš„æ•°æ®å½¢çŠ¶ä¸º [[0,1,0,1,0,1,0,1â€¦],[0,1,0,1,0,1,0,1â€¦],â€¦] æ ‡ç­¾æ•°æ®å¾ˆç‰¹æ®Šï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œæ‰€ä»¥è™½ç„¶æ ‡ç­¾åº”è¯¥æ˜¯0åˆ°9çš„æ•°å­—ï¼Œä½†æ˜¯è¿™é‡Œä½¿æ ‡ç­¾æ•°æ®æ ¼å¼æ˜¯ one-hot vectors [[1,0,0,0,0,0,0,0,0,0,0],â€¦] ä¸€ä¸ªone-hotå‘é‡é™¤äº†æŸä¸€ä½çš„æ•°å­—æ˜¯1ä»¥å¤–å…¶ä½™å„ç»´åº¦æ•°å­—éƒ½æ˜¯0**ï¼Œæ¯”å¦‚[1,0,0,0,0,0,0,0,0,0] ä»£è¡¨1ï¼Œ[0,1,0,0,0,0,0,0,0,0]ä»£è¡¨2. æ›´è¿›ä¸€æ­¥ï¼Œè¿™é‡Œçš„ one-hot å‘é‡å…¶å®ä»£è¡¨ç€å¯¹åº”çš„æ•°æ®åˆ†æˆè¿™åç±»çš„æ¦‚ç‡ã€‚æ¦‚ç‡ä¸º1å°±æ˜¯æ­£ç¡®çš„åˆ†ç±»ã€‚ ä»£ç ï¼š # ä¿å­˜è¾“å…¥æ•°æ® def px(prefix, img1, img2, img3, img4): with open('./data/' + prefix + '_images.py', 'a+') as f: print(img1, file=f, end=\",\\n\") print(img2, file=f, end=\",\\n\") print(img3, file=f, end=\",\\n\") print(img4, file=f, end=\",\\n\") # ä¿å­˜æ ‡ç­¾æ•°æ® def py(prefix, code): with open('./data/' + prefix + '_labels.py', 'a+') as f: for x in range(4): tmp = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] tmp[int(code[x])] = 1 print(tmp, file=f, end=\",\\n\") ç»è¿‡ä¸Šé¢ä¸¤æ­¥ï¼Œåœ¨å°±è·å¾—äº†è®­ç»ƒå’Œæµ‹è¯•ç”¨çš„æ•°æ®å’Œæ ‡ç­¾æ•°æ® ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:5:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æ„å»ºæ¨¡å‹è®­ç»ƒ æ•°æ®å‡†å¤‡å¥½å•¦ï¼Œåˆ°äº†è¦æ­å»ºâ€œç®¡é“â€çš„æ—¶å€™äº†ã€‚ ä¹Ÿå°±æ˜¯ä½ éœ€è¦å‘Šè¯‰ TensorFlowï¼š ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"1. è¾“å…¥æ•°æ®çš„å½¢çŠ¶æ˜¯æ€æ ·çš„ï¼Ÿ x = tf.placeholder(tf.float32, [None, DLEN]) None è¡¨ç¤ºä¸å®šä¹‰æœ‰å¤šå°‘è®­ç»ƒæ•°æ®ï¼ŒDLENæ˜¯ 16*21ï¼Œå³ä¸€ç»´åŒ–çš„å›¾ç‰‡çš„å¤§å°ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:1","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"2. è¾“å‡ºæ•°æ®çš„å½¢çŠ¶æ˜¯æ€æ ·çš„ï¼Ÿ y = tf.placeholder(\"float\", [None, 10]) åŒæ ·None è¡¨ç¤ºä¸å®šä¹‰æœ‰å¤šå°‘è®­ç»ƒæ•°æ®ï¼Œ10 å°±æ˜¯æ ‡ç­¾æ•°æ®çš„ç»´åº¦ï¼Œå³å›¾ç‰‡æœ‰ 10 ä¸ªåˆ†ç±»ã€‚æ¯ä¸ªåˆ†ç±»å¯¹åº”ç€ä¸€ä¸ªæ¦‚ç‡ï¼Œæ‰€ä»¥æ˜¯æµ®ç‚¹ç±»å‹ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:2","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"3. è¾“å…¥æ•°æ®ï¼Œæ¨¡å‹ï¼Œæ ‡ç­¾æ•°æ®æ€æ ·æ‹Ÿåˆï¼Ÿ W = tf.Variable(tf.zeros([DLEN, 10])) # æƒé‡ b = tf.Variable(tf.zeros([10])) # åç½® y_ = tf.nn.softmax(tf.matmul(x, W) + b) ä¸€ä¸ªå¾ˆç®€å•çš„æ¨¡å‹ï¼Œå¤§ä½“å°±æ˜¯ y = softmax(Wx+b) å…¶ä¸­ W å’Œ b æ˜¯ TensorFlow ä¸­çš„å˜é‡ï¼Œä»–ä»¬ä¿å­˜ç€æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ï¼Œéœ€è¦å®šä¹‰å‡ºæ¥ã€‚è€Œæ¨¡å‹è®­ç»ƒçš„ç›®çš„ï¼Œä¹Ÿå°±æ˜¯æŠŠ W å’Œ b çš„å€¼ç¡®å®šï¼Œä½¿å¾—è¿™ä¸ªå¼å­å¯ä»¥æ›´å¥½çš„æ‹Ÿåˆæ•°æ®ã€‚ softmax æ˜¯æ‰€è°“çš„æ¿€æ´»å‡½æ•°ï¼ŒæŠŠçº¿æ€§çš„ç»“æœè½¬æ¢æˆéœ€è¦çš„æ ·å¼ï¼Œä¹Ÿå°±æ˜¯åˆ†ç±»æ¦‚ç‡çš„åˆ†å¸ƒã€‚ å…³äº softmax ä¹‹ç±»æ›´å¤šè§£é‡Šè¯·æŸ¥çœ‹å‚è€ƒé“¾æ¥ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:3","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"4. æ€æ ·è¯„ä¼°æ¨¡å‹çš„å¥½åï¼Ÿ æ¨¡å‹è®­ç»ƒå°±æ˜¯ä¸ºäº†ä½¿æ¨¡å‹è¾“å‡ºç»“æœå’Œå®é™…æƒ…å†µç›¸å·®å°½å¯èƒ½å°ã€‚æ‰€ä»¥è¦å®šä¹‰è¯„ä¼°æ–¹å¼ã€‚ è¿™é‡Œç”¨æ‰€è°“çš„äº¤å‰ç†µæ¥è¯„ä¼°ã€‚ cross_entropy = -tf.reduce_sum(y_*tf.log(y)) ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:4","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"5. æ€æ ·æœ€å°åŒ–è¯¯å·®ï¼Ÿ ç°åœ¨ TensorFlow å·²ç»çŸ¥é“äº†è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œå®ƒè¦åšçš„å·¥ä½œå°±æ˜¯è®©æ¨¡å‹çš„è¯¯å·®è¶³å¤Ÿå°ï¼Œå®ƒä¼šä½¿å‡ºå„ç§æ–¹æ³•ä½¿ä¸Šé¢å®šä¹‰çš„äº¤å‰ç†µ cross_entropy å˜å¾—å°½å¯èƒ½å°ã€‚ TensorFlow å†…ç½®äº†ä¸å°‘æ–¹å¼å¯ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œä¸åŒæ–¹å¼æœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé€‚ç”¨æ¡ä»¶ã€‚åœ¨è¿™é‡Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ¥å®ç°è¿™ä¸ªç›®çš„ã€‚ train_step = tf.train.GradientDescentOptimizer(0.01).minimize(cross_entropy) ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:5","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"è®­ç»ƒå‡†å¤‡ Python ä½œä¸ºè§£é‡Šå‹è¯­è¨€ï¼Œè¿è¡Œæ•ˆç‡ä¸èƒ½ç®—æ˜¯å¤ªå¥½ï¼Œè€Œè¿™ç§æœºå™¨å­¦ä¹ åŸºæœ¬æ˜¯éœ€è¦å¤§é‡è®¡ç®—åŠ›çš„åœºåˆã€‚TensorFlow åœ¨åº•å±‚æ˜¯ç”¨ C++ å†™å°±ï¼Œåœ¨ Python ç«¯åªæ˜¯ä¸€ä¸ªæ“ä½œç«¯å£ï¼Œæ‰€æœ‰çš„è®¡ç®—éƒ½è¦äº¤ç»™åº•å±‚å¤„ç†ã€‚è¿™è‡ªç„¶å°±å¼•å‡ºäº†ä¼šè¯çš„æ¦‚å¿µï¼Œåº•å±‚å’Œè°ƒç”¨å±‚éœ€è¦é€šä¿¡ã€‚ä¹Ÿæ­£æ˜¯è¿™ä¸ªç‰¹ç‚¹ï¼ŒTensorFlow æ”¯æŒå¾ˆå¤šå…¶ä»–è¯­è¨€æ¥å…¥ï¼Œå¦‚ Java, Cï¼Œè€Œä¸ä»…ä»…æ˜¯ Pythonã€‚ å’Œåº•å±‚é€šä¿¡æ˜¯é€šè¿‡ä¼šè¯å®Œæˆçš„å¯ä»¥é€šè¿‡ä¸€è¡Œä»£ç æ¥å¯åŠ¨ä¼šè¯ï¼š sess = tf.Session() # è®­ç»ƒ ... sess.close() åˆ«å¿˜äº†åœ¨ä½¿ç”¨å®Œåå…³é—­ä¼šè¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Python çš„ with è¯­å¥æ¥è‡ªåŠ¨ç®¡ç†ã€‚ åœ¨ TensorFlow ä¸­ï¼Œå˜é‡éƒ½æ˜¯éœ€è¦åœ¨ä¼šè¯å¯åŠ¨ä¹‹ååˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨ã€‚ sess.run(tf.global_variables_initializer()) ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:6","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"å¼€å§‹è®­ç»ƒ for i in range(DNUM): batch_xs = [train_images.data[i]] batch_ys = [train_labels.data[i]] sess.run(train_step, feed_dict={x: batch_xs, y_: batch_ys}) æŠŠæ¨¡å‹å’Œè®­ç»ƒæ•°æ®äº¤ç»™ä¼šè¯ï¼Œåº•å±‚å°±è‡ªåŠ¨å¤„ç†ã€‚å¯ä»¥ä¸€æ¬¡ä¼ å…¥ä»»æ„æ•°é‡æ•°æ®ç»™æ¨¡å‹ï¼ˆä¸Šé¢è®¾ç½®Noneçš„ä½œç”¨ï¼‰ï¼Œä¸ºäº†è®­ç»ƒæ•ˆæœï¼Œå¯ä»¥é€‚å½“è°ƒèŠ‚æ¯ä¸€æ‰¹æ¬¡è®­ç»ƒçš„æ•°æ®ã€‚ç”šè‡³äºæœ‰æ—¶å€™è¿˜è¦éšæœºé€‰æ‹©æ•°æ®ä»¥è·å¾—æ›´å¥½çš„è®­ç»ƒæ•ˆæœã€‚åœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸€æ¡ä¸€æ¡è®­ç»ƒï¼Œåæ­£æœ€åæ•ˆæœè¿˜å¯ä»¥ã€‚è¦äº†è§£æ›´å¤šå¯ä»¥æŸ¥çœ‹å‚è€ƒé“¾æ¥ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:7","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æ£€éªŒè®­ç»ƒç»“æœ è¿™é‡Œä½¿ç”¨æµ‹è¯•æ•°æ®æ£€éªŒç»“æœ correct_prediction = tf.equal(tf.argmax(y,1), tf.argmax(y_,1)) accuracy = tf.reduce_mean(tf.cast(correct_prediction, \"float\")) print(sess.run(accuracy, feed_dict={x: test_images.data, y_: test_labels.data})) æ¨¡å‹è¾“å‡ºæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢å­˜ç€æ¯ä¸ªåˆ†ç±»çš„æ¦‚ç‡ï¼Œæ‰€ä»¥è¦æ‹¿å‡ºæ¦‚ç‡æœ€å¤§çš„åˆ†ç±»å’Œæµ‹è¯•æ ‡ç­¾æ¯”è¾ƒã€‚çœ‹åœ¨è¿™ 250 æ¡æµ‹è¯•æ•°æ®é‡Œé¢ï¼Œæ­£ç¡®ç‡æ˜¯å¤šå°‘ã€‚å½“ç„¶è¿™äº›ä¹Ÿæ˜¯å®šä¹‰å®Œæ“ä½œæ­¥éª¤ï¼Œäº¤ç»™ä¼šè¯æ¥è¿è¡Œå¤„ç†çš„ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:6:8","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æå–æ¨¡å‹ä½¿ç”¨ åœ¨ä¸Šé¢å·²ç»æŠŠæ¨¡å‹è®­ç»ƒå¥½äº†ï¼Œè€Œä¸”æ•ˆæœè¿˜ä¸é”™å“¦ï¼Œè¿‘ 99% çš„æ­£ç¡®ç‡ï¼Œæˆ–è®¸æ¯”äººå·¥æ‰“ç è¿˜é«˜ä¸€äº›å‘¢ï¼ˆè·å–æµ‹è¯•æ•°æ®æ—¶å€™å¸¸å¸¸è¿”å›æœ‰é”™è¯¯çš„å€¼ï¼‰ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘ç°åœ¨è¦æŠŠè¿™ä¸ªæ¨¡å‹ç”¨äºç”Ÿäº§æ€ä¹ˆåŠï¼Œæ€»ä¸å¯èƒ½æ¯æ¬¡éƒ½è®­ç»ƒä¸€æ¬¡ã€‚åœ¨è¿™é‡Œå°±è¦ä½¿ç”¨åˆ° TensorFlow çš„æ¨¡å‹ä¿å­˜å’Œè½½å…¥åŠŸèƒ½äº†ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:7:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"ä¿å­˜æ¨¡å‹ å…ˆåœ¨æ¨¡å‹è®­ç»ƒçš„æ—¶å€™ä¿å­˜æ¨¡å‹ï¼Œå®šä¹‰ä¸€ä¸ª saverï¼Œç„¶åç›´æ¥æŠŠä¼šè¯ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•å°±å¥½äº†ã€‚ saver = tf.train.Saver() # è®­ç»ƒä»£ç  # ... saver.save(sess, 'model/model') sess.close() å½“ç„¶è¿™é‡Œçš„ saver ä¹Ÿæœ‰ä¸å°‘é…ç½®ï¼Œæ¯”å¦‚ä¿å­˜æœ€è¿‘å¤šå°‘æ‰¹æ¬¡çš„è®­ç»ƒç»“æœä¹‹ç±»ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥èµ„æ–™ã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:7:1","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Technology"],"content":"æ¢å¤æ¨¡å‹ åŒæ ·æ¢å¤æ¨¡å‹ä¹Ÿå¾ˆç®€å• saver.restore(sess, \"model/model\") å½“ç„¶ä½ è¿˜æ˜¯éœ€è¦å®šä¹‰å¥½æ¨¡å‹ï¼Œæ‰èƒ½æ¢å¤ã€‚æˆ‘çš„ç†è§£æ˜¯è¿™é‡Œæ¨¡å‹ä¿å­˜çš„æ˜¯è®­ç»ƒè¿‡ç¨‹ä¸­å„ä¸ªå˜é‡çš„å€¼ï¼Œæƒé‡åç½®ä»€ä¹ˆçš„ï¼Œæ‰€ä»¥ç»“æ„æ¶å­è¿˜æ˜¯è¦äº‹å…ˆæ­å¥½æ‰è¡Œã€‚ ","date":"2022-03-31","objectID":"/20220331_tensorflow-captcha/:8:0","tags":["TensorFlow","MachineLearning"],"title":"Tensorflow Identify Simple Captcha","uri":"/20220331_tensorflow-captcha/"},{"categories":["Life"],"content":"Article description.","date":"2021-12-18","objectID":"/20211218_2021-summary-video/","tags":["Life","Video","Shang hai","Bei jing"],"title":"Memories of 2021","uri":"/20211218_2021-summary-video/"},{"categories":["Life"],"content":"Photos and videos recorded in 2021. ","date":"2021-12-18","objectID":"/20211218_2021-summary-video/:0:0","tags":["Life","Video","Shang hai","Bei jing"],"title":"Memories of 2021","uri":"/20211218_2021-summary-video/"},{"categories":["Technology"],"content":"Flink optimization includes resource configuration optimization, back pressure processing, data skew, KafkaSource optimization and FlinkSQL optimization. ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:0:0","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"èµ„æºé…ç½®è°ƒä¼˜ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:0","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"å†…å­˜è®¾ç½® ç»™ä»»åŠ¡åˆ†é…èµ„æºï¼Œåœ¨ä¸€å®šèŒƒå›´å†…ï¼Œå¢åŠ èµ„æºçš„åˆ†é…ä¸æ€§èƒ½çš„æå‡æ˜¯æ­£æ¯”çš„ï¼ˆéƒ¨åˆ†æƒ…å†µå¦‚èµ„æºè¿‡å¤§ï¼Œç”³è¯·èµ„æºæ—¶é—´å¾ˆé•¿ï¼‰ã€‚ æäº¤æ–¹å¼ä¸»è¦æ˜¯ yarn-per-jobï¼Œèµ„æºçš„åˆ†é…åœ¨ä½¿ç”¨è„šæœ¬æäº¤ Flink ä»»åŠ¡æ—¶è¿›è¡ŒæŒ‡å®šã€‚ ç›®å‰é€šå¸¸ä½¿ç”¨å®¢æˆ·ç«¯æ¨¡å¼ï¼Œå‚æ•°ä½¿ç”¨ -D\u003cproperty=value\u003e æŒ‡å®š bin/fink run \\ -t yarn-per-job \\ -d \\ -p 5 \\ æŒ‡å®šå¹¶è¡Œåº¦ -Dyarn.application.queue=test \\ æŒ‡å®š yarn é˜Ÿåˆ— -Djobmanager.memory.process.size=2048mb \\ jm 2-4Gè¶³å¤Ÿ -Dtaskmanager.memory.process.size=6144mb \\ å•ä¸ª tm 2-8G è¶³å¤Ÿ -Dtaskmanager.numberOfTaskSlots=2 \\ ä¸å®¹å™¨æ ¸æ•° 1core:1slot æˆ– 1core:2slot ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:1","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"å¹¶è¡Œåº¦è®¾ç½® æœ€ä¼˜å¹¶è¡Œåº¦è®¡ç®— å®Œæˆå¼€å‘åï¼Œå‹æµ‹ï¼Œä»»åŠ¡å¹¶è¡Œåº¦ç»™ 10 ä»¥ä¸‹ï¼Œæµ‹è¯•å•ä¸ªå¹¶è¡Œåº¦çš„å¤„ç†ä¸Šé™ã€‚ç„¶å æ€» QPS / å•å¹¶è¡Œåº¦çš„å¤„ç†èƒ½åŠ› = å¹¶è¡Œåº¦ ä¸èƒ½åªæ ¹æ® QPS å¾—å‡ºå¹¶è¡Œåº¦ï¼Œå› ä¸ºæœ‰äº›å­—æ®µå°‘ï¼Œé€»è¾‘ç®€å•ä»»åŠ¡ã€‚æœ€å¥½æ ¹æ®é«˜å³°æœŸçš„ QPS å‹æµ‹ï¼Œå¹¶è¡Œåº¦ * 1.2ï¼Œå¯Œä½™ä¸€äº›èµ„æºã€‚ Source ç«¯å¹¶è¡Œåº¦çš„é…ç½® æ•°æ®æºç«¯æ˜¯ Kafkaï¼ŒSource çš„å¹¶è¡Œåº¦è®¾ç½®ä¸º Kafka å¯¹åº” Topic çš„åˆ†åŒºæ•°ã€‚ å¦‚æœç­‰äº Kafka çš„åˆ†åŒºæ•°ï¼Œæ¶ˆè´¹é€Ÿåº¦ä»è·Ÿä¸ä¸Šæ•°æ®ç”Ÿäº§é€Ÿåº¦ï¼Œéœ€è€ƒè™‘ Kafka è¦æ‰©å¤§åˆ†åŒºï¼ŒåŒæ—¶è°ƒå¤§å¹¶è¡Œåº¦ç­‰äºåˆ†åŒºæ•°ã€‚ Tip ä¼˜å…ˆåŠ èµ„æºï¼› Kafka çš„åˆ†åŒºæ•°å¢åŠ ä¸å¯é€†æ“ä½œï¼Œå¢åŠ åˆ†åŒºæ”¾åœ¨æœ€åä½¿ç”¨ã€‚ Transform ç«¯å¹¶è¡Œåº¦çš„é…ç½® keyby ä¹‹å‰çš„ç®—å­ ä¸€èˆ¬ä¸ä¼šåšå¤ªé‡çš„æ“ä½œï¼Œæ¯”å¦‚æ˜¯ mapã€filterã€flatmap ç­‰å¤„ç†è¾ƒå¿«çš„ç®—å­ï¼Œå¹¶è¡Œåº¦å¯ä»¥å’Œ source ä¿æŒä¸€è‡´ã€‚ keyby ä¹‹åçš„ç®—å­ å¦‚æœå¹¶è¡Œæ¯”è¾ƒå¤§ï¼Œå¯ä»¥è®¾ç½®å¹¶è¡Œåº¦ä¸º 2 çš„æ•´æ¬¡å¹‚ï¼› å°å¹¶å‘ä»»åŠ¡çš„å¹¶è¡Œåº¦ä¸ä¸€å®šéœ€è¦è®¾ç½®æˆ 2 çš„æ•´æ•°æ¬¡å¹‚ï¼› å¤§å¹¶å‘å¦‚æœæ²¡æœ‰ keybyï¼Œå¹¶è¡Œåº¦ä¹Ÿæ— éœ€è®¾ç½®ä¸º 2 çš„æ•´æ¬¡å¹‚ã€‚ Sink ç«¯å¹¶è¡Œåº¦çš„é…ç½® å¯ä»¥æ ¹æ® Sink ç«¯çš„æ•°æ®é‡åŠä¸‹æ¸¸æœåŠ¡æŠ—å‹èƒ½åŠ›è¿›è¡Œè¯„ä¼°ã€‚ å¦‚æœ Sink ç«¯æ˜¯ Kafkaï¼Œå¯ä»¥è®¾ä¸º Kafka å¯¹åº” Topic çš„åˆ†åŒºæ•°ã€‚ å¦å¤– Sink ç«¯è¦ä¸ä¸‹æ¸¸çš„æœåŠ¡è¿›è¡Œäº¤äº’ï¼Œè¦è€ƒè™‘å»¶è¿Ÿå’Œå‹æµ‹ï¼Œå¯ä»¥é‡‡ç”¨ï¼š æ§åˆ¶å¹¶è¡Œåº¦ï¼› é‡‡ç”¨æ‰¹é‡æäº¤çš„æ–¹å¼ã€‚å…¬å¸é‡‡ç”¨ CH é‡‡ç”¨æ¯5æ¡ä¸€æäº¤ï¼ŒåŠ ä¸Šæ—¶é—´æ§åˆ¶ (æ—¶é—´åˆ°äº†ï¼Œä½†ä¸è¶³5æ¡ï¼Œä¹Ÿä¼šæäº¤) æäº¤çš„æ–¹å¼ã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:2","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"RocksDB å¤§çŠ¶æ€è°ƒä¼˜ çŠ¶æ€å®¢æˆ·ç«¯ï¼ŒFlink æä¾›çš„ç”¨äºç®¡ç†çŠ¶æ€çš„ç»„ä»¶ï¼ŒRocksDB åŸºäº LSM Tree å®ç° (ç±»ä¼¼äº HBASE)ï¼Œå†™æ•°æ®éƒ½æ˜¯å…ˆç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥ RocksDB çš„å†™è¯·æ±‚æ•ˆç‡æ¯”è¾ƒé«˜ã€‚ Memory æœ¬åœ°ï¼štaskmanagerå†…å­˜ è¿œç¨‹ï¼šjmå†…å­˜ fs æœ¬åœ°ï¼štmå†…å­˜ è¿œç¨‹ï¼šæ–‡ä»¶ç³»ç»Ÿï¼ˆä¸€èˆ¬æ˜¯HDFSï¼‰ rocksDB æœ¬åœ°ï¼šå½“å‰æœºå™¨çš„å†…å­˜ + ç£ç›˜ è¿œç¨‹ï¼šæ–‡ä»¶ç³»ç»Ÿï¼ˆHDFSï¼‰ è°ƒä¼˜ï¼š å¢é‡æ£€æŸ¥ç‚¹ï¼Œï¼ˆç‹¬æœ‰çš„ï¼‰ è®¾ç½®ä¸º æœºæ¢° + å†…å­˜æ¨¡å¼ï¼Œæœ‰æ¡ä»¶ä¸Š SSD ç¼“å­˜å‘½ä¸­ç‡ï¼Œå’Œ HBASE ä¸€æ ·ï¼Œcache è¶Šå¤§ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜ã€‚ä¸€èˆ¬è®¾ç½®ä¸º 64 ~ 256 MBã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:3","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"CheckPoint è®¾ç½® cp é˜²æ­¢æ•°æ®æŒ‚æ‰ï¼Œä» cp æ¢å¤æ•°æ®ï¼› ä¸€èˆ¬åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œæ—¶é—´é—´éš”è®¾ç½®ä¸ºåˆ†é’Ÿçº§åˆ«ï¼› å¦‚æœè®¿é—® HDFS æ¯”è¾ƒè€—æ—¶ï¼Œæ—¶é—´é—´éš”å¯ä»¥è®¾ç½®ä¸º 5 ~ 10 åˆ†é’Ÿï¼› ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:4","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"Flink parameterTool è¯»å–é…ç½® è¯»å–è¿è¡Œå‚æ•° ä½¿ç”¨ parameterTool.get(\"host\") æ›¿æ¢ args[0] ä¼ å‚æ—¶ä½¿ç”¨ --host hadoop102 --poart 9999 è¯»å–ç³»ç»Ÿå±æ€§ è¯»å–é…ç½®æ–‡ä»¶ parameterTool.fromPropertiesFile(\"/application.properties\") é…ç½®å…¨å±€å‚æ•° ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:5","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"å‹æµ‹æ–¹å¼ å…ˆåœ¨ kafka ä¸­ç§¯å‹æ•°æ®ï¼Œä¹‹åå¼€å¯ Flink ä»»åŠ¡ï¼Œå‡ºç°åå‹ï¼Œå°±æ˜¯å¤„ç†ç“¶é¢ˆã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:1:6","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"åå‹å¤„ç† ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:2:0","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"åå‹ç°è±¡åŠå®šä½ åå‹ç°è±¡ kafka åå‹ï¼š é€çº§ä¼ é€’ï¼› transform çš„ compute ç«¯æœ‰è¯»ç¼“å­˜å’Œå†™ç¼“å­˜ï¼Œç¼“å­˜æ»¡äº†å‘ä¸Šçº§æ‹‰å–æ•°æ®çš„å»¶è¿Ÿå¢å¤§ï¼›æ¯”å¦‚ä¸Šçº§æ˜¯ source ç«¯ï¼› source ç«¯åŒç†ï¼Œå‘ kafka å®¢æˆ·ç«¯æœåŠ¡ç«¯æ‹‰å–æ•°æ®å»¶è¿Ÿå¢å¤§ï¼› ä¼šé€ æˆ kafka æ•°æ®å»¶è¿Ÿï¼Œæœ‰å¯èƒ½é€ æˆæœºå™¨å†…å­˜æº¢å‡ºã€‚ spark åå‹ spark å¼€å¯åå‹ä¸€å®šæ˜¯åŸºäº receiver æ¨¡å¼ã€‚ executor -\u003e executor -\u003e executorâ€¦ ä¸ kafka ä¸åŒ executor å‡ºç°æ•°æ®åå‹ä¸ä¼šé€çº§å‘ä¸Šæ¸¸ä¼ é€’ï¼Œä¼šç›´æ¥é€šä¿¡ Driverï¼ŒDriver ä¼šç›´æ¥é€šä¿¡æœ€ä¸Šçº§ executor æ”¾æ…¢é€Ÿåº¦ã€‚ Tip é€çº§æ›´å¥½ï¼š è®¾ç½®äº†ç¼“å­˜å°±æ˜¯ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µ ç›´æ¥é€šä¿¡ Driverï¼Œä¼šå½±å“æ•´ä½“çš„è¿›ç¨‹ï¼Œä¸æ–¹ä¾¿ç¡®å®šé—®é¢˜ã€‚ åˆ©ç”¨ Flink Web UI å®šä½ åˆ©ç”¨ Metrics ç›‘æ§å·¥å…·å®šä½åå‹ä½ç½® åå‹æ—¶ï¼Œè§‚å¯Ÿåˆ° é‡åˆ°ç“¶é¢ˆçš„è¯¥ Task çš„ inPoolUage ä¸º 1 ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:2:1","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"åå‹çš„åŸå› åŠå¤„ç† ç³»ç»Ÿèµ„æº å†…å­˜å’ŒCPUèµ„æºã€‚ä¸€èˆ¬æƒ…å†µ æœ¬éƒ½ç£ç›˜åŠç½‘å¡èµ„æºä¸ä¼šæ˜¯ç“¶é¢ˆã€‚å¦‚æœæŸäº›èµ„æºè¢«å……åˆ†åˆ©ç”¨æˆ–å¤§é‡ä½¿ç”¨ï¼Œå¯ä»¥å€ŸåŠ©åˆ†æå·¥å…·åˆ†ææ€§èƒ½ç“¶é¢ˆï¼ˆJVM Profiler + FlameGraph ç”Ÿæˆç«ç„°å›¾ï¼‰ ç«ç„°å›¾è¡¨ç¤ºäº† CPU æ‰§è¡Œå„ä¸ªåŠŸèƒ½çš„æ—¶é—´ï¼Œä»ä¸‹è‡ªä¸Šå±•ç¤ºäº†æ–¹æ³•çš„è°ƒç”¨å…³ç³»ï¼Œå°–é¡¶é€šå¸¸è¡¨ç¤ºæ‰§è¡Œæ­£å¸¸ï¼Œå¹³é¡¶è¡¨ç¤ºè¿è¡Œæ—¶é—´è¿‡é•¿ï¼Œé€šå¸¸ä¸ºç“¶é¢ˆã€‚ é’ˆå¯¹ç‰¹å®šçš„èµ„æºè°ƒä¼˜ Flink å‡å°‘ç“¶é¢ˆç®—å­ä¸Šæ¸¸çš„å¹¶è¡Œåº¦ï¼Œä»è€Œå‡å°‘ç“¶é¢ˆç®—å­æ¥å—çš„æ•°æ®é‡ï¼ˆå¯èƒ½ä¼šé€ æˆ Job æ•°æ®å»¶è¿Ÿå¢å¤§ï¼‰ åƒåœ¾å›æ”¶GC è¿è¡Œæ—¶æ‰“å¼€å‚æ•° printGCDetails ä¸‹è½½ GC æ—¥å¿—ï¼šå› ä¸ºæ˜¯ on yarn æ¨¡å¼ï¼Œä¸€ä¸ªä¸€ä¸ªèŠ‚ç‚¹çœ‹æ—¥å¿—æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥æ‰“å¼€ WebUIï¼Œåœ¨ JobManager æˆ– TaskManagerï¼Œä¸‹è½½ Stdout ä½¿ç”¨ GCviewer åˆ†ææ•°æ®ï¼šæœ€é‡è¦çš„æŒ‡æ ‡æ˜¯ Funll GC åï¼Œè€å¹´ä»£å‰©ä½™å¤§å° è¿™ä¸ªæŒ‡æ ‡ï¼ŒæŒ‰ç…§ Java æ€§èƒ½ä¼˜åŒ–æƒå¨æŒ‡å— è¿™æœ¬ä¹¦ Java å †å¤§å°è®¡ç®—æ³•åˆ™ï¼Œè®¾ Full GC åè€å¹´ä»£å‰©ä½™å¤§å°ç©ºé—´ä¸º Mï¼Œé‚£ä¹ˆå †çš„å¤§å°å»ºè®®è®¾ç½®ä¸º 3 ~ 4å€ Mï¼Œæ–°ç”Ÿä»£ä¸º 1 ~ 1.5 å€ Mï¼Œè€å¹´ä»£ä¸º 2 ~ 3å€ Mã€‚ CPU/çº¿ç¨‹ç“¶é¢ˆ \u0026 çº¿ç¨‹ç«äº‰ ï¼ˆè¿˜æ˜¯èµ„æºé—®é¢˜ï¼Œä½¿ç”¨å‹æµ‹ä¿è¯èµ„æºåˆç†ï¼‰ã€‚ subtask å¯èƒ½ä¼šå› ä¸ºå…±äº«èµ„æºä¸Šé«˜è´Ÿè½½çº¿ç¨‹çš„ç«äº‰æˆä¸ºç“¶é¢ˆã€‚åŒæ ·å¯ä»¥è€ƒè™‘ä¸Šè¿°åˆ†æå·¥å…·ã€‚è€ƒè™‘åœ¨ä»£ç ä¸­æŸ¥æ‰¾åŒæ­¥å¼€é”€ã€é”ç«äº‰ã€å°½ç®¡é¿å…åœ¨ä»£ç ä¸­æ·»åŠ åŒæ­¥ã€‚ è´Ÿè½½ä¸å¹³è¡¡ å±äºæ•°æ®å€¾æ–œé—®é¢˜ å¤–éƒ¨ä¾èµ– source ç«¯è¯»å–æ€§èƒ½æ¯”è¾ƒä½æˆ–è€… Sink ç«¯æ€§èƒ½è¾ƒå·®ï¼Œéœ€è¦æ£€æŸ¥ç¬¬ä¸‰æ–¹ç»„ä»¶æ˜¯å¦é‡åˆ°ç“¶é¢ˆã€‚å¦‚ï¼š kafkaé›†ç¾¤æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œkafka è¿æ¥å™¨æ˜¯å¦å¹¶è¡Œåº¦è¾ƒä½ï¼› HBASE çš„ rowkey æ˜¯å¦é‡åˆ°çƒ­ç‚¹é—®é¢˜ã€‚ éœ€è¦ç»“åˆå…·ä½“ç»„ä»¶æ¥åˆ†æ è§£å†³æ–¹æ¡ˆï¼šæ—è·¯ç¼“å­˜ + å¼‚æ­¥IO ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:2:2","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"æ•°æ®å€¾æ–œ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:3:0","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ•°æ®å€¾æ–œ é€šè¿‡ Flink Web UI å¯ä»¥ç²¾ç¡®çš„çœ‹åˆ°æ¯ä¸ª subtask å¤„ç†äº†å¤šå°‘æ•°æ®ï¼Œå³å¯ä»¥åˆ¤æ–­å‡º Flink ä»»åŠ¡æ˜¯å¦å­˜åœ¨æ•°æ®å€¾æ–œã€‚é€šå¸¸æ•°æ®å€¾æ–œä¹Ÿä¼šå¼•èµ·åå‹ã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:3:1","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"æ•°æ®å€¾æ–œçš„è§£å†³ keyBy å‰å‘ç”Ÿæ•°æ®å€¾æ–œ ä¸Šæ¸¸ç®—å­çš„æŸäº›å®ä¾‹å¯èƒ½å¤„ç†çš„æ•°æ®è¾ƒå¤šï¼ŒæŸäº›å®ä¾‹å¯èƒ½å¤„ç†çš„æ•°æ®è¾ƒå°‘ï¼Œäº§ç”Ÿæ”¹æƒ…å†µå¯èƒ½æ˜¯å› ä¸ºæ•°æ®æºæœ¬èº«å°±ä¸å‡åŒ€ï¼Œä¾‹å¦‚ç”±äºæŸäº›åŸå›  Kafka çš„ topic ä¸­æŸäº› partition çš„æ•°æ®é‡è¾ƒå¤§ï¼Œå¯¹äºä¸å­˜åœ¨ keyby çš„ Flink ä»»åŠ¡ä¹Ÿä¼šå‡ºç°è¯¥æƒ…å†µã€‚ è§£å†³æ–¹æ¡ˆï¼šéœ€è¦è®© Flink ä»»åŠ¡å¼ºåˆ¶è¿›è¡Œ shuffleã€‚ä½¿ç”¨ shuffleã€rebalanceï¼ˆrebçš„è½®è¯¢æ¯”shuffleçš„éšæœºæ›´å¥½ï¼Œrescaleæ˜¯èŒƒå›´è½®è¯¢ï¼‰ æˆ– rescale ç®—å­å³å¯å°†æ•°æ®å‡åŒ€åˆ†é…ï¼Œä»è€Œè§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ã€‚ keyBy åå‘ç”Ÿæ•°æ®å€¾æ–œ æ‰©å±• Hiveã€mrã€spark éƒ½æœ‰å¯èƒ½ keyby æ•°æ®å€¾æ–œçš„é€šç”¨æ–¹æ³•ï¼š åŒé‡èšåˆï¼Œå¦‚ a å¼€å¤´çš„æ•°æ®æœ‰10ä¸‡æ¡ï¼ŒæŠŠ a æ•°æ®ç”¨ hash æ‰“æ•£ï¼Œa_0 ~ a_9ï¼Œæ¯ä¸ªæ•°æ® 1 ä¸‡æ¡ï¼›ç¬¬äºŒæ¬¡æŠŠåç¼€å»æ‰ï¼ŒæŠŠ a çš„åæ¡æ•°æ®å†åšä¸€æ¬¡ç´¯åŠ å¾—åˆ°ç»“æœã€‚ Flink ç›´æ¥èšåˆï¼Œä¸ç”¨å¼€çª—ç”¨ä¸äº†ã€‚å› ä¸ºæµå¤„ç†è¿˜æ˜¯ä¸€æ¡æ¡å†™æ•°æ®ï¼Œæ²¡æœ‰è§£å†³æ•°æ®æ•°é‡é—®é¢˜ï¼Œä¸‹æ¸¸å»æ‰éšæœºæ•°é‡æ–° keyby è¿˜æ˜¯ a æ•°æ®è¿˜æ˜¯åˆ°ä¸€èµ·äº†ï¼Œä»ç„¶æœ‰å¯èƒ½æ•°æ®å€¾æ–œ + é‡å¤æ•°æ®é—®é¢˜å¯¼è‡´ç»“æœä¸å¯¹ï¼Œç”±äºæµå¤„ç†ï¼Œkeyby æœ¬èº«æ˜¯ 1+1+1+1ï¼Œæµå¤„ç†å˜æˆäº†1+2+3+4ã€‚å½“ç„¶ä½¿ç”¨å¼€çª—å¯ä»¥è§„é¿ï¼Œä½†å¼€çª—è¿˜ä¼šæ•°æ®å€¾æ–œã€‚ ä½¿ç”¨ LocalKeyBy çš„æ€æƒ³ï¼šå®šä¹‰çŠ¶æ€ï¼Œç§¯æ”’æ‰¹æ¬¡çš„å¤„ç†ã€‚ç±»ä¼¼ MapReduce ä¸­ Combiner çš„æ€æƒ³ã€‚ åœ¨æœ¬åœ°å®šä¹‰çŠ¶æ€ï¼Œä½¿ç”¨å®šæ—¶å™¨æˆ–è€…è®¾ç½®æ•°é‡åˆ°è¾¾å¤šå°‘çš„æ—¶å€™ï¼Œmap ç«¯çš„æ•°æ®è¿›è¡Œä¸€ä¸ªç´¯åŠ ç»è¿‡ keyby å†åˆ° reduce ç«¯ã€‚ keyBy åçš„çª—å£èšåˆæ“ä½œå­˜åœ¨æ•°æ®å€¾æ–œ çª—å£å°±æ˜¯æ‰¹å¤„ç†ï¼Œçª—å£åªè¾“å‡ºä¸€æ¬¡ç»“æœã€‚ ä½†æ˜¯ä¸¤ä¸ªçª—å£ä¹Ÿä¼šå‡ºç° 4+4 å˜æˆ 4+8 çš„ç°è±¡ã€‚ï¼ˆå°†å¤šä¸ªçª—å£çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼‰ï¼ˆç¬¬ä¸€ä¸ªçª—å£ 4 ä¸ª aï¼Œæœ€ç»ˆçª—å£keybyåè¾“å‡º [a, 4]ï¼Œç¬¬äºŒä¸ªçª—å£åˆæ¥ 4 ä¸ª aï¼Œå»æ‰éšæœºæ•°åç”±äºéƒ½æ˜¯ aï¼Œç¬¬äºŒçª—å£çš„ [a, 4] å°±ä¼šå’Œç¬¬ä¸€ä¸ªçª—å£çš„ [a, 4] sum æ“ä½œ å˜æˆ [a, 8]ï¼Œç¬¬ä¸€ä¸ªçª—å£å’Œç¬¬äºŒä¸ªçª—å£ç´¯åŠ å°±ä¼šå‡ºç° [a, 12] è¿™ä¸ªé”™è¯¯ç»“æœï¼‰ è§£å†³æ–¹æ³•ï¼šå¸¦ä¸Šçª—å£ä¿¡æ¯è¿›è¡Œèšåˆã€‚ å®ç°æ€è·¯ï¼š key æ‹¼æ¥éšæœºæ•°å‰ç¼€æˆ–åç¼€ï¼Œè¿›è¡Œ keyby ã€å¼€çª—ã€èšåˆï¼› æ³¨æ„ï¼š èšåˆå®Œä¸å†æ˜¯ windowedStreamï¼Œè¦è·å– windowEnd ä½œä¸ºçª—å£æ ‡è®°ä½œä¸ºç¬¬äºŒé˜¶æ®µåˆ†ç»„ä¾æ®ï¼Œé¿å…ä¸åŒçª—å£çš„ç»“æœèšåˆåˆ°ä¸€èµ·ã€‚ å»æ‰éšæœºæ•°å‰ç¼€æˆ–åç¼€ï¼ŒæŒ‰ç…§åŸæ¥çš„ key åŠ windowEnd ä½œä¸º keybyã€èšåˆã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:3:2","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"KafkaSource è°ƒä¼˜ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:4:0","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"åŠ¨æ€å‘ç°åˆ†åŒº ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:4:1","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"ä» kafka æ•°æ®æºç”Ÿæˆ watermark kafka å•åˆ†åŒºå†…æœ‰åºï¼Œå¤šåˆ†åŒºæ— åºï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºç½‘ç»œå»¶è¿Ÿç­‰å› ç´ é€ æˆæ•°æ®æ— åºã€é”™ä¹±ç­‰éšæ‚£ã€‚ ä½¿ç”¨ flink ä¸­å¯è¯†åˆ« kafkaåˆ†åŒºçš„ watermark ç”Ÿæˆæœºåˆ¶ã€‚å°†åœ¨ kafka æ¶ˆè´¹ç«¯å†…éƒ¨é’ˆå¯¹æ¯ä¸ª kafka åˆ†åŒºç”Ÿæˆ watermarkï¼Œä¸”ä¸åŒåˆ†åŒº watermark çš„åˆå¹¶æ–¹å¼ä¸åœ¨æ•°æ®æµ shuffle æ—¶çš„åˆå¹¶æ–¹å¼ç›¸åŒã€‚ ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:4:2","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"è®¾ç½®ç©ºé—²ç­‰å¾… å¦‚æœæ•°æ®æºä¸­çš„æŸä¸€åˆ†åŒº/åˆ†ç‰‡åœ¨ä¸€æ®µæ—¶é—´å†…æœªå‘é€äº‹ä»¶æ•°æ®ï¼Œåˆ™ä»¥ä¸ºç€ watermarkGenerator ä¹Ÿä¸ä¼šè¿‡å¾—ä»»ä½•æ–°æ•°æ®å»ç”Ÿæˆ watermarkã€‚è¯¥åˆ†åŒºwatermark ä¸€ç›´ä¸º long çš„æœ€å°å€¼ minValueã€‚æ¯”å¦‚åœ¨ kafka çš„ topic ä¸­ï¼Œä¸ªåˆ« partition ä¸€ç›´æ²¡æœ‰æ–°çš„æ•°æ®ã€‚ ç”±äºä¸‹æ¸¸ç®—å­ watermark çš„è®¡ç®—æ–¹å¼æ˜¯å–æ‰€æœ‰ä¸åŒçš„ä¸Šæ¸¸å¹¶è¡Œæ•°æ®æº watermark çš„æœ€å°å€¼ï¼Œåˆ™å¯¼è‡´çª—å£ã€å®šæ—¶å™¨ä¸ä¼šè¢«è§¦å‘ã€‚ å¯ä»¥ä½¿ç”¨ watermarkStrategy æ¥æ£€æµ‹ç©ºé—²è¾“å…¥å¹¶å°†å…¶æ ‡è®°ä¸ºç©ºé—²çŠ¶æ€ã€‚ .withIdleness(Duration.ofMinutes(5)) ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:4:3","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"kafka çš„ offset æ¶ˆè´¹ç­–ç•¥ é»˜è®¤æ¶ˆè´¹ç­–ç•¥ï¼šè¯»å–ä¸Šæ¬¡çš„ offset ä¿¡æ¯ï¼Œç¬¬ä¸€æ¬¡è¯»ä¼šæ ¹æ® auto.offset.reset çš„å€¼æ¥è¿›è¡Œæ¶ˆè´¹æ•°æ® ä»æœ€æ—©çš„æ•°æ®å¼€å§‹è¿›è¡Œæ¶ˆè´¹ï¼Œå¿½ç•¥å­˜å‚¨ offset ä¿¡æ¯ï¼› ä»æœ€æ–°çš„æ•°æ®ä¿¡æ¯æ¶ˆè´¹ï¼Œå¿½ç•¥å­˜å‚¨ offset ä¿¡æ¯ï¼› ä»æŒ‡å®šä½ç½®å¼€å§‹æ¶ˆè´¹ï¼› ","date":"2021-06-23","objectID":"/20210623_flink-optimize/:4:4","tags":["DataWarehouse","Tuning","Flink"],"title":"Flink Performance Tuning","uri":"/20210623_flink-optimize/"},{"categories":["Technology"],"content":"There are systems that can store values of different columns separately, but that canâ€™t effectively process analytical queries due to their optimization for other scenarios. Examples are HBase and BigTable. You would get throughput around a hundred thousand rows per second in these systems, but not hundreds of millions of rows per second. ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:0:0","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"MergeTree é€‰å‹ ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:1:0","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"ReplacingMergeTree åœ¨ MergeTree çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº† â€œå¤„ç†é‡å¤æ•°æ®â€ çš„åŠŸèƒ½ï¼Œè¯¥å¼•æ“å’Œ MergeTree çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä¼šåˆ é™¤å…·æœ‰ç›¸åŒä¸»é”®çš„é‡å¤é¡¹ã€‚ä½¿ç”¨ order by ä½¿ç”¨çš„å­—æ®µæ¥è§„å®šå»é‡å­—æ®µã€‚ ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:1:1","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"SummingMergeTree åœ¨ MergeTree çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº† â€œåˆå¹¶é‡å¤æ•°æ®â€ çš„åŠŸèƒ½ï¼Œä¼šæŠŠå…·æœ‰ç›¸åŒä¸»é”®çš„è¡Œåˆå¹¶ä¸ºä¸€è¡Œï¼Œè¯¥è¡ŒåŒ…å«äº†è¢«åˆå¹¶çš„è¡Œä¸­å…·æœ‰æ•°å€¼æ•°æ®ç±»å‹çš„åˆ—çš„æ±‡æ€»å€¼ã€‚ ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:1:2","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"é€‰å‹ ReplacingMergeTree ä½¿ç”¨ SummingMergeTree ä¸èƒ½ä¿è¯æ•°æ®å‡†ç¡®æ€§ï¼Œå¦‚ä¸­æ–­é‡å¯æ•°æ®ä¼šé‡æ–°è¿›æ¥åˆå¹¶ã€‚ è§£å†³æ•°æ®åˆå¹¶çš„æ–¹å¼æœ‰å¾ˆå¤šã€‚ ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:1:3","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"Flink JDBC CH ä¸šåŠ¡ï¼š result.addSink(JdbcSink.sink()); //question: Phoenix ä¹Ÿæ˜¯ JDBCï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨ JdbcSink? // å› ä¸ºä¹‹å‰è®¿é—® Hbase çš„è¡¨éƒ½ä¸ä¸€æ ·ï¼Œè¡¨å­—æ®µä¹Ÿä¸ä¸€æ ·ã€‚( phoenix å¯ä»¥ç”¨ è‡ªå®šä¹‰çš„ MySQLSink æˆ– JDBC) // CH æ•°æ®æ¥æºå”¯ä¸€ //ä½¿ç”¨å·¥å…·ç±» result.addSink(ClickHouseUtil.getSink(\"insert into line(?, ?, ?)\")) å·¥å…·ç±»ï¼š public class ClickHouseUtil{ public static \u003cT\u003e SinkFunction\u003cT\u003e getSink()String sql{ return JdbcSink.\u003cT\u003esink(sql, new JdbcStatementBuilder\u003cT\u003e(){ @Override public void accept(PreparedStatement preparedStatement, T t) throws SQLException{ //è·å–æ‰€æœ‰å±æ€§ä¿¡æ¯ Field[] fields = t.getClass().getDeclaredFields(); for (int i = 0; i \u003c fields.length; i++){ Field field = fields[i]; //åå°„ è·å–å€¼ Object value = field.get(t); //ç»™é¢„ç¼–è¯‘ SQL å¯¹è±¡èµ‹å€¼ preparedStatement.setObject(i + 1, value); } } }, new JdbcExecutionOptions.Builder().withBatchSize(5).build(), new JdbcConnectionOptions.JdbcConnectionOptionsBuilder() .withDriverName(\"\") .withUrl(\"\") .build()); } } ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:2:0","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"Kafka2CH Goods topic from Kafka2CH //1.get exeEnv //2.read kafka all topic, create stream //3.uniform all stream format //4.union all stream //5.get tm from data and create WaterMark //6.group by, window, reduce. (æŒ‰ id åˆ†ç»„ï¼Œ10ç§’æ»šåŠ¨çª—å£ï¼Œå¢é‡èšåˆ(ç´¯åŠ å€¼)å’Œå…¨é‡èšåˆ(æå–çª—å£ä¿¡æ¯)) //7.join dimension info //8.wite stream to CH ","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:3:0","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"Sugar å¤§å±å±•ç¤º","date":"2021-04-13","objectID":"/20210413_clickhouse-flink/:4:0","tags":["DataWarehouse","Flink","ClickHouse"],"title":"Data Warehouse: ClickHouse With Flink","uri":"/20210413_clickhouse-flink/"},{"categories":["Technology"],"content":"Data warehouse is a system that pulls together data derived from operational systems and external data sources within an organization for reporting and analysis. A data warehouse is a central repository of information that provides users with current and historical decision support information. ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:0:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"DWM æ•°æ®ä¸­é—´å±‚ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"ä¸šåŠ¡æ•°æ®å†™å…¥DWM æ•°æ®æµå’Œç¨‹åºæµç¨‹ æ•°æ®æµï¼šï¼šweb/app -\u003e Nginx -\u003e SpringBoot -\u003e Mysql -\u003e FlinkApp -\u003e Kafka(ods) -\u003e FlinkApp -\u003e Kafka/Hbase(dwd-dim) -\u003e [FlinkApp -\u003e Kafka(dwm)] ç¨‹åºï¼šmocklog -\u003e Mysql -\u003e FlinkCDC -\u003e KafkaZ(zk) -\u003e BaseLogApp -\u003e Kafka/Phoneix(zk/hdfs/hbase) -\u003e [UniqueVisitApp -\u003e Kafka] ä»£ç å®ç° - ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—® //UniqueVisitApp // 1.è·å–æ‰§è¡Œç¯å¢ƒ StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment(); env.setParallelism(1); // 2.è¯»å– kafka dwd_page_log ä¸»é¢˜çš„æ•°æ® env.addSource(MyKafkaUtil.getKafkaConsumer(sourceTopic, groupId)); // 3.å°†æ¯è¡Œæ•°æ®è½¬æ¢ä¸º JSON å¯¹è±¡ jsonObjDS = KafkaDS.map(JSON::parseObject); // 4.è¿‡æ»¤æ•°æ®ã€çŠ¶æ€ç¼–ç¨‹ã€åªä¿ç•™æ¯å¤©ç¬¬ä¸€ä¸ªæ•°æ® keyedStream = jsonObjDS.keyBy(jsonObj -\u003e jsonObj.getJSONObject(\"common\")).getString(\"mid\"); uvDS = keyedStream.filter(new RichFilterFunction\u003cJSONObject\u003e(){ private ValueState\u003cString\u003e dataState; private SimpleDateFormat simpleDateFormat; @Override public void open(Configuration parameters) throws Exception { valueStateDescriptor = new ValueStateDescriptor\u003c\u003e(\"data-state\", String.class); dataState = getRuntimeContext().getState(valueStateDescriptor); simpleDateFormat = new SimpleDateFormat(\"yyyy-MM-dd\"); } @Override public boolean filter(JSONObject value) throws Exception{ return {...}; } }); // 5.å°†æ•°æ®å†™å…¥ Kafka uvDS.map(JSONAware::toJSONString).addSink(MyKafkaUtil.getKafkaProducer(sinkTopic)); // 6.å¯åŠ¨ env.execute(\"UniqueVisitApp\"); ä»£ç å®ç° - ç”¨æˆ·è·³å‡ºé¡µé¢ //UserJumpDetailApp // 1.è·å–æ‰§è¡Œç¯å¢ƒ // 2.è¯»å– kafka ä¸»é¢˜æ•°æ®åˆ›å»ºæµ // 3.å°†æ¯è¡Œæ•°æ®è½¬æ¢ä¸º JSON å¯¹è±¡ï¼Œæå–æ—¶é—´æˆ³ // 4.å®šä¹‰æ¨¡å¼åºåˆ— // 5.å°†æ¨¡å¼åºåˆ—ä½œç”¨åˆ°æµä¸Š // 6.æå–åŒ¹é…ä¸Šçš„è¶…æ—¶äº‹ä»¶, UNION ä¸¤ç§äº‹ä»¶ // 7.å°†æ•°æ®å†™å…¥ Kafka // 6.å¯åŠ¨ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:1","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"Flink Stream Join Window Join stream.join(otherStream) .where(\u003cKeySelector\u003e) .equalTo(\u003cKeySelector\u003e) .window(\u003cWindowAssigner\u003e) .apply(\u003cJoinFunction\u003e) Tumbing Window Join æ»šåŠ¨çª—å£ï¼šå’Œ SparkStreaming ç›´æ¥ Join ä¸€æ · Sliding Window Join æ»‘åŠ¨çª—å£ï¼šæœ‰å¯èƒ½æ•°æ®é‡å¤ Join Session Window join ä¼šè¯çª—å£ï¼šä¸¤ä¸ªæµçš„æ•°æ®ä¸€æ®µæ—¶é—´éƒ½æ²¡æœ‰æ•°æ®ï¼Œä¸¤ä¸ªæµå¼€å§‹ Join Interval Join å¯¹è¢«Joinçš„æµæœ‰ lower bound å’Œ upper bound èŒƒå›´é€‰æ‹©ï¼ˆèŒƒå›´é€‰æ‹©åˆ™è¦ç”¨åˆ°çŠ¶æ€ç¼–ç¨‹ã€å½“å‰ä»…æ”¯æŒçŠ¶æ€æ—¶é—´ï¼Œéœ€æå–å‡ºçŠ¶æ€æ—¶é—´ï¼‰ ä»£ç å®ç° - è®¢å•æ˜ç»†è¡¨åŒæµ Join //OrderWideApp //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.è¯»å– Kafka ä¸»é¢˜çš„æ•°æ®ï¼Œè½¬åŒ–ä¸º JavaBean å¯¹è±¡å¹¶ä¸”æå–æ—¶é—´æˆ³ç”Ÿæˆ WaterMark //3.åŒæµ Join //4.å…³è”ç»´åº¦ä¿¡æ¯ //5.å†™å…¥Kafka //6.å¯åŠ¨ä»»åŠ¡ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:2","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"ç»´åº¦è¡¨å…³è” ä¼˜åŒ–1ï¼šåŠ å…¥æ—è·¯ç¼“å­˜ ç»´åº¦å…³è”æ—¶æŸ¥è¯¢ç»´åº¦è¡¨ï¼Œå…ˆæŸ¥ Redisï¼Œå†æŸ¥ HBASEã€‚ Redis ä½œä¸ºæ—è·¯ç¼“å­˜ï¼Œè®¢å•å®½è¡¨æŸ¥è¯¢ç»´åº¦æ•°æ®æ—¶å…ˆæŸ¥æ—è·¯ç¼“å­˜ã€‚æ²¡æœ‰å†æŸ¥è¯¢ç»´åº¦æ•°æ®ï¼ŒåŒæ—¶åŒæ­¥åˆ°æ—è·¯ç¼“å­˜ã€‚ æ³¨æ„é—®é¢˜ 1.ç¼“å­˜è¦è®¾è¿‡æœŸæ—¶é—´ï¼Œä¸ç„¶å†·æ•°æ®ä¼šå¸¸é©»ç¼“å­˜æµªè´¹èµ„æºã€‚ 2.è¦è€ƒè™‘ç»´åº¦æ•°æ®æ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœå‘ç”Ÿå˜åŒ–è¦ä¸»åŠ¨æ¸…æ¥šç¼“å­˜ã€‚ ç¼“å­˜é€‰å‹ ä¸¤ç§ï¼šå †ç¼“å­˜ æˆ–è€… ç‹¬ç«‹ç¼“å­˜æœåŠ¡(Redis, memcache) å †ç¼“å­˜ï¼Œæ€§èƒ½å¥½ï¼Œç®¡ç†æ€§å·®ã€‚ ç‹¬ç«‹ç¼“å­˜æœåŠ¡ï¼Œæœ‰åˆ›å»ºè¿æ¥ã€ç½‘ç»œ IO ç­‰æ¶ˆè€—ã€‚ç®¡ç†æ€§æ›´å¼ºï¼Œæ›´å®¹æ˜“æ‰©å±•ã€‚ è”åˆä½¿ç”¨(LRU Cacheï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨) ä»£ç å®ç° public class RedisUtil{...} public class DimUtil{//ç»´åº¦è¡¨å…³è” //æŸ¥è¯¢ HBASE è¡¨ä¹‹å‰å…ˆæŸ¥è¯¢ Redis Jedis jedis = RedisUtil.getJedis(); String dimInfoJsonStr = jedis.get(redisKey); // RedisKey ä¸ç”¨ hash çš„åŸå› ï¼š // 1.ç”¨æˆ·æ•°æ®é‡å¤§ï¼Œä½¿ç”¨å¤§é‡æ•°æ®å¯èƒ½åˆ°ä¸€æ¡ hash ä¸Šï¼Œé€ æˆçƒ­ç‚¹é—®é¢˜ã€‚ // 2.éœ€è¦è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ // RedisKey ä¸ç”¨ Set çš„åŸå› ï¼š // 1.æŸ¥è¯¢ä¸æ–¹ä¾¿ // 2.éœ€è¦è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ if(dimInfoJsonStr != null){ //å½’è¿˜è¿æ¥ jedis.close(); //é‡ç½®è¿‡æœŸæ—¶é—´ jedis.expire(redisKey, 24 * 60 * 60); //è¿”å›ç»“æœ return JsonObject.parseObject(dimInfoJsonStr); } //ä» HBASE æ‹¿æ•°æ® .... //å°†æ•°æ®å†™å…¥ Redis jedis.set(); jedis.expire(); jedis.close(); return dimInfoJson; } ä¼˜åŒ–2ï¼šå¼‚æ­¥æŸ¥è¯¢ å¼‚æ­¥æŸ¥è¯¢æŠŠæŸ¥è¯¢æ“ä½œæ‰˜ç®¡ç»™å•ç‹¬çš„çº¿ç¨‹æ± å®Œæˆï¼Œè¿™æ ·ä¸ä¼šå› ä¸ºæŸä¸ªæŸ¥è¯¢é€ æˆé˜»å¡ï¼Œå•ä¸ªå¹¶è¡Œå¯ä»¥è¿ç»­å‘é€å¤šä¸ªè¯·æ±‚ï¼Œæé«˜å¹¶å‘æ•ˆç‡ã€‚ ä»£ä»·ï¼šæ¶ˆè€—æ›´å¤šçš„ Tasksï¼Œthreadsã€Flink-internal network connections æ•°æ®æµå’Œç¨‹åºæµç¨‹ æ•°æ®æµï¼šweb/app -\u003e Nginx -\u003e SpringBoot -\u003e Mysql -\u003e FlinkApp -\u003e Kafka(ods) -\u003e FlinkApp -\u003e Kafka/Hbase(dwd-dim) -\u003e [FlinkApp(redis)] -\u003e Kafka(dwm) ç¨‹åºï¼šmocklog -\u003e Mysql -\u003e FlinkCDC -\u003e KafkaZ(zk) -\u003e BaseLogApp -\u003e Kafka/Phoneix(zk/hdfs/hbase) -\u003e [OrderWideApp(Redis) -\u003e Kafka] ä»£ç å®ç° public class DimAsyncFunction\u003cT\u003e extends RichAsyncFunciton\u003cT, T\u003e{ @Override public void open(){} @Override public void asyncInvoke(){} @Override public void timeout(){} } public class ThreadPoolUtil{ private static ThreadPoolExecutor threadPoolExecutor = null; private ThreadPoolUtil(){ } public static ThreadPoolExecutor getThreadPool{ //æ‡’æ±‰å¼-å•ä¾‹æ¨¡å¼ if(threadPoolExecutor == null){ synchronized(ThreadPoolUtil.class){ if(threadPoolExecutor == null){ threadPoolExecutor = new ThreadPoolExecutor(corePoolSize = 8,maximumPoolSize = 16,keepAliveTime = 1L,TimUnit.MiNUTES,new LinkedBlockingDeque\u003c\u003e()); } } } return threadPoolExecutor; } } ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:3","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"ä¸»æµæ•°æ®ä¸¢å¤± ä½¿ç”¨ intervalJoin æ¥ç®¡ç†æµçš„çŠ¶æ€æ—¶é—´ï¼Œä¿è¯å½“æ”¯æµæ•°æ®åˆ°è¾¾æ—¶ä¸»æµæ•°æ®è¿˜ä¿å­˜åœ¨çŠ¶æ€ä¸­ã€‚ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:4","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"ä¸šåŠ¡æ•°æ®å†™å…¥DWM ä»£ç å®ç° - æ”¯ä»˜å®½è¡¨ PaymentWideApp; //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.è¯»å– kafka ä¸»é¢˜æ•°æ®åˆ›å»ºæµ //3.åŒæµ Join //4.å†™å…¥Kafka //5.å¯åŠ¨ä»»åŠ¡ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:1:5","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"DWS æ•°ä»“æ±‡æ€»å±‚ è½»åº¦èšåˆï¼Œå› ä¸º DWS å±‚è¦åº”å¯¹å¾ˆå¤šå®æ—¶æŸ¥è¯¢ï¼Œå¦‚æœå®Œå…¨çš„æ˜ç»†é‚£ä¹ˆæŸ¥è¯¢çš„å‹åŠ›æ˜¯éå¸¸å¤§çš„ã€‚ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:2:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"ä¸»é¢˜å®½è¡¨å†™å…¥DWS æ•°æ®æµå’Œç¨‹åºæµç¨‹ æ•°æ®æµï¼šweb/app -\u003e Nginx -\u003e SpringBoot -\u003e Mysql -\u003e FlinkApp -\u003e Kafka(ods) -\u003e FlinkApp -\u003e Kafka/Hbase(dwd-dim) -\u003e FlinkApp(redis) -\u003e Kafka(dwm) -\u003e [FlinkApp -\u003e ClickHouse] ç¨‹åºï¼šmocklog -\u003e Mysql -\u003e FlinkCDC -\u003e KafkaZ(zk) -\u003e BaseLogApp -\u003e Kafka/Phoneix(zk/hdfs/hbase) -\u003e OrderWideApp(Redis) -\u003e Kafka -\u003e [uv/uj -\u003e kafka -\u003e VisitorStatsApp -\u003e ClickHouse] ä»£ç å®ç° - è®¿å®¢ä¸»é¢˜å®½è¡¨ VisitorStatsApp; //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.è¯»å– kafka æ•°æ®åˆ›å»ºæµ //3.å°†æ¯ä¸ªæµå¤„ç†æˆç›¸åŒçš„æ•°æ®ç±»å‹ //4.Union æ‰€æœ‰æµ //5.æå–æ—¶é—´æˆ³ç”Ÿæˆ WaterMark //6.æŒ‰ç…§ç»´åº¦ä¿¡æ¯åˆ†ç»„ //7.å¼€çª—èšåˆ 10s çš„æ»šåŠ¨çª—å£ WindowedStream\u003cVisitorStats, Tuple4, TimeWindow\u003e windowedStream = keyedStream.window(TumblingEventTimeWindows.of(Time.seconds(10))); // reducefunction å¢é‡èšåˆï¼Œæ•ˆç‡é«˜ // windowsfunction å…¨é‡èšåˆï¼ŒåŒ…å«çª—å£ä¿¡æ¯ // reduce + window windowedStream.reduce(new ReduceFunction\u003cVisitorStats\u003e(){}, new WindowFunction\u003cVisitorStats, VisitorStats, Tuple4, TimeWindow(){}) //8.æ•°æ®å†™å…¥ ClickHouse //9.å¯åŠ¨ä»»åŠ¡ Info ç»´åº¦èšåˆé‡‡ç”¨æ–¹å¼ï¼šuv, 0, 0, 0 ,0 union 0, pv, 0, 0, 0 union 0, 0, sv, 0, 0 â€¦ å…ˆunionå†æ ¹æ®ä¸»é”®èšåˆ Question uv pv sv uj dur ä¸åŒæµçš„æ•°æ®è¿›è¡Œç»´åº¦èšåˆæ—¶ï¼Œå‡ºç°æœ‰æµæ•°æ®( uj )ä¼šä¸¢å¤±ä¸€ç›´æ˜¾ç¤ºæ˜¯ 0 çš„æƒ…å†µï¼Œä¸ºä»€ä¹ˆï¼Ÿ è®¡ç®—å®Œ uj è¡¨è¾“å…¥æµï¼Œæ»šåŠ¨çª—å£è®¾ç½®çš„ 10 ç§’å·²ç»å…³é—­ã€‚ dwd-page-log ç¬¬ä¸€æ¡æ•°æ®åˆ°è¾¾ï¼Œvisitors-topic å¼€çª—[ts + 0, ts + 10)ç§’çš„çª—å£æ¥æ¥æ”¶dwd-page-logè¿™10ç§’çš„å…¨éƒ¨æ•°æ® ä½† visitors-topic åŒæ—¶ä½¿ç”¨ dwd-page-log å’Œ uj ä¸¤ä¸ªæµçš„æ•°æ®ï¼Œuj éœ€è¦10ç§’åæ‰è¾“å‡ºæµï¼Œvisitors-topic å¼€çª—å·²ç»å…³é—­ è§£å†³æ–¹æ³•ï¼š æ–¹æ³•ä¸€ï¼šæ•°æ®æœ¬èº«æ—¶é—´åˆ‡æ¢æˆå¤„ç†çš„æ—¶é—´ã€‚ä¸å»ºè®®ï¼Œæ•°æ®æ—¶é—´ä¸ç»Ÿä¸€ï¼Œä¸å…·æœ‰å¹‚ç­‰æ€§ æ–¹æ³•äºŒï¼šå¢åŠ å»¶è¿Ÿæ—¶é—´ ","date":"2021-03-21","objectID":"/20210321_dw-flink-part2/:2:1","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â…¡","uri":"/20210321_dw-flink-part2/"},{"categories":["Technology"],"content":"Data warehouse is a system that pulls together data derived from operational systems and external data sources within an organization for reporting and analysis. A data warehouse is a central repository of information that provides users with current and historical decision support information. real time process ","date":"2021-03-08","objectID":"/20210308_dw-flink/:0:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"ODS æ•°æ®é‡‡é›†å±‚ åŸå§‹æ•°æ®ï¼Œæ—¥å¿—å’Œä¸šåŠ¡æ•°æ® ","date":"2021-03-08","objectID":"/20210308_dw-flink/:1:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"æ—¥å¿—æ•°æ®é‡‡é›† springboot springboot å¥½å¤„ï¼š ä¸éœ€è¦é‚£äº›ç¹çé‡å¤çš„ xml æ–‡ä»¶ å†…åµŒ Tomcatï¼Œä¸éœ€è¦å¤–éƒ¨ Tomcat æ›´æ–¹ä¾¿çš„å’Œå„ä¸ªç¬¬ä¸‰æ–¹å·¥å…·æ•´åˆï¼Œåªè¦ç»´æŠ¤ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ï¼ˆmysqlã€redisã€esã€dubboã€kafkaï¼‰ springboot å’Œ ssm çš„å…³ç³» springboot æ•´åˆäº† springmvcï¼Œspring ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´æœ¬è´¨è¿˜æ˜¯åŸæœ‰çš„ springï¼Œspringmvc çš„åŒ…ï¼Œä½†æ˜¯ springboot å•ç‹¬åŒ…è£…äº†ä¸€å±‚ï¼Œç”¨æˆ·ä¸å¿…ç›´æ¥å¯¹ springmvcï¼Œspring ç­‰åœ¨ xml ä¸­é…ç½®ã€‚ springbootåˆ†å±‚ æŒæ¡å†™æ•°æ®æ¥å£ controllerå±‚ï¼šæ‹¦æˆªç”¨æˆ·è¯·æ±‚ï¼Œè°ƒç”¨Serviceï¼Œå“åº”è¯·æ±‚ serviceå±‚ï¼šè°ƒç”¨ DAOï¼Œå¤„ç†æ•°æ® DAOï¼ˆä½¿ç”¨ MyBatis æ—¶ç§°ä¸º Mapper å±‚ï¼‰ï¼šè·å–æ•°æ® æŒä¹…åŒ–å±‚ï¼šå­˜å‚¨æ•°æ® SpringBoot æ•´åˆKafka import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.RequestMapping; //@Controller //æ³¨è§£æ ‡æ˜ Controller @RestController //@Controller + @ResponseBody @Slf4j //lombokä¸­çš„åŒ… public class LoggerController{ @RequestMapping(\"test2\") public String test2(@RequestParam(\"name\") String nn, @RequestParam(\"age\", defaultValue = \"18\") int age){ return \"success\" + name + age; } @Autowired //è‡ªåŠ¨æ³¨å…¥ private KafkaTemplate\u003cString, String\u003e kafkaTemplate; @RequestMapping(\"applog\") public String test2(@RequestParam(\"param\") String jsonStr){ //sparkmall-mockï¼šæ¨¡æ‹Ÿç”Ÿæˆæ•°æ®æ¨¡å— //mockæœåŠ¡å™¨ä¸åœçš„è®¿é—® http://pc_IP:8080/applog?jsonStr=* äº§ç”ŸåŸå§‹æ•°æ® /*1.ä¿®æ”¹SpringBootæ ¸å¿ƒé…ç½®ï¼š server.port=8081 æŒ‡å®škafkaä»£ç†åœ°å€ï¼Œå¯ä»¥å¤šä¸ªï¼šspring.kafka.bootstrap-servers=hadoop102.9092 æŒ‡å®šæ¶ˆæ¯keyå’Œæ¶ˆæ¯ä½“çš„ç¼–è§£ç æ–¹å¼ï¼š spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerilizer spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerilizer*/ /*2.Resourcesä¸­æ·»åŠ  logback.xml é…ç½®æ–‡ä»¶ï¼šå†³å®šå¦‚ä½•æ‰“å°ã€è½ç›˜ã€æ‰“å°å“ªäº›æ—¥å¿— ï¼Œç±»ä¼¼log4j åœ¨æ³¨é‡Š@Slf4jåï¼Œä½¿ç”¨log.info(jsonStr);log.warn(jsonStr);log.debug();log.error();log.trace()*/ /*3.è‡ªåŠ¨æ³¨å…¥kafkaTemplateï¼Œproducer send æ•°æ®ï¼Œæ‰“å¼€zkã€kkæœåŠ¡ è¿è¡Œkafkaæ¶ˆè´¹è€…ï¼šbin/kafka-console-consumer.sh --bootstrap-server hadoop102:9092 --topic ods_base_log*/ kafkaTemplate.send(\"ods_base_log\", jsonStr); return \"success\"; } } æ‰“åŒ…é›†ç¾¤éƒ¨ç½²ï¼ŒNginx åå‘ä»£ç† ç®€ä»‹ï¼š é«˜æ€§èƒ½çš„ HTTP å’Œ åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œåœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ã€‚ åå‘ä»£ç†å’Œæ­£å‘ä»£ç†ï¼š æ­£å‘ä»£ç†ç±»ä¼¼ä¸€ä¸ªè·³æ¿æœºï¼Œä»£ç†è®¿é—®å¤–éƒ¨èµ„æºï¼Œå¦‚ VPNã€‚ åå‘ä»£ç†æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internet ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ã€‚ Nginx ä¸»è¦åº”ç”¨ é™æ€ç½‘ç«™éƒ¨ç½²ï¼šNginx æ˜¯ä¸€ä¸ª HTTP çš„ web æœåŠ¡å™¨ï¼Œå¯ä»¥å°†æœåŠ¡å™¨ä¸Šçš„é™æ€æ–‡ä»¶ï¼ˆå¦‚ HTMLã€å›¾ç‰‡ç­‰ï¼‰é€šè¿‡ HTTP åè®®è¿”å›ç»™æµè§ˆå™¨å®¢æˆ·ç«¯ã€‚ è´Ÿè½½å‡è¡¡ï¼šå¦‚æ•°æ®è¯·æ±‚å‘åˆ°é›†ç¾¤ä¸­ä¸åŒçš„æœºå™¨ä¸Šï¼Œå¸¸ç”¨ç­–ç•¥ï¼šè½®è¯¢ã€æƒé‡ã€å¤‡æœº é™æ€ä»£ç†ï¼šæŠŠæ‰€æœ‰é™æ€èµ„æºçš„è®¿é—®æ”¹ä¸ºè®¿é—® Nginx è€Œä¸æ˜¯ Tomcatï¼ŒNginx æ›´æ“…é•¿é™æ€èµ„æºçš„å¤„ç†ã€‚ ","date":"2021-03-08","objectID":"/20210308_dw-flink/:1:1","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"ä¸šåŠ¡æ•°æ®é‡‡é›† Flink-CDC CDC Change Data Capture(å˜æ›´æ•°æ®è·å–)çš„ç®€ç§°ï¼Œæ•è·å¢åˆ æ”¹ã€‚ CDCçš„ç§ç±» CDCä¸»è¦åˆ†ä¸ºåŸºäºæŸ¥è¯¢å’ŒåŸºäºBinlogä¸¤ç§æ–¹å¼ åŸºäºæŸ¥è¯¢ åŸºäºBinlog å¼€æºäº§å“ Sqoopã€Kafka JDBC Source Canalã€Maxwellã€Debezium æ‰§è¡Œæ¨¡å¼ Batch Streaming æ˜¯å¦å¯ä»¥æ•è·æ‰€æœ‰æ•°æ®å˜åŒ– å¦ æ˜¯ å»¶è¿Ÿæ€§ é«˜å»¶è¿Ÿ ä½å»¶è¿Ÿ æ˜¯å¦å¢åŠ æ•°æ®åº“å‹åŠ› æ˜¯ å¦ Flink-cdc-connectors å¯ä»¥ç›´æ¥ä» MySQLã€PostgreSQLç­‰æ•°æ®åº“ç›´æ¥ è¯»å–å…¨é‡æ•°æ®å’Œå¢é‡å˜æ›´æ•°æ®çš„ source ç»„ä»¶ ç»„ä»¶ ä¸šåŠ¡æµç¨‹ Flinkï¼š MySQL -\u003e Canal -\u003e kafka -\u003e Flink -\u003e ä¸šåŠ¡å¤„ç† Flink-CDC: MySQL -\u003e Fink-CDC -\u003e ä¸šåŠ¡å¤„ç† Flink-cdc code public class FlinkCDC{ public static void main(String[] args){ //1.è·å–æ‰§è¡Œç¯å¢ƒ //1.1å¼€å¯ CD å¹¶æŒ‡å®šåç«¯ä¸ºFS memory fs rocksdb //1.2å¼€å¯ checkpoint å®ç°æ–­ç‚¹ç»­ä¼  //2.é€šè¿‡ flinkcsc æ„å»º sourcefunction å¹¶è¯»å–æ•°æ® //3.æ‰“å°æ•°æ® //4.å¯åŠ¨ä»»åŠ¡ } } FlinkSQL FlinkSQLåªèƒ½åšå•è¡¨çš„ç›‘æ§ Debeziumå¯ä»¥åšå¤šè¡¨çš„ç›‘æ§ï¼Œéœ€è¦è‡ªå®šä¹‰ååºåˆ—åŒ–å™¨ public class FlihnkCDCWithSQL{ public staic void main(String[] args){ //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.DDLæ–¹å¼å»ºè¡¨ //3.æŸ¥è¯¢æ•°æ® //4.å°†åŠ¨æ€è¡¨è½¬åŒ–ä¸ºæµ //5.å¯åŠ¨ä»»åŠ¡ } } Flink-cdc DataStream CustomerDeserialization @Override public void deserialize(SourceRecord sourceRecord, Collector...){ //1.åˆ›å»ºJsonå¯¹è±¡ç”¨äºå­˜å‚¨æœ€ç»ˆæ•°æ® //2.è·å–åº“åã€è¡¨æ˜ //3.è·å–\"before\"æ•°æ® //4.è·å–\"after\"æ•°æ® //5.è·å–æ“ä½œç±»å‹ //6.å†™å…¥JSONå¯¹è±¡ //7.è¾“å‡ºæ•°æ® } CDC Maxwell Canal å¯¹æ¯” FlinkCDC Maxwell Canal SQLå’Œæ•°æ®å…³ç³» æ—  æ—  ä¸€å¯¹ä¸€ åˆå§‹åŒ–åŠŸèƒ½ æœ‰(å¤šåº“å¤šè¡¨) æœ‰(å•è¡¨) æ—  æ–­ç‚¹ç»­ä¼  ck MySQL æœ¬åœ°ç£ç›˜ å°è£…æ ¼å¼ è‡ªå®šä¹‰ JSON JSON(c/sè‡ªå®šä¹‰) é«˜å¯ç”¨ è¿è¡Œé›†ç¾¤é«˜å¯ç”¨ æ—  é›†ç¾¤(ZK) ç¯å¢ƒæ­å»º IDEAç›®å½• åŠŸèƒ½ app äº§ç”Ÿå„å±‚æ•°æ®çš„ flink ä»»åŠ¡ bean æ•°æ®å¯¹è±¡ common å…¬å…±å¸¸é‡ utils å·¥å…·ç±» ","date":"2021-03-08","objectID":"/20210308_dw-flink/:1:2","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"ODS æ€»ç»“ ä¿æŒæ•°æ®åŸè²Œï¼Œä¸åšä»»ä½•ä¿®æ”¹ FlinkCDC: DataStream / FlinkSQL åŒºåˆ« FlinkCDC / Maxwell / Canal åŒºåˆ« ","date":"2021-03-08","objectID":"/20210308_dw-flink/:1:3","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"DWD æ˜ç»†æ•°æ®å±‚ ","date":"2021-03-08","objectID":"/20210308_dw-flink/:2:0","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"æ—¥å¿—æ•°æ®å†™å…¥DWDå±‚ æ•°æ®æµå’Œç¨‹åºæµç¨‹ æ•°æ®æµï¼šï¼šweb/app -\u003e Nginx -\u003e SpringBoot -\u003e Mysql -\u003e FlinkApp -\u003e Kafka(ods) -\u003e FlinkApp -\u003e Kafka/Hbase(dwd-dim) ç¨‹åºï¼šmocklog -\u003e Nginx -\u003e Logger.sh -\u003e KafkaZ(zk) -\u003e BaseLogApp -\u003e Kafka ä»£ç å®ç° public class BaseLogApp{ public static void main(String[] args){ //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.æ¶ˆè´¹ ods_base_log ä¸»é¢˜æ•°æ®åˆ›å»ºæµ //3.å°†æ¯è¡Œæ•°æ®è½¬æ¢ä¸ºJSONå¯¹è±¡ //3.1å‘ç”Ÿå¼‚å¸¸ï¼Œå¦‚ä¸æ»¡è¶³JSONæ ¼å¼ï¼Œæ•è·å†™å…¥ä¾§è¾“å‡ºæµ //4.æ–°è€ç”¨æˆ·æ ¡éªŒï¼ŒçŠ¶æ€ç¼–è¾‘ //4.1 è½¬æ€ç¼–ç¨‹ jsonObjDS.keyBy(...).map(new RichMapFunction\u003cJSONObject, JSONObject\u003e()){ private ValueState\u003cString\u003e valueState; @Override public void open(Configuration parameters) throws Exception { valueState = getRuntimeContext().getState(new ValueStateDescriptor\u003cString\u003e(\"value-state\", String.class)); } @Override public JSONObject map(JSONObject value) throws Excepiton { //è·å–JSONä¸­\"is_new\"æ ‡è®° String isNew = value.getJSONObject(\"common\").getString(\"is_new\"); //isnewåšå¤„ç†ï¼Œæ—§æ•°æ®ä¸å¤„ç† if(\"1\".equals(isNew)){ String state = valueState.value(); if(state != null){ //ä¿®æ”¹isnewæ ‡è®° value.getJSONObject(\"common\").put(\"is_new\", \"0\"); }else{ valueState.update(\"1\"); } } return value; } }; //5.åˆ†æµã€ä¾§è¾“å‡ºæµ é¡µé¢ï¼šä¸»æµ å¯åŠ¨ï¼šä¾§è¾“å‡ºæµ æ›å…‰ï¼šä¾§è¾“å‡ºæµ //6.æå–ä¾§è¾“å‡ºæµ //7.å°†ä¸‰ä¸ªæµè¿›è¡Œæ‰“å°å¹¶è¾“å‡ºåˆ°å¯¹åº”çš„kafkaä¸»é¢˜ä¸­ } } ","date":"2021-03-08","objectID":"/20210308_dw-flink/:2:1","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"ä¸šåŠ¡æ•°æ®å†™å…¥DWDå±‚ é€‰å‹ åœ¨å®æ—¶è®¡ç®—ä¸­ä¸€èˆ¬æŠŠç»´åº¦æ•°æ®å†™å…¥å­˜å‚¨å®¹å™¨ï¼Œå¦‚ HBASEã€Redisã€MySQL ç­‰ã€‚ ä¸€èˆ¬æŠŠå®æ—¶æ•°æ®å†™å…¥æµä¸­ï¼Œè¿›å…¥dwdå±‚ï¼Œæœ€ç»ˆå½¢æˆå®½è¡¨ã€‚ HBASEï¼šHBaseæ˜¯å»ºç«‹åœ¨HDFSä¹‹ä¸Š,æä¾›é«˜å¯é æ€§çš„åˆ—å­˜å‚¨ï¼Œå®æ—¶è¯»å†™çš„æ•°æ®åº“ç³»ç»Ÿã€‚å®ƒä»‹äºNosqlå’Œå…³ç³»å‹æ•°æ®åº“ä¹‹é—´ï¼Œä»…é€šè¿‡ä¸»é”®å’Œä¸»é”®çš„rangeæ¥æ£€ç´¢æ•°æ®ï¼Œä»…æ”¯æŒå•è¡Œäº‹åŠ¡ã€‚ä¸»è¦ç”¨æ¥å­˜å‚¨éç»“æ„åŒ–å’ŒåŠç»“æ„åŒ–çš„æ¾æ•£æ•°æ®ã€‚ Redisï¼šåˆ†å¸ƒå¼ç¼“å­˜ï¼ŒåŸºäºå†…å­˜ï¼Œå¼ºè°ƒç¼“å­˜ï¼Œæ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œæ”¯æŒäº‹åŠ¡æ“ä½œï¼ŒNoSQL ç±»å‹çš„Key/valeæ•°æ®åº“ï¼ŒåŒæ—¶æ”¯æŒListã€Setç­‰æ›´ä¸°å¯Œçš„ç±»å‹ã€‚é€‚åˆæ”¾ä¸€äº›é¢‘ç¹ä½¿ç”¨ï¼Œæ¯”è¾ƒçƒ­çš„æ•°æ®ï¼Œå› ä¸ºæ˜¯æ”¾åœ¨å†…å­˜ä¸­ï¼Œè¯»å†™é€Ÿåº¦éƒ½éå¸¸å¿«ã€‚ MySQLï¼šå¹¶å‘å‹åŠ›å¤§ï¼Œè¯»å–é€Ÿåº¦æ…¢ã€‚ Phoenix \u0026 HBASE åŠŸèƒ½ï¼š Phoenixæ˜¯ä¸€ç§ä¸“é—¨é’ˆå¯¹äºHbase æ‰€è®¾è®¡çš„SQL on Hbase çš„ä¸€ä¸ªå·¥å…· ä½¿ç”¨SQLå¯¹Hbaseè¿›è¡Œæ“ä½œ ä½¿ç”¨phoenixè‡ªåŠ¨æ„å»ºäºŒçº§ç´¢å¼•æ¥è¿›è¡Œå¿«é€ŸæŸ¥è¯¢å’Œç»´æŠ¤ åŸç†ï¼š ä¸Šå±‚æä¾›äº†SQLæ¥å£ åº•å±‚å…¨éƒ¨é€šè¿‡Hbase Java APIæ¥å®ç°ï¼Œé€šè¿‡æ„å»ºä¸€ç³»åˆ—çš„Scanå’ŒPutæ¥å®ç°æ•°æ®çš„è¯»å†™ åŠŸèƒ½éå¸¸ä¸°å¯Œ åº•å±‚å°è£…äº†å¤§é‡çš„å†…ç½®çš„åå¤„ç†å™¨ï¼Œå¯ä»¥å®ç°å„ç§å¤æ‚çš„å¤„ç†éœ€æ±‚ï¼Œä¾‹å¦‚äºŒçº§ç´¢å¼•ç­‰ ä¼˜ç‚¹ æ”¯æŒSQLæ¥å£ æ”¯æŒè‡ªåŠ¨ç»´æŠ¤äºŒçº§ç´¢å¼• ç¼ºç‚¹ SQLæ”¯æŒçš„è¯­æ³•ä¸å…¨é¢ Bugæ¯”è¾ƒå¤š å®ç°åŠ¨æ€åˆ†æµæ–¹æ¡ˆ ZKå­˜å‚¨ï¼Œé€šè¿‡ watch æ„ŸçŸ¥æ•°æ®å˜åŒ– MySQLå­˜å‚¨ï¼Œå‘¨æœŸæ€§çš„åŒæ­¥ *MySQLå­˜å‚¨ï¼Œä½¿ç”¨å¹¿æ’­æµ æ•°æ®æµå’Œç¨‹åºæµç¨‹ æ•°æ®æµï¼šï¼šweb/app -\u003e Nginx -\u003e SpringBoot -\u003e Mysql -\u003e FlinkApp -\u003e Kafka(ods) -\u003e FlinkApp -\u003e Kafka/Hbase(dwd-dim) ç¨‹åºï¼š mockDB -\u003e Mysql -\u003e FlinkCDC -\u003e Kafka(ZK) -\u003e BaseDBApp -\u003e Kafka/Hbase(Phoenix, zk, hdfs) ä»£ç å®ç° BaseDBApp; //1.è·å–æ‰§è¡Œç¯å¢ƒ //2.æ¶ˆè´¹ kafka ods_base_db ä¸»é¢˜æ•°æ®åˆ›å»ºæµ //3.å°†æ¯è¡Œæ•°æ®è½¬æ¢æˆJSONå¯¹è±¡å¹¶è¿‡æ»¤ ä¸»æµ //4.ä½¿ç”¨FlinkCDCæ¶ˆè´¹é…ç½®è¡¨å¹¶å¤„ç†æˆ å¹¿æ’­æµ //5.è¿æ¥ä¸»æµå’Œå¹¿æ’­æµ //6.åˆ†æµ å¤„ç†æ•°æ® å¹¿æ’­æµæ•°æ®å’Œä¸»æµæ•°æ®(æ ¹æ®å¹¿æ’­æµæ•°æ®è¿›è¡Œå¤„ç†) //7.æå–kafkaæµæ•°æ®å’ŒHBASEæµæ•°æ® //8.å°†kafkaæ•°æ®å†™å…¥Kafkaä¸»é¢˜ï¼Œå°†HBASEæ•°æ®å†™å…¥Phoenixè¡¨ //9.å¯åŠ¨ ","date":"2021-03-08","objectID":"/20210308_dw-flink/:2:2","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"ç»´è¡¨å±‚DIMå±‚ å±‚ ä¸šåŠ¡ ODS / DWD / DIM ä¸€èˆ¬ä¸ä¸šåŠ¡éœ€æ±‚æ— å…³ (ç¦»çº¿æ•°ä»“æ˜¯ DWS å’Œ DWT) / (å®æ—¶æ•°ä»“æ˜¯ DWM / DWS) ä¸ä¸šåŠ¡ç›¸å…³æ€§éå¸¸é«˜ ADS ç­‰äºä¸šåŠ¡éœ€æ±‚ ","date":"2021-03-08","objectID":"/20210308_dw-flink/:2:3","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"DWD-DIM æ€»ç»“ è¡Œä¸ºæ•°æ®ï¼šDWDï¼ˆKafkaï¼‰ è¿‡æ»¤è„æ•°æ® â€“\u003e ä¾§è¾“å‡ºæµ è„æ•°æ®ç‡ æ–°è€ç”¨æˆ·æ ¡éªŒ â€“\u003e å‰å°æ ¡éªŒä¸å‡† åˆ†æµ â€“\u003e ä¾§è¾“å‡ºæµ é¡µé¢ã€å¯åŠ¨ã€æ›å…‰ã€åŠ¨ä½œã€é”™è¯¯ å†™å…¥ kafka ä¸šåŠ¡æ•°æ®ï¼šDWDï¼ˆKafkaï¼‰- DIMï¼ˆHBASEï¼‰ è¿‡æ»¤æ•°æ® â€“\u003e åˆ é™¤æ•°æ® è¯»å–é…ç½®è¡¨åˆ›å»ºå¹¿æ’­æµ è¿æ¥ä¸»æµå’Œå¹¿æ’­æµå¹¶å¤„ç† å¹¿æ’­æµæ•°æ®ï¼š è§£ææ•°æ®ï¼ŒPhoenixå»ºè¡¨ å†™å…¥çŠ¶æ€å¹¿æ’­ ä¸»æµæ•°æ® è¯»å–çŠ¶æ€ è¿‡æ»¤å­—æ®µ åˆ†æµï¼ˆæ·»åŠ SinkTableå­—æ®µï¼‰ æå–Kafkaå’ŒHBASEæµåˆ†åˆ«å¯¹åº”çš„ä½ç½® HBASEæµï¼šè‡ªå®šä¹‰Sink Kafkaæµï¼šè‡ªå®šä¹‰åºåˆ—åŒ–æ–¹å¼ ","date":"2021-03-08","objectID":"/20210308_dw-flink/:2:4","tags":["DataWarehouse","Flink"],"title":"Data Warehouse: Real-Time, part â… ","uri":"/20210308_dw-flink/"},{"categories":["Technology"],"content":"Data warehouse is a system that pulls together data derived from operational systems and external data sources within an organization for reporting and analysis. A data warehouse is a central repository of information that provides users with current and historical decision support information. ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:0:0","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®ä»“åº“ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:1:0","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ¦‚å¿µ offline DW process æ•°ä»“æ˜¯å¯¹æ•°æ®è¿›è¡Œ å¤‡ä»½ã€æ¸…æ´—ã€èšåˆã€ç»Ÿè®¡ ç­‰æ“ä½œã€‚ ODSåŸå§‹æ•°æ®å±‚ï¼›DWDæ˜ç»†æ•°æ®å±‚ï¼›DWSæœåŠ¡æ•°æ®å±‚ï¼›DWTæ•°æ®ä¸»é¢˜å±‚ï¼›ADSæ•°æ®åº”ç”¨å±‚ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:1:1","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æŠ€æœ¯ç»„ä»¶ æ•°æ®é‡‡é›†ä¼ è¾“ï¼šFlumeï¼ŒKafkaï¼ŒDataXï¼ŒSqoopï¼ŒLogstash æ•°æ®å­˜å‚¨ï¼šMySQLï¼ŒHDFSï¼ŒHBASEï¼ŒRedisï¼ŒMongoDB æ•°æ®è®¡ç®—ï¼šHiveï¼ŒSparkï¼ŒFlinkï¼ŒTezï¼ŒStorm æ•°æ®æŸ¥è¯¢ï¼šPrestoï¼ŒKylinï¼ŒImpalaï¼ŒDruid æ•°æ®å¯è§†åŒ–ï¼šEchartsã€Supersetã€QuickBIã€DataV ä»»åŠ¡è°ƒåº¦ï¼šAzkabanã€Oozie é›†ç¾¤ç›‘æ§ï¼šZabbix å…ƒæ•°æ®ç®¡ç†ï¼šAtlas æƒé™ç®¡ç†ï¼šRanger ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:1:2","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"ç³»ç»Ÿæµç¨‹ ä¸šåŠ¡æ•°æ® / å‰ç«¯ js æ•°æ®ï¼šæŒä¹…åŒ–æˆ–ä¸æŒä¹…åŒ–å†™å…¥æ•°æ®åº“ã€‚ Nginxï¼šè´Ÿè½½å‡è¡¡ï¼Œä½¿æ¯ä¸ªèŠ‚ç‚¹æ•°æ®é‡ä¿æŒåˆç†ã€‚ Flumeï¼šé‡‡é›†æ—¥å¿—ã€‚å¯ä»¥ç›´æ¥é‡‡é›†åˆ° Hadoopï¼Œä½† hadoop å¯èƒ½å¤„ç†å¾ˆæ…¢ï¼Œå¦‚åŒ11ã€‚å¯ä»¥å…ˆå†™åˆ° Kafka é‡Œã€‚ Flume ç»„æˆï¼ŒPut äº‹åŠ¡ï¼ŒTake äº‹åŠ¡ Flume ä¸‰ä¸ªå™¨ï¼šæ‹¦æˆªå™¨ï¼Œé€‰æ‹©å™¨ï¼Œç›‘æ§å™¨ Flume ä¼˜åŒ–ï¼šå†…å­˜ï¼Œå°æ•° Kafkaï¼š23 ä»¶äº‹ 1.kafkaåŸºæœ¬ä¿¡æ¯ 2.æŒ‚äº† 3.ä¸¢å¤± 4.é‡å¤ 5.ç§¯å‹ 6.ä¼˜åŒ– 7.é«˜æ•ˆè¯»å†™çš„åŸå›  Zookeeperï¼šåˆ†å¸ƒå¼åè°ƒ 1.éƒ¨ç½²å¤šå°‘å° 2.é€‰ä¸¾æœºåˆ¶ï¼ŒPaxosç®—æ³• Flumeï¼š æ¶ˆè´¹ä¼ åˆ° Hadoop Hiveï¼š 1.Hiveå†…éƒ¨è¡¨ã€å¤–éƒ¨è¡¨åŒºåˆ« 2.4ä¸ªby 3.ç³»ç»Ÿå‡½æ•° 4.UDFã€UDTFå‡½æ•° 5.çª—å£å‡½æ•° 6.Hiveä¼˜åŒ– 7.æ•°æ®å€¾æ–œ 8.Hiveå¼•æ“ 9.å…ƒæ•°æ®å¤‡ä»½ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:1:3","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"é›†ç¾¤é…ç½® é…ç½®åŸåˆ™: æ¶ˆè€—å†…å­˜çš„ç»„ä»¶è¦åˆ†å¼€ï¼šHDFS çš„ NameNodeã€Yarn çš„ ResourceManager åˆ†å¼€é…ç½® kafkaã€zkã€flume ä¼ è¾“æ•°æ®æ¯”è¾ƒç´§å¯†çš„æ”¾åœ¨ä¸€èµ· å®¢æˆ·ç«¯æ”¾åœ¨ä¸€åˆ°ä¸¤å°æœåŠ¡å™¨ä¸Šï¼Œæ–¹ä¾¿å¤–éƒ¨è®¿é—® ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:1:4","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®é‡‡é›†æ¨¡å— ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:0","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Hadoop ä¼˜åŒ–ï¼š æ•°æ®å‡è¡¡ï¼šèŠ‚ç‚¹ä¸èŠ‚ç‚¹é—´ï¼Œç£ç›˜ä¸ç£ç›˜é—´ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å‘½ä»¤ä½¿æ•°æ®å‡è¡¡ï¼Œthreshold è®¾ç½®å·®å€¼ã€‚ LZO å‹ç¼©ï¼šhadoop é¢å¤–æ”¯æŒ gzipã€Snappyã€Lzoã€Lzop(åˆ†ç‰‡) å‹ç¼©æ–¹å¼ã€‚LZOåˆ›å»ºç´¢å¼•åå¯ä»¥å®ç°åˆ†ç‰‡ã€‚ éœ€è¦å‹ç¼©çš„ä¸‰ä¸ªåœ°æ–¹ï¼š Map Reduce è¾“å…¥ç«¯ å¿« è¾“å‡ºç«¯ å…ˆè€ƒè™‘æ•°æ®é‡ 1.å° =\u003e å¿« snappy çœ‹éœ€æ±‚ 1.æ°¸ä¹…ä¿å­˜ï¼šå‹ç¼©è¶Šå°è¶Šå¥½ 2.æ•°æ®é‡å¤§ =\u003e åˆ‡ç‰‡ bzip2 lzo =\u003e éœ€è¦åˆ›å»ºç´¢å¼• lzo 2.ä¸‹ä¸€ä¸ªmapreduceè¾“å…¥ç«¯ æ•°æ®é‡å° =\u003e å¿« æ•°æ®é‡å¤§ =\u003e åˆ‡ç‰‡ å‹ç¼© HDFSå‚æ•°è°ƒä¼˜ï¼š å¯¹äºå¤§é›†ç¾¤æˆ–è€…å¤§é‡å®¢æˆ·ç«¯çš„é›†ç¾¤æ¥è¯´ï¼Œé€šå¸¸éœ€è¦è°ƒå¤§ dfs.namenode.handler.count çš„ä¸ªæ•°ï¼Œé»˜è®¤å€¼ä¸º10ä¸ªã€‚å»ºè®®è°ƒæ•´ä¸º 20 * logecluster size Yarnå‚æ•°è°ƒä¼˜ yarn-site.xmlï¼š æƒ…æ™¯æè¿°ï¼šæ€»å…±7å°æœºå™¨ï¼Œæ¯å¤©å‡ äº¿æ¡æ•°æ®ï¼Œæ•°æ®æº -\u003e Flume -\u003e Kafka -\u003e HDFS -\u003e Hive é—®é¢˜ï¼šæ•°æ®ç»Ÿè®¡ä¸»è¦ç”¨ HiveSQLï¼Œæ²¡æœ‰æ•°æ®å€¾æ–œï¼Œå°æ–‡ä»¶å·²ç»åšäº†åˆå¹¶å¤„ç†ï¼Œå¼€å¯äº† JVM é‡ç”¨ï¼Œè€Œä¸”IO æ²¡æœ‰é˜»å¡ï¼Œå†…å­˜ç”¨äº†ä¸åˆ° 50%ï¼Œä½†è¿˜æ˜¯è·‘çš„éå¸¸æ…¢ï¼Œè€Œä¸”æ•°æ®é‡æ´ªå³°æ—¶ï¼Œæ•´ä¸ªé›†ç¾¤éƒ½ä¼šå®•æ‰ï¼ŒåŸºäºè¿™ç§æƒ…å†µçš„ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ä»€ä¹ˆã€‚ è§£å†³åŠæ³•ï¼šå…¸å‹çš„å†…å­˜åˆ©ç”¨ç‡ä¸å¤Ÿï¼Œä¸€èˆ¬æ˜¯ Yarn çš„2ä¸ªé…ç½®é€ æˆçš„ï¼Œå•ä¸ªä»»åŠ¡å¯ä»¥ç”³è¯·çš„æœ€å¤§å†…å­˜å¤§å°ï¼Œå’Œ Hadoop å•ä¸ªèŠ‚ç‚¹å¯ç”¨å†…å­˜å¤§å°ã€‚è°ƒèŠ‚è¿™ä¸¤ä¸ªå‚æ•°èƒ½æé«˜ç³»ç»Ÿå†…å­˜çš„åˆ©ç”¨ç‡ã€‚ ï¼ˆNodeManager é»˜è®¤å†…å­˜å¤§å° 8gï¼Œå•ä¸ªä»»åŠ¡é»˜è®¤å†…å­˜å¤§å° 8gï¼Œmaptaské»˜è®¤å†…å­˜å¤§å° 1gï¼Œreducetaské»˜è®¤å†…å­˜å¤§å° 1gã€‚ï¼‰NodeManagerå†…å­˜æ”¹ä¸ºèŠ‚ç‚¹ 80% å·¦å³çš„å†…å­˜å¤§å°ã€‚å•ä¸ªä»»åŠ¡å†…å­˜å¤§å°æ ¹æ®æ¯ 128M æ•°æ®åˆ†é…1gå†…å­˜ã€‚maptask å’Œ reducetask å†…å­˜è‹¥ä¸æ”¯æŒå‹ç¼©ä¹Ÿéœ€è¦è°ƒå¤§ã€‚ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:1","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Zookeeper ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:2","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Kafka kafka æœºå™¨æ•°é‡è®¡ç®—ï¼š æœºå™¨æ•°é‡ï¼ˆç»éªŒå…¬å¼ï¼‰= 2 *ï¼ˆå³°å€¼ç”Ÿäº§é€Ÿåº¦ * å‰¯æœ¬æ•° / 100) + 1 å…ˆé€šè¿‡å‹æµ‹æ‹¿åˆ°å³°å€¼ç”Ÿäº§é€Ÿåº¦ï¼Œæ¯”å¦‚å³°å€¼ç”Ÿäº§é€Ÿåº¦æ˜¯ 50M/sã€‚å‰¯æœ¬æ•°é»˜è®¤æ˜¯1ä¸ªï¼Œç”Ÿäº§ç¯å¢ƒå¯ä»¥è®¾ç½®ä¸º2ã€‚Kafka æœºå™¨æ•°é‡ = 2 * ï¼ˆ50 * 2 / 100ï¼‰+ 1 = 3 å°ã€‚ kafka producer ç”Ÿäº§è€…å‹åŠ›æµ‹è¯•ï¼š bin/kafka-producer-perf-test.sh --topic test --record-size 100 --num-records 100000 --throughput -1 --producer-props bootstrap.servers=hadoop102:9092,hadoop103:9092 å‚æ•°è¯´æ˜ï¼š â€“record-sizeï¼šæ˜¯ä¸€æ¡ä¿¡æ¯æœ‰å¤šå¤§ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚ â€“num-recordsï¼šæ˜¯æ€»å…±å‘é€å¤šå°‘æ¡ä¿¡æ¯ã€‚ â€“throughputï¼šæ˜¯æ¯ç§’å¤šå°‘æ¡ä¿¡æ¯ï¼Œè®¾æˆ-1è¡¨ç¤ºä¸é™æµï¼Œå¯æµ‹å‡ºç”Ÿäº§è€…æœ€å¤§ååé‡ã€‚ kafka consumer æ¶ˆè´¹è€…å‹åŠ›æµ‹è¯•ï¼š å¦‚æœ IOã€CPUã€å†…å­˜ã€ç½‘ç»œ è¿™å››ä¸ªæŒ‡æ ‡éƒ½ä¸èƒ½æ”¹å˜ï¼Œè€ƒè™‘å¢åŠ åˆ†åŒºæ•°æ¥æå‡æ€§èƒ½ã€‚ å‚æ•°è¯´æ˜ï¼š â€“broker-listï¼šæŒ‡å®š kafka é›†ç¾¤åœ°å€ â€“topicï¼šæŒ‡å®š topic çš„åç§° â€“fetch-sizeï¼šæŒ‡å®šæ¯æ¬¡ fetch çš„æ•°æ®å¤§å° â€“messagesï¼šæ€»å…±è¦æ¶ˆè´¹çš„æ¶ˆæ¯ä¸ªæ•° kafka åˆ†åŒºæ•°è®¡ç®—ï¼š åˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªåˆ†åŒºçš„topic æµ‹è¯•è¿™ä¸ª topic çš„ producer ååé‡å’Œ consumer ååé‡ã€‚ å‡è®¾ä»–ä»¬çš„å€¼æ˜¯ Tp å’Œ Tcï¼Œå•ä½æ˜¯ MB/sã€‚ ç„¶åå‡è®¾æ€»çš„ç›®æ ‡ååé‡æ˜¯ Ttï¼Œé‚£ä¹ˆåˆ†åŒºæ•° = Tt/min( Tpï¼ŒTc) åˆ†åŒºæ•°ä¸€èˆ¬è®¾ç½®ä¸ºï¼š3 - 10ä¸ª ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:3","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Flume Flume ç»„ä»¶é€‰å‹ Sourceï¼š Taildir Sourceï¼šæ”¯æŒæ–­ç‚¹ç»­ä¼ ã€å¤šç›®å½•ã€‚ä½†å¯èƒ½æœ‰æ•°æ®é‡å¤ï¼ˆé‡å¤æ•°æ®åœ¨ä¸‹ä¸€çº§è§£å†³ï¼šåœ¨ hive çš„ dwd å±‚ã€spark streaming ä½¿ç”¨ group byã€å¼€çª—å–çª—å£ç¬¬ä¸€æ¡æ•°æ®ï¼‰ Channelï¼š kafka channelï¼šæ•°æ®å­˜æ”¾åœ¨ kafka é‡Œé¢ã€‚kafka æ•°æ®å­˜åœ¨ç£ç›˜é‡Œã€‚ åŸºäºç£ç›˜ï¼Œå¯é æ€§é«˜ kafka channel \u003e memory channel + kafka sink å¦‚æœä¸‹ä¸€çº§æ˜¯ kafkaï¼Œä¼˜å…ˆé€‰æ‹© kafka channel å¦‚æœä¸‹ä¸€çº§ä¸æ˜¯ kafkaï¼Œå¯¹å¯é æ€§è¦æ±‚æ¯”è¾ƒé«˜ï¼Œé‡‘èé¢†åŸŸï¼Œä¼˜å…ˆé€‰æ‹© file channel å¦‚æœä¸‹ä¸€çº§ä¸æ˜¯ kafkaï¼Œå¯¹å¯é æ€§è¦æ±‚ä¸é«˜ï¼Œé€‰æ‹© memory channelï¼Œè¿½æ±‚æ•ˆç‡ kafka channel 1.6ç‰ˆæœ¬äº§ç”Ÿï¼Œä½†æœ‰ bug äº§ç”Ÿçš„æ•°æ®æ˜¯ header + å†…å®¹ï¼Œ1.7 ç‰ˆæœ¬è§£å†³ Flume æ‹¦æˆªå™¨ Flume æ¶ˆè´¹ Kafka é‡Œé¢çš„æ•°æ®æ—¶ï¼Œå¯èƒ½å·²ç»æ˜¯ç¬¬äºŒå¤©ï¼Œæ•°æ®æœ‰å¯èƒ½å‘å¾€ç¬¬äºŒå¤©çš„ HDFS è·¯å¾„ã€‚ è§£å†³æ€è·¯ï¼šæ‹¦æˆª json æ—¥å¿—ï¼Œé€šè¿‡ fastjson è§£æ jsonï¼Œè·å–å®é™…æ—¶é—´ tsã€‚å°†è·å–çš„ ts æ—¶é—´å†™å…¥æ‹¦æˆªå™¨ header å¤´ï¼Œheader çš„ key å¿…é¡»æ˜¯ timestampï¼Œå› ä¸º Flume æ¡†æ¶ä¼šæ ¹æ®è¿™ä¸ª key çš„å€¼è¯†åˆ«ä¸ºæ—¶é—´ï¼Œå†™å…¥åˆ° HDFSã€‚ åˆ›å»º Maven å·¥ç¨‹ flume-interceptor åˆ›å»ºåŒ…åï¼šcom.whatever.flume.interceptor åœ¨ pom.xml æ–‡ä»¶ä¸­æ·»åŠ é…ç½® åœ¨ com.whatever.flume.interceptor åŒ…ä¸‹åˆ›å»º JSONUtils ç±» åœ¨ com.whatever.flume.interceptor åŒ…ä¸‹åˆ›å»º ETLInterceptor ç±»ï¼Œé‡å†™æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆ JSON æ ¼å¼ æ‰“åŒ…ï¼Œåˆ†å‘åˆ° Flume èŠ‚ç‚¹ flume_scs Flumeä¼˜åŒ–ï¼š å†…å­˜å‚æ•°è®¾ç½®ä¼˜åŒ–ï¼š JVM heap ä¸€èˆ¬è®¾ç½®ä¸º 4G æˆ–æ›´é«˜ -Xmxï¼ˆå¯åŠ¨å†…å­˜ï¼‰ ä¸ -Xmsï¼ˆè¿è¡Œå†…å­˜ï¼‰ æœ€å¥½è®¾ç½®ä¸€è‡´ï¼Œå‡å°‘å†…å­˜æŠ–åŠ¨å¸¦æ¥çš„æ€§èƒ½å½±å“ï¼Œå¦‚æœä¸ä¸€è‡´å®¹æ˜“å€’ç½® fullgc ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:4","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"DataX åŒæ­¥ç­–ç•¥ï¼š åŒæ­¥ç­–ç•¥ ä¼˜ç‚¹ ç¼ºç‚¹ å…¨é‡åŒæ­¥ é€»è¾‘ç®€å• æ•ˆç‡ä½ å¢é‡åŒæ­¥ æ•ˆç‡é«˜ï¼Œæ— éœ€åŒæ­¥å’Œå­˜å‚¨é‡å¤æ•°æ® é€»è¾‘å¤æ‚ DadaX ç›¸æ¯” Sqoop åŠŸèƒ½æ›´å¼ºå¤§ï¼š åŠŸèƒ½ DataX Sqoop è¿è¡Œæ¨¡å¼ å•è¿›ç¨‹å¤šçº¿ç¨‹ MR åˆ†å¸ƒå¼ ä¸æ”¯æŒ å¯ä»¥é€šè¿‡è°ƒåº¦ç³»ç»Ÿè§„é¿ æ”¯æŒ æµæ§ æœ‰ éœ€å®šåˆ¶ ç»Ÿè®¡ä¿¡æ¯ æœ‰ åˆ†å¸ƒå¼æ•°æ®æ”¶é›†ä¸æ–¹ä¾¿ æ•°æ®æ ¡éªŒ æœ‰ éœ€å®šåˆ¶ ç›‘æ§ éœ€å®šåˆ¶ éœ€å®šåˆ¶ DataX è°ƒåº¦å†³ç­–æ€è·¯ï¼š ä¸¾ä¾‹ï¼Œç”¨æˆ·æäº¤äº†ä¸€ä¸ª DataX ä½œä¸šï¼Œå¹¶ä¸”é…ç½®äº†æ€»çš„å¹¶å‘æ•°ä¸º 20ï¼Œç›®çš„æ˜¯å¯¹ä¸€ä¸ªæœ‰ 100 å¼ åˆ†è¡¨çš„ MySQL è¿›è¡ŒåŒæ­¥ã€‚è°ƒåº¦å†³ç­–æ€è·¯æ˜¯ï¼š dataX job æ ¹æ®åˆ†åº“åˆ†è¡¨åˆ‡åˆ†ç­–ç•¥ï¼Œå°†åŒæ­¥å·¥ä½œåˆ†æˆ 100 ä¸ª Taskã€‚ æ ¹æ®é…ç½®çš„æ€»çš„å¹¶å‘åº¦ 20ï¼Œä»¥åŠæ¯ä¸ª TaskGroup çš„å¹¶å‘åº¦ 5ï¼ŒdataXå…±éœ€è¦ 4 ä¸ª TaskGroupã€‚ 4 ä¸ª TaskGroup åˆ† 100 ä¸ª Taskï¼Œæ¯ä¸ª TaskGroup è´Ÿè´£ 25ä¸ª Taskã€‚ åŒæ­¥ HDFS æ•°æ®åˆ° MySQL æ¡ˆä¾‹ï¼š é€‰ç”¨ HDFSReader å’Œ MySQLWriterï¼Œåˆ†åˆ«è®¾ç½® json é…ç½®æ–‡ä»¶ã€‚ DataXä¼˜åŒ–ï¼š æå‡ DataX job å†… channel å¹¶å‘æ•°ï¼Œå†…å­˜çš„å ç”¨æ˜¾è‘—å¢åŠ ï¼Œæ¯ä¸ª channel ä¼šæœ‰ä¸€ä¸ª Bufferï¼Œä½œä¸ºä¸´æ—¶æ•°æ®äº¤æ¢çš„ç¼“å†²åŒºï¼Œè€Œåœ¨ reader å’Œ writer ä¸­ï¼Œä¹Ÿä¼šæœ‰ bufferï¼Œä¸ºäº†é˜²æ­¢ OOMï¼Œéœ€è¦è°ƒå¤§ JVM çš„å †å†…å­˜ã€‚ è°ƒæ•´ JVM xms xmx å‚æ•°çš„ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯ç›´æ¥æ›´æ”¹ datax.py è„šæœ¬ï¼›å¦ä¸€ç§æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™ï¼ŒåŠ ä¸Šå‚æ•°ï¼š python datax/bin/datax.py --jvm=\"-Xms8G -Xmx8G\" /path/to/your/job.json ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:5","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Maxwell MySQL å˜æ›´æ•°æ®æŠ“å–è½¯ä»¶ï¼Œå®æ—¶ç›‘æ§ MySQL çš„ insertã€updateã€deleteã€‚å¹¶å°†å˜æ›´æ•°æ®å‘é€ç»™ Kafka ç­‰æµæ•°æ®å¤„ç†å¹³å°ã€‚ åŸç†ï¼š è¯»å– MySQL çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinlogï¼‰ï¼Œä»ä¸­è·å–å˜æ›´æ•°æ®ã€‚ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:2:6","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®é‡‡é›†æ¨¡å—æ€»ç»“ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:0","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Linux # å‘½ä»¤ top ps -ef df -h #ç£ç›˜ç©ºé—´ netstat #æŸ¥çœ‹ç«¯å£å· # 4ä¸ªå·¥å…· awk sed sort cut # å†™è¿‡ä»€ä¹ˆè„šæœ¬ 1. åŒæ­¥åˆ†å‘ 2. å¯åŠ¨åœæ­¢ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:1","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Sqoop å¯¼å…¥æ•°æ®çš„æ–¹å¼ï¼š å…¨é‡ï¼šwhere 1=1 å¢é‡ï¼šwhere åˆ›å»ºæ—¶é—´ = å½“å¤© æ–°å¢åŠå˜åŒ–ï¼šwhere åˆ›å»ºæ—¶é—´ = å½“å¤© or æ“ä½œæ—¶é—´ = å½“å¤© ç‰¹æ®Šï¼šåªå¯¼å…¥ä¸€æ¬¡ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:2","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Hadoop å¸¸ç”¨ç«¯å£å·ï¼š 2.xï¼š50070/8020ï¼šHDFS 8088ï¼šä»»åŠ¡æƒ…å†µ 19888ï¼šJob history 3.xï¼š9870/8020ï¼šHDFS 8088ï¼šä»»åŠ¡æƒ…å†µ 19888ï¼šJob history é…ç½®æ–‡ä»¶ï¼š /etc/profile 2.xï¼šcore-site.xml hdfs-site.xml yarn-site.xml mapred-site.xml slaves 3.xï¼šcore-site.xml hdfs-site.xml yarn-site.xml mapred-site.xml workers ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:3","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"HDFS HDFS çš„è¯»å†™æµç¨‹ï¼Œç¬”è¯•ï¼š å†™è¯¦ç»†æ­¥éª¤ï¼š å®¢æˆ·ç«¯å‘NameNodeå‘å‡ºå†™æ–‡ä»¶è¯·æ±‚ã€‚ æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨æ–‡ä»¶ã€æ£€æŸ¥æƒé™ã€‚è‹¥é€šè¿‡æ£€æŸ¥ï¼Œç›´æ¥å…ˆå°†æ“ä½œå†™å…¥EditLogï¼Œå¹¶è¿”å›è¾“å‡ºæµå¯¹è±¡ã€‚ ï¼ˆæ³¨ï¼šWALï¼Œwrite ahead logï¼Œå…ˆå†™Logï¼Œå†å†™å†…å­˜ï¼Œå› ä¸ºEditLogè®°å½•çš„æ˜¯æœ€æ–°çš„HDFSå®¢æˆ·ç«¯æ‰§è¡Œæ‰€æœ‰çš„å†™æ“ä½œã€‚å¦‚æœåç»­çœŸå®å†™æ“ä½œå¤±è´¥äº†ï¼Œç”±äºåœ¨çœŸå®å†™æ“ä½œä¹‹å‰ï¼Œæ“ä½œå°±è¢«å†™å…¥EditLogä¸­äº†ï¼Œæ•…EditLogä¸­ä»ä¼šæœ‰è®°å½•ï¼Œæˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒåç»­clientè¯»ä¸åˆ°ç›¸åº”çš„æ•°æ®å—ï¼Œå› ä¸ºåœ¨ç¬¬5æ­¥ä¸­DataNodeæ”¶åˆ°å—åä¼šæœ‰ä¸€è¿”å›ç¡®è®¤ä¿¡æ¯ï¼Œè‹¥æ²¡å†™æˆåŠŸï¼Œå‘é€ç«¯æ²¡æ”¶åˆ°ç¡®è®¤ä¿¡æ¯ï¼Œä¼šä¸€ç›´é‡è¯•ï¼Œç›´åˆ°æˆåŠŸï¼‰ clientç«¯æŒ‰128MBçš„å—åˆ‡åˆ†æ–‡ä»¶ã€‚ clientå°†NameNodeè¿”å›çš„åˆ†é…çš„å¯å†™çš„DataNodeåˆ—è¡¨å’ŒDataæ•°æ®ä¸€åŒå‘é€ç»™æœ€è¿‘çš„ç¬¬ä¸€ä¸ªDataNodeèŠ‚ç‚¹ï¼Œæ­¤åclientç«¯å’ŒNameNodeåˆ†é…çš„å¤šä¸ªDataNodeæ„æˆpipelineç®¡é“ï¼Œclientç«¯å‘è¾“å‡ºæµå¯¹è±¡ä¸­å†™æ•°æ®ã€‚clientæ¯å‘ç¬¬ä¸€ä¸ªDataNodeå†™å…¥ä¸€ä¸ªpacketï¼Œè¿™ä¸ªpacketä¾¿ä¼šç›´æ¥åœ¨pipelineé‡Œä¼ ç»™ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªâ€¦DataNodeã€‚ ï¼ˆæ³¨ï¼šå¹¶ä¸æ˜¯å†™å¥½ä¸€ä¸ªå—æˆ–ä¸€æ•´ä¸ªæ–‡ä»¶åæ‰å‘ååˆ†å‘ï¼‰ æ¯ä¸ªDataNodeå†™å®Œä¸€ä¸ªå—åï¼Œä¼šè¿”å›ç¡®è®¤ä¿¡æ¯ã€‚ ï¼ˆæ³¨ï¼šå¹¶ä¸æ˜¯æ¯å†™å®Œä¸€ä¸ªpacketåå°±è¿”å›ç¡®è®¤ä¿¡æ¯ï¼Œå› ä¸ºpacketä¸­çš„æ¯ä¸ªchunkéƒ½æºå¸¦æ ¡éªŒä¿¡æ¯ï¼Œæ²¡å¿…è¦æ¯å†™ä¸€ä¸ªå°±æ±‡æŠ¥ä¸€ä¸‹ï¼Œè¿™æ ·æ•ˆç‡å¤ªæ…¢ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å†™å®Œä¸€ä¸ªblockå—åï¼Œå¯¹æ ¡éªŒä¿¡æ¯è¿›è¡Œæ±‡æ€»åˆ†æï¼Œå°±èƒ½å¾—å‡ºæ˜¯å¦æœ‰å—å†™é”™çš„æƒ…å†µå‘ç”Ÿï¼‰ å†™å®Œæ•°æ®ï¼Œå…³é—­è¾“è¾“å‡ºæµã€‚ å‘é€å®Œæˆä¿¡å·ç»™NameNodeã€‚ ï¼ˆæ³¨ï¼šå‘é€å®Œæˆä¿¡å·çš„æ—¶æœºå–å†³äºé›†ç¾¤æ˜¯å¼ºä¸€è‡´æ€§è¿˜æ˜¯æœ€ç»ˆä¸€è‡´æ€§ï¼Œå¼ºä¸€è‡´æ€§åˆ™éœ€è¦æ‰€æœ‰DataNodeå†™å®Œåæ‰å‘NameNodeæ±‡æŠ¥ã€‚æœ€ç»ˆä¸€è‡´æ€§åˆ™å…¶ä¸­ä»»æ„ä¸€ä¸ªDataNodeå†™å®Œåå°±èƒ½å•ç‹¬å‘NameNodeæ±‡æŠ¥ï¼ŒHDFSä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯å¼ºè°ƒå¼ºä¸€è‡´æ€§ï¼‰ è¯»è¯¦ç»†æ­¥éª¤ï¼š clientè®¿é—®NameNodeï¼ŒæŸ¥è¯¢å…ƒæ•°æ®ä¿¡æ¯ï¼Œè·å¾—è¿™ä¸ªæ–‡ä»¶çš„æ•°æ®å—ä½ç½®åˆ—è¡¨ï¼Œè¿”å›è¾“å…¥æµå¯¹è±¡ã€‚ å°±è¿‘æŒ‘é€‰ä¸€å°datanodeæœåŠ¡å™¨ï¼Œè¯·æ±‚å»ºç«‹è¾“å…¥æµ ã€‚ DataNodeå‘è¾“å…¥æµä¸­ä¸­å†™æ•°æ®ï¼Œä»¥packetä¸ºå•ä½æ¥æ ¡éªŒã€‚ å…³é—­è¾“å…¥æµ å°æ–‡ä»¶å±å®³ï¼š å­˜å‚¨æ—¶é—´ï¼šå°æ–‡ä»¶ä¼šå ç”¨ namenode ä¸€æ•´ä¸ªåŒºå—ï¼Œä¸€ä¸ªæ–‡ä»¶å—150å­—èŠ‚ã€‚128gå†…å­˜çš„ namenode èƒ½å­˜å‚¨ 9äº¿ä¸ªæ–‡ä»¶å—ã€‚ è®¡ç®—æ—¶é—´ï¼š1ä¸ªæ–‡ä»¶å—å¼€å¯1ä¸ªmaptaskï¼Œä¸€ä¸ªmaptaskå°±æ˜¯1gå†…å­˜ã€‚ å¦‚ä½•è§£å†³ï¼š åˆå¹¶ï¼šCombineTextinputformat =\u003e å‡å°‘ maptask harå½’æ¡£ JVMé‡ç”¨ HDFS æœ‰å‡ ä¸ªå‰¯æœ¬ï¼š 3 HDFS å—å¤§å°ï¼š 2.x 3.xï¼š128M ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:4","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Mapreduce shuffle åŠå…¶ä¼˜åŒ–ï¼š shuffle å®šä¹‰ï¼šmap æ–¹æ³•ä¹‹åï¼Œreduceæ–¹æ³•ä¹‹å‰æ··æ´—çš„è¿‡ç¨‹ã€‚ map é˜¶æ®µä¹‹åï¼š å…ˆè°ƒç”¨ getpartition æ–¹æ³•ï¼Œæ ‡è®°æ•°æ®æ˜¯å“ªä¸€ä¸ªåˆ†åŒºã€‚ è¿›å…¥ç¯å½¢ç¼“å†²åŒºï¼ˆç¼“å†²åŒºå¤§å°100M ï¼‰ï¼Œåˆ°è¾¾ 80% è¿›è¡Œæº¢å†™ï¼ˆæ’åºæ‰‹æ®µï¼šå¯¹ key çš„ç´¢å¼•æŒ‰ç…§ å­—å…¸åº è¿›è¡Œ å¿«æ’ï¼‰ å¯¹æº¢å†™æ–‡ä»¶è¿›è¡Œå½’å¹¶ï¼Œå†™åˆ°æŒ‡å®šç£ç›˜ï¼ŒæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ reduce é˜¶æ®µä¹‹å‰ï¼š æ‹‰å–ç£ç›˜ä¸ŠæŒ‡å®šçš„æ•°æ®ï¼Œæ”¾åˆ°å†…å­˜ä¸­ï¼ˆå†…å­˜ä¸å¤Ÿåœ¨ç£ç›˜ä¸­ï¼‰ reduce æ“ä½œ ä¼˜åŒ–ï¼š getpartition æ–¹æ³•æ—¶ï¼šè‡ªå®šä¹‰åˆ†åŒºï¼šè§£å†³æ•°æ®å€¾æ–œé—®é¢˜ã€‚ è°ƒæ•´ç¼“å†²åŒºå¤§å°å’Œæº¢å†™é˜ˆå€¼ï¼Œç¼“å†²åŒºå¤§å°ç”±100Mè°ƒæ•´åˆ°200Mï¼Œæº¢å†™é˜ˆå€¼ç”±80%è°ƒæ•´åˆ°90%ã€‚äº§ç”Ÿå¤§é‡çš„æº¢å†™æ–‡ä»¶ï¼Œä½¿ç”¨combinerèšç±»æ–‡ä»¶ï¼ˆå‰ææ˜¯ä¸å½±å“æœ€ç»ˆä¸šåŠ¡é€»è¾‘ï¼‰ã€‚è¿™æ ·å‡å°‘äº†å†™æ–‡ä»¶çš„ä¸ªæ•°ï¼Œåˆå¹¶ä¼šå¿«ä¸€äº›ã€‚ æº¢å†™æ–‡ä»¶å½’å¹¶åˆ°ç£ç›˜ï¼šå‡å°‘ç£ç›˜IOå‹ç¼©ï¼Œä½¿ç”¨å¿«çš„å‹ç¼©ç®—æ³•ï¼šsnappy/lzo Map Reduce è¾“å…¥ç«¯ å¿« è¾“å‡ºç«¯ å…ˆè€ƒè™‘æ•°æ®é‡ 1.å° =\u003e å¿« snappy çœ‹éœ€æ±‚ 1.æ°¸ä¹…ä¿å­˜ï¼šå‹ç¼©è¶Šå°è¶Šå¥½ 2.æ•°æ®é‡å¤§ =\u003e åˆ‡ç‰‡ bzip2 lzo =\u003e éœ€è¦åˆ›å»ºç´¢å¼• lzo 2.ä¸‹ä¸€ä¸ªmapreduceè¾“å…¥ç«¯ æ•°æ®é‡å° =\u003e å¿« æ•°æ®é‡å¤§ =\u003e åˆ‡ç‰‡ å‹ç¼© reduce æ‹‰å–ç£ç›˜æŒ‡å®šçš„æ•°æ®ï¼Œé»˜è®¤æ‹‰å–5ä¸ªï¼Œå¯ä»¥æ”¹æˆ10 - 20ä¸ª yarn å’Œ hadoopå†…å­˜å¤§å°è°ƒæ•´ï¼šå•ä¸ªä»»åŠ¡å¯ä»¥ç”³è¯·çš„æœ€å¤§å†…å­˜å¤§å°ï¼Œå’Œ Hadoop å•ä¸ªèŠ‚ç‚¹å¯ç”¨å†…å­˜å¤§å°ã€‚è°ƒèŠ‚è¿™ä¸¤ä¸ªå‚æ•°èƒ½æé«˜ç³»ç»Ÿå†…å­˜çš„åˆ©ç”¨ç‡ã€‚ ï¼ˆNodeManager é»˜è®¤å†…å­˜å¤§å° 8gï¼Œå•ä¸ªä»»åŠ¡é»˜è®¤å†…å­˜å¤§å° 8gï¼Œmaptaské»˜è®¤å†…å­˜å¤§å° 1gï¼Œreducetaské»˜è®¤å†…å­˜å¤§å° 1gã€‚ï¼‰NodeManagerå†…å­˜æ”¹ä¸ºèŠ‚ç‚¹ 80% å·¦å³çš„å†…å­˜å¤§å°ã€‚å•ä¸ªä»»åŠ¡å†…å­˜å¤§å°æ ¹æ®æ¯ 128M æ•°æ®åˆ†é…1gå†…å­˜ã€‚maptask å’Œ reducetask å†…å­˜è‹¥ä¸æ”¯æŒå‹ç¼©ä¹Ÿéœ€è¦è°ƒå¤§ã€‚ è¿›è¡Œäº†å‡ æ¬¡æ’åºï¼š mapåè¿›è¡Œä¸€æ¬¡å¿«æ’ï¼Œä¸€æ¬¡å½’å¹¶ã€‚ reduceæ—¶è¿›è¡Œä¸€æ¬¡å½’å¹¶ï¼Œä¸€æ¬¡åˆ†ç»„ã€‚ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:5","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Yarn yarn çš„å·¥ä½œæœºåˆ¶ï¼š ç”¨æˆ·ä½¿ç”¨å®¢æˆ·ç«¯å‘ RM æäº¤ä¸€ä¸ªä»»åŠ¡ï¼ŒåŒæ—¶æŒ‡å®šæäº¤åˆ°å“ªä¸ªé˜Ÿåˆ—å’Œéœ€è¦å¤šå°‘èµ„æºã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æ¯ä¸ªè®¡ç®—å¼•æ“çš„å¯¹åº”å‚æ•°è®¾ç½®ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šï¼Œåˆ™ä½¿ç”¨é»˜è®¤è®¾ç½®ã€‚ RM åœ¨æ”¶åˆ°ä»»åŠ¡æäº¤çš„è¯·æ±‚åï¼Œå…ˆæ ¹æ®èµ„æºå’Œé˜Ÿåˆ—æ˜¯å¦æ»¡è¶³è¦æ±‚é€‰æ‹©ä¸€ä¸ª NMï¼Œé€šçŸ¥å®ƒå¯åŠ¨ä¸€ä¸ªç‰¹æ®Šçš„ containerï¼Œç§°ä¸º ApplicationMasterï¼ˆAMï¼‰ï¼Œåç»­æµç¨‹ç”±å®ƒå‘èµ·ã€‚ AM å‘ RM æ³¨å†Œåæ ¹æ®è‡ªå·±ä»»åŠ¡çš„éœ€è¦ï¼Œå‘ RM ç”³è¯· containerï¼ŒåŒ…æ‹¬æ•°é‡ã€æ‰€éœ€èµ„æºé‡ã€æ‰€åœ¨ä½ç½®ç­‰å› ç´ ã€‚ å¦‚æœé˜Ÿåˆ—æœ‰è¶³å¤Ÿèµ„æºï¼ŒRM ä¼šå°† container åˆ†é…ç»™æœ‰è¶³å¤Ÿå‰©ä½™èµ„æºçš„ NMï¼Œç”± AM é€šçŸ¥ NM å¯åŠ¨ containerã€‚ container å¯åŠ¨åæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼Œå¤„ç†åˆ†ç»™è‡ªå·±çš„æ•°æ®ã€‚NM é™¤äº†è´Ÿè´£å¯åŠ¨ containerï¼Œè¿˜è´Ÿè´£ç›‘æ§å®ƒçš„èµ„æºä½¿ç”¨çŠ¶å†µä»¥åŠæ˜¯å¦å¤±è´¥é€€å‡ºç­‰å·¥ä½œï¼Œå¦‚æœ container å®é™…ä½¿ç”¨çš„å†…å­˜è¶…è¿‡ç”³è¯·æ—¶æŒ‡å®šçš„å†…å­˜ï¼Œä¼šå°†å…¶æ€æ­»ï¼Œä¿è¯å…¶ä»– container èƒ½æ­£å¸¸è¿è¡Œã€‚ å„ä¸ª container å‘ AM æ±‡æŠ¥è‡ªå·±çš„è¿›åº¦ï¼Œéƒ½å®Œæˆåï¼ŒAM å‘ RM æ³¨é”€ä»»åŠ¡å¹¶é€€å‡ºï¼ŒRM é€šçŸ¥ NM æ€æ­»å¯¹åº”çš„ containerï¼Œä»»åŠ¡ç»“æŸã€‚ hadoop è°ƒåº¦å™¨ï¼š ä¸‰ç§è°ƒåº¦å™¨ï¼šFIFOã€å®¹é‡è°ƒåº¦å™¨ã€å…¬å¹³è°ƒåº¦å™¨ Apacheé»˜è®¤è°ƒåº¦å™¨ï¼šå®¹é‡è°ƒåº¦å™¨ï¼ˆapacheé»˜è®¤èµ„æºå¾ˆå°ï¼‰ CDHé»˜è®¤è°ƒåº¦å™¨ï¼šå…¬å¹³è°ƒåº¦å™¨ ç‰¹ç‚¹ï¼š FIFOè°ƒåº¦å™¨ç‰¹ç‚¹ï¼šæ”¯æŒå•é˜Ÿåˆ—ï¼Œä»»åŠ¡å…ˆè¿›å…ˆå‡ºï¼Œä¼ä¸šä¸­å‡ ä¹ä¸ç”¨ã€‚ å®¹é‡è°ƒåº¦å™¨ï¼šåº•å±‚æ˜¯FIFOè°ƒåº¦å™¨ã€‚æ”¯æŒå¤šé˜Ÿåˆ—ï¼Œå¯ä»¥å€Ÿç”¨å…¶ä»–é˜Ÿåˆ—èµ„æºã€‚å…ˆè¿›å…¥çš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œã€‚ å…¬å¹³è°ƒåº¦å™¨ï¼šæ”¯æŒå¤šé˜Ÿåˆ—(å¹¶å‘åº¦æ¯”å®¹é‡è°ƒåº¦é«˜)ï¼Œå¯ä»¥å€Ÿç”¨å…¶ä»–é˜Ÿåˆ—èµ„æºã€‚é˜Ÿåˆ—ä¸­æ‰€æœ‰ä»»åŠ¡å…¬å¹³äº«æœ‰é˜Ÿåˆ—èµ„æºã€‚ å®¹å™¨è°ƒåº¦å™¨é…ç½®å¤šé˜Ÿåˆ—ï¼š æŒ‰ç…§åˆ†æå¼•æ“åˆ›å»ºé˜Ÿåˆ—ï¼šmrã€sparkã€flinkã€hive æŒ‰ç…§ä¸šåŠ¡ï¼šç™»å½•ã€æ³¨å†Œã€è´­ç‰©è½¦ã€ä¸‹å•ã€æ”¯ä»˜ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:6","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Zookeeper é€‰ä¸¾æœºåˆ¶ï¼š åŠæ•°æœºåˆ¶ï¼š3å°æœåŠ¡å™¨ï¼Œ2å°æŠ•è°è°å°±æ˜¯è€å¤§ å¸¸ç”¨å‘½ä»¤ï¼š delete create å®‰è£…å°æ•°ï¼š æ ¹æ®é›†ç¾¤æœºå™¨æ•°é‡ï¼Œ3-11å°ã€‚zkå°æ•°å¤šäº†ï¼Œå¢åŠ å¯é æ€§ï¼Œä½†é™ä½é€‰ä¸¾æ•ˆç‡ã€‚ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:7","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Flume ç»„æˆï¼šï¼ˆsourceã€channelã€sinkã€putäº‹åŠ¡ã€takeäº‹åŠ¡ï¼‰ sourceï¼šï¼ˆTaildirsourceï¼‰ ä¼˜ç‚¹ï¼šæ–­ç‚¹ç»­ä¼ ã€å¤šç›®å½•ï¼Œå®æ—¶ç›‘æ§ã€‚ç¼ºç‚¹ï¼šæ–‡ä»¶åæ›´å(å¦‚log4jå°±æ˜¯æ›´åçš„æ—¥å¿—æ¡†æ¶)ä¹‹åé‡æ–°è¯»å–è¯¥æ–‡ä»¶é€ æˆé‡å¤ã€‚æ³¨æ„ï¼šè®©Taildirsourceåˆ¤æ–­æ–‡ä»¶æ—¶åªçœ‹iNodeå€¼ Apache 1.7ã€CDH1.6ç‰ˆæœ¬äº§ç”Ÿçš„ æ²¡æœ‰æ–­ç‚¹ç»­ä¼ æ€ä¹ˆåŠï¼šè‡ªå®šä¹‰ sourceï¼Œè¯»å–çš„ä½ç½®å§‹ç»ˆæŒä¹…åˆ°ç£ç›˜ä¸Š æŒ‚äº†ï¼šä¸ä¼šä¸¢æ•°æ®ï¼Œä½†æœ‰å¯èƒ½é‡å¤æ•°æ® å¦‚ä½•å¤„ç†é‡å¤æ•°æ®ï¼šä¸å¤„ç†æˆ–ä¸‹ä¸€çº§å¤„ç†ï¼Œé‡‡ç”¨äº‹åŠ¡æ–¹å¼æ•ˆç‡å¤ªä½ ä¸æ”¯æŒé€’å½’éå†æ–‡ä»¶å¤¹ï¼šè‡ªå®šä¹‰é€’å½’ channelï¼šï¼ˆKafkaChannelï¼‰ ä¼˜ç‚¹ï¼šå°†æ•°æ®å†™å…¥Kafkaï¼Œçœäº†ä¸€å±‚sink file channel ç£ç›˜|å¯é æ€§é«˜|æ€§èƒ½ä½ memory channel å†…å­˜|å¯é æ€§ä½|æ€§èƒ½é«˜ kafka channel å­˜kafkaé‡Œï¼Œkafkaå­˜åœ¨ç£ç›˜|å¯é æ€§é«˜|æ€§èƒ½ä¼˜äº memory channel + kafka sink sinkï¼šï¼ˆHDFS sinkï¼‰ ç”¨æ¥è§£å†³å°æ–‡ä»¶é—®é¢˜ è®¾ç½®å¤§å°128Mã€æ—¶é—´ï¼ˆ1-2å°æ—¶ï¼‰ã€eventä¸ªæ•°ç¦æ­¢0 KafkaChannelï¼šåœ¨kafkaä¸­æ—¢å¯ä»¥ç”Ÿäº§è€…ä¹Ÿå¯ä»¥ä½œä¸ºæ¶ˆè´¹è€… ç”¨æ³•ï¼š source - kafkachannel - sink source - kafkachannelï¼ˆä½œä¸ºæ¶ˆè´¹è€…ï¼‰ kafkachannel - sinkï¼ˆä½œä¸ºç”Ÿäº§è€…ï¼‰ ä¸‰ä¸ªå™¨ï¼šï¼ˆæ‹¦æˆªå™¨ã€é€‰æ‹©å™¨ã€ç›‘æ§å™¨ï¼‰ æ‹¦æˆªå™¨ï¼šæ—¶é—´æˆ³æ‹¦æˆªå™¨ æˆ–è€… è‡ªå®šä¹‰æ‹¦æˆªå™¨ é€‰æ‹©å™¨ï¼šé»˜è®¤æ˜¯replicatingï¼ŒæŠŠæ•°æ®å‘å¾€ä¸‹ä¸€çº§æ‰€æœ‰é€šé“ ç›‘æ§å™¨ï¼šg, ç›‘æ§ putã€take äº‹åŠ¡å°è¯•æäº¤çš„æ¬¡æ•°è¿œè¿œå¤§äºæœ€ç»ˆæäº¤æˆåŠŸçš„æ¬¡æ•°ï¼Œè¯´æ˜ flume å¼‚å¸¸ã€‚è‡ªèº«ï¼šå¢åŠ å†…å­˜ï¼Œå…¶ä»–ï¼šå¢åŠ  flume å°æ•° ä¼˜åŒ–ï¼š file channel èƒ½é…ç½®å¤šç›®å½•å°±é…ç½®å¤šç›®å½•ï¼ˆä¸åŒç£ç›˜ï¼‰ ä½¿ç”¨ HDFS sink ç”¨æ¥è§£å†³å°æ–‡ä»¶é—®é¢˜ é€šè¿‡ç›‘æ§å™¨æ‰¾å¯»åŸå› ï¼Œå¢åŠ å†…å­˜å’Œå°æ•° æŒ‚äº†æ¢å¤ï¼š channel æŒ‚äº†ï¼šmemory channel 100ä¸ªevent æ•°æ®ä¸¢å¤±ã€‚ï¼ˆfile channel 100ä¸‡ä¸ªeventï¼Œæ²¡æœ‰ä¸¢å¤±é£é™©ï¼‰ taildir source æŒ‚äº†ï¼šä¸ä¼šä¸¢æ•°ï¼Œå¯èƒ½é‡å¤æ•°æ® ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:8","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Kafka åŸºæœ¬ä¿¡æ¯ï¼š ç»„æˆï¼š producerï¼š ACKï¼š0 1 -1 æ‹¦æˆªå™¨ï¼Œåºåˆ—åŒ–å™¨ï¼Œåˆ†åŒºå™¨ å‘é€æµç¨‹ å¹‚ç­‰æ€§ï¼Œäº‹åŠ¡ åˆ†åŒºè§„åˆ™ï¼š æœ‰æŒ‡å®šåˆ†åŒºåˆ™å‘å¾€æŒ‡å®šåˆ†åŒº ï¼›æ²¡æœ‰æŒ‡å®šåˆ†åŒºï¼Œåˆ™æ ¹æ®keyå€¼Hashï¼›æ²¡æœ‰æŒ‡å®šåˆ†åŒºä¹Ÿæ²¡æœ‰keyçš„æ—¶å€™ï¼Œè½®è¯¢ï¼ˆç²˜æ€§ï¼‰ brokerï¼š Topicï¼šå‰¯æœ¬ï¼ˆé«˜å¯é ï¼‰ ISRï¼šLEOã€HW åˆ†åŒºï¼ˆé«˜å¹¶å‘ï¼Œè´Ÿè½½å‡è¡¡ï¼Œé˜²æ­¢çƒ­ç‚¹ï¼‰ consumer åˆ†åŒºåˆ†é…è§„åˆ™ offsetä¿å­˜ï¼š é»˜è®¤ï¼š__consumer_offsetsä¸»é¢˜ã€‚ å…¶ä»–ï¼šæ‰‹åŠ¨ç»´æŠ¤Offsetï¼ˆMySQLï¼‰ ä¿å­˜æ•°æ®\u0026ä¿å­˜Offsetå†™åˆ°ä¸€ä¸ªäº‹ç‰© ç²¾å‡†ä¸€æ¬¡æ¶ˆè´¹ å…ˆä¿å­˜æ•°æ®åä¿å­˜Offset é‡å¤æ•°æ®+å¹‚ç­‰æ€§ï¼ˆç²¾å‡†ä¸€æ¬¡æ¶ˆè´¹ï¼‰ å…ˆä¿å­˜Offsetåä¿å­˜æ•°æ® ä¸¢å¤±æ•°æ® zkï¼šå­˜æ”¾ brokerï¼ˆid, topicï¼‰ï¼Œconsumerï¼ˆç›¸åº”çš„ offsetï¼‰ï¼Œæ²¡æœ‰ç”Ÿäº§è€…ä¿¡æ¯ å®‰è£…å°æ•°ï¼š2 * (ç”Ÿäº§è€…å³°å€¼ç”Ÿäº§é€Ÿç‡(å‹æµ‹) * å‰¯æœ¬ / 100) + 1, å…ˆä½¿ç”¨3å°æœºå™¨å‹æµ‹ å‰¯æœ¬æ•°ï¼šé€šå¸¸2ä¸ªå‰¯æœ¬ï¼Œé»˜è®¤1ä¸ªå‰¯æœ¬ã€‚å¤šï¼šå¯é æ€§é«˜ï¼Œä¼ è¾“æ€§èƒ½å·® æ•°æ®é‡ï¼š100ä¸‡æ—¥æ´» ä¸€äºº100æ¡ ä¸€æ¡1kã€‚ 1M/s æ•°æ®ä¿å­˜å¤šä¹…ï¼š3å¤© ç£ç›˜é¢„ç•™ï¼š100g(ä¸€å¤©æ•°æ®) * 2ä¸ªå‰¯æœ¬ * 3å¤© / 0.7 ç›‘æ§ï¼škafka egaleï¼šå¼€æºæ¡†æ¶ åˆ†åŒºï¼šæé«˜å¹¶å‘åº¦ï¼šå…ˆè®¾ç½®1ä¸ªï¼Œé€šè¿‡å‹æµ‹ç”Ÿäº§è€…å³°å€¼ç”Ÿäº§é€Ÿç‡tpã€æ¶ˆè´¹è€…å³°å€¼æ¶ˆè´¹é€Ÿç‡tc æœŸæœ›ååé‡t 100m/s åˆ†åŒºæ•° = t / min (tp, tc) åˆ†åŒºåˆ†é…ç­–ç•¥ï¼š range é»˜è®¤ roundrobin é‡‡ç”¨ roundrobin æ‰€æœ‰æ•°æ®é‡‡ç”¨ hash æ–¹å¼å¤§æ•£ï¼Œå†é‡‡ç”¨è½®è¯¢çš„æ–¹å¼æ‰§è¡Œ isrï¼šä¸»è¦è§£å†³leaderæŒ‚äº†è°å½“è€å¤§ï¼Œåœ¨ isr é˜Ÿåˆ—çš„éƒ½æœ‰æœºä¼šå½“è€å¤§ã€‚ å¤šå°‘ä¸ª topicï¼šæ»¡è¶³ä¸‹ä¸€çº§æ¶ˆè´¹è€…å³å¯ã€‚ æŒ‚äº†: çŸ­æœŸï¼šflume channel ç¼“å†²æ•°æ® é•¿æœŸï¼šæ—¥å¿—æœåŠ¡å™¨ä¿ç•™30å¤©æ—¥å¿— ä¸¢ï¼šack é…ç½®å‚æ•° 0ï¼šå‘é€æ•°æ®ï¼Œä¸éœ€è¦åº”ç­”ã€‚å¯é æ€§æœ€å·®ï¼Œä¼ è¾“æ€§èƒ½æœ€å¥½ã€‚ 1ï¼šå‘é€æ•°æ®ï¼Œleader åº”ç­”ã€‚å¯é æ€§ä¸€èˆ¬ï¼Œä¼ è¾“æ€§èƒ½ä¸€èˆ¬ã€‚ -1ï¼šå‘é€æ•°æ®ï¼Œleader å’Œ follower å…±åŒåº”ç­”ã€‚å¯é æ€§æœ€é«˜ï¼Œä¼ è¾“æ€§èƒ½æœ€å·®ã€‚ ä¼ä¸šä¸­ï¼š0å‡ ä¹ä¸ç”¨ï¼Œä¸å¤ªé‡è¦1ï¼Œé‡è¦-1 é‡å¤ï¼š é‡‡ç”¨ äº‹åŠ¡ã€å¹‚ç­‰æ€§ã€ack = -1 å¹‚ç­‰æ€§ï¼šå•åˆ†åŒºå•ä¼šè¯å†…æ•°æ®ä¸é‡å¤ äº‹åŠ¡ï¼šæ¯æ¡æ•°æ®æ¯”è¾ƒï¼Œå¯ä»¥æ¯”è¾ƒå¤šä¸ªåˆ†åŒº äº‹åŠ¡ï¼š åœ¨ä¸‹ä¸€çº§å¤„ç†ï¼š ç§¯å‹ï¼škafka ä¿å­˜æ•°æ®çš„æ—¶é—´æ˜¯æœ‰é™çš„ï¼Œæ²¡æœ‰åŠæ—¶æ¶ˆè´¹å®Œ å¢åŠ åˆ†åŒºï¼ŒåŒæ—¶å¢åŠ æ¶ˆè´¹è€…å¯¹åº”çš„CPUæ ¸æ•° å¢åŠ æ¶ˆè´¹è€… batchsize ä¼˜åŒ–ï¼š æ—¥å¿—ä¿å­˜3å¤© å¢åŠ ç½‘ç»œé€šä¿¡å»¶è¿Ÿæ—¶é—´ é«˜æ•ˆè¯»å†™åŸå› ï¼š é›†ç¾¤ï¼Œåˆ†åŒº é¡ºåºè¯»å†™600m/s(vip)ï¼Œéšæœºè¯»å†™100m/s é›¶æ‹·è´ ä¼ è¾“ä¸€æ¡2mæ—¥å¿—æ–‡ä»¶ï¼Œç°è±¡ï¼šå¡ä½ã€‚è°ƒæ•´ä¸¤ä¸ªå‚æ•°å¤§å° æ•°æ®è¿‡æœŸï¼šåˆ é™¤ æˆ–è€… å‹ç¼©ï¼Œé€šå¸¸åˆ é™¤ï¼Œå‰¯æœ¬å¤‡ä»½30å¤©æ•°æ® ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:9","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Hive ç»„æˆï¼š hive_structure å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨åŒºåˆ«ï¼š å†…éƒ¨è¡¨åˆ é™¤æ•°æ®ï¼šå…ƒæ•°æ®ã€åŸå§‹æ•°æ® åˆ æ‰ å¤–è¡¨åˆ æ•°æ®ï¼šå…ƒæ•°æ®åˆ æ‰ï¼ŒåŸå§‹æ•°æ®ä¿ç•™ åªæœ‰è‡ªå·±ä¸´æ—¶ä½¿ç”¨è¡¨ï¼Œåˆ›å»ºå†…éƒ¨è¡¨ã€‚ç»å¤§éƒ¨åˆ†åœºæ™¯éƒ½æ˜¯å¤–éƒ¨è¡¨ 4ä¸ªbyï¼š order byï¼šå…¨å±€æ’åº ï¼ˆåªæœ‰ä¸€ä¸ªreduce taskï¼Œæ•°æ®å€¾æ–œï¼Œèµ„æºåˆ†é…ä¸è¶³ï¼‰ä¸ä½¿ç”¨ sort byï¼šå±€éƒ¨æ’åºï¼Œåªä¿è¯æ¯ä¸ª reducer task è¾“å‡ºæœ‰åº distribute byï¼šåˆ†æ¡¶ï¼Œå–ä½™åˆ†ç»„ï¼Œæ²¡æœ‰æ’åº cluster byï¼š distribute by + sort by è‡ªå®šä¹‰å‡½æ•°ï¼š è‡ªå®šä¹‰udfå‡½æ•°æ­¥éª¤ï¼š 1è¿›1å‡ºï¼Œä¸€è¡Œï¼Œå®šä¹‰ç±» ç»§æ‰¿udfï¼Œé‡å†™ evaluate æ–¹æ³• è‡ªå®šä¹‰udtfå‡½æ•°æ­¥éª¤ï¼šå¤šè¿›å¤šå‡ºï¼Œç»§æ‰¿ udtfï¼Œé‡å†™ä¸‰ä¸ªæ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼ˆå®šä¹‰åç§°ã€æ ¡éªŒè¿”å›å€¼ç±»å‹ï¼‰ã€closeã€processï¼‰ã€‚æ‰“åŒ…+ä¸Šä¼ hdfs+åœ¨hiveå®¢æˆ·ç«¯åˆ›å»º çª—å£å‡½æ•°ï¼šrankã€overã€topn ä¼˜åŒ–ï¼š è¡Œåˆ—è¿‡æ»¤ï¼šjoin -\u003e where =\u003e where -\u003e join åˆ†åŒº å°æ–‡ä»¶ï¼šcombineHiveInputformat æˆ–è€… JVMé‡ç”¨ æˆ–è€… merge å‹ç¼© ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:3:10","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®ä»“åº“ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:4:0","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®åˆ†å±‚ ODSï¼ˆOperation Data Storeï¼‰åŸå§‹æ•°æ®å±‚ï¼šå­˜æ”¾åŸå§‹æ•°æ®ï¼Œèµ·åˆ°å¤‡ä»½çš„ä½œç”¨ DWDï¼ˆData Warehouse Detailï¼‰æ˜ç»†æ•°æ®å±‚ï¼šæ¸…æ´—ï¼Œå»ç©ºï¼Œå»è„æ•°æ®ï¼Œç»´åº¦é€€åŒ– DWSï¼ˆDW serviceï¼‰æŒ‰å¤©è¿›è¡Œè½»åº¦æ±‡æ€» DWTï¼ˆDW Topicï¼‰æŒ‰ä¸»é¢˜è¿›è¡Œæ±‡æ€» ADSï¼ˆApplication Data Storeï¼‰ä¸ºå„ç§ç»Ÿè®¡æŠ¥è¡¨æä¾›æ•°æ® ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:4:1","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°ä»“å»ºæ¨¡ ODSå±‚ï¼š åˆ›å»ºæ”¯æŒLZOå‹ç¼©çš„è¡¨ï¼šå‡å°‘å­˜å‚¨ç©ºé—´ï¼Œ100g -\u003e 10g - 5g(å–å†³äºæ–‡ä»¶æ ¼å¼ï¼Œæ¯”å¦‚JSONçš„åµŒå¥—æ–¹å¼ï¼ŒCSVçš„åˆ—æ•°é‡) åˆ›å»ºåˆ†åŒºè¡¨ï¼šé˜²æ­¢å…¨è¡¨æ‰«æï¼ˆå¯¼æ•°æ®ï¼šå…¨é‡ã€å¢é‡ã€æ–°å¢å’Œå˜åŒ–ï¼‰ ä¿æŒæ•°æ®åŸè²Œä¸åšä»»ä½•ä¿®æ”¹ï¼Œèµ·åˆ°å¤‡ä»½æ•°æ®çš„ä½œç”¨ DWDå±‚ï¼šğŸ”¶ é€‰æ‹©ä¸šåŠ¡è¿‡ç¨‹ -\u003e å£°æ˜ç²’åº¦ -\u003e ç¡®è®¤ç»´åº¦ -\u003e ç¡®è®¤äº‹å® ä¸šåŠ¡è¿‡ç¨‹ï¼šå“ªäº›åè®®éœ€è¦åšå¤„ç† å£°æ˜ç²’åº¦ï¼šç²’åº¦å¯ä»¥æ˜¯å¤©ã€ä¸€äººã€åŒºåŸŸ ç¡®è®¤ç»´åº¦ï¼šæ—¶é—´ç»´åº¦ã€åœ°åŒºç»´åº¦ã€ç”¨æˆ·ç»´åº¦ ç¡®è®¤äº‹å®ï¼šä¸šåŠ¡ä¸­çš„åº¦é‡å€¼ï¼ˆæ¬¡æ•°ã€ä¸ªæ•°ã€ä»¶æ•°ã€é‡‘é¢ã€å¯ä»¥è¿›è¡Œç´¯åŠ ï¼‰ DWSå±‚ï¼š å¯¹å„ä¸ªä¸»é¢˜å¯¹è±¡è¿›è¡Œç»Ÿè®¡ï¼šå¤©ã€æœˆã€å¹´ã€åœ°åŒºã€ç”¨æˆ· DWTå±‚ï¼š ç»Ÿè®¡ç´¯è®¡è¡Œä¸ºï¼šä»å¼€å§‹åˆ°ç»“æŸï¼Œæ€»ç»“è¡¨ ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:4:2","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"æ•°æ®å¤„ç† æ•°æ®å¤„ç†å¤§è‡´åˆ†ä¸ºä¸¤å¤§ç±»ï¼š OLTPï¼ˆon-line transaction processingï¼‰è”æœºäº‹åŠ¡å¤„ç† OLAPï¼ˆon-line Analytical Processingï¼‰è”æœºåˆ†æå¤„ç† ","date":"2021-01-08","objectID":"/20210108_dw-behavior-collection/:4:3","tags":["DataWarehouse","Tuning"],"title":"Data Warehouse: Offline Tuning","uri":"/20210108_dw-behavior-collection/"},{"categories":["Technology"],"content":"Article description.","date":"2020-12-15","objectID":"/20201215_parquet-format/","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"Apache Parquet is designed for efficient as well as performant flat columnar storage format of data compared to row based files like CSV or TSV files. Parquet uses the record shredding and assembly algorithm which is superior to simple flattening of nested namespaces. Parquet is optimized to work with complex data in bulk and features different ways for efficient data compression and encoding types. This approach is best especially for those queries that need to read certain columns from a large table. Parquet can only read the needed columns therefore greatly minimizing the IO. HDFS é»˜è®¤å­˜çš„æ˜¯æ–‡æœ¬æ ¼å¼ï¼Œæ‰€ä»¥ hive, presto éƒ½æ˜¯åœ¨æ–‡æœ¬æ ¼å¼ä¸Šåšè®¡ç®—ï¼Œhadoopæœ¬èº«æ˜¯å…¨è¡¨æ‰«ï¼Œåªæ˜¯åˆ†å¸ƒå¼è€Œä»¥ï¼Œæ‰€ä»¥ä¹‹å‰ä½¿ç”¨çš„å°±æ˜¯åˆ†å¸ƒå¼çš„å…¨è¡¨æ‰«ï¼Œæ²¡æœ‰å‘æŒ¥å‡ºæ•°æ®ä»“åº“è¯¥æœ‰çš„åŠŸèƒ½,åˆ—å¼å­˜å‚¨ï¼Œå¤©ç„¶æ“…é•¿åˆ†æï¼Œåƒä¸‡çº§åˆ«çš„è¡¨ï¼Œcountï¼Œsumï¼Œgroup by ï¼Œç§’å‡ºç»“æœã€‚ ","date":"2020-12-15","objectID":"/20201215_parquet-format/:0:0","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"1ã€åœºæ™¯æè¿° å¯¹å®¢æˆ·æ—¥å¿—åšäº†æ•°æ®ä»“åº“ï¼Œä½†å®é™…ä¸šåŠ¡ä½¿ç”¨ä¸­æœ‰ä¸€äº›ä¸ªå…±åŒç‚¹ï¼Œ A éœ€è¦å…³è”ç»´åº¦è¡¨ B æœ€ç»ˆä»…å–æŸä¸ªäº§å“ä¸€æ®µæ—¶é—´å†…çš„æ•°æ® C åªå…³æ³¨å…¶ä¸­æå°‘çš„å­—æ®µ åŸºäºä»¥ä¸Šä¸šåŠ¡ï¼Œæˆ‘ä»¬å†³å®šæ¯å¤©å®šæ—¶ç»Ÿä¸€å…³è”ç»´åº¦è¡¨ï¼Œå¯¹å…³è”åçš„æ•°æ®è¿›è¡Œå¦å¤–å­˜å‚¨ã€‚å„ä¸ªä¸šåŠ¡ç›´æ¥ä½¿ç”¨å…³è”åçš„æ•°æ®è¿›è¡Œç¦»çº¿è®¡ç®—ã€‚ ","date":"2020-12-15","objectID":"/20201215_parquet-format/:1:0","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"2ã€é€‰æ‹© parquet çš„å¤–éƒ¨å› ç´  åœ¨å„ç§åˆ—å­˜å‚¨ä¸­ï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹© parquet çš„åŸå› æœ‰è®¸å¤šã€‚é™¤äº† parquet è‡ªèº«çš„ä¼˜ç‚¹ï¼Œè¿˜æœ‰ä»¥ä¸‹å› ç´ ï¼š Aã€å…¬å¸å½“æ—¶å·²ç»ä¸Šçº¿spark é›†ç¾¤ï¼Œè€Œsparkå¤©ç„¶æ”¯æŒparquetï¼Œå¹¶ä¸ºå…¶æ¨èçš„å­˜å‚¨æ ¼å¼(é»˜è®¤å­˜å‚¨ä¸ºparquet)ã€‚ Bã€hive æ”¯æŒ parquet æ ¼å¼å­˜å‚¨ï¼Œå¦‚æœä»¥åä½¿ç”¨hivesql è¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå®Œå…¨å…¼å®¹ã€‚ ","date":"2020-12-15","objectID":"/20201215_parquet-format/:2:0","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"3ã€é€‰æ‹© parquet çš„å†…åœ¨åŸå›  ä¸‹é¢é€šè¿‡å¯¹æ¯” parquet å’Œ csv è¯´è¯´ parquet è‡ªèº«éƒ½æœ‰å“ªäº›ä¼˜åŠ¿ csvåœ¨hdfsä¸Šå­˜å‚¨çš„å¤§å°ä¸å®é™…æ–‡ä»¶å¤§å°ä¸€æ ·ã€‚è‹¥è€ƒè™‘å‰¯æœ¬ï¼Œåˆ™ä¸ºå®é™…æ–‡ä»¶å¤§å°*å‰¯æœ¬æ•°ç›®ã€‚ï¼ˆè‹¥æ²¡æœ‰å‹ç¼©ï¼‰ 3.1 parqueté‡‡ç”¨ä¸åŒå‹ç¼©æ–¹å¼çš„å‹ç¼©æ¯” è¯´æ˜ï¼šåŸå§‹æ—¥å¿—å¤§å°ä¸º214Gå·¦å³ï¼Œ120å¤šçš„å­—æ®µ é‡‡ç”¨csvï¼ˆéå‹ç¼©æ¨¡å¼ï¼‰å‡ ä¹æ²¡æœ‰å‹ç¼©ã€‚ é‡‡ç”¨ parquet éå‹ç¼©æ¨¡å¼ã€gzipã€snappyæ ¼å¼å‹ç¼©ååˆ†åˆ«ä¸º17.4Gã€8.0Gã€11Gï¼Œè¾¾åˆ°çš„å‹ç¼©æ¯”åˆ†åˆ«æ˜¯ï¼š12ã€27ã€19ã€‚ csv parquet éå‹ç¼© parquet gzip parquet snappy å­˜å‚¨å¤§å° 214G 17.4G 8.0G 11G å‹ç¼©æ¯”ä¾‹ 12 27 19 è‹¥æˆ‘ä»¬åœ¨ hdfs ä¸Šå­˜å‚¨3ä»½ï¼Œå‹ç¼©æ¯”ä»è¾¾åˆ°4ã€9ã€6å€ 3.2 åˆ†åŒºè¿‡æ»¤ä¸åˆ—ä¿®å‰ª 3.2.1åˆ†åŒºè¿‡æ»¤ parquetç»“åˆsparkï¼Œå¯ä»¥å®Œç¾çš„å®ç°æ”¯æŒåˆ†åŒºè¿‡æ»¤ã€‚å¦‚ï¼Œéœ€è¦æŸä¸ªäº§å“æŸæ®µæ—¶é—´çš„æ•°æ®ï¼Œåˆ™hdfsåªå–è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚ spark sqlã€rdd ç­‰çš„filterã€whereå…³é”®å­—å‡èƒ½è¾¾åˆ°åˆ†åŒºè¿‡æ»¤çš„æ•ˆæœã€‚ ä½¿ç”¨sparkçš„partitionBy å¯ä»¥å®ç°åˆ†åŒºï¼Œè‹¥ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œåˆ™åˆ›å»ºå¤šçº§åˆ†åŒºã€‚ç¬¬ä¸€ä¸ªå­—æ®µä½œä¸ºä¸€çº§åˆ†åŒºï¼Œç¬¬äºŒä¸ªå­—æ®µä½œä¸º2çº§åˆ†åŒºã€‚ã€‚ã€‚ã€‚ã€‚ 3.2.2 åˆ—ä¿®å‰ª åˆ—ä¿®å‰ªï¼šå…¶å®è¯´ç®€å•ç‚¹å°±æ˜¯æˆ‘ä»¬è¦å–å›çš„é‚£äº›åˆ—çš„æ•°æ®ã€‚ å½“å–å¾—åˆ—è¶Šå°‘ï¼Œé€Ÿåº¦è¶Šå¿«ã€‚å½“å–æ‰€æœ‰åˆ—çš„æ•°æ®æ—¶ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„120åˆ—æ•°æ®ï¼Œè¿™æ—¶æ•ˆç‡å°†æä½ã€‚åŒæ—¶ï¼Œä¹Ÿå°±å¤±å»äº†ä½¿ç”¨parquetçš„æ„ä¹‰ã€‚ 3.2.3 åˆ†åŒºè¿‡æ»¤ä¸åˆ—ä¿®å‰ªæµ‹è¯•å¦‚ä¸‹ï¼š è¯´æ˜ï¼š Aã€taskæ•°ã€inputå€¼ã€è€—æ—¶å‡ä¸ºspark web uiä¸Šçš„çœŸå®æ•°æ®ã€‚ Bã€ä¹‹æ‰€ä»¥æ²¡æœ‰éªŒè¯csvè¿›è¡Œå¯¹æ¯”ï¼Œæ˜¯å› ä¸ºå½“200å¤šGï¼Œæ¯æ¡è®°å½•ä¸º120å­—æ®µæ—¶ï¼Œcsvè¯»å–ä¸€ä¸ªå­—æ®µç®—ä¸ªcountå°±ç›´æ¥lost excuteräº†ã€‚ Cã€æ³¨æ„ï¼šä¸ºé¿å…è‡ªåŠ¨ä¼˜åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“å°äº†æ¯æ¡è®°å½•æ¯ä¸ªå­—æ®µçš„å€¼ã€‚ï¼ˆä»¥ä¸Šè€—æ—¶ä¼°è®¡æœ‰å¤šéƒ¨åˆ†æ˜¯è€—åœ¨è¿™é‡Œäº†ï¼‰ Dã€é€šè¿‡ä¸Šå›¾å¯¹æ¯”å¯ä»¥å‘ç°ï¼š å½“æˆ‘ä»¬å–å‡ºæ‰€æœ‰è®°å½•æ—¶ï¼Œä¸‰ç§å‹ç¼©æ–¹å¼è€—æ—¶å·®åˆ«ä¸å¤§ã€‚è€—æ—¶å¤§æ¦‚7åˆ†é’Ÿã€‚ å½“æˆ‘ä»¬ä»…å–å‡ºæŸä¸€å¤©æ—¶ï¼Œparquetçš„åˆ†åŒºè¿‡æ»¤ä¼˜åŠ¿ä¾¿æ˜¾ç¤ºå‡ºæ¥ã€‚ä»…ä¸º6åˆ†ä¹‹ä¸€å·¦å³ã€‚è²Œä¼¼å½“æ—¶å…¨é‡ä¸ºä¸ƒå…«å¤©å·¦å³å§ã€‚ å½“æˆ‘ä»¬ä»…å–æŸä¸€å¤©çš„ä¸€ä¸ªå­—æ®µæ—¶ï¼Œæ—¶é—´å°†å†æ¬¡ç¼©çŸ­ã€‚è¿™æ—¶ï¼Œç¡¬ç›˜å°†åªæ‰«æè¯¥åˆ—æ‰€åœ¨rowgroupçš„æŸ±é¢ã€‚å¤§å¤§èŠ‚çœIOã€‚å¦‚æœ‰å…´è¶£ï¼Œå¯ä»¥å‚è€ƒ æ·±å…¥åˆ†æParquetåˆ—å¼å­˜å‚¨æ ¼å¼ Eã€æµ‹è¯•æ—¶è¯·å¼€å¯filterpushdownåŠŸèƒ½ ","date":"2020-12-15","objectID":"/20201215_parquet-format/:3:0","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"4ã€ç»“è®º parquetçš„gzipçš„å‹ç¼©æ¯”ç‡æœ€é«˜ï¼Œè‹¥ä¸è€ƒè™‘å¤‡ä»½å¯ä»¥è¾¾åˆ°27å€ã€‚å¯èƒ½è¿™ä¹Ÿæ˜¯spar parqueté»˜è®¤é‡‡ç”¨gzipå‹ç¼©çš„åŸå› å§ã€‚ åˆ†åŒºè¿‡æ»¤å’Œåˆ—ä¿®å‰ªå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤§å¹…èŠ‚çœç£ç›˜IOã€‚ä»¥å‡è½»å¯¹æœåŠ¡å™¨çš„å‹åŠ›ã€‚ å¦‚æœä½ çš„æ•°æ®å­—æ®µéå¸¸å¤šï¼Œä½†å®é™…åº”ç”¨ä¸­ï¼Œæ¯ä¸ªä¸šåŠ¡ä»…è¯»å–å…¶ä¸­å°‘é‡å­—æ®µï¼Œparquetå°†æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚ ","date":"2020-12-15","objectID":"/20201215_parquet-format/:4:0","tags":["Spark","Hdfs","Hive"],"title":"HDFS: Parquet Format","uri":"/20201215_parquet-format/"},{"categories":["Technology"],"content":"Article description.","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"A high performance columnar OLAP database management system for real-time analytics using SQL. ClickHouse can be customized with a new set of efficient columnar storage engines, and has realized rich functions such as data ordered storage, primary key indexing, sparse indexing, data sharding, data partitioning, TTL, and primary and backup replication. ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:0:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Feature Yandexï¼Œåˆ—å¼å­˜å‚¨æ•°æ®åº“ï¼Œåœ¨çº¿åˆ†æå¤„ç†æŸ¥è¯¢ï¼ˆOLAPï¼‰ï¼ŒSQLæŸ¥è¯¢å®æ—¶ç”Ÿæˆåˆ†ææ•°æ®æŠ¥å‘Šã€‚ åˆ—å¼å­˜å‚¨ id1 id2 id3 name1 name2 name3 value1 value2 value3 æ›´æ“…é•¿åš countã€sum ã€èšåˆç­‰æ“ä½œï¼Œä¼˜äºè¡Œå¼å­˜å‚¨ã€‚ å‹ç¼©æ•ˆç‡é«˜ã€‚ç”±äºæŸä¸€åˆ—çš„æ•°æ®ç±»å‹éƒ½æ˜¯ç›¸åŒçš„ï¼Œé’ˆå¯¹äºæ•°æ®å­˜å‚¨æ›´å®¹æ˜“è¿›è¡Œæ•°æ®å‹ç¼©ï¼Œæ¯ä¸€åˆ—é€‰æ‹©æ›´ä¼˜çš„æ•°æ®å‹ç¼©ç®—æ³•ï¼Œå¤§å¤§æé«˜äº†æ•°æ®å‹ç¼©çš„æ¯”é‡ã€‚ OLAP OLAPï¼šæ›´æ“…é•¿ä¸€æ¬¡å†™å…¥ï¼Œå¤šæ¬¡è¯»å–ã€‚æ›´åå‘äºæŸ¥æ•°æ® OLTPï¼šæ›´åå‘äºå¢åˆ æ”¹æŸ¥æ•°æ® é«˜ååçš„å†™å…¥èƒ½åŠ› ä¸ HBASE çš„å­˜å‚¨ç»“æ„ç›¸ä¼¼ï¼ŒClickHouse é‡‡ç”¨ç±» LSM Tree çš„ç»“æ„ï¼Œæ•°æ®å†™å…¥åå®šæœŸåœ¨åå° compaction æ“ä½œã€‚é€šè¿‡ç±» LSM treeçš„ç»“æ„ï¼ŒClickHouse åœ¨æ•°æ®å¯¼å…¥æ—¶å…¨éƒ¨æ˜¯é¡ºåº append å†™ï¼Œå†™å…¥åæ•°æ®æ®µä¸å¯æ›´æ”¹ï¼Œåœ¨åå° compaction æ—¶ä¹Ÿæ˜¯å¤šä¸ªæ®µ merge sort åé¡ºåºå†™å›ç£ç›˜ã€‚é¡ºåºå†™çš„ç‰¹æ€§ï¼Œå……åˆ†åˆ©ç”¨äº†ç£ç›˜çš„ååèƒ½åŠ›ï¼Œç£ç›˜çš„ååèƒ½åŠ›ï¼Œå³ä¾¿åœ¨ HDD ä¸Šä¹Ÿæœ‰ç€ä¸é”™çš„å†™å…¥æ€§èƒ½ã€‚ æ•°æ®åˆ†åŒºä¸çº¿ç¨‹çº§å¹¶è¡Œ åˆ†åŒºå’Œåˆ‡ç‰‡ä¸åŒï¼Œåˆ†åŒºæ˜¯å°†æ•°æ®åˆ†ä¸ºå¤šä¸ª partitionï¼Œæ¯ä¸ª partition å†è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºå¤šä¸ª index granularity (ç´¢å¼•ç²’åº¦)ï¼Œç„¶åé€šè¿‡ CPU çš„å¤šæ ¸åˆ†åˆ«å¤„ç†å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ¥å®ç°å¹¶è¡Œæ•°æ®å¤„ç†ã€‚å•æ¡ query æŸ¥è¯¢å°±èƒ½åˆ©ç”¨æ•´æœºæ‰€æœ‰ CPUã€‚ æè‡´çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼Œæå¤§çš„é™ä½äº†æŸ¥è¯¢å»¶æ—¶ã€‚ æ‰€ä»¥ä¹Ÿä¸åˆ©äºå¤šæ¡å¹¶å‘æŸ¥è¯¢ï¼Œå¯¹äºé«˜ qps çš„æŸ¥è¯¢ä¸šåŠ¡ä¸æ˜¯ CH çš„å¼ºé¡¹ã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:1:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Data Type MySQL Hive ClickHouse(åŒºåˆ†å¤§å°å†™) byte tinyint Int8 short smallint Int16 int bigint Int64 timestamp timestamp DataTime â€¦ â€¦ â€¦ æšä¸¾ æ•°æ®ç±»å‹ä¸­ æ²¡æœ‰å¸ƒå°”å€¼ï¼Œå¯ä»¥é€šè¿‡æšä¸¾ä»£æ›¿ã€‚ åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªæšä¸¾ Enum8(â€™trueâ€™ = 1, â€˜falseâ€™ = 2) ç±»å‹çš„åˆ—ï¼š CREATE TABLE t_enum ( x Enum8('true' = 1, 'false' = 2) ) ENGINE = TineLog # t_enum è¡¨åªå¯ä»¥æ”¾ trueã€falseã€1ã€2 å†…å®¹ æ•°ç»„ Array(T)ï¼Œä¸æ¨èä½¿ç”¨å¤šç»´æ•°ç»„ï¼Œå¯¹å¤šç»´æ•°ç»„çš„æ”¯æŒæœ‰é™ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½åœ¨ MergeTree è¡¨ä¸­å­˜å‚¨å¤šç»´æ•°ç»„ã€‚ å¯ä»¥ä½¿ç”¨ array(T) æˆ– [] åˆ›å»ºæ•°ç»„ SELECT array(1, 2) AS arr, toTypeName(arr) å…ƒç»„ Tuple(T1, T2, â€¦)ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰å•ç‹¬çš„ç±»å‹ SELECT array(1, 'a') AS arr, toTypeName(arr) ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:2:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Table Engineâ­ MySQL é»˜è®¤çš„å¼•æ“ï¼šInnoDB æ˜¯äº‹åŠ¡å‹æ•°æ®åº“çš„é¦–é€‰å¼•æ“ï¼Œæ”¯æŒäº‹åŠ¡å®‰å…¨è¡¨ï¼ˆACIDï¼‰ã€‚ ä½¿ç”¨äºŒåç§è¡¨å¼•æ“å†³å®šäº†ï¼š æ•°æ®å­˜å‚¨æ–¹å¼å’Œä½ç½®ï¼Œå†™åˆ°å†…å­˜è¿˜æ˜¯ç£ç›˜ æ”¯æŒå“ªäº›æŸ¥è¯¢ä»¥åŠå¦‚ä½•æ”¯æŒ å¹¶å‘è®¿é—®æ•°æ® ç´¢å¼•çš„ä½¿ç”¨ æ˜¯å¦å¤šçº¿ç¨‹è¯·æ±‚ æ•°æ®å¤åˆ¶å‚æ•° ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"1. TinyLog æœ€ç®€å•çš„è¡¨å¼•æ“ï¼Œç”¨äºå°†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚æ¯åˆ—éƒ½å­˜å‚¨åœ¨å•ç‹¬çš„å‹ç¼©æ–‡ä»¶ä¸­ï¼Œå†™å…¥æ—¶ï¼Œæ•°æ®å°†é™„åŠ åˆ°æ–‡ä»¶æœ«å°¾ã€‚ ç£ç›˜ ä¸æ”¯æŒç´¢å¼• ä¸æ”¯æŒå¹¶å‘å†™ï¼Œä¸æ”¯æŒä¸€è¾¹è¯»ä¸€è¾¹å†™ create tabele t (a UInt16, b String) engine = TinyLog ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:1","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"2. Memory å†…å­˜å¼•æ“ï¼Œé‡å¯æ•°æ®å°±ä¼šæ¶ˆå¤±ï¼Œè¯»å†™ä¸äº’ç›¸é˜»å¡ï¼Œä¸æ”¯æŒç´¢å¼•ã€‚ç®€å•æŸ¥è¯¢æ€§èƒ½è¡¨ç°è¶…è¿‡ 10 G/sã€‚æµ‹è¯•åœºæ™¯æˆ–æ•°æ®é‡åˆä¸å¤ªå¤§çš„åœºæ™¯ï¼ˆä¸Šé™å¤§çº¦ 1 äº¿è¡Œï¼‰ã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:2","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"3. Merge ï¼ˆä¸è¦å’Œ MergeTree å¼•æ“æ··æ·†ï¼‰æœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œä½†å¯ç”¨äºåŒæ—¶ä»ä»»æ„å¤šä¸ªå…¶ä»–çš„è¡¨ä¸­è¯»å–æ•°æ®ï¼Œè¯»æ˜¯è‡ªåŠ¨å¹¶è¡Œçš„ï¼Œä¸æ”¯æŒå†™å…¥ã€‚è¯»æ•°æ®æ—¶ï¼Œé‚£äº›è¢«çœŸæ­£è¯»å–åˆ°æ•°æ®çš„è¡¨çš„ç´¢å¼•ä¼šè¢«ä½¿ç”¨ã€‚ create table t(id UInt16, name String) engine = Merge(currentDatabase(), '^t'); ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:3","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"4. MergeTree (é‡ç‚¹) clickhouse ä¸­æœ€å¼ºå¤§çš„è¡¨å¼•æ“ï¼Œå½“å·¨é‡æ•°æ®è¦æ’å…¥åˆ°è¡¨ä¸­ï¼Œéœ€è¦é«˜æ•ˆåœ°ä¸€æ‰¹æ‰¹å†™å…¥æ•°æ®ç‰‡æ®µï¼Œå¹¶å¸Œæœ›è¿™äº›æ•°æ®ç‰‡æ®µåœ¨åå°æŒ‰ç…§ä¸€å®šè§„åˆ™åˆå¹¶ã€‚ç›¸æ¯”æ’å…¥æ—¶ä¸æ–­ä¿®æ”¹ï¼ˆé‡å†™ï¼‰æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œè¿™ç§ç­–ç•¥ä¼šé«˜æ•ˆå¾ˆå¤šã€‚ æ•°æ®æŒ‰ç…§ä¸»é”®æ’åº å¯ä»¥ä½¿ç”¨åˆ†åŒºï¼ˆå¦‚æœæŒ‡å®šäº†ä¸»é”®ï¼‰ æ”¯æŒæ•°æ®å‰¯æœ¬ æ”¯æŒæ•°æ®é‡‡æ · å»ºè¡¨å‚æ•° ENGINE = MergeTree() -[PARTITION BY]: åˆ†åŒºé”®ã€‚ ä½œç”¨ï¼šä¸ hive çš„åˆ†åŒºç›¸åŒï¼Œç›®çš„ä¸»è¦æ˜¯é™ä½æ‰«æçš„èŒƒå›´ï¼Œä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦ã€‚ é»˜è®¤ï¼šä¸ºä¸€ä¸ªåˆ†åŒºã€‚ åˆ†åŒºç›®å½•ï¼šMergeTree æ˜¯ä»¥åˆ—æ–‡ä»¶ + ç´¢å¼•æ–‡ä»¶ + è¡¨å®šä¹‰æ–‡ä»¶ç»„æˆçš„ï¼Œå¦‚æœè®¾å®šäº†åˆ†åŒºé‚£ä¹ˆè¿™äº›æ–‡ä»¶å°±ä¼šä¿å­˜åˆ°ä¸åŒçš„åˆ†åŒºç›®å½•ä¸­ã€‚(tip: è¦æŒ‰æœˆåˆ†åŒºï¼Œå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ toYYYYMM(data_column) ) å¹¶è¡Œï¼šè·¨åˆ†åŒºçš„æŸ¥è¯¢ç»Ÿè®¡ï¼ŒCH ä¼šä»¥åˆ†åŒºä¸ºå•ä½å¹¶è¡Œå¤„ç†ã€‚ å†™å…¥å’Œåˆ†åŒºåˆå¹¶ï¼šä»»ä½•ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®å†™å…¥éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶çš„åˆ†åŒºï¼Œä¸ä¼šçº³å…¥ä»»ä½•å·²æœ‰çš„åˆ†åŒºã€‚åå‡ åˆ†é’Ÿå CH ä¼šè‡ªåŠ¨æ‰§è¡Œåˆå¹¶æ“ä½œã€‚æˆ–æ‰‹åŠ¨åˆå¹¶ optimize table x final; é€šå¸¸æŒ‰å¤©åˆ†åŒºæ¯”è¾ƒåˆé€‚ã€‚ -[PRIMARY KEY]: ä¸»é”®ã€‚ ä¸å…¶ä»–æ•°æ®åº“ä¸åŒï¼Œå®ƒåªæä¾›äº†æ•°æ®çš„ä¸€çº§ç´¢å¼•ï¼Œä½†å´ä¸æ˜¯å”¯ä¸€çº¦æŸã€‚å¯ä»¥æœ‰ç›¸åŒçš„ key æ•°æ®ã€‚ ä¸»é”®çš„è®¾å®šä¾æ®æŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢æœ€é¢‘ç¹çš„å­—æ®µä½œä¸º ä¸»é”®ã€‚æ ¹æ®æ¡ä»¶é€šè¿‡å¯¹ä¸»é”®è¿›è¡ŒæŸç§å½¢å¼çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œèƒ½å¤Ÿå®šä½åˆ°å¯¹åº”çš„ index granularityï¼Œé¿å…äº†å…¨è¡¨æ‰«æã€‚ index_granularity: ç¨€ç–ç´¢å¼•ï¼Œç´¢å¼•ç²’åº¦ï¼Œå³ç´¢å¼•ä¸­ç›¸é‚»ã€æ ‡è®°ã€‘é—´çš„æ•°æ®è¡Œæ•°ï¼Œé»˜è®¤ 8192 è¡Œä¸€ä¸ªç´¢å¼•ã€‚è¿™å°±è¦æ±‚å­—æ®µæœ‰åº ORDER BY: è¡¨çš„æ’åºé”®ï¼Œå¯ä»¥æ˜¯ä¸€ç»„åˆ—çš„å…ƒç»„æˆ–ä»»æ„çš„è¡¨è¾¾å¼ã€‚ è®¾å®š åˆ†åŒºå†… çš„æ•°æ®æŒ‰ç…§å“ªäº›å­—æ®µé¡ºåºè¿›è¡Œæœ‰åºä¿å­˜ã€‚ ORDER BY æ˜¯ MergeTree ä¸­å”¯ä¸€ä¸€ä¸ªå¿…é¡»é¡¹ï¼Œæ¯” primary key æ›´é‡è¦ï¼Œæ²¡æœ‰ä¸»é”®ä¾ç…§ order by çš„å­—æ®µè¿›è¡Œå¤„ç†ï¼ˆæ¯”å¦‚å»é‡æ±‡æ€»ï¼‰ ä¸»é”®å¿…é¡»æ˜¯ order by å­—æ®µçš„å‰ç¼€å­—æ®µ ï¼Œå¦‚ order by å­—æ®µæ˜¯ (id, sku_id, line)ï¼Œé‚£ä¹ˆä¸»é”®å¿…é¡»æ˜¯ idã€ (id, sku_id) æˆ–è€… (id, sku_id, line) -[SAMPLE BY]: ç”¨äºæŠ½æ ·çš„è¡¨è¾¾å¼ï¼Œå¦‚æœè¦ç”¨æŠ½æ ·è¡¨è¾¾å¼ï¼Œä¸»é”®ä¸­å¿…é¡»åŒ…å«è¿™ä¸ªè¡¨è¾¾å¼ SETTINGS: å½±å“ MergeTree æ€§èƒ½çš„é¢å¤–å‚æ•°ï¼š use_minimalistic_part_header_in_zookeeper: æ•°æ®ç‰‡æ®µå¤´åœ¨ Zookeeper ä¸­çš„å­˜å‚¨æ–¹å¼ min_merge_bytes_to_use_direct_io: ä½¿ç”¨ç›´æ¥ I/O ï¼ˆä¸ç»è¿‡ç¼“å­˜ I/Oï¼‰æ¥æ“ä½œç£ç›˜çš„åˆå¹¶æ“ä½œæ—¶è¦æ±‚çš„æœ€å°æ•°æ®é‡ã€‚å½“æ•°æ®é‡ç‰¹åˆ«å¤§æ—¶ï¼Œæ²¡å¿…è¦ç»è¿‡ç¼“å­˜ I/Oï¼Œé»˜è®¤æ•°æ®å°äº 10G ä¼šå¼€å¯ç¼“å­˜ I/O æ•°æ®TTL Time To Live, MergeTree æä¾›äº†å¯ä»¥ç®¡ç†æ•°æ®æˆ–åˆ—çš„ ç”Ÿå‘½å‘¨æœŸ çš„åŠŸèƒ½ã€‚ç»™å­—æ®µè®¾ç½®æ—¶é—´ï¼Œåˆ°æœŸåå­—æ®µæ•°æ®å½’ 0 ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:4","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"5. ReplacingMergeTree åœ¨ MergeTree çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº† â€œå¤„ç†é‡å¤æ•°æ®â€ çš„åŠŸèƒ½ï¼Œè¯¥å¼•æ“å’Œ MergeTree çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä¼šåˆ é™¤å…·æœ‰ç›¸åŒä¸»é”®çš„é‡å¤é¡¹ã€‚ä½¿ç”¨ order by ä½¿ç”¨çš„å­—æ®µæ¥è§„å®šå»é‡å­—æ®µã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:5","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"6. SummingMergeTree åœ¨ MergeTree çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº† â€œåˆå¹¶é‡å¤æ•°æ®â€ çš„åŠŸèƒ½ï¼Œä¼šæŠŠå…·æœ‰ç›¸åŒä¸»é”®çš„è¡Œåˆå¹¶ä¸ºä¸€è¡Œï¼Œè¯¥è¡ŒåŒ…å«äº†è¢«åˆå¹¶çš„è¡Œä¸­å…·æœ‰æ•°å€¼æ•°æ®ç±»å‹çš„åˆ—çš„æ±‡æ€»å€¼ã€‚ create table smt_table (date Date, name String, sum Uint16, not_sum UInt16) engine = SummingMergeTree(sum) partition by date order by (date, name) ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:6","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"7. Distributed (é‡ç‚¹) åˆ†å¸ƒå¼å¼•æ“ï¼Œæœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œä½†å¯ä»¥åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šè¿›è¡Œåˆ†å¸ƒå¼æŸ¥è¯¢ã€‚è¯»æ˜¯è‡ªåŠ¨å¹¶è¡Œçš„ã€‚è¯»å–æ—¶ï¼Œè¿œç¨‹æœåŠ¡å™¨è¡¨çš„ç´¢å¼•ä¼šè¢«ä½¿ç”¨ã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:3:7","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"SQL Operation insert update / delete select alter ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:4:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Im/Export HDFS Clickhouse ä» 18.16.0 ç‰ˆæœ¬å¼€å§‹æ”¯æŒä» HDFS è¯»å–æ–‡ä»¶ï¼Œåœ¨ 19.1.6 ç‰ˆæœ¬æ”¯æŒè¯»å’Œå†™ï¼Œåœ¨ 19.4 ç‰ˆæœ¬å¼€å§‹æ”¯æŒ Parquet æ ¼å¼ã€‚ æ¡ˆä¾‹ä¸€ï¼šclient é€šè¿‡ clickhouse æŸ¥è¯¢å¼•æ“è®¿é—® HDFS ä¸Šçš„æ–‡ä»¶ # ä¸Šä¼  csv åˆ° hdfs æ ¹ç›®å½• hadoop fs -put module.csv / # è¿›å…¥ clickhouse å‘½ä»¤ clickhouse-client -h hadoop2 -m # å»ºè¡¨ create table hdfs_module_csv ( id Int8, name String ) Engine = HDFS('hdfs://hadoop2:9000/module.csv','CSV'); éªŒè¯ï¼š # åˆ é™¤ HDFS ä¸Šçš„ CSVï¼ŒéªŒè¯æ˜¯å¦åœ¨ clickhouse ä¸Šå ç”¨ç©ºé—´ hadoop fs -rm -r /module.csv # sql SELECT * from hdfs_module_csv; # error æ¡ˆä¾‹äºŒï¼šHDFS æ’å…¥æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨å¼•æ“ï¼Œclient é€šè¿‡ clickhouse æŸ¥è¯¢å¼•æ“æŸ¥è¯¢ clickhouse æœ¬åœ°æ•°æ® # é€šè¿‡ sql æ’å…¥åˆ°æœ¬åœ° insert into student_local select * from hdfs_module_csv ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:5:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Back Up åŸºäº ZKï¼Œéœ€åœ¨é…ç½® ZK ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:6:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Shard ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:7:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"é›†ç¾¤å†™å…¥æµç¨‹ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:7:1","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"é›†ç¾¤è¯»å–æµç¨‹ ä¼˜å…ˆé€‰æ‹© errors_count å°çš„å‰¯æœ¬ errors_count ç›¸åŒçš„æœ‰éšæœºã€é¡ºåºã€éšæœºã€host åç§°ç›¸ä¼¼ç­‰å››ç§é€‰æ‹©æ–¹å¼ã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:7:2","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"é…ç½®ä¸‰èŠ‚ç‚¹é›†ç¾¤åŠå‰¯æœ¬ hadoop102 hadoop103 hadoop104 shard1, shard1å‰¯æœ¬ shard1, shard1å‰¯æœ¬ (103æ•°æ®å’Œ102æ•°æ®ç›¸åŒ) shard2, shard2å‰¯æœ¬ 102_shard1_replica1 + 104_shard2_replica1 ç»„æˆå®Œæ•´æ•°æ® 103_shard1_replica2 + 104_shard2_replica1 ä¹Ÿå¯ä»¥ç»„æˆå®Œæ•´æ•°æ® ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:7:3","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Optimize max_memory_usage æ­¤å‚æ•°åœ¨ /etc/clickhouse-server/user.xml ä¸­ï¼Œè¡¨ç¤ºå•è¯ Query å ç”¨å†…å­˜æœ€å¤§å€¼ï¼Œè¶…è¿‡ Query å¤±è´¥ï¼Œå°½é‡è°ƒå¤§ã€‚ åˆ é™¤å¤šä¸ªèŠ‚ç‚¹ä¸Šçš„åŒä¸€å¼ è¡¨ ä½¿ç”¨ on cluster å…³é”®å­—ã€‚ drop table * on cluster table_name è‡ªåŠ¨æ•°æ®å¤‡ä»½ åªç”¨ MergeTree å¼•æ“æ”¯æŒå‰¯æœ¬ã€‚ è®¾ç½®åˆ†ç‰‡å’Œåˆ†ç‰‡å‰¯æœ¬èŠ‚ç‚¹ã€‚ ","date":"2020-11-07","objectID":"/20201107_clickhouse-intro/:8:0","tags":["ClickHouse","SQL"],"title":"Clickhouse Introduction","uri":"/20201107_clickhouse-intro/"},{"categories":["Technology"],"content":"Article description.","date":"2020-10-26","objectID":"/20201026_hbase-optimize/","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"HBase is a high reliability, high performance, column-oriented, and scalable distributed database. However, the READ/write performance deteriorates when a large amount of concurrent data or existing data is generated. You can use the following methods to improve the HBase search speed. ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:0:0","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"HBase æ•°æ®è¡¨ä¼˜åŒ– HBase æ˜¯ä¸€ä¸ªé«˜å¯é æ€§ã€é«˜æ€§èƒ½ã€é¢å‘åˆ—ã€å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œä½†æ˜¯å½“å¹¶å‘é‡è¿‡é«˜æˆ–è€…å·²æœ‰æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œè¯»å†™æ€§èƒ½ä¼šä¸‹é™ã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹å¼é€æ­¥æå‡ HBase çš„æ£€ç´¢é€Ÿåº¦ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:0","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"é¢„å…ˆåˆ†åŒº é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨åˆ›å»º HBase è¡¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Region åˆ†åŒºï¼Œå½“å¯¼å…¥æ•°æ®çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ HBase å®¢æˆ·ç«¯éƒ½å‘è¿™ä¸€ä¸ª Region å†™æ•°æ®ï¼Œç›´åˆ°è¿™ä¸ª Region è¶³å¤Ÿå¤§äº†æ‰è¿›è¡Œåˆ‡åˆ†ã€‚ä¸€ç§å¯ä»¥åŠ å¿«æ‰¹é‡å†™å…¥é€Ÿåº¦çš„æ–¹æ³•æ˜¯é€šè¿‡é¢„å…ˆåˆ›å»ºä¸€äº›ç©ºçš„ Regionsï¼Œè¿™æ ·å½“æ•°æ®å†™å…¥ HBase æ—¶ï¼Œä¼šæŒ‰ç…§ Region åˆ†åŒºæƒ…å†µï¼Œåœ¨é›†ç¾¤å†…åšæ•°æ®çš„è´Ÿè½½å‡è¡¡ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:1","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"Rowkey ä¼˜åŒ– HBase ä¸­ Rowkey æ˜¯æŒ‰ç…§å­—å…¸åºå­˜å‚¨ï¼Œå› æ­¤ï¼Œè®¾è®¡ Rowkey æ—¶ï¼Œè¦å……åˆ†åˆ©ç”¨æ’åºç‰¹ç‚¹ï¼Œå°†ç»å¸¸ä¸€èµ·è¯»å–çš„æ•°æ®å­˜å‚¨åˆ°ä¸€å—ï¼Œå°†æœ€è¿‘å¯èƒ½ä¼šè¢«è®¿é—®çš„æ•°æ®æ”¾åœ¨ä¸€å—ã€‚ æ­¤å¤–ï¼ŒRowkey è‹¥æ˜¯é€’å¢çš„ç”Ÿæˆï¼Œå»ºè®®ä¸è¦ä½¿ç”¨æ­£åºç›´æ¥å†™å…¥ Rowkeyï¼Œè€Œæ˜¯é‡‡ç”¨ reverse çš„æ–¹å¼åè½¬ Rowkeyï¼Œä½¿å¾— Rowkey å¤§è‡´å‡è¡¡åˆ†å¸ƒï¼Œè¿™æ ·è®¾è®¡æœ‰ä¸ªå¥½å¤„æ˜¯èƒ½å°† RegionServer çš„è´Ÿè½½å‡è¡¡ï¼Œå¦åˆ™å®¹æ˜“äº§ç”Ÿæ‰€æœ‰æ–°æ•°æ®éƒ½åœ¨ä¸€ä¸ª RegionServer ä¸Šå †ç§¯çš„ç°è±¡ï¼Œè¿™ä¸€ç‚¹è¿˜å¯ä»¥ç»“åˆ table çš„é¢„åˆ‡åˆ†ä¸€èµ·è®¾è®¡ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:2","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"å‡å°‘ ColumnFamily æ•°é‡ ä¸è¦åœ¨ä¸€å¼ è¡¨é‡Œå®šä¹‰å¤ªå¤šçš„ ColumnFamilyã€‚ç›®å‰ Hbase å¹¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†è¶…è¿‡ 2~3 ä¸ª ColumnFamily çš„è¡¨ã€‚å› ä¸ºæŸä¸ª ColumnFamily åœ¨ flush çš„æ—¶å€™ï¼Œå®ƒé‚»è¿‘çš„ ColumnFamily ä¹Ÿä¼šå› å…³è”æ•ˆåº”è¢«è§¦å‘ flushï¼Œæœ€ç»ˆå¯¼è‡´ç³»ç»Ÿäº§ç”Ÿæ›´å¤šçš„ I/Oã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:3","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"ç¼“å­˜ç­–ç•¥ (setCachingï¼‰ åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ HColumnDescriptor.setInMemory(true) å°†è¡¨æ”¾åˆ° RegionServer çš„ç¼“å­˜ä¸­ï¼Œä¿è¯åœ¨è¯»å–çš„æ—¶å€™è¢« cache å‘½ä¸­ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:4","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"è®¾ç½®å­˜å‚¨ç”Ÿå‘½æœŸ åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ HColumnDescriptor.setTimeToLive(int timeToLive) è®¾ç½®è¡¨ä¸­æ•°æ®çš„å­˜å‚¨ç”Ÿå‘½æœŸï¼Œè¿‡æœŸæ•°æ®å°†è‡ªåŠ¨è¢«åˆ é™¤ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:5","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"ç¡¬ç›˜é…ç½® æ¯å° RegionServer ç®¡ç† 10~1000 ä¸ª Regionsï¼Œæ¯ä¸ª Region åœ¨ 1~2Gï¼Œåˆ™æ¯å° Server æœ€å°‘è¦ 10Gï¼Œæœ€å¤§è¦ 1000*2G=2TBï¼Œè€ƒè™‘ 3 å¤‡ä»½ï¼Œåˆ™è¦ 6TBã€‚æ–¹æ¡ˆä¸€æ˜¯ç”¨ 3 å— 2TB ç¡¬ç›˜ï¼ŒäºŒæ˜¯ç”¨ 12 å— 500G ç¡¬ç›˜ï¼Œå¸¦å®½è¶³å¤Ÿæ—¶ï¼Œåè€…èƒ½æä¾›æ›´å¤§çš„ååç‡ï¼Œæ›´ç»†ç²’åº¦çš„å†—ä½™å¤‡ä»½ï¼Œæ›´å¿«é€Ÿçš„å•ç›˜æ•…éšœæ¢å¤ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:6","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"åˆ†é…åˆé€‚çš„å†…å­˜ç»™ RegionServer æœåŠ¡ åœ¨ä¸å½±å“å…¶ä»–æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œè¶Šå¤§è¶Šå¥½ã€‚ä¾‹å¦‚åœ¨ HBase çš„ conf ç›®å½•ä¸‹çš„ hbase-env.sh çš„æœ€åæ·»åŠ  export HBASE_REGIONSERVER_OPTS=â€-Xmx16000m $HBASE_REGIONSERVER_OPTSâ€ å…¶ä¸­ 16000m ä¸ºåˆ†é…ç»™ RegionServer çš„å†…å­˜å¤§å°ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:7","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"å†™æ•°æ®çš„å¤‡ä»½æ•° å¤‡ä»½æ•°ä¸è¯»æ€§èƒ½æˆæ­£æ¯”ï¼Œä¸å†™æ€§èƒ½æˆåæ¯”ï¼Œä¸”å¤‡ä»½æ•°å½±å“é«˜å¯ç”¨æ€§ã€‚æœ‰ä¸¤ç§é…ç½®æ–¹å¼ï¼Œä¸€ç§æ˜¯å°† hdfs-site.xml æ‹·è´åˆ° hbase çš„ conf ç›®å½•ä¸‹ï¼Œç„¶ååœ¨å…¶ä¸­æ·»åŠ æˆ–ä¿®æ”¹é…ç½®é¡¹ dfs.replication çš„å€¼ä¸ºè¦è®¾ç½®çš„å¤‡ä»½æ•°ï¼Œè¿™ç§ä¿®æ”¹å¯¹æ‰€æœ‰çš„ HBase ç”¨æˆ·è¡¨éƒ½ç”Ÿæ•ˆï¼Œå¦å¤–ä¸€ç§æ–¹å¼ï¼Œæ˜¯æ”¹å†™ HBase ä»£ç ï¼Œè®© HBase æ”¯æŒé’ˆå¯¹åˆ—æ—è®¾ç½®å¤‡ä»½æ•°ï¼Œåœ¨åˆ›å»ºè¡¨æ—¶ï¼Œè®¾ç½®åˆ—æ—å¤‡ä»½æ•°ï¼Œé»˜è®¤ä¸º 3ï¼Œæ­¤ç§å¤‡ä»½æ•°åªå¯¹è®¾ç½®çš„åˆ—æ—ç”Ÿæ•ˆã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:8","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"WALï¼ˆé¢„å†™æ—¥å¿—ï¼‰ å¯è®¾ç½®å¼€å…³ï¼Œè¡¨ç¤º HBase åœ¨å†™æ•°æ®å‰ç”¨ä¸ç”¨å…ˆå†™æ—¥å¿—ï¼Œé»˜è®¤æ˜¯æ‰“å¼€ï¼Œå…³æ‰ä¼šæé«˜æ€§èƒ½ï¼Œä½†æ˜¯å¦‚æœç³»ç»Ÿå‡ºç°æ•…éšœ (è´Ÿè´£æ’å…¥çš„ RegionServer æŒ‚æ‰)ï¼Œæ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚é…ç½® WAL åœ¨è°ƒç”¨ Java API å†™å…¥æ—¶ï¼Œè®¾ç½® Put å®ä¾‹çš„ WALï¼Œè°ƒç”¨ Put.setWriteToWAL(boolean)ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:9","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"æ‰¹é‡å†™ HBase çš„ Put æ”¯æŒå•æ¡æ’å…¥ï¼Œä¹Ÿæ”¯æŒæ‰¹é‡æ’å…¥ï¼Œä¸€èˆ¬æ¥è¯´æ‰¹é‡å†™æ›´å¿«ï¼ŒèŠ‚çœæ¥å›çš„ç½‘ç»œå¼€é”€ã€‚åœ¨å®¢æˆ·ç«¯è°ƒç”¨ Java API æ—¶ï¼Œå…ˆå°†æ‰¹é‡çš„ Put æ”¾å…¥ä¸€ä¸ª Put åˆ—è¡¨ï¼Œç„¶åè°ƒç”¨ HTable çš„ Put(Put åˆ—è¡¨) å‡½æ•°æ¥æ‰¹é‡å†™ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:10","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"å®¢æˆ·ç«¯ä¸€æ¬¡ä»æœåŠ¡å™¨æ‹‰å–çš„æ•°é‡ é€šè¿‡é…ç½®ä¸€æ¬¡æ‹‰å»çš„è¾ƒå¤§çš„æ•°æ®é‡å¯ä»¥å‡å°‘å®¢æˆ·ç«¯è·å–æ•°æ®çš„æ—¶é—´ï¼Œä½†æ˜¯å®ƒä¼šå ç”¨å®¢æˆ·ç«¯å†…å­˜ã€‚æœ‰ä¸‰ä¸ªåœ°æ–¹å¯è¿›è¡Œé…ç½®ï¼š 1ï¼‰åœ¨ HBase çš„ conf é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½® hbase.client.scanner.cachingï¼› 2ï¼‰é€šè¿‡è°ƒç”¨ HTable.setScannerCaching(int scannerCaching) è¿›è¡Œé…ç½®ï¼› 3ï¼‰é€šè¿‡è°ƒç”¨ Scan.setCaching(int caching) è¿›è¡Œé…ç½®ã€‚ä¸‰è€…çš„ä¼˜å…ˆçº§è¶Šæ¥è¶Šé«˜ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:11","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"RegionServer çš„è¯·æ±‚å¤„ç† IO çº¿ç¨‹æ•° è¾ƒå°‘çš„ IO çº¿ç¨‹é€‚ç”¨äºå¤„ç†å•æ¬¡è¯·æ±‚å†…å­˜æ¶ˆè€—è¾ƒé«˜çš„ Big Put åœºæ™¯ (å¤§å®¹é‡å•æ¬¡ Put æˆ–è®¾ç½®äº†è¾ƒå¤§ cache çš„ Scanï¼Œå‡å±äº Big Put) æˆ– ReigonServer çš„å†…å­˜æ¯”è¾ƒç´§å¼ çš„åœºæ™¯ã€‚ è¾ƒå¤šçš„ IO çº¿ç¨‹ï¼Œé€‚ç”¨äºå•æ¬¡è¯·æ±‚å†…å­˜æ¶ˆè€—ä½ï¼ŒTPS è¦æ±‚ (æ¯ç§’äº‹åŠ¡å¤„ç†é‡ (TransactionPerSecond)) éå¸¸é«˜çš„åœºæ™¯ã€‚è®¾ç½®è¯¥å€¼çš„æ—¶å€™ï¼Œä»¥ç›‘æ§å†…å­˜ä¸ºä¸»è¦å‚è€ƒã€‚ åœ¨ hbase-site.xml é…ç½®æ–‡ä»¶ä¸­é…ç½®é¡¹ä¸º hbase.regionserver.handler.countã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:12","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"Region å¤§å°è®¾ç½® é…ç½®é¡¹ä¸º hbase.hregion.max.filesizeï¼Œæ‰€å±é…ç½®æ–‡ä»¶ä¸º hbase-site.xml.ï¼Œé»˜è®¤å¤§å° 256Mã€‚ åœ¨å½“å‰ ReigonServer ä¸Šå•ä¸ª Reigon çš„æœ€å¤§å­˜å‚¨ç©ºé—´ï¼Œå•ä¸ª Region è¶…è¿‡è¯¥å€¼æ—¶ï¼Œè¿™ä¸ª Region ä¼šè¢«è‡ªåŠ¨ split æˆæ›´å°çš„ Regionã€‚å° Region å¯¹ split å’Œ compaction å‹å¥½ï¼Œå› ä¸ºæ‹†åˆ† Region æˆ– compact å° Region é‡Œçš„ StoreFile é€Ÿåº¦å¾ˆå¿«ï¼Œå†…å­˜å ç”¨ä½ã€‚ç¼ºç‚¹æ˜¯ split å’Œ compaction ä¼šå¾ˆé¢‘ç¹ï¼Œç‰¹åˆ«æ˜¯æ•°é‡è¾ƒå¤šçš„å° Region ä¸åœåœ° split, compactionï¼Œä¼šå¯¼è‡´é›†ç¾¤å“åº”æ—¶é—´æ³¢åŠ¨å¾ˆå¤§ï¼ŒRegion æ•°é‡å¤ªå¤šä¸ä»…ç»™ç®¡ç†ä¸Šå¸¦æ¥éº»çƒ¦ï¼Œç”šè‡³ä¼šå¼•å‘ä¸€äº› Hbase çš„ bugã€‚ä¸€èˆ¬ 512M ä»¥ä¸‹çš„éƒ½ç®—å° Regionã€‚å¤§ Region åˆ™ä¸å¤ªé€‚åˆç»å¸¸ split å’Œ compactionï¼Œå› ä¸ºåšä¸€æ¬¡ compact å’Œ split ä¼šäº§ç”Ÿè¾ƒé•¿æ—¶é—´çš„åœé¡¿ï¼Œå¯¹åº”ç”¨çš„è¯»å†™æ€§èƒ½å†²å‡»éå¸¸å¤§ã€‚ æ­¤å¤–ï¼Œå¤§ Region æ„å‘³ç€è¾ƒå¤§çš„ StoreFileï¼Œcompaction æ—¶å¯¹å†…å­˜ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚å¦‚æœä½ çš„åº”ç”¨åœºæ™¯ä¸­ï¼ŒæŸä¸ªæ—¶é—´ç‚¹çš„è®¿é—®é‡è¾ƒä½ï¼Œé‚£ä¹ˆåœ¨æ­¤æ—¶åš compact å’Œ splitï¼Œæ—¢èƒ½é¡ºåˆ©å®Œæˆ split å’Œ compactionï¼Œåˆèƒ½ä¿è¯ç»å¤§å¤šæ•°æ—¶é—´å¹³ç¨³çš„è¯»å†™æ€§èƒ½ã€‚compaction æ˜¯æ— æ³•é¿å…çš„ï¼Œsplit å¯ä»¥ä»è‡ªåŠ¨è°ƒæ•´ä¸ºæ‰‹åŠ¨ã€‚åªè¦é€šè¿‡å°†è¿™ä¸ªå‚æ•°å€¼è°ƒå¤§åˆ°æŸä¸ªå¾ˆéš¾è¾¾åˆ°çš„å€¼ï¼Œæ¯”å¦‚ 100Gï¼Œå°±å¯ä»¥é—´æ¥ç¦ç”¨è‡ªåŠ¨ split(RegionServer ä¸ä¼šå¯¹æœªåˆ°è¾¾ 100G çš„ Region åš split)ã€‚å†é…åˆ RegionSplitter è¿™ä¸ªå·¥å…·ï¼Œåœ¨éœ€è¦ split æ—¶ï¼Œæ‰‹åŠ¨ splitã€‚æ‰‹åŠ¨ split åœ¨çµæ´»æ€§å’Œç¨³å®šæ€§ä¸Šæ¯”èµ·è‡ªåŠ¨ split è¦é«˜å¾ˆå¤šï¼Œè€Œä¸”ç®¡ç†æˆæœ¬å¢åŠ ä¸å¤šï¼Œæ¯”è¾ƒæ¨è online å®æ—¶ç³»ç»Ÿä½¿ç”¨ã€‚å†…å­˜æ–¹é¢ï¼Œå° Region åœ¨è®¾ç½® memstore çš„å¤§å°å€¼ä¸Šæ¯”è¾ƒçµæ´»ï¼Œå¤§ Region åˆ™è¿‡å¤§è¿‡å°éƒ½ä¸è¡Œï¼Œè¿‡å¤§ä¼šå¯¼è‡´ flush æ—¶ app çš„ IO wait å¢é«˜ï¼Œè¿‡å°åˆ™å›  StoreFile è¿‡å¤šå½±å“è¯»æ€§èƒ½ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:13","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"HBase é…ç½® å»ºè®® HBase çš„æœåŠ¡å™¨å†…å­˜è‡³å°‘ 32Gï¼Œè¡¨ 1 æ˜¯é€šè¿‡å®è·µæ£€éªŒå¾—åˆ°çš„åˆ†é…ç»™å„è§’è‰²çš„å†…å­˜å»ºè®®å€¼ã€‚ è¡¨ 1. HBase ç›¸å…³æœåŠ¡é…ç½®ä¿¡æ¯ æ¨¡å— æœåŠ¡ç§ç±» å†…å­˜éœ€æ±‚ HDFS HDFS NameNode 16GB HDFS DataNode 2GB HBase HMaster 2GB HRegionServer 16GB ZooKeeper ZooKeeper 4GB HBase çš„å•ä¸ª Region å¤§å°å»ºè®®è®¾ç½®å¤§ä¸€äº›ï¼Œæ¨è 2Gï¼ŒRegionServer å¤„ç†å°‘é‡çš„å¤§ Region æ¯”å¤§é‡çš„å° Region æ›´å¿«ã€‚å¯¹äºä¸é‡è¦çš„æ•°æ®ï¼Œåœ¨åˆ›å»ºè¡¨æ—¶å°†å…¶æ”¾åœ¨å•ç‹¬çš„åˆ—æ—å†…ï¼Œå¹¶ä¸”è®¾ç½®å…¶åˆ—æ—å¤‡ä»½æ•°ä¸º 2ï¼ˆé»˜è®¤æ˜¯è¿™æ ·æ—¢ä¿è¯äº†åŒå¤‡ä»½ï¼Œåˆå¯ä»¥èŠ‚çº¦ç©ºé—´ï¼Œæé«˜å†™æ€§èƒ½ï¼Œä»£ä»·æ˜¯é«˜å¯ç”¨æ€§æ¯”å¤‡ä»½æ•°ä¸º 3 çš„ç¨å·®ï¼Œä¸”è¯»æ€§èƒ½ä¸å¦‚é»˜è®¤å¤‡ä»½æ•°çš„æ—¶å€™ã€‚ ","date":"2020-10-26","objectID":"/20201026_hbase-optimize/:1:14","tags":["Tuning","Hbase","Hdfs"],"title":"Hbase Performance Tuning","uri":"/20201026_hbase-optimize/"},{"categories":["Technology"],"content":"Article description.","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"Rows in HBase are sorted lexicographically by row key. This design optimizes for scans, allowing you to store related rows, or rows that will be read together, near each other. However, poorly designed row keys are a common source of hotspotting. Hotspotting occurs when a large amount of client traffic is directed at one node, or only a few nodes, of a cluster. This traffic may represent reads, writes, or other operations. The traffic overwhelms the single machine responsible for hosting that region, causing performance degradation and potentially leading to region unavailability. This can also have adverse effects on other regions hosted by the same region server as that host is unable to service the requested load. It is important to design data access patterns such that the cluster is fully and evenly utilized. ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:0:0","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyçš„ä½œç”¨ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:1:0","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyåœ¨æŸ¥è¯¢ä¸­çš„ä½œç”¨ HBaseä¸­RowKeyå¯ä»¥å”¯ä¸€æ ‡è¯†ä¸€è¡Œè®°å½•ï¼Œåœ¨HBaseä¸­æ£€ç´¢æ•°æ®æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š é€šè¿‡ get æ–¹å¼ï¼ŒæŒ‡å®š RowKey è·å–å”¯ä¸€ä¸€æ¡è®°å½• é€šè¿‡ scan æ–¹å¼ï¼Œè®¾ç½® startRow å’Œ stopRow å‚æ•°è¿›è¡ŒèŒƒå›´åŒ¹é… å…¨è¡¨æ‰«æï¼Œå³ç›´æ¥æ‰«ææ•´å¼ è¡¨ä¸­æ‰€æœ‰è¡Œè®°å½• å½“å¤§é‡è¯·æ±‚è®¿é—®HBaseé›†ç¾¤çš„ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªèŠ‚ç‚¹ï¼Œé€ æˆå°‘æ•°RegionServerçš„è¯»å†™è¯·æ±‚è¿‡å¤šã€è´Ÿè½½è¿‡å¤§ï¼Œè€Œå…¶ä»–RegionServerè´Ÿè½½å´å¾ˆå°ï¼Œè¿™æ ·å°±é€ æˆçƒ­ç‚¹ç°è±¡ã€‚å¤§é‡è®¿é—®ä¼šä½¿çƒ­ç‚¹Regionæ‰€åœ¨çš„ä¸»æœºè´Ÿè½½è¿‡å¤§ï¼Œå¼•èµ·æ€§èƒ½ä¸‹é™ï¼Œç”šè‡³å¯¼è‡´Regionä¸å¯ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å‘HBaseä¸­æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œåº”å°½é‡å‡è¡¡åœ°æŠŠè®°å½•åˆ†æ•£åˆ°ä¸åŒçš„Regioné‡Œå»ï¼Œå¹³è¡¡æ¯ä¸ªRegionçš„å‹åŠ›ã€‚ ä¸‹é¢æ ¹æ®ä¸€ä¸ªä¾‹å­åˆ†åˆ«ä»‹ç»ä¸‹æ ¹æ®RowKeyè¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™æ”¯æŒçš„æƒ…å†µã€‚ å¦‚æœæˆ‘ä»¬RowKeyè®¾è®¡ä¸ºuid+phone+nameï¼Œé‚£ä¹ˆè¿™ç§è®¾è®¡å¯ä»¥å¾ˆå¥½çš„æ”¯æŒä¸€ä¸‹çš„åœºæ™¯: uid=873969725 AND phone=18900000000 AND name=zhangsanuid= 873969725 AND phone=18900000000uid= 873969725 AND phone=189?uid= 873969725 éš¾ä»¥æ”¯æŒçš„åœºæ™¯ï¼š phone=18900000000 AND name = zhangsanphone=18900000000 name=zhangsan ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œæ ¹æ®RowKeyä»å‰å‘ååŒ¹é…ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è®¾è®¡RowKeyçš„æ—¶å€™é€‰æ‹©å¥½å­—æ®µä¹‹åï¼Œè¿˜åº”è¯¥ç»“åˆæˆ‘ä»¬çš„å®é™…çš„é«˜é¢‘çš„æŸ¥è¯¢åœºæ™¯æ¥ç»„åˆé€‰æ‹©çš„å­—æ®µï¼Œè¶Šé«˜é¢‘çš„æŸ¥è¯¢å­—æ®µæ’åˆ—è¶Šé å·¦ã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:1:1","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyåœ¨Regionä¸­çš„ä½œç”¨ åœ¨ HBase ä¸­ï¼ŒRegion ç›¸å½“äºä¸€ä¸ªæ•°æ®çš„åˆ†ç‰‡ï¼Œæ¯ä¸ª Region éƒ½æœ‰StartRowKeyå’ŒStopRowKeyï¼Œè¿™æ˜¯è¡¨ç¤º Region å­˜å‚¨çš„ RowKey çš„èŒƒå›´ï¼ŒHBase è¡¨çš„æ•°æ®æ—¶æŒ‰ç…§ RowKey æ¥åˆ†æ•£åˆ°ä¸åŒçš„ Regionï¼Œè¦æƒ³å°†æ•°æ®è®°å½•å‡è¡¡çš„åˆ†æ•£åˆ°ä¸åŒçš„Regionä¸­å»ï¼Œå› æ­¤éœ€è¦ RowKey æ»¡è¶³è¿™ç§æ•£åˆ—çš„ç‰¹ç‚¹ã€‚æ­¤å¤–ï¼Œåœ¨æ•°æ®è¯»å†™è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯ä¸RowKey å¯†åˆ‡ç›¸å…³ï¼ŒRowKeyåœ¨è¯»å†™è¿‡ç¨‹ä¸­çš„ä½œç”¨ï¼š è¯»å†™æ•°æ®æ—¶é€šè¿‡ RowKey æ‰¾åˆ°å¯¹åº”çš„ Regionï¼› MemStore ä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§ RowKey çš„å­—å…¸åºæ’åºï¼› HFile ä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§ RowKey çš„å­—å…¸åºæ’åºã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:1:2","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyçš„è®¾è®¡ åœ¨HBaseä¸­RowKeyåœ¨æ•°æ®æ£€ç´¢å’Œæ•°æ®å­˜å‚¨æ–¹é¢éƒ½æœ‰é‡è¦çš„ä½œç”¨ï¼Œä¸€ä¸ªå¥½çš„RowKeyè®¾è®¡ä¼šå½±å“åˆ°æ•°æ®åœ¨HBaseä¸­çš„åˆ†å¸ƒï¼Œè¿˜ä¼šå½±å“æˆ‘ä»¬æŸ¥è¯¢æ•ˆç‡ï¼Œæ‰€ä»¥ä¸€ä¸ªå¥½çš„RowKeyçš„è®¾è®¡æ–¹æ¡ˆæ˜¯å¤šä¹ˆé‡è¦ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹RowKeyçš„è®¾è®¡åŸåˆ™ã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:2:0","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyè®¾è®¡åŸåˆ™ é•¿åº¦åŸåˆ™ RowKeyæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ç æµï¼Œå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ä¸º64kbï¼Œå®é™…åº”ç”¨ä¸­ä¸€èˆ¬ä¸º10-100byteï¼Œä»¥byte[]å½¢å¼ä¿å­˜ï¼Œä¸€èˆ¬è®¾è®¡æˆå®šé•¿ã€‚å»ºè®®è¶ŠçŸ­è¶Šå¥½ï¼Œä¸è¦è¶…è¿‡16ä¸ªå­—èŠ‚ï¼ŒåŸå› å¦‚ä¸‹ï¼š æ•°æ®çš„æŒä¹…åŒ–æ–‡ä»¶HFileä¸­æ—¶æŒ‰ç…§Key-Valueå­˜å‚¨çš„ï¼Œå¦‚æœRowKeyè¿‡é•¿ï¼Œä¾‹å¦‚è¶…è¿‡100byteï¼Œé‚£ä¹ˆ1000wè¡Œçš„è®°å½•ï¼Œä»…RowKeyå°±éœ€å ç”¨è¿‘1GBçš„ç©ºé—´ã€‚è¿™æ ·ä¼šæå¤§å½±å“HFileçš„å­˜å‚¨æ•ˆç‡ã€‚ MemStoreä¼šç¼“å­˜éƒ¨åˆ†æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œè‹¥RowKeyå­—æ®µè¿‡é•¿ï¼Œå†…å­˜çš„æœ‰æ•ˆåˆ©ç”¨ç‡å°±ä¼šé™ä½ï¼Œå°±ä¸èƒ½ç¼“å­˜æ›´å¤šçš„æ•°æ®ï¼Œä»è€Œé™ä½æ£€ç´¢æ•ˆç‡ã€‚ ç›®å‰æ“ä½œç³»ç»Ÿéƒ½æ˜¯64ä½ç³»ç»Ÿï¼Œå†…å­˜8å­—èŠ‚å¯¹é½ï¼Œæ§åˆ¶åœ¨16å­—èŠ‚ï¼Œ8å­—èŠ‚çš„æ•´æ•°å€åˆ©ç”¨äº†æ“ä½œç³»ç»Ÿçš„æœ€ä½³ç‰¹æ€§ã€‚ å”¯ä¸€åŸåˆ™ å¿…é¡»åœ¨è®¾è®¡ä¸Šä¿è¯RowKeyçš„å”¯ä¸€æ€§ã€‚ç”±äºåœ¨HBaseä¸­æ•°æ®å­˜å‚¨æ˜¯Key-Valueå½¢å¼ï¼Œè‹¥å‘HBaseä¸­åŒä¸€å¼ è¡¨æ’å…¥ç›¸åŒRowKeyçš„æ•°æ®ï¼Œåˆ™åŸå…ˆå­˜åœ¨çš„æ•°æ®ä¼šè¢«æ–°çš„æ•°æ®è¦†ç›–ã€‚ æ’åºåŸåˆ™ HBaseçš„RowKeyæ˜¯æŒ‰ç…§ASCIIæœ‰åºæ’åºçš„ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è®¾è®¡RowKeyçš„æ—¶å€™è¦å……åˆ†åˆ©ç”¨è¿™ç‚¹ã€‚ æ•£åˆ—åŸåˆ™ è®¾è®¡çš„RowKeyåº”å‡åŒ€çš„åˆ†å¸ƒåœ¨å„ä¸ªHBaseèŠ‚ç‚¹ä¸Šã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:2:1","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyå­—æ®µé€‰æ‹© RowKeyå­—æ®µçš„é€‰æ‹©ï¼Œéµå¾ªçš„æœ€åŸºæœ¬åŸåˆ™æ˜¯å”¯ä¸€æ€§ï¼ŒRowKeyå¿…é¡»èƒ½å¤Ÿå”¯ä¸€çš„è¯†åˆ«ä¸€è¡Œæ•°æ®ã€‚æ— è®ºåº”ç”¨çš„è´Ÿè½½ç‰¹ç‚¹æ˜¯ä»€ä¹ˆæ ·ï¼ŒRowKeyå­—æ®µéƒ½åº”è¯¥å‚è€ƒæœ€é«˜é¢‘çš„æŸ¥è¯¢åœºæ™¯ã€‚æ•°æ®åº“é€šå¸¸éƒ½æ˜¯ä»¥å¦‚ä½•é«˜æ•ˆçš„è¯»å–å’Œæ¶ˆè´¹æ•°æ®ä¸ºç›®çš„ï¼Œè€Œä¸æ˜¯æ•°æ®å­˜å‚¨æœ¬èº«ã€‚ç„¶åï¼Œç»“åˆå…·ä½“çš„è´Ÿè½½ç‰¹ç‚¹ï¼Œå†å¯¹é€‰å–çš„RowKeyå­—æ®µå€¼è¿›è¡Œæ”¹é€ ï¼Œç»„åˆå­—æ®µåœºæ™¯ä¸‹éœ€è¦é‡ç‚¹è€ƒè™‘å­—æ®µçš„é¡ºåºã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:2:2","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"é¿å…æ•°æ®çƒ­ç‚¹çš„æ–¹æ³• åœ¨å¯¹HBaseçš„è¯»å†™è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•é¿å…çƒ­ç‚¹ç°è±¡å‘¢ï¼Ÿä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š Reversing å¦‚æœç»åˆæ­¥è®¾è®¡å‡ºçš„RowKeyåœ¨æ•°æ®åˆ†å¸ƒä¸Šä¸å‡åŒ€ï¼Œä½†RowKeyå°¾éƒ¨çš„æ•°æ®å´å‘ˆç°å‡ºäº†è‰¯å¥½çš„éšæœºæ€§ï¼Œæ­¤æ—¶ï¼Œå¯ä»¥è€ƒè™‘å°†RowKeyçš„ä¿¡æ¯ç¿»è½¬ï¼Œæˆ–è€…ç›´æ¥å°†å°¾éƒ¨çš„bytesæå‰åˆ°RowKeyçš„å¼€å¤´ã€‚Reversingå¯ä»¥æœ‰æ•ˆçš„ä½¿RowKeyéšæœºåˆ†å¸ƒï¼Œä½†æ˜¯ç‰ºç‰²äº†RowKeyçš„æœ‰åºæ€§ã€‚ ç¼ºç‚¹ï¼š åˆ©äºGetæ“ä½œï¼Œä½†ä¸åˆ©äºScanæ“ä½œï¼Œå› ä¸ºæ•°æ®åœ¨åŸRowKeyä¸Šçš„è‡ªç„¶é¡ºåºå·²ç»è¢«æ‰“ä¹±ã€‚ Salting Saltingï¼ˆåŠ ç›ï¼‰çš„åŸç†æ˜¯åœ¨åŸRowKeyçš„å‰é¢æ·»åŠ å›ºå®šé•¿åº¦çš„éšæœºæ•°ï¼Œä¹Ÿå°±æ˜¯ç»™RowKeyåˆ†é…ä¸€ä¸ªéšæœºå‰ç¼€ä½¿å®ƒå’Œä¹‹é—´çš„RowKeyçš„å¼€å¤´ä¸åŒã€‚éšæœºæ•°èƒ½ä¿éšœæ•°æ®åœ¨æ‰€æœ‰Regionsé—´çš„è´Ÿè½½å‡è¡¡ã€‚ ç¼ºç‚¹ï¼š å› ä¸ºæ·»åŠ çš„æ˜¯éšæœºæ•°ï¼ŒåŸºäºåŸRowKeyæŸ¥è¯¢æ—¶æ— æ³•çŸ¥é“éšæœºæ•°æ˜¯ä»€ä¹ˆï¼Œé‚£æ ·åœ¨æŸ¥è¯¢çš„æ—¶å€™å°±éœ€è¦å»å„ä¸ªå¯èƒ½çš„Regionsä¸­æŸ¥æ‰¾ï¼ŒSaltingå¯¹äºè¯»å–æ˜¯åˆ©ç©ºçš„ã€‚å¹¶ä¸”åŠ ç›è¿™ç§æ–¹å¼å¢åŠ äº†è¯»å†™æ—¶çš„ååé‡ã€‚ Hashing åŸºäº RowKey çš„å®Œæ•´æˆ–éƒ¨åˆ†æ•°æ®è¿›è¡Œ Hashï¼Œè€Œåå°†Hashingåçš„å€¼å®Œæ•´æ›¿æ¢æˆ–éƒ¨åˆ†æ›¿æ¢åŸRowKeyçš„å‰ç¼€éƒ¨åˆ†ã€‚è¿™é‡Œè¯´çš„ hash åŒ…å« MD5ã€sha1ã€sha256 æˆ– sha512 ç­‰ç®—æ³•ã€‚ ç¼ºç‚¹ï¼š ä¸ Reversing ç±»ä¼¼ï¼ŒHashing ä¹Ÿä¸åˆ©äº Scanï¼Œå› ä¸ºæ‰“ä¹±äº†åŸRowKeyçš„è‡ªç„¶é¡ºåºã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:2:3","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyè®¾è®¡æ¡ˆä¾‹å‰–æ 1. æŸ¥è¯¢æŸç”¨æˆ·åœ¨æŸåº”ç”¨ä¸­çš„æ“ä½œè®°å½• reverse(userid) + appid + timestamp 2. æŸ¥è¯¢æŸç”¨æˆ·åœ¨æŸåº”ç”¨ä¸­çš„æ“ä½œè®°å½•ï¼ˆä¼˜å…ˆå±•ç°æœ€è¿‘çš„æ•°æ®ï¼‰ reverse(userid) + appid + (Long.Max_Value - timestamp) 3. æŸ¥è¯¢æŸç”¨æˆ·åœ¨æŸæ®µæ—¶é—´å†…æ‰€æœ‰åº”ç”¨çš„æ“ä½œè®°å½• reverse(userid) + timestamp + appid 4. æŸ¥è¯¢æŸç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ reverse(userid) 5. æŸ¥è¯¢æŸeventidè®°å½•ä¿¡æ¯ salt + eventid + timestamp å¦‚æœ useridæ˜¯æŒ‰æ•°å­—é€’å¢çš„ï¼Œå¹¶ä¸”é•¿åº¦ä¸ä¸€ï¼Œå¯ä»¥å…ˆé¢„ä¼° userid æœ€å¤§é•¿åº¦ï¼Œç„¶åå°†useridè¿›è¡Œç¿»è½¬ï¼Œå†åœ¨ç¿»è½¬ä¹‹åçš„å­—ç¬¦ä¸²åé¢è¡¥0ï¼ˆè‡³æœ€å¤§é•¿åº¦ï¼‰ï¼›å¦‚æœé•¿åº¦å›ºå®šï¼Œç›´æ¥è¿›è¡Œç¿»è½¬å³å¯ï¼ˆå¦‚æ‰‹æœºå·ç ï¼‰ã€‚ åœ¨ç¬¬5ä¸ªä¾‹å­ä¸­ï¼ŒåŠ ç›çš„ç›®çš„æ˜¯ä¸ºäº†å¢åŠ æŸ¥è¯¢çš„å¹¶å‘æ€§ï¼ŒåŠ å…¥Slatçš„èŒƒå›´æ˜¯0~nï¼Œå¯ä»¥å°†æ•°æ®åˆ†ä¸ºnä¸ªsplitåŒæ—¶åšscanæ“ä½œï¼Œæœ‰åˆ©äºæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:3:0","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"RowKeyæ€»ç»“ åœ¨HBaseçš„ä½¿ç”¨è¿‡ç¨‹ï¼Œè®¾è®¡RowKeyæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸€ä¸ªç¯èŠ‚ã€‚æˆ‘ä»¬åœ¨è¿›è¡ŒRowKeyè®¾è®¡çš„æ—¶å€™å¯å‚ç…§å¦‚ä¸‹æ­¥éª¤ï¼š ç»“åˆä¸šåŠ¡åœºæ™¯ç‰¹ç‚¹ï¼Œé€‰æ‹©åˆé€‚çš„å­—æ®µæ¥åšä¸ºRowKeyï¼Œå¹¶ä¸”æŒ‰ç…§æŸ¥è¯¢é¢‘æ¬¡æ¥æ”¾ç½®å­—æ®µé¡ºåº é€šè¿‡è®¾è®¡çš„RowKeyèƒ½å°½å¯èƒ½çš„å°†æ•°æ®æ‰“æ•£åˆ°æ•´ä¸ªé›†ç¾¤ä¸­ï¼Œå‡è¡¡è´Ÿè½½ï¼Œé¿å…çƒ­ç‚¹é—®é¢˜ è®¾è®¡çš„RowKeyåº”å°½é‡ç®€çŸ­ ","date":"2020-10-16","objectID":"/20201016_hbase-rowkey-design/:4:0","tags":["Hbase","Hdfs","SQL"],"title":"Hbase Rowkey Design","uri":"/20201016_hbase-rowkey-design/"},{"categories":["Technology"],"content":"Article description.","date":"2020-08-11","objectID":"/20200811_yarn-clusteryarn-client/","tags":["Spark","Yarn"],"title":"Spark On Yarn: yarn-cluster, yarn-client","uri":"/20200811_yarn-clusteryarn-client/"},{"categories":["Technology"],"content":"YARN is a generic resource-management framework for distributed workloads; in other words, a cluster-level operating system. Although part of the Hadoop ecosystem, YARN can support a lot of varied compute-frameworks (such as Tez, and Spark) in addition to MapReduce. Sparkæ”¯æŒå¯æ’æ‹”çš„é›†ç¾¤ç®¡ç†æ¨¡å¼(Standaloneã€Mesosä»¥åŠYARN )ï¼Œé›†ç¾¤ç®¡ç†è´Ÿè´£å¯åŠ¨executorè¿›ç¨‹ï¼Œç¼–å†™Spark application çš„äººæ ¹æœ¬ä¸éœ€è¦çŸ¥é“Sparkç”¨çš„æ˜¯ä»€ä¹ˆé›†ç¾¤ç®¡ç†ã€‚Sparkæ”¯æŒçš„ä¸‰ç§é›†ç¾¤æ¨¡å¼ï¼Œè¿™ä¸‰ç§é›†ç¾¤æ¨¡å¼éƒ½ç”±ä¸¤ä¸ªç»„ä»¶ç»„æˆ:masterå’Œslaveã€‚MasteræœåŠ¡(YARN ResourceManager,Mesos masterå’ŒSpark standalone master)å†³å®šå“ªäº›applicationå¯ä»¥è¿è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¿è¡Œä»¥åŠå“ªé‡Œå»è¿è¡Œã€‚è€ŒslaveæœåŠ¡( YARN NodeManager, Mesos slaveå’ŒSpark standalone slave)å®é™…ä¸Šè¿è¡Œexecutorè¿›ç¨‹ã€‚ å½“åœ¨YARNä¸Šè¿è¡ŒSparkä½œä¸šï¼Œæ¯ä¸ªSpark executorä½œä¸ºä¸€ä¸ªYARNå®¹å™¨(container)è¿è¡Œã€‚Sparkå¯ä»¥ä½¿å¾—å¤šä¸ªTasksåœ¨åŒä¸€ä¸ªå®¹å™¨(container)é‡Œé¢è¿è¡Œã€‚è¿™æ˜¯ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ã€‚ æ³¨æ„è¿™é‡Œå’ŒHadoopçš„MapReduceä½œä¸šä¸ä¸€æ ·ï¼ŒMapReduceä½œä¸šä¸ºæ¯ä¸ªTaskå¼€å¯ä¸åŒçš„JVMæ¥è¿è¡Œã€‚è™½ç„¶è¯´MapReduceå¯ä»¥é€šè¿‡å‚æ•°æ¥é…ç½®ã€‚è¯¦è§mapreduce.job.jvm.numtasks ä»å¹¿ä¹‰ä¸Šè®²ï¼Œyarn-clusteré€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼›è€Œyarn-clienté€‚ç”¨äºäº¤äº’å’Œè°ƒè¯•ï¼Œä¹Ÿå°±æ˜¯å¸Œæœ›å¿«é€Ÿåœ°çœ‹åˆ°applicationçš„è¾“å‡ºã€‚ Application Masterã€‚åœ¨YARNä¸­ï¼Œæ¯ä¸ªApplicationå®ä¾‹éƒ½æœ‰ä¸€ä¸ªApplication Masterè¿›ç¨‹ï¼Œå®ƒæ˜¯Applicationå¯åŠ¨çš„ç¬¬ä¸€ä¸ªå®¹å™¨ã€‚å®ƒè´Ÿè´£å’ŒResourceManageræ‰“äº¤é“ï¼Œå¹¶è¯·æ±‚èµ„æºã€‚è·å–èµ„æºä¹‹åå‘Šè¯‰NodeManagerä¸ºå…¶å¯åŠ¨containerã€‚ ä»æ·±å±‚æ¬¡çš„å«ä¹‰è®²ï¼Œyarn-clusterå’Œyarn-clientæ¨¡å¼çš„åŒºåˆ«å…¶å®å°±æ˜¯Application Masterè¿›ç¨‹çš„åŒºåˆ«ï¼Œyarn-clusteræ¨¡å¼ä¸‹ï¼Œdriverè¿è¡Œåœ¨AM(Application Master)ä¸­ï¼Œå®ƒè´Ÿè´£å‘YARNç”³è¯·èµ„æºï¼Œå¹¶ç›‘ç£ä½œä¸šçš„è¿è¡ŒçŠ¶å†µã€‚å½“ç”¨æˆ·æäº¤äº†ä½œä¸šä¹‹åï¼Œå°±å¯ä»¥å…³æ‰Clientï¼Œä½œä¸šä¼šç»§ç»­åœ¨YARNä¸Šè¿è¡Œã€‚ç„¶è€Œyarn-clusteræ¨¡å¼ä¸é€‚åˆè¿è¡Œäº¤äº’ç±»å‹çš„ä½œä¸šã€‚è€Œyarn-clientæ¨¡å¼ä¸‹ï¼ŒApplication Masterä»…ä»…å‘YARNè¯·æ±‚executorï¼Œclientä¼šå’Œè¯·æ±‚çš„containeré€šä¿¡æ¥è°ƒåº¦ä»–ä»¬å·¥ä½œï¼Œä¹Ÿå°±æ˜¯è¯´Clientä¸èƒ½ç¦»å¼€ã€‚ï¼ˆä¸Šå›¾æ˜¯yarn-clusteræ¨¡å¼ï¼Œä¸‹å›¾æ˜¯yarn-clientæ¨¡å¼ï¼‰ï¼š spark-yarn-f31 spark-yarn-f22 ","date":"2020-08-11","objectID":"/20200811_yarn-clusteryarn-client/:0:0","tags":["Spark","Yarn"],"title":"Spark On Yarn: yarn-cluster, yarn-client","uri":"/20200811_yarn-clusteryarn-client/"},{"categories":["Technology"],"content":"Article description.","date":"2020-08-03","objectID":"/20200803_spark-guide3/","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Apache Spark has its architectural foundation in the resilient distributed dataset (RDD), a read-only multiset of data items distributed over a cluster of machines, that is maintained in a fault-tolerant way. The Dataframe API was released as an abstraction on top of the RDD, followed by the Dataset API. ","date":"2020-08-03","objectID":"/20200803_spark-guide3/:0:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Project ä¸šåŠ¡åœºæ™¯ ç»Ÿè®¡å‡ºç§Ÿè½¦åˆ©ç”¨ç‡(æœ‰ä¹˜å®¢ä¹˜åçš„æ—¶é—´å’Œæ— ä¹˜å®¢ç©ºè·‘çš„æ—¶é—´æ¯”ä¾‹) æŠ€æœ¯è¦ç‚¹ æ•°æ®æ¸…æ´— Jsonè§£æ åœ°ç†ä½ç½®ä¿¡æ¯å¤„ç† æ¢ç´¢æ€§æ•°æ®åˆ†æ ä¼šè¯åˆ†æ æ•°æ®è¯»å– class TaxiAnalysisRunner{ def main(args: Array[String]): Unit = { //1åˆ›å»ºSparkSession val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"taxi\") .getOrCreate() //2å¯¼å…¥éšå¼è½¬æ¢å’Œå‡½æ•° import spark.implicits._ import org.apache.spark.sql.functions._ //3æ•°æ®è¯»å– val taxiRaw: Dataset[Row] = spark.read .option(\"header\", value = true) .csv(\"dataset/half_trip.csv\") } } æŠ½è±¡æ•°æ®ç±» //dataframeæ˜¯ROWç±»å‹çš„dataset //è¯»å–çš„dataframeæ˜¯rowç±»å‹çš„ï¼Œå¦‚æœæ˜¯dataset[trip]æŠŠç±»å‹æŠ½è±¡ï¼Œå¯¹æ•°æ®æ–¹ä¾¿å¤„ç† case class Trip( license: String, pickUpTime: Long, dropOffTime: Long, pickUpX: Double, pickUpy: Double, dropOffX: Double, dropOffY: Double ) è½¬æ¢DFç±»å‹ã€æ¸…æ´—å¼‚å¸¸æ•°æ® //dataframe[Row] =\u003e dataset[] val taxiParsed:RDD[Either[Trip,(Row,Exception)]] = taxiRaw.rdd.map(safe(parse)) //å¼‚å¸¸æ•°æ® val exceptionResult = taxiParsed.filter(e =\u003e e.isRight) .map(e =\u003e e.right.get._1) val taxi Good: Dataset[Trip] = taxiParsed.map(either =\u003e either.left.get).toDS() def parse(row: Row): Trip = { val richRow = new richRow(row) val license = richRow.getAs[String](\"hack_license\").orNull val pickUpTime = parseTime(richRow, \"...\") val dropOffTime = parseTime(richRow, \"...\") val pickUpX = parseLocation(richRow, \"...\") val pickUpy = parseLocation(richRow, \"...\") val dropOffX = parseLocation(richRow, \"...\") val dropOffY = parseLocation(richRow, \"...\") Trip(license, pickUpTime, dropOffTime, pickUpX, pickUpy, dropOffX, dropOffY) } class RichRow(row: Row){ def getAs[T](field: String): Option[T] = { if(row.isNullAt(row.fieldIndex(field))){ None }else{ Some(row.getAs[T](field)) } } } def parseTime(row: RichRow, field: String): Long = { //è§„å®šæ ¼å¼ val pattern = \"yyyy-MM-dd HH:mm:ss\" val formatter = new SimpleDateFormat(pattern, locale.ENGLISH) //æ‰§è¡Œè½¬æ¢ val time = row.getAs[String](field) val timeOption = time.map(time =\u003e formatter.parse(time).getTime) //Optionä»£è¡¨æŸä¸ªæ–¹æ³•ï¼Œç»“æœå¯èƒ½ä¸ºç©ºï¼Œä½¿å¾—æ–¹æ³•è°ƒç”¨å‡ºå¿…é¡»å¤„ç†ä¸ºnullçš„æƒ…å†µ //Optionå¯¹è±¡æœ¬èº«æä¾›äº†ä¸€äº›å¯¹äºnullçš„æ”¯æŒ timeOption.getOrElse(0L) } def parseLocation(row: RickRow, field: String): Double = { val location = row.getAs[String](fiecld) val locationOption = location.map(loc =\u003e loc.toDouble) locationOption.getOrElse(0D) } //parseå¼‚å¸¸å¤„ç† //å‡ºç°å¼‚å¸¸-\u003eè¿”å›å¼‚å¸¸ä¿¡æ¯ï¼Œå’Œå½“å‰è°ƒç”¨ def safe[P, R](f: P =\u003e R): P =\u003e Either[R,(P,Exception)]={ new Function[P, Either[R,(P,Exception)]] with Serializable { override def apply(param: P): Either[R, (P, Exception)] = { try{ Left(param) }catch{ case e: Exception =\u003e Right((param, e)) } } } } ç»Ÿè®¡åˆ†å¸ƒ //ç¼–å†™udfï¼Œå°†æ¯«ç§’è½¬ä¸ºå°æ—¶å•ä½ val hours = (pickUpTime: Long, dropOffTime: Long) =\u003e { val duration = dropOffTime - pickUpTime val hours = TimeUnit.HOURS.convert(duration, TimeUnit.MILLISECONDS) hours } val hoursUDF = udf(hours) //ç»Ÿè®¡ taxiGood.groupBy(hoursUDF($\"pickUpTime\",$\"dropOffTime\") as \"duration\") .count() .sort(\"duration\") .show() //ç›´æ–¹å›¾ spark.udf.register(\"hours\", hours) val taxiClean = taxiGood.where(\"hours(pickUpTime, dropOffTime) BETWEEN 0 AND 3\") JSONåœ°ç†ä¿¡æ¯ case class FeatureCollection(features: List[Feature]) case class Feature(Properties: Map[String, String], geometry: JObject) { def getGeometry(): Geometry = { import org.json4s._ import org.json4s.jackson.JsonMethods._ val mapGeo = GeometryEngine.geoJsonToGeometry(compact(render(geometry)), 0, Geometry.Type.Unknown) mapGeo.getGeometry } } object FeatureExtraction{ //JSONè§£æ def parseJson(json: String): FeatureCollection = { //1å¯¼å…¥ä¸€ä¸ªformatséšå¼è½¬æ¢ implicit val formats = Serialization.formats(NoTypeHints) //2JSON -\u003e Obj import org.json4s.jackson.Serialization.read val featureCollection = read[FeatureCollection](json) featureCollection } } //é“¾æ¥è¡Œæ”¿åŒºä¿¡æ¯ //1è¯»å–æ•°æ® val geoJson = Source.fromFile(\"dataset/districts.geojson\").mkString val featureColleciton = FeatureExtraction.parseJson(geoJson) //2æ’åº //ç†è®ºä¸Šå¤§çš„åŒºåŸŸæ•°é‡å¤šï¼ŒæŠŠå¤§çš„åŒºåŸŸæ”¾åœ¨å‰é¢ï¼Œå‡å°‘æœç´¢æ¬¡æ•° val sortedFeatures = featureCollection.features.sortBy(feature =\u003e { (feature.properties(\"boroughCode\"), - feature.getGeometry().calculateArea2D()) }) //3å¹¿æ’­ val featuresBC = spark.sparkContext.broadcast(sortedFeatures) //4UDF val boroughLookUp = (x: Double, y: Double) =\u003e { //1æœç´¢ç»çº¬åº¦æ‰€åœ¨çš„åŒºåŸŸ val feature","date":"2020-08-03","objectID":"/20200803_spark-guide3/:1:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Spark Streaming Spark Streaming çš„ç‰¹ç‚¹ Spark Streaming å¹¶ä¸æ˜¯å®æ—¶æµï¼Œè€Œæ˜¯æŒ‰æ—¶é—´åˆ‡åˆ†å°æ‰¹é‡ï¼Œä¸€ä¸ªä¸€ä¸ªçš„å°æ‰¹å¤„ç† Spark Streaming å¯¹æ•°æ®æ˜¯æŒ‰ç…§æ—¶é—´åˆ‡åˆ†ä¸ºä¸€ä¸ªåˆä¸€ä¸ªçš„RDDï¼Œç„¶åé’ˆå¯¹RDDè¿›è¡Œå¤„ç† å¤„ç†æ¶æ„ æ‰¹å¤„ç†ï¼šHDFS æµå¤„ç†ï¼šKafka æ··åˆå¤„ç†ï¼šæµå¼è®¡ç®—å’Œæ‰¹å¤„ç†ç»“åˆ Netcat Netcatä»¥åœ¨ä¸¤å°è®¾å¤‡ä¸Šé¢ç›¸äº’äº¤äº’ï¼Œå³ä¾¦å¬æ¨¡å¼/ä¼ è¾“æ¨¡å¼ åŠŸèƒ½ï¼šTelnetåŠŸèƒ½ã€è·å–bannerä¿¡æ¯ã€ä¼ è¾“æ–‡æœ¬ä¿¡æ¯ã€ä¼ è¾“æ–‡ä»¶/ç›®å½•ã€åŠ å¯†ä¼ è¾“æ–‡ä»¶ï¼Œé»˜è®¤ä¸åŠ å¯†ã€è¿œç¨‹æ§åˆ¶ã€åŠ å¯†æ‰€æœ‰æµé‡ã€æµåª’ä½“æœåŠ¡å™¨ã€è¿œç¨‹å…‹éš†ç¡¬ç›˜ object StreamingWordCount { def main(args: Array[String]): Unit = { val sparkConf = new SparkConff().setAppName(\"stream word count\").setMaster(\"local[6]\") val ssc = new StreamingContext(sparkConf, Seconds(1))//æ‰¹æ¬¡æ—¶é—´ï¼Œæ¯1ç§’æ”¶é›†ä¸€æ¬¡æ•°æ® //åœ¨åˆ›å»ºStreaming Contextçš„æ—¶å€™ä¹Ÿè¦ç”¨åˆ°confï¼Œè¯´æ˜Spark Streamingæ˜¯åŸºäºSpark Coreçš„ //åœ¨æ‰§è¡Œmasterçš„æ—¶å€™ï¼Œä¸èƒ½æŒ‡å®šä¸€ä¸ªçº¿ç¨‹ï¼šå› ä¸ºåœ¨Streamingè¿è¡Œçš„æ—¶å€™ï¼Œéœ€è¦å¼€ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»ä¸€ç›´ç›‘å¬æ•°æ®çš„è·å– //socketTextStreamæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªDStreamï¼Œç›‘å¬Socketè¾“å…¥ï¼Œå½“åšæ–‡æœ¬å¤„ç† //DStreamå¯ä»¥ç†è§£æ˜¯ä¸€ä¸ªæµå¼çš„RDD val lines: ReceiverInputDStream[String] = ssc.socketTextStream( hostnmae = \"192.168.169.101\", port = 9999, storageLevel = StoreageLevel.MEMORY_AND_DISK_SER ) //2æ•°æ®å¤„ç† // 1æ‹†åˆ†å•è¯ val words = lines.flatMap(_.split(\" \")) // 2è½¬æ¢å•è¯ val tuples = words.map((_, 1)) // 3è¯é¢‘reduce val counts = tuples.reduceByKey(_ + _) ssc.start() // mainæ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ•´ä¸ªç¨‹åºå°±ä¼šé€€å‡ºï¼Œæ‰€ä»¥éœ€è¦é˜»å¡ä¸»çº¿ç¨‹ ssc.awaitTermination() } } å®¹é”™ çƒ­å¤‡ å½“Receiverè·å–æ•°æ®ï¼Œäº¤ç»™BlockManagerå­˜å‚¨ å¦‚æœè®¾ç½®äº†StorageLevel.MEMORY_AND_DISK_SERï¼Œåˆ™æ„å‘³ç€BlockManager ä¸ä»…ä¼šåœ¨æœ¬æœºå­˜å‚¨ï¼Œä¹Ÿä¼šå‘å¾€å…¶å®ƒçš„ä¸»æœºå­˜å‚¨ï¼Œæœ¬è´¨å°±æ˜¯å†—ä½™å¤‡ä»½ å¦‚æœæŸä¸€ä¸ªè®¡ç®—å¤±è´¥äº†ï¼Œé€šè¿‡å†—ä½™çš„å¤‡ä»½ï¼Œå†æ¬¡è¿›è¡Œè®¡ç®—å³å¯ å†·å¤‡ WAL é¢„å†™æ—¥å¿— å½“æ•°æ®å‡ºé”™æ—¶ï¼Œæ ¹æ®Redo logå»é‡æ–°å¤„ç†æ•°æ® é‡æ”¾ æœ‰ä¸€äº›ä¸Šæ¸¸çš„å¤–éƒ¨ç³»ç»Ÿæ˜¯æ”¯æŒé‡æ”¾çš„ï¼Œå¦‚ Kafka Kafka å¯ä»¥æ ¹æ®Offsetæ¥è·å–æ•°æ® å‡ºé”™æ—¶ï¼Œåªéœ€é€šè¿‡Kafkaå†æ¬¡è¯»å–å³å¯ ","date":"2020-08-03","objectID":"/20200803_spark-guide3/:2:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Structured Streaming ç¼–ç¨‹æ¨¡å‹æ¼”è¿› RDDï¼š é’ˆå¯¹è‡ªå®šä¹‰çš„æ•°æ®å¯¹è±¡è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥å¤„ç†ä»»æ„ç±»å‹çš„å¯¹è±¡ï¼Œæ¯”è¾ƒç¬¦åˆé¢å‘å¯¹è±¡ RDDå¤„ç†æ•°æ®é€Ÿè¾ƒæ…¢ RDDæ— æ³•æ„ŸçŸ¥æ•°æ®çš„ç»“æ„ï¼Œæ— æ³•é’ˆå¯¹æ•°æ®ç»“æ„è¿›è¡Œç¼–ç¨‹ DataFrameï¼š ä¿ç•™å…ƒä¿¡æ¯ï¼Œé’ˆå¯¹æ•°æ®ç»“æ„è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚æ ¹æ®æŸä¸€åˆ—è¿›è¡Œæ’åºæˆ–è€…åˆ†ç»„ DFåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šç»è¿‡catalystè¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä¸”åºåˆ—åŒ–æ›´åŠ é«˜æ•ˆï¼Œæ€§èƒ½ä¼šæ›´å¥½ DFæ— æ³•å¤„ç†éç»“æ„åŒ–æ•°æ®ï¼Œå› ä¸ºDFå†…éƒ¨ä½¿ç”¨Rowå¯¹è±¡ä¿å­˜æ•°æ® DFçš„è¯»å†™æ¡†æ¶æ›´åŠ å¼ºå¤§ï¼Œæ”¯æŒå¤šç§æ•°æ®æº DataSetï¼š DSç»“åˆäº†RDDå’ŒDFçš„ç‰¹ç‚¹ï¼Œå¯ä»¥å¤„ç†ç»“æ„åŒ–æ•°æ®ï¼Œä¹Ÿå¯ä»¥å¤„ç†éç»“æ„åŒ–æ•°æ® åºåˆ—åŒ– å°†å¯¹è±¡çš„å†…å®¹å˜æˆäºŒè¿›åˆ¶æˆ–å­˜å…¥æ–‡ä»¶ä¸­ä¿å­˜ æ•°æ®åœºæ™¯ï¼š æŒä¹…åŒ–å¯¹è±¡æ•°æ® ç½‘ç»œä¸­ä¸èƒ½ä¼ è¾“Javaå¯¹è±¡ï¼Œåªèƒ½å°†å…¶åºåˆ—åŒ–åä¼ è¾“äºŒè¿›åˆ¶æ•°æ® åºåˆ—åŒ–åº”ç”¨åœºæ™¯ Taskåˆ†å‘ï¼šMasterçš„driverå¾€Workerçš„Executorä»»åŠ¡åˆ†å‘ RDDç¼“å­˜ï¼šåºåˆ—åŒ–ååˆ†å¸ƒå¼å­˜å‚¨ å¹¿æ’­å˜é‡ï¼šåºåˆ—åŒ–ååˆ†å¸ƒå¼å­˜å‚¨ Shuffleè¿‡ç¨‹ Spark Streaming çš„ Receiverï¼škafkaä¼ å…¥çš„æ•°æ®æ˜¯åºåˆ—åŒ–çš„æ•°æ® RDDçš„åºåˆ—åŒ– Kryoæ˜¯Sparkå¼•å…¥çš„ä¸€ä¸ªå¤–éƒ¨çš„åºåˆ—åŒ–å·¥å…·ï¼Œå¯ä»¥å¢å¿«RDDçš„è¿è¡Œé€Ÿåº¦ å› ä¸ºKryoåºåˆ—åŒ–åçš„å¯¹è±¡æ›´å°ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–é€Ÿåº¦éå¸¸å¿« val conf = new SparkConf() .setMaster(\"local[2]\") .setAppName(\"KyroTest\") conf.set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") conf.registerKryoClasses(Array(classOf[Person])) val sc = new SparkContext(conf) rdd.map(arr =\u003e Person(arr(0), arr(1), arr(2))) StructuredStreamingåŒºåˆ« StructuredStreamingç›¸æ¯”äºSparkStreamingçš„è¿›æ­¥ç±»ä¼¼äºRDDåˆ°Datasetçš„è¿›æ­¥ StructuredStreamingæ”¯æŒè¿ç»­æµæ¨¡å‹ï¼Œç±»ä¼¼äºFlinké‚£æ ·çš„å®æ—¶æµ StructuredStreaming Project éœ€æ±‚ å¯¹æµå¼æ•°æ®è¿›è¡Œç´¯åŠ è¯é¢‘ç»Ÿè®¡ æ•´ä½“ç»“æ„ Socket Server å‘é€æ•°æ®ï¼Œ Structured Streaming ç¨‹åºæ¥å—æ•°æ® Socket Server ä½¿ç”¨ Netcat nc æ¥å®ç° //1.åˆ›å»ºsparkSession //2.æ•°æ®è¯»å– val source: DataFrame = spark.readStream .format(\"socket\") .option(\"host\", \"192.168.168.101\") .option(\"port\", 9999) .load() val sourceDS: Dataset[String] = source.as[String] //3.æ•°æ®å¤„ç† val words = sourceDS.flatMap(_.split(\" \")) .map((_, 1)) .groupByKey(_._1) .count() //4.ç»“æœç”Ÿæˆ words.writeStream .outputMode(OutputMode.Complete()) .format(\"console\") .start() .awaitTermination() # å¼€å¯Netcat nc -lk 9999 StreamExecution åˆ†ä¸ºä¸‰ä¸ªé‡è¦çš„éƒ¨åˆ† Source ä»å¤–éƒ¨æ•°æ®æºè¯»å–æ•°æ®ï¼Œä¾‹å¦‚kafka LogicalPlan é€»è¾‘è®¡åˆ’ï¼Œåœ¨æµä¸ŠæŸ¥è¯¢è®¡åˆ’ï¼Œæ ¹æ®æºå¤´DFå¤„ç†ç”Ÿæˆé€»è¾‘è®¡åˆ’ Sink å†™å…¥ç»“æœ StateStore Structured Streaming è™½ç„¶ä»APIè§’åº¦ä¸Šæ¨¡æ‹Ÿå‡ºæ¥çš„æ˜¯ä¸€ä¸ªæ— çº¿æ‰©å±•çš„è¡¨ï¼Œä½†å…¶å†…éƒ¨è¿˜æ˜¯å¢é‡å¤„ç†ã€‚ æ¯ä¸€æ‰¹æ¬¡å¤„ç†å®Œæˆï¼Œä¼šå°†ç»“æœå†™å…¥çŠ¶æ€ã€‚æ¯ä¸€æ‰¹æ¬¡å¤„ç†ä¹‹å‰ï¼Œæ‹‰å‡ºæ¥æœ€æ–°çš„çŠ¶æ€ï¼Œåˆå¹¶åˆ°å¤„ç†è¿‡ç¨‹ä¸­ ","date":"2020-08-03","objectID":"/20200803_spark-guide3/:3:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Structured Streaming HDFS åœºæ™¯ Sqoop MySQL -\u003e Sqoop -\u003e HDFS[å¢é‡æ•°æ®1ï¼Œå¢é‡æ•°æ®2ï¼Œâ€¦ ] -\u003e Structured Streaming -\u003e Hbase Ngix Ngix[log1, log2ï¼Œâ€¦ ] -\u003e Flume -\u003e HDFS[å¢é‡æ•°æ®1ï¼Œå¢é‡æ•°æ®2ï¼Œâ€¦ ] -\u003e Structured Streaming -\u003e Hbase ç‰¹ç‚¹ ä¼šäº§ç”Ÿå¤§é‡å°æ–‡ä»¶åœ¨HDFSä¸Š Project Pythonç¨‹åºç”Ÿæˆæ•°æ®åˆ°HDFS Structured Streaming ä»HDFSä¸­è·å–æ•°æ® Structured Streaming å¤„ç†æ•°æ® # Pythonç¨‹åºç”Ÿæˆæ•°æ®åˆ°HDFS import os for index in range(100): #1.æ–‡ä»¶å†…å®¹ content = \"\"\" {\"name\": \"Michael\"} {\"name\": \"Andy\", \"age\": 30} {\"name\": \"Justin\", \"age\": 19} \"\"\" #2.æ–‡ä»¶è·¯å¾„ file_name = \"/export/dataset/text{0}.json\".format(index) #3.æ‰“å¼€æ–‡ä»¶ï¼Œå†™å…¥å†…å®¹ with open(file_name, \"w\") as file: file.write(content) #4.æ‰§è¡ŒHDFSå‘½ä»¤ï¼Œåˆ›å»ºHDFSç›®å½•ï¼Œä¸Šä¼ æ–‡ä»¶åˆ°HDFSä¸­ os.system(\"/export/servers/haddop/bin/hdfs dfs -mkdir -p /dataset/dataset/\") os.system(\"/export/servers/haddop/bin/hdfs dfs -put {0} /dataset/dataset\".format(file_name)) //Structured Streaming ä»HDFSä¸­è·å–æ•°æ® object HDFSSource{ def main(args: Array[String]): Unit = { System.setProperty(\"hadoop.home.dir\", \"C:\\\\winutil\") //1.åˆ›å»ºSparkSession val spark = SparkSession.builder() .appName(\"hdfs_souce\") .master(\"local[6]\") .getOrCreate() //2.æ•°æ®è¯»å– val schema = new StructType() .add(\"name\", \"string\") .add(\"age\", \"integer\") val souce = spark.readStream .scheme(schema) .json(\"hdfs://node01:8020/dataset/dataset\") //3.è¾“å‡ºç»“æœ source.writeStream .outputMode(OutputMode.Append()) .format(\"console\") .start() .awaitTermination() } } ","date":"2020-08-03","objectID":"/20200803_spark-guide3/:4:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Structured Streaming Kafka Kafkaæ˜¯ä¸€ä¸ª Pub/Sub ç³»ç»Ÿ Publisher / Subscriber å‘å¸ƒè®¢é˜…ç³»ç»Ÿ å‘å¸ƒè€… --\u003e kafka --\u003e è®¢é˜…è€… å‘å¸ƒè®¢é˜…ç³»ç»Ÿå¯ä»¥æœ‰å¤šä¸ªPublisherå¯¹åº”ä¸€ä¸ªSubscriberï¼Œä¾‹å¦‚å¤šä¸ªç³»ç»Ÿéƒ½ä¼šäº§ç”Ÿæ—¥å¿—ï¼Œä¸€ä¸ªæ—¥å¿—å¤„ç†å™¨å¯ä»¥ç®€å•çš„è·å–æ‰€æœ‰ç³»ç»Ÿäº§ç”Ÿçš„æ—¥å¿— ç”¨æˆ·ç³»ç»Ÿ --\u003e è®¢å•ç³»ç»Ÿ --\u003e kafka --\u003e æ—¥å¿—å¤„ç†å™¨ å†…å®¹ç³»ç»Ÿ --\u003e å‘å¸ƒè®¢é˜…ç³»ç»Ÿä¹Ÿå¯ä»¥ä¸€ä¸ªPublisherå¯¹åº”å¤šä¸ªSubscriberï¼Œ è¿™æ ·å°±ç±»ä¼¼äºå¹¿æ’­äº†ï¼Œä¾‹å¦‚é€šè¿‡è¿™æ ·çš„æ–¹å¼å¯ä»¥éå¸¸è½»æ˜“çš„å°†ä¸€ä¸ªè®¢å•çš„è¯·æ±‚åˆ†å‘ç»™æ‰€æœ‰æ„Ÿå…´è¶£çš„ç³»ç»Ÿï¼Œå‡å°‘è€¦åˆæ€§ --\u003e æ—¥å¿—å¤„ç†å™¨ ç”¨æˆ·ç³»ç»Ÿ --\u003e kafka --\u003e æ—¥å¿—å¤„ç†å™¨ --\u003e æ—¥å¿—å¤„ç†å™¨ å¤§æ•°æ®ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯ç³»ç»Ÿå¾€å¾€å¯ä»¥ä½œä¸ºæ•´ä¸ªæ•°æ®å¹³å°çš„å…¥å£ï¼Œå·¦è¾¹å¯¹æ¥ä¸šåŠ¡ç³»ç»Ÿå„ä¸ªæ¨¡å—ï¼Œå³è¾¹å¯¹æ¥æ•°æ®ç³»ç»Ÿå„ä¸ªè®¡ç®—å·¥å…· ä¸šåŠ¡ç³»ç»Ÿ æ•°æ®ç³»ç»Ÿ [ç”¨æˆ·ç³»ç»Ÿ] --\u003e --\u003e [HDFS] [è®¢å•ç³»ç»Ÿ] --\u003e kafka --\u003e [Structured Streaming] [æœåŠ¡ç³»ç»Ÿ] --\u003e --\u003e [MapReduce] Kafka çš„ç‰¹ç‚¹ Kafka éå¸¸é‡è¦çš„åº”ç”¨åœºæ™¯å°±æ˜¯å¯¹æ¥ä¸šåŠ¡ç³»ç»Ÿå’Œæ•°æ®ç³»ç»Ÿï¼Œä½œä¸ºä¸€ä¸ªæ•°æ®ç®¡é“ï¼Œå…¶éœ€è¦æµé€šçš„æ•°æ®é‡æƒŠäººï¼Œæ‰€ä»¥ Kafka ä¸€å®šæœ‰ï¼š é«˜ååé‡ é«˜å¯é æ€§ Topic å’Œ Partitions æ¶ˆæ¯å’Œäº‹ä»¶ç»å¸¸æ˜¯ä¸åŒç±»å‹çš„ï¼Œä¾‹å¦‚ç”¨æˆ·æ³¨å†Œæ˜¯ä¸€ç§æ¶ˆæ¯ï¼Œè®¢å•åˆ›å»ºä¹Ÿæ˜¯ä¸€ç§æ¶ˆæ¯ åˆ›å»ºè®¢å•äº‹ä»¶ --\u003e kafka --\u003e structured Streaming ç”¨æˆ·æ³¨å†Œäº‹ä»¶ --\u003e Kafka ä¸­ä½¿ç”¨ Topic æ¥ç»„ç»‡ä¸åŒç±»å‹çš„æ¶ˆæ¯ åˆ›å»ºè®¢å•äº‹ä»¶ --\u003e Topic Order --\u003e structured Streaming ç”¨æˆ·æ³¨å†Œäº‹ä»¶ --\u003e Topic Order Kafka ä¸­çš„ Topic è¦æ‰¿å—éå¸¸å¤§çš„ååé‡ï¼Œæ‰€ä»¥ Topic åº”è¯¥æ˜¯å¯ä»¥åˆ†ç‰‡çš„ï¼Œåº”è¯¥æ˜¯åˆ†å¸ƒå¼çš„ Anatomy of a Topic Partition 0 [0][1][2][3] Partition 1 [0][1] Partition 3 [0][1][2] Old --\u003e New Kafka å’Œ Structured Streaming æ•´åˆçš„ç»“æ„ Structured Streaming ä¸­ä½¿ç”¨ Source å¯¹æ¥å¤–éƒ¨ç³»ç»Ÿï¼Œå¯¹æ¥ Kafka çš„ Source å«åš KafkaSource KafkaSource ä¸­ä¼šä½¿ç”¨ KafkaSourceRDD æ¥æ˜ å°„å¤–éƒ¨ Kafka çš„ Topicï¼Œä¸¤è€…çš„ Partition ä¸€ä¸€å¯¹åº” Structured Streaming ä¼šå¹¶è¡Œçš„ä» Kafka ä¸­è·å–æ•°æ® Structured Streaming è¯»å– Kafka æ¶ˆæ¯çš„ä¸‰ç§æ–¹å¼ Earlist ä»æ¯ä¸ª Kafka åˆ†åŒºæœ€å¼€å§‹å¤„å¼€å§‹è·å– Assign æ‰‹åŠ¨æŒ‡å®šæ¯ä¸ª Kafka åˆ†åŒºä¸­çš„ Offset Latest ä¸å†å¤„ç†ä¹‹å‰çš„æ¶ˆæ¯ï¼Œåªè·å–æµè®¡ç®—å¯åŠ¨åæ–°äº§ç”Ÿçš„æ•°æ® PROJECT éœ€æ±‚ æ¨¡æ‹Ÿç‰©è”ç½‘ç³»ç»Ÿçš„æ•°æ®ç»Ÿè®¡ ä½¿ç”¨ç”Ÿäº§è€…åœ¨ Kafka çš„ Topicï¼šStreaming-test ä¸­è¾“å…¥ JSON æ•°æ® ä½¿ç”¨ Structured Streaming è¿‡æ»¤å‡ºæ¥å®¶é‡Œæœ‰äººçš„æ•°æ® åˆ›å»º Topic å¹¶è¾“å…¥æ•°æ®åˆ° Topic ä½¿ç”¨å‘½ä»¤åˆ›å»º Topic bin/kafka-topics.sh --create streaming-test --replication-factor 1 --partitions 3 --zookeeper node01:2181 å¼€å¯ Producer bin/kafka-console-producer.sh --broker-list node01:9092,node02:9092,node03:9092 -topic streaming-test æŠŠ Json è½¬ä¸ºå•è¡Œè¾“å…¥ Spark è¯»å– kafka çš„ Topic object KafkaSource{ def main(args: Array[String]): Unit = { //1.åˆ›å»º SparkSession //2.è¯»å– Kafka æ•°æ® val source: Dadaset[String] = spark.readSteam .format(\"kafka\") .option(\"kafka.bootstrap.servers\", \"node01:9092,node02:9092,node03:9092\") .option(\"subscribe\", \"streaming_test_1\") .option(\"startingOffsets\", \"earliest\") .load() .selectExpr(\"CAST(value AS STRING) as value\") .as[String] //3.å¤„ç†æ•°æ®ï¼ŒDataset(String) -\u003e Dataset(id, name, category) //1::Toy Story (1995)::Animation|Children's|Comedy source.map(item =\u003e { val arr = item.split(\"::\") (arr(0).toInt, arr(1).toString, arr(2).toString) }).as[(Int, String, String)].toDF(\"id\", \"name\", \"category\") //4.Sink to HDFS result.writeStream .format(\"parquet\") .option(\"path\", \"/dataset/streaming/movies/\") .option(\"checkpointLocation\", \"checkpoint\") .start() .awaitTermination() //4.Sink to Kafka result.writeStream .format(\"kafka\") .outputMode(OutputMode.Append()) .option(\"checkpointLocation\", \"checkpoint\") .option(\"kafka.bootstrap.servers\", \"node01:9092, node2:9092\") .option(\"topic\", \"streaming_test_3\") .start() .awaitTermination() //4.Sink to Mysql //ä½¿ç”¨foreachWriter } } Sink Trigger å¾®æ‰¹æ¬¡ é»˜è®¤ä¸€ç§’é—´éš” è¿ç»­æµ Trigger.Continuous(â€œ1 secondâ€)ï¼Œåªæ”¯æŒMapç±»çš„ç±»å‹æ“ä½œï¼Œä¸æ”¯æŒèšåˆï¼ŒSourceå’ŒSinkåªæ”¯æŒKafka ","date":"2020-08-03","objectID":"/20200803_spark-guide3/:5:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¢","uri":"/20200803_spark-guide3/"},{"categories":["Technology"],"content":"Article description.","date":"2020-07-07","objectID":"/20200707_spark-guide2/","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Apache Spark has its architectural foundation in the resilient distributed dataset (RDD), a read-only multiset of data items distributed over a cluster of machines, that is maintained in a fault-tolerant way. The Dataframe API was released as an abstraction on top of the RDD, followed by the Dataset API. ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:0:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Advanced Operation closure def test(): Unit = { val f = closure() f(5) } def closure(): Int =\u003e Double = { val factor = 3.14 val areaFunction = (r: int) =\u003e { math.pow(r,2) * factor } areaFunction } få°±æ˜¯é—­åŒ…ï¼Œé—­åŒ…çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•° åœ¨scalaä¸­å‡½æ•°æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ï¼ŒFunctionX é—­åŒ…ä¹Ÿæ˜¯ä¸€ä¸ªFunctionXç±»å‹çš„å¯¹è±¡ é—­åŒ…æ˜¯ä¸€ä¸ªå¯¹è±¡ class MyClass{ val field = \"Hello\" def doStuff(rdd: RDD[String]): RDD [String] = { rdd.map(x =\u003e field + x) //å¼•ç”¨Myclasså¯¹è±¡ä¸­çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œè¯´æ˜å…¶å¯ä»¥è®¿é—®MyClassè¿™ä¸ªç±»çš„æ€»ç”¨åŸŸï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé—­åŒ…ã€‚å°é—­çš„æ˜¯MyClassè¿™ä¸ªä½œç”¨åŸŸã€‚ //åœ¨å°†å…¶åˆ†å‘çš„ä¸åŒçš„Executorä¸­æ‰§è¡Œçš„æ—¶å€™ï¼Œå…¶ä¾èµ–MyClassè¿™ä¸ªç±»å½“å‰çš„å¯¹è±¡ï¼Œå› ä¸ºå…¶å°é—­äº†è¿™ä¸ªä½œç”¨åŸŸã€‚MyClasså’Œå‡½æ•°éƒ½è¦ä¸€èµ·è¢«åºåˆ—åŒ–ã€‚å‘åˆ°ä¸åŒçš„ç»“ç‚¹ä¸­æ‰§è¡Œã€‚ //1. å¦‚æœMyClassä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œå°†ä¼šæŠ¥é”™ //2. å¦‚æœåœ¨è¿™ä¸ªé—­åŒ…ä¸­ï¼Œä¾èµ–äº†ä¸€ä¸ªå¤–éƒ¨å¾ˆå¤§çš„é›†åˆï¼Œé‚£ä¹ˆè¿™ä¸ªé›†åˆä¼šéšç€æ¯ä¸€ä¸ªTaskåˆ†å‘ } } Global accumulator åœ¨ä»»æ„åœ°æ–¹åˆ›å»ºlong accumulator ç´¯åŠ  ç»“æœ val counter = sc.longAccumulator(\"counter\") val result = sc.parallelize(Seq(1,2,3,4,5)).foreach(counter.add(_)) counter.value Broadcast å¹¿æ’­å˜é‡å…è®¸å°†ä¸€ä¸ªRead-Onlyçš„å˜é‡ç¼“å­˜åˆ°é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè€Œä¸æ˜¯ä¼ é€’ç»™æ¯ä¸€ä¸ªTaskä¸€ä¸ªå‰¯æœ¬ é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æŒ‡çš„æ˜¯ä¸€ä¸ªæœºå™¨ æ¯ä¸€ä¸ªTaskï¼Œä¸€ä¸ªTaskæ˜¯ä¸€ä¸ªStageä¸­çš„æœ€å°å¤„ç†å•å…ƒï¼Œä¸€ä¸ªExecutorä¸­å¯ä»¥æœ‰å¤šä¸ªStageï¼Œæ¯ä¸ªStageæœ‰å¤šä¸ªTask æ‰€ä»¥åœ¨éœ€è¦å¤šä¸ªStageçš„å¤šä¸ªTaskä¸­ä½¿ç”¨ç›¸åŒæ•°æ®çš„æƒ…å†µä¸‹ï¼Œå¹¿æ’­ç‰¹åˆ«æœ‰ç”¨ val v = Map(\"Spark\" -\u003e \"http[123]\", \"scala\" -\u003e \"http[456]\") val config = new SparkConf().setMaster(\"local[6]\").setAppName(\"bc\") val sc = new SparkContext(config) //åˆ›å»ºå¹¿æ’­ val bc = sc.broadcast(v) val r = sc.parallelize(Seq(\"Spark\", \"Scala\")) //ä½¿ç”¨å¹¿æ’­å˜é‡ä»£æ›¿ç›´æ¥å¼•ç”¨é›†åˆï¼Œåªä¼šå¤åˆ¶å’Œexecutorä¸€æ ·çš„æ•°é‡ //åœ¨ä½¿ç”¨å¹¿æ’­ä¹‹å‰ï¼Œå¤åˆ¶mapäº†taskæ•°é‡ä»½ //åœ¨ä½¿ç”¨å¹¿æ’­ä¹‹åï¼Œå¤åˆ¶æ¬¡æ•°å’Œexecutoræ•°é‡ä¸€è‡´ val result = r.map(item =\u003e bc.value(item)).collect() ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:1:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"SparkSQL Sparkçš„RDDä¸»è¦ç”¨äºå¤„ç†éç»“æ„åŒ–æ•°æ®å’ŒåŠç»“æ„åŒ–æ•°æ® SparkSQLä¸»è¦ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ® SparkSQLæ”¯æŒï¼šå‘½ä»¤å¼ã€SQL ä¼˜åŠ¿ï¼š è™½ç„¶SparkSQLæ˜¯åŸºäºRDDçš„ï¼Œä½†æ˜¯SparkSQLçš„é€Ÿåº¦æ¯”RDDè¦å¿«å¾ˆå¤š SparkSQLæä¾›äº†æ›´å¥½çš„å¤–éƒ¨æ•°æ®æºè¯»å†™æ”¯æŒ SparkSQLæä¾›äº†ç›´æ¥è®¿é—®åˆ—çš„èƒ½åŠ› case class Person(name: String, age: Int) val spark: SparkSession = new sql.SparkSession.Builder() .appName(\"hello\") .master(\"local[6]\") .getOrCreate() impart spark.implicits._ val personRDD: RDD[people] = spark.sparkContext.parallelize(Seq(Person(\"zs\", 10),Person(\"ls\", 15))) val personDS: Dataset[Person] = PersonRDD.toDS() val teenagers: Dataset[String] = PersonDS.where('age \u003e 10) .where('age \u003c 20) .select('name) .as[String] RDDå’ŒSparkSQLè¿è¡Œæ—¶çš„åŒºåˆ« RDDçš„è¿è¡Œæµç¨‹ï¼š RDD-\u003eDAGScheduler-\u003eTaskScheduleri-\u003eWorker å…ˆå°†RDDè§£æä¸ºç”±Stageç»„æˆçš„DAGï¼Œåå°†Stageè½¬ä¸ºTaskç›´æ¥è¿è¡Œ SparkSQLçš„è¿è¡Œæµç¨‹ï¼š è§£æSQLï¼Œå¹¶ä¸”ç”ŸæˆASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ åœ¨ASTä¸­åŠ å…¥å…ƒæ•°æ®ä¿¡æ¯ï¼Œåšè¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†ä¸€äº›ä¼˜åŒ–ï¼Œä¾‹å¦‚ col = col è¿™æ ·çš„æ¡ä»¶ å¯¹å·²ç»åŠ å…¥å…ƒæ•°æ®çš„ASTï¼Œè¾“å…¥ä¼˜åŒ–å™¨ï¼Œè¿›è¡Œä¼˜åŒ–ï¼ˆä¾‹å¦‚ï¼šè°“è¯ä¸‹æ¨ï¼Œåˆ—å€¼è£å‰ªï¼‰ ç”Ÿæˆçš„ASTå…¶å®æœ€ç»ˆè¿˜æ²¡åŠæ³•ç›´æ¥è¿è¡Œï¼Œè¿™ä¸ªASTæ˜¯é€»è¾‘è®¡åˆ’ï¼Œç»“æŸåï¼Œéœ€è¦ç”Ÿæˆç‰©ç†è®¡åˆ’ï¼Œä»è€Œç”ŸæˆRDDæ¥è¿è¡Œã€‚ Dataset \u0026 DataFrame RDD ä¼˜ç‚¹ï¼š JVMå¯¹è±¡ç»„æˆçš„åˆ†å¸ƒå¼æ•°æ®é›†åˆ ä¸å¯å˜å¹¶ä¸”æœ‰å®¹é”™èƒ½åŠ› å¯å¤„ç†æœºæ„åŒ–å’Œéç»“æ„åŒ–çš„æ•°æ® æ”¯æŒå‡½æ•°å¼è½¬æ¢ RDDç¼ºç‚¹ï¼š æ²¡æœ‰Schema ç”¨æˆ·è‡ªå·±ä¼˜åŒ–ç¨‹åº ä»ä¸åŒçš„æ•°æ®æºè¯»å–æ•°æ®éå¸¸å›°éš¾ åˆå¹¶å¤šä¸ªæ•°æ®æºä¸­çš„æ•°æ®ä¹Ÿéå¸¸å›°éš¾ DataFrame: DataFrameç±»ä¼¼ä¸€å¼ å…³ç³»å‹æ•°æ®çš„è¡¨ åœ¨DataFrameä¸Šçš„æ“ä½œï¼Œéå¸¸ç±»ä¼¼SQLè¯­å¥ DataFrameä¸­æœ‰è¡Œå’Œåˆ—ï¼ŒSchema DataFrameçš„ä¼˜ç‚¹ï¼š Rowå¯¹è±¡ç»„æˆçš„åˆ†å¸ƒå¼æ•°æ®é›† ä¸å¯å˜å¹¶ä¸”æœ‰å®¹é”™èƒ½åŠ› å¤„ç†ç»“æ„åŒ–æ•°æ® è‡ªå¸¦ä¼˜åŒ–å™¨Catalyset,å¯è‡ªåŠ¨ä¼˜åŒ–ç¨‹åº Data source API DataFrameè®©Sparkå¯¹ç»“æ„åŒ–æ•°æ®æœ‰äº†å¤„ç†èƒ½åŠ› DataFrameçš„ç¼ºç‚¹ï¼š ç¼–è¯‘æ—¶ä¸èƒ½ç±»å‹è½¬åŒ–å®‰å…¨æ£€æŸ¥ï¼Œè¿è¡Œæ—¶æ‰èƒ½ç¡®å®šæ˜¯å¦æœ‰é—®é¢˜ å¯¹äºå¯¹è±¡æ”¯æŒä¸å‹å¥½ï¼Œrddå†…éƒ¨æ•°æ®ç›´æ¥ä»¥javaå¯¹è±¡å­˜å‚¨ï¼Œdataframeå†…å­˜å­˜å‚¨çš„æ˜¯rowå¯¹è±¡è€Œä¸èƒ½æ˜¯è‡ªå®šä¹‰å¯¹è±¡ Datasetçš„ä¼˜ç‚¹ï¼š DateSetæ•´åˆäº†RDDå’ŒDataFrameçš„ä¼˜ç‚¹ï¼Œæ”¯æŒç»“æ„åŒ–å’Œéç»“æ„åŒ–æ•°æ® å’ŒRDDä¸€æ ·ï¼Œæ”¯æŒè‡ªå®šä¹‰å¯¹è±¡å­˜å‚¨ å’ŒDataFrameä¸€æ ·ï¼Œæ”¯æŒç»“æ„åŒ–æ•°æ®çš„sqlæŸ¥è¯¢ é‡‡ç”¨å †å¤–å†…å­˜å­˜å‚¨ï¼Œgcå‹å¥½ ç±»å‹è½¬åŒ–å®‰å…¨ï¼Œä»£ç å‹å¥½ def dataset1(): Unit = { //1.åˆ›å»ºSparkSession val spark = new sql.SparkSession.Builder() .master(\"local[6]\") .appName(\"dateset1\") .getOrCreate() //2.å¯¼å…¥éšå¼è½¬åŒ– import spark.implicits._ //3.demo val sourceRDD = spark.sparkContext.parallelize(Seq(Person(\"zs\", 10),Person(\"ls\", 15))) val dataset = sourceRDD.toDS() //Datasetæ”¯æŒå¼ºç±»å‹API dataset.filter(item =\u003e item.age \u003e 10).show() //Datasetæ”¯æŒå¼±ç±»å‹API dataset.filter( 'age \u003e 10 ).show() dataset.filter( $\"age\" \u003e 10 ).show() //Datasetå¯ä»¥ç›´æ¥ç¼–å†™SQLè¡¨è¾¾å¼ dataset.filter( \"age \u003e 10\").show() DataFrame Practice: def dataframe1(): Unit = { //1. åˆ›å»ºSparkSession val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"pm analysis\") .getOrCreate() //2.è¯»å–æ•°æ®é›† val souceDF = spark.read .option(\"header\", value = true) .csv(\"dataset/beijingPM.csv\") //3.å¤„ç†æ•°æ®é›† sourceDF.select('year, 'month, 'PM_Dongsi) .where('PM_Dongsi =!= \"NA\") .groupBy('year, 'month) .count() .show() spark.stop() } DataFrame \u0026 Dataset åŒºåˆ«ï¼š DataFrameæ˜¯Datasetçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ŒDataFrameæ˜¯Dataset[Row]çš„åˆ«å DataFrameè¡¨è¾¾çš„å«ä¹‰æ˜¯ä¸€ä¸ªæ”¯æŒå‡½æ•°å¼æ“ä½œçš„è¡¨ï¼Œè€ŒDatasetè¡¨è¾¾æ˜¯ä¸€ä¸ªç±»ä¼¼RDDçš„ä¸œè¥¿ï¼ŒDatasetå¯ä»¥å¤„ç†ä»»ä½•å¯¹è±¡ DataFrameä¸­å­˜æ”¾çš„æ˜¯Rowå¯¹è±¡ï¼Œè€ŒDatasetä¸­å¯ä»¥å­˜æ”¾ä»»ä½•ç±»å‹çš„å¯¹è±¡ DataFrameæ˜¯å¼±ç±»å‹ï¼ŒDatasetæ˜¯å¼ºç±»å‹ã€‚DataFrameçš„æ“ä½œæ–¹å¼å’ŒDatasetæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯¹äºå¼ºç±»å‹çš„æ“ä½œè€Œè¨€ï¼Œä»–ä»¬å¤„ç†çš„ç±»å‹æ˜¯ä¸åŒçš„ DataFrameåœ¨è¿›è¡Œå¼ºç±»å‹æ“ä½œçš„æ—¶å€™ï¼Œä¾‹å¦‚mapç®—å­ï¼Œæ‰€å¤„ç†çš„æ•°æ®ç±»å‹æ°¸è¿œæ˜¯Row è€ŒDatasetï¼Œå…¶ä¸­æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä»–å°±å¤„ç†ä»€ä¹ˆç±»å‹ã€‚ val df: DataFrame = personList.toDF() df.map( (row: Row) =\u003e Row(row.get(0), row,getAs[Int](1) * 2))(RowEncoder.apply(df.schema)) val ds: Dataset[person] = personList.toDS() ds.map((person: Person =\u003e Person(person.name, person.age * 2))) DataFrameåªèƒ½åšåˆ°è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼ŒDatasetèƒ½åšåˆ°ç¼–è¯‘å’Œè¿è¡Œéƒ½æœ‰ç±»å‹æ£€æŸ¥ DataFrameå¼±ç±»å‹æ˜¯ç¼–è¯‘æ—¶ä¸å®‰å…¨(df.groupBy(â€œname, schoolâ€)) Datasetæ‰€ä»£è¡¨çš„æ“ä½œï¼Œæ˜¯ç±»å‹å®‰å…¨çš„ï¼Œç¼–è¯‘æ—¶å®‰å…¨çš„(ds.filter(person =\u003e person.name)) Row DataFrameå°±æ˜¯Rowé›†åˆåŠ ä¸ŠSchemaä¿¡æ¯ case class Person(name: String, age: Int) def row(): Unit = { //1.Rowå¦‚ä½•åˆ›å»ºï¼Œæ˜¯ä»€ä¹ˆ //rowå¯¹è±¡å¿…é¡»é…åˆSchemaå¯¹è±¡æ‰ä¼šæœ‰åˆ—å val person = Person(\"zs\", 15) val row = Row(\"zs\", 15) //2.å¦‚ä½•ä»Rowä¸­è·å–æ•°æ® row.getString(0) row.getInt(1) //3.Rowä¹Ÿæ˜¯æ ·ä¾‹ç±» row match{ case Row(name, age) =\u003e println(name, age) } } Reader def reader1(): Unit = { //1.create SparkSession val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"reader1\") .getOrCreate() //2.firstWay spark.read .format(\"csv\") .option(\"header\", value = true) .option(\"inferSchema\", value = true) .load(\"dataset/bjPM.csv\") .show(10) //3.sencendWay spark.read .option(\"header\", value = true) .option(\"inferSchema\", value = true) .csv(\"dataset/bjPM.csv\") .show(10) } Writer def writer1(): Unit = { System.setProperty(\"hodoop.home.dir\",\"c:\\\\winutils\") //1.create SparkSession val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"reader1\") .getOrCreate() //2.read data","date":"2020-07-07","objectID":"/20200707_spark-guide2/:2:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Data Type Transformation flatMap,map,mapPartitions,transform,as: class TypedTransformation{ //1.åˆ›å»ºsparksession val spark = SparkSession.builder().master(\"local[6]\").appName(\"typed\").getOrCreate() import spark.implicits._ @Test def trans():Unit = { //flatmap val ds = Seq(\"hello spark\", \"hello hadoop\").toDS ds.flatMap(item =\u003e item.split(\" \")).show() //map val ds2 = Seq(Persion(\"zs\",15),Persion(\"lisi\",20)).toDS() ds2.map(person =\u003e Person(person.name, person.age*2)).show() //mappartitions ds2.mapPartitions{ //iter ä¸èƒ½å¤§åˆ°æ¯ä¸ªExecutorçš„å†…å­˜æ”¾ä¸ä¸‹ï¼Œä¸ç„¶å°±ä¼šOOM //å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè½¬æ¢ï¼Œåç”Ÿæˆä¸€ä¸ªæ–°çš„é›†åˆ iter =\u003e{ val result = iter.map(person =\u003e Person(person.name, person.age * 2)) result } } } } def trans1(): Unit = { val ds = spark.rage(10) //0-10 ds.transform(dataset =\u003e dataset.withColumn(\"doubled\", 'id * 2')) .show() } DFè½¬æˆDS rdd.toDF -\u003e DataFrame //toDFæŠŠrddè½¬æˆDF dataFrame -\u003e Dataset //DataFrameå°±æ˜¯Dataset[Row] case class Student(name:String, age:Int, gpa:Float) //è¯»å– val schema = StructType( Seq( StructField(\"name\",StringType), StructField(\"age\",IntegerType), StructField(\"gpa\",FloatType) ) ) val df = spark.read .schema(schema) .option(\"delimiter\",\"\\t\") .csv(\"dataset/studenttab10k\") //è½¬æ¢ //æœ¬è´¨ä¸Šdataset[Row].as[Student] =\u003e Dataset[Student] val ds: Dataset[Student] = df.as[Student] //è¾“å‡º ds.show() Filter def filter(): Unit = { val ds = Seq(Person(\"zs\",15),Person(\"ls\",20)).toDS() ds.filter(person =\u003e person.age \u003e 15).show() } Group groupByKey: val ds = Seq(Person(\"zs\",15),Person(\"ls\",20)).toDS() val grouped: KeyValueGroupedDataset[String, Person] = ds.groupByKey(person =\u003e person.name) val result: Dataset[(String, Long)] = grouped.count() result.show() Split val ds = spark.range(15) //randomSplit, the number of part, weight val datasets: Array[Dataset[lang.Long]] =ds.randomSplit(Array(5,2,3)) datasets.foeach(_.show()) //split ds.sample(withReplacement = false, fraction = 0.4).show() Sort val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() ds.orderBy('name.desc).show() ds.sort('name.asc).show() Distinct distinct,dropDuplicates: def dropDuplicates(): Unit = { val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() //é‡å¤åˆ—å®Œå…¨åŒ¹é… ds.distinct().show() //æŒ‡å®šåˆ—å»é‡ ds.dropDuplicates(\"age\").show() } Collection å·®é›†ã€äº¤é›†ã€å¹¶é›†ã€limit def collection(): Unit ={ val ds1 = spark.range(1,10) val ds2 = spark.range(5,15) ds1.except(ds2) ds1.intersect(ds2) ds1.union(ds2) ds1.limit(3) } ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:3:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Data Typeless Transformation select val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() ds.sort() .... .secect('name).show() ds.selectExpr(\"sum(age)\").show() import org.apache.spark.sql.funcitons._ ds.select(exper(\"sum(age)\")).show() Column val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() import org.apache.spark.sql.funcitons._ //å¦‚æœæƒ³ä½¿ç”¨å‡½æ•°çš„åŠŸèƒ½ //1.ä½¿ç”¨functions.xx //2.ä½¿ç”¨è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨expr(\"...\")éšæ—¶ç¼–å†™è¡¨è¾¾å¼ ds.withColumn(\"random\",expr(\"rand()\")).show() ds.withColumn(\"name_new\",'name + ...).show() ds.withColumn(\"name_jok\",'name === \"\").show() ds.withColumnRenamed(\"name\",\"new_name\").show() Drop val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() ds.drop('age).show() GroupBy val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() //ä¸ºä»€ä¹ˆgroupByKeyæ˜¯æœ‰ç±»å‹çš„ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯å› ä¸ºgroupByKeyæ‰€ç”Ÿæˆçš„å¯¹è±¡ä¸­çš„ç®—å­æ˜¯æœ‰ç±»å‹çš„ ds.groupByKey(item =\u003e item.name).mapValues() //ä¸ºä»€ä¹ˆgroupByæ˜¯æ— ç±»å‹çš„ï¼Œå› ä¸ºgroupByæ‰€ç”Ÿæˆçš„å¯¹è±¡ä¸­çš„ç®—å­æ˜¯æ— ç±»å‹çš„ï¼Œé’ˆå¯¹åˆ—è¿›è¡Œå¤„ç† ds.groupBy('name).agg(mean(\"age\")).show() ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:4:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Column Creation class Column{ val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"column\") .getOrCreate() def creation():Unit = { val ds = Seq(Person(\"zs\",15),Person(\"ls\",20),Person(\"zs\",8)).toDS() val df = Seq((\"zs\",15),(\"ls\",20),(\"zs\",8)).toDF(\"name\",\"age\") //1. ' å¿…é¡»å¯¼å…¥sparkçš„éšå¼è½¬åŒ–æ‰èƒ½ä½¿ç”¨str.intern() val column: Symbol = 'name //2. $ å¿…é¡»å¯¼å…¥sparkçš„éšå¼è½¬åŒ–æ‰èƒ½ä½¿ç”¨ val column1: ColumnName = $\"name\" //3. col å¿…é¡»å¯¼å…¥functions import org.apache.spark.sql.functions._ val column2:sql.Column = col(\"name\") //4. column å¿…é¡»å¯¼å…¥functions val column3:sql.Column = column(\"name\") //Datasetå¯ä»¥ï¼ŒDataFrameå¯ä»¥ä½¿ç”¨columnå¯¹è±¡ ds.select(column).show() df.select(column).show() //columnæœ‰å››ç§åˆ›å»ºæ–¹å¼ //columnå¯¹è±¡å¯ä»¥ç”¨ä½œäºDatasetå’ŒDataFrameä¸­ //columnå¯ä»¥å’Œå‘½ä»¤å¼çš„å¼±ç±»å‹çš„APIé…åˆä½¿ç”¨:select where //5. dataset.col //ä½¿ç”¨datasetæ¥è·å–columnå¯¹è±¡ï¼Œä¼šå’ŒæŸä¸ªdatasetè¿›è¡Œç»‘å®šï¼Œåœ¨é€»è¾‘è®¡åˆ’ä¸­ï¼Œå°±ä¼šæœ‰ä¸åŒçš„è¡¨ç° val column4 = ds.col(\"name\") val column5 = ds1.col(\"name\") ds.select(column5).show() //ä¸ºä»€ä¹ˆè¦å’Œdatasetæ¥ç»‘å®šå‘¢ï¼Ÿ ds.join(ds1, ds.col(\"name\") === ds1.col(\"name\")) //6. dataset.apply val column6 = ds.apply(\"name\") val column7 = ds(\"name\") } } Type ds.select('name as \"new_name\").show() ds.select('age.as[Long]).show() API //æ·»åŠ æ–°åˆ— df.withColun(\"age\", 'age * 2).show() //æ¨¡ç³ŠæŸ¥è¯¢ ds.where('name like \"zhang%\").show() //æ’åº ds.sort('age asc).show() //æšä¸¾åˆ¤æ–­ ds.where('name isin (\"zs\",\"wu\",\"ls\")).show() ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:5:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"N/A ç¼ºå¤±å€¼çš„å¤„ç†ï¼š ä¸¢å¼ƒç¼ºå¤±å€¼çš„è¡Œ æ›¿æ¢åˆå§‹å€¼ DataFrameNaFunctions åˆ›å»º val naf: DataFrameNaFunctions = df.na åŠŸèƒ½ naf.dropâ€¦ naf.fill â€¦ df.na.drop.show() df.na.fill.show() class NullProcessor { @Test def nullAndNaN(): Unit = { //ss val spark = SparkSession.builder() .master(\"local[6]\") .appName(\"null processor\") .getOrCreate() //å¯¼å…¥ //è¯»å– // 1.é€šè¿‡spark-csvè‡ªåŠ¨çš„æ¨æ–­ç±»å‹æ¥è¯»å–ï¼Œæ¨æ–­æ•°å­—çš„æ—¶å€™ä¼šå°†NaNæ¨æ–­ä¸ºå­—ç¬¦ä¸² spark.read .option(\"header\", true) .option(\"inferSchema\",true) .csv(dataset/ds) // 2.ç›´æ¥è¯»å–å­—ç¬¦ä¸²ï¼Œåœ¨åç»­çš„æ“ä½œä¸­ä½¿ç”¨mapç®—å­è½¬æ¢ç±»å‹ spark.read.csv().map(row =\u003e row...) // 3.æŒ‡å®šSchema,ä¸è¦è‡ªåŠ¨æ¨æ–­ val schema = structType( list( StructField(\"id\",LongType), StructField(\"year\",IntegerType), StructField(\"day\",IntegerType), StructField(\"season\",IntegerType), StructField(\"pm\",DoubleType) ) ) val sourceDF = spark.read .option(\"header\", value = true) .schema(schema) .csv(\"dataset/data.csv\") .show() //ä¸¢å¼ƒ // è§„åˆ™ï¼š // 1.anyï¼šåªè¦æœ‰ä¸€ä¸ªNaNå°±ä¸¢å¼ƒ sourceDF.na.drop(\"any\").show() sourceDF.na.drop().show() // 2.all: æ‰€æœ‰æ•°æ®NaNæ‰ä¸¢å¼ƒ sourceDF.na.drop(\"all\").show() // 3.æŸäº›åˆ— sourceDF.na.drop(\"any\",List(\"year\",\"month\",\"day\")).show() //å¡«å…… // è§„åˆ™ï¼š // 1.é’ˆå¯¹æ‰€æœ‰åˆ—é»˜è®¤å€¼å¡«å…… sourceDF.na.fill(0).show() // 2.é’ˆå¯¹ç‰¹å®šåˆ—å¡«å…… sourceDF.na.fill(0,List(\"year\", \"month\")).show() } } SparkSQLå¤„ç†å¼‚å¸¸å­—ç¬¦ä¸²: def strProcessor(): Unit = { //1.ä¸¢å¼ƒ import spark.implicits._ sourceDF.where('PM_dongsi =!= \"NA\").show() //2.æ›¿æ¢ import org.apache.spark.sql.functions._ sourceDF.select( 'No as \"id\", 'year, 'month, 'day, when('PM_Dongsi === \"NA\", Double.NaN) .otherwise('PM_Dongsi cast DoubleType) .as(\"pm\") ).show() sourceDF.na.replace(\"PM_Dongsi\", Map(\"NA\" -\u003e \"NaN\", \"NULL\" -\u003e \"null\")).show() } ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:6:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"groupBy groupBy //åˆ†ç»„ val groupedDF = cleanDF.groupBy($\"year\",$\"month\") //ä½¿ç”¨functionså‡½æ•°æ¥å®Œæˆèšåˆ import org.apache.spark.sql.functions._ groupedDF.agg(avg($\"pm\") as \"pm_avg\") .orderBy($\"pm_avg\".desc) //åˆ†ç»„ç¬¬äºŒç§æ–¹å¼ groupedDF.avg(\"pm\") .select($\"avg(pm)\" as \"pm_avg\") .orderBy(\"pm_avg\") å¤šç»´èšåˆ //requirement 1:ä¸åŒå¹´ï¼Œä¸åŒæ¥æºPMå€¼çš„å¹³å‡æ•° val postAndYearDF = pmFinal.groupBy('source,'year) .agg(avg($pm) as \"pm\") //requirement 2:æŒ‰ç…§ä¸åŒçš„æ¥æºç»Ÿè®¡PMå€¼çš„å¹³å‡æ•° val postDF = pmFinal.groupBy($source) .agg(avg($pm) as \"pm\") .select($source, lit(null) as \"year\", $pm) //åˆå¹¶åœ¨åŒä¸€ä¸ªç»“æœé›†ä¸­ postAndYearDF.union(postDF) .sort($source, $year asc_nulls_last, $pm) rollup æ»šåŠ¨åˆ†ç»„ï¼šrollup(A, B)ï¼Œç”Ÿæˆä¸‰åˆ—ï¼šABåˆ†ç»„ï¼ŒA nullåˆ†ç»„ï¼Œnull(å…¨å±€)çš„åˆ†ç»„ //requirement 1: æ¯ä¸ªåŸå¸‚ï¼Œæ¯å¹´çš„é”€å”®é¢ //requirement 2: æ¯ä¸ªåŸå¸‚ï¼Œä¸€å…±çš„é”€å”®é¢ //requirement 3: æ€»ä½“é”€å”®é¢ val sales = Seq( (\"Bj\", 2016, 100), (\"Bj\", 2017, 200), (\"shanghai\", 2015, 50), (\"shanghai\", 2016, 150), (\"Guangzhou\", 2017, 50), ).toDF(\"city\", \"year\", \"amount\") sales.rollup($city, $year) .agg(sum($amount) as \"amount\") .sort($city asc asc_nulls_last, $year.asc_nulls_last) cube rollupå¯¹å‚æ•°é¡ºåºæœ‰è¦æ±‚ï¼Œcubeæ˜¯å¯¹rollupçš„å¼¥è¡¥ rollup(A, B)ï¼Œç”Ÿæˆå››åˆ—ï¼šABåˆ†ç»„ï¼ŒA nullåˆ†ç»„ï¼Œnull Båˆ†ç»„ï¼Œnull(å…¨å±€)çš„åˆ†ç»„ import org.apache.spark.sql.functions._ pmFinal.cube($source, $year) .agg(avg($pm) as \"pm\") .sort($source.asc_nulls_last, $year.asc_nulls_last) RelationalGroupedDataset groupBy, rollup, cubeåçš„æ•°æ®ç±»å‹éƒ½æ˜¯RelationalGroupedDataset RelationalGroupedDatasetå¹¶ä¸æ˜¯DataFrameï¼Œæ‰€ä»¥å…¶ä¸­å¹¶æ²¡æœ‰DataFrameçš„æ–¹æ³•ï¼Œåªæœ‰å¦‚ä¸‹ä¸€äº›èšåˆç›¸å…³çš„æ–¹æ³•ï¼Œä¸‹åˆ—æ–¹æ³•è°ƒç”¨åä¼šç”ŸæˆDataFrameå¯¹è±¡ï¼Œç„¶åå°±å¯ä»¥å†æ¬¡ä½¿ç”¨DataFrameçš„ç®—å­è¿›è¡Œæ“ä½œ æ“ä½œç¬¦ è§£é‡Š avg average count count max max min min mean average sum sum agg èšåˆï¼Œå¯ä»¥ä½¿ç”¨sql.funcitonsä¸­çš„å‡½æ•°æ¥é…åˆè¿›è¡Œæ“ä½œ pmDf.groupBy($year).agg(avg($pm) as \"pm_avg\") ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:7:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Table Join Join class JoinProcessor{ //create Spark //import implicits._ @Test def introJoin(): Unit = { val person = Seq((0, \"Lu\", 0), (1, \"Li\", 0), (2,\"Tim\", 0)) .toDF(\"id\", \"name\", \"cityID\") val cities = Seq((0, \"BJ\"), (1, \"SH\"), (2,\"GZ\")) .toDF(\"id\", \"name\") val df = person.join(cities, person.col(\"cityID\") === cities.col(\"id\")) .select(person.col(\"id\"),person.col(\"name\"),cities.col(\"name\")) df.createOrReplaceTempView(\"user_city\") } } cross äº¤å‰è¿æ¥ï¼Œç¬›å¡å°”ç§¯ def crossJoin(): Unit = { person.crossJoin(cities) .where(person.col(\"cityId\") === cities.col(\"id\")) spark.sql(\"select u.id, u.name, from person u cross join cities c\" + \"where u.cityId = c.id\") } inner äº¤é›† select * from person inner join cities on person.cityId = cities.id person.join(right = cities, joinExprs = person(\"cityId\") === citeis(\"id\"), joinType = \"inner\") outer å…¨å¤–è¿æ¥ å†…è¿æ¥çš„ç»“æœåªæœ‰è¿æ¥ä¸Šçš„æ•°æ®ï¼Œè€Œå…¨å¤–è¿æ¥å¯ä»¥åŒ…å«æ²¡æœ‰è¿æ¥ä¸Šçš„æ•°æ®ã€‚ leftouter å·¦å¤–è¿æ¥ å…¨å¤–è¿æ¥å«æ²¡æœ‰è¿æ¥ä¸Šçš„æ•°æ®ï¼Œå·¦å¤–è¿æ¥åªåŒ…å«å·¦è¾¹æ²¡æœ‰è¿æ¥ä¸Šçš„æ•°æ®ã€‚ semi\u0026anti Semi-join é€šå¸¸å‡ºç°åœ¨ä½¿ç”¨äº†existsæˆ–inçš„sqlä¸­ï¼Œæ‰€è°“semi-joinå³åœ¨ä¸¤è¡¨å…³è”æ—¶ï¼Œå½“ç¬¬äºŒä¸ªè¡¨ä¸­å­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåŒ¹é…è®°å½•æ—¶ï¼Œè¿”å›ç¬¬ä¸€ä¸ªè¡¨çš„è®°å½•ï¼› ä¸æ™®é€šjoinçš„åŒºåˆ«åœ¨äºsemi-joinæ—¶ï¼Œç¬¬ä¸€ä¸ªè¡¨é‡Œçš„è®°å½•æœ€å¤šåªè¿”å›ä¸€æ¬¡ï¼› Anti-join è€Œanti-joinåˆ™ä¸semi-joinç›¸åï¼Œå³å½“åœ¨ç¬¬äºŒå¼ è¡¨æ²¡æœ‰å‘ç°åŒ¹é…è®°å½•æ—¶ï¼Œæ‰ä¼šè¿”å›ç¬¬ä¸€å¼ è¡¨é‡Œçš„è®°å½•ï¼› å½“ä½¿ç”¨not exists/not inçš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œä¸¤è€…åœ¨å¤„ç†nullå€¼çš„æ—¶å€™ä¼šæœ‰æ‰€åŒºåˆ« ä½¿ç”¨not inä¸”ç›¸åº”åˆ—æœ‰not nullçº¦æŸ not existsï¼Œä¸ä¿è¯æ¯æ¬¡éƒ½ç”¨åˆ°anti-joinä»£ ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:8:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"UDF è‡ªå®šä¹‰åˆ—æ“ä½œå‡½æ•° ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:9:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Over Rank //1å®šä¹‰çª—å£ val window = Window.partitionBy($category) .orderBy($revenue.desc) //2å¤„ç†æ•°æ® import org.apache.spark.sql.functions._ source.select($production, $category, dense_rank() over window as \"rank\") .where($rank \u003c= 2) .show() ","date":"2020-07-07","objectID":"/20200707_spark-guide2/:10:0","tags":["Java","Spark"],"title":"Spark Guide, Part â…¡","uri":"/20200707_spark-guide2/"},{"categories":["Technology"],"content":"Article description.","date":"2020-06-15","objectID":"/20200615_hive-key-point/","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hive is a Hadoop-based data warehouse tool that maps structured data files into a database table and provides complete SQL query functionality that converts SQL statements into MapReduce tasks for execution. It is very suitable for statistical analysis of data warehouse. ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:0:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveçš„ä¸¤å¼ è¡¨å…³è”ï¼Œä½¿ç”¨MapReduceæ€ä¹ˆå®ç°ï¼Ÿ å¦‚æœå…¶ä¸­æœ‰ä¸€å¼ è¡¨ä¸ºå°è¡¨ï¼Œç›´æ¥ä½¿ç”¨mapç«¯joinçš„æ–¹å¼ï¼ˆmapç«¯åŠ è½½å°è¡¨ï¼‰è¿›è¡Œèšåˆã€‚ å¦‚æœä¸¤å¼ éƒ½æ˜¯å¤§è¡¨ï¼Œé‚£ä¹ˆé‡‡ç”¨è”åˆkeyï¼Œè”åˆkeyçš„ç¬¬ä¸€ä¸ªç»„æˆéƒ¨åˆ†æ˜¯joinonä¸­çš„å…¬å…±å­—æ®µï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€ä¸ªflagï¼Œ0ä»£è¡¨è¡¨Aï¼Œ1ä»£è¡¨è¡¨Bï¼Œç”±æ­¤è®©ReduceåŒºåˆ†å®¢æˆ·ä¿¡æ¯å’Œè®¢å•ä¿¡æ¯ï¼›åœ¨Mapperä¸­åŒæ—¶å¤„ç†ä¸¤å¼ è¡¨çš„ä¿¡æ¯ï¼Œå°†joinonå…¬å…±å­—æ®µç›¸åŒçš„æ•°æ®åˆ’åˆ†åˆ°åŒä¸€ä¸ªåˆ†åŒºä¸­ï¼Œè¿›è€Œä¼ é€’åˆ°ä¸€ä¸ªReduceä¸­ï¼Œç„¶ååœ¨Reduceä¸­å®ç°èšåˆã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:1:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveçš„ç‰¹ç‚¹ï¼ŒHiveå’ŒRDBMSæœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ hiveæ˜¯åŸºäºHadoopçš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·ï¼Œå¯ä»¥å°†ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œå¹¶æä¾›å®Œæ•´çš„sqlæŸ¥è¯¢åŠŸèƒ½ï¼Œå¯ä»¥å°†sqlè¯­å¥è½¬æ¢ä¸ºMapReduceä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚å…¶ä¼˜ç‚¹æ˜¯å­¦ä¹ æˆæœ¬ä½ï¼Œå¯ä»¥é€šè¿‡ç±»SQLè¯­å¥å¿«é€Ÿå®ç°ç®€å•çš„MapReduceç»Ÿè®¡ï¼Œä¸å¿…å¼€å‘ä¸“é—¨çš„MapReduceåº”ç”¨ï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æï¼Œä½†æ˜¯Hiveä¸æ”¯æŒå®æ—¶æŸ¥è¯¢ã€‚ Hiveä¸å…³ç³»å‹æ•°æ®åº“çš„åŒºåˆ«ï¼š hqlDifferents ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:2:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"hiveä¸­SortByï¼ŒOrderByï¼ŒClusterByï¼ŒDistrbuteByå„ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ Orderbyï¼šä¼šå¯¹è¾“å…¥åšå…¨å±€æ’åºï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªreducerï¼ˆå¤šä¸ªreduceræ— æ³•ä¿è¯å…¨å±€æœ‰åºï¼‰ã€‚åªæœ‰ä¸€ä¸ªreducerï¼Œä¼šå¯¼è‡´å½“è¾“å…¥è§„æ¨¡è¾ƒå¤§æ—¶ï¼Œéœ€è¦è¾ƒé•¿çš„è®¡ç®—æ—¶é—´ã€‚ Sortbyï¼šä¸æ˜¯å…¨å±€æ’åºï¼Œå…¶åœ¨æ•°æ®è¿›å…¥reducerå‰å®Œæˆæ’åºã€‚ Distributebyï¼šæŒ‰ç…§æŒ‡å®šçš„å­—æ®µå¯¹æ•°æ®è¿›è¡Œåˆ’åˆ†è¾“å‡ºåˆ°ä¸åŒçš„reduceä¸­ã€‚ Clusterbyï¼šé™¤äº†å…·æœ‰distributebyçš„åŠŸèƒ½å¤–è¿˜å…¼å…·sortbyçš„åŠŸèƒ½ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:3:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveä¸­splitã€coalesceåŠcollect_listå‡½æ•°çš„ç”¨æ³•ï¼ˆä¸¾ä¾‹ï¼‰ï¼Ÿ splitå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°ç»„ï¼Œå³ï¼šsplit(â€˜a,b,c,dâ€™,â€™,â€™)==\u003e[â€œaâ€,â€œbâ€,â€œcâ€,â€œdâ€]ã€‚ coalesce(Tv1,Tv2,â€¦)è¿”å›å‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªéç©ºå€¼ï¼›å¦‚æœæ‰€æœ‰å€¼éƒ½ä¸ºNULLï¼Œé‚£ä¹ˆè¿”å›NULLã€‚ collect_liståˆ—å‡ºè¯¥å­—æ®µæ‰€æœ‰çš„å€¼ï¼Œä¸å»é‡=\u003eselectcollect_list(id)fromtableã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:4:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveæœ‰å“ªäº›æ–¹å¼ä¿å­˜å…ƒæ•°æ®ï¼Œå„æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ Hiveæ”¯æŒä¸‰ç§ä¸åŒçš„å…ƒå­˜å‚¨æœåŠ¡å™¨ï¼Œåˆ†åˆ«ä¸ºï¼šå†…åµŒå¼å…ƒå­˜å‚¨æœåŠ¡å™¨ã€æœ¬åœ°å…ƒå­˜å‚¨æœåŠ¡å™¨ã€è¿œç¨‹å…ƒå­˜å‚¨æœåŠ¡å™¨ï¼Œæ¯ç§å­˜å‚¨æ–¹å¼ä½¿ç”¨ä¸åŒçš„é…ç½®å‚æ•°ã€‚ å†…åµŒå¼å…ƒå­˜å‚¨ä¸»è¦ç”¨äºå•å…ƒæµ‹è¯•ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹æ¯æ¬¡åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿æ¥åˆ°å…ƒå­˜å‚¨ï¼ŒDerbyæ˜¯å†…åµŒå¼å…ƒå­˜å‚¨çš„é»˜è®¤æ•°æ®åº“ã€‚ åœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªHiveå®¢æˆ·ç«¯éƒ½ä¼šæ‰“å¼€åˆ°æ•°æ®å­˜å‚¨çš„è¿æ¥å¹¶åœ¨è¯¥è¿æ¥ä¸Šè¯·æ±‚SQLæŸ¥è¯¢ã€‚ åœ¨è¿œç¨‹æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„Hiveå®¢æˆ·ç«¯éƒ½å°†æ‰“å¼€ä¸€ä¸ªåˆ°å…ƒæ•°æ®æœåŠ¡å™¨çš„è¿æ¥ï¼Œè¯¥æœåŠ¡å™¨ä¾æ¬¡æŸ¥è¯¢å…ƒæ•°æ®ï¼Œå…ƒæ•°æ®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ä½¿ç”¨Thriftåè®®é€šä¿¡ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:5:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveå†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨çš„åŒºåˆ«ï¼Ÿ åˆ›å»ºè¡¨æ—¶ï¼šåˆ›å»ºå†…éƒ¨è¡¨æ—¶ï¼Œä¼šå°†æ•°æ®ç§»åŠ¨åˆ°æ•°æ®ä»“åº“æŒ‡å‘çš„è·¯å¾„ï¼›è‹¥åˆ›å»ºå¤–éƒ¨è¡¨ï¼Œä»…è®°å½•æ•°æ®æ‰€åœ¨çš„è·¯å¾„ï¼Œä¸å¯¹æ•°æ®çš„ä½ç½®åšä»»ä½•æ”¹å˜ã€‚ åˆ é™¤è¡¨æ—¶ï¼šåœ¨åˆ é™¤è¡¨çš„æ—¶å€™ï¼Œå†…éƒ¨è¡¨çš„å…ƒæ•°æ®å’Œæ•°æ®ä¼šè¢«ä¸€èµ·åˆ é™¤ï¼Œè€Œå¤–éƒ¨è¡¨åªåˆ é™¤å…ƒæ•°æ®ï¼Œä¸åˆ é™¤æ•°æ®ã€‚è¿™æ ·å¤–éƒ¨è¡¨ç›¸å¯¹æ¥è¯´æ›´åŠ å®‰å…¨äº›ï¼Œæ•°æ®ç»„ç»‡ä¹Ÿæ›´åŠ çµæ´»ï¼Œæ–¹ä¾¿å…±äº«æºæ•°æ®ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:6:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveçš„å‡½æ•°ï¼šUDFã€UDAFã€UDTFçš„åŒºåˆ«ï¼Ÿ UDFï¼šå•è¡Œè¿›å…¥ï¼Œå•è¡Œè¾“å‡º UDAFï¼šå¤šè¡Œè¿›å…¥ï¼Œå•è¡Œè¾“å‡º UDTFï¼šå•è¡Œè¾“å…¥ï¼Œå¤šè¡Œè¾“å‡º ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:7:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"æ‰€æœ‰çš„Hiveä»»åŠ¡éƒ½ä¼šæœ‰MapReduceçš„æ‰§è¡Œå—ï¼Ÿ ä¸æ˜¯ï¼Œä»Hive0.10.0ç‰ˆæœ¬å¼€å§‹ï¼Œå¯¹äºç®€å•çš„ä¸éœ€è¦èšåˆçš„ç±»ä¼¼SELECTfrom LIMITnè¯­å¥ï¼Œä¸éœ€è¦èµ·MapReducejobï¼Œç›´æ¥é€šè¿‡Fetchtaskè·å–æ•°æ®ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:8:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveæ¡¶è¡¨çš„ç†è§£ï¼Ÿ æ¡¶è¡¨æ˜¯å¯¹æ•°æ®æŸä¸ªå­—æ®µè¿›è¡Œå“ˆå¸Œå–å€¼ï¼Œç„¶åæ”¾åˆ°ä¸åŒæ–‡ä»¶ä¸­å­˜å‚¨ã€‚ æ•°æ®åŠ è½½åˆ°æ¡¶è¡¨æ—¶ï¼Œä¼šå¯¹å­—æ®µå–hashå€¼ï¼Œç„¶åä¸æ¡¶çš„æ•°é‡å–æ¨¡ã€‚æŠŠæ•°æ®æ”¾åˆ°å¯¹åº”çš„æ–‡ä»¶ä¸­ã€‚ç‰©ç†ä¸Šï¼Œæ¯ä¸ªæ¡¶å°±æ˜¯è¡¨(æˆ–åˆ†åŒºï¼‰ç›®å½•é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªä½œä¸šäº§ç”Ÿçš„æ¡¶(è¾“å‡ºæ–‡ä»¶)å’Œreduceä»»åŠ¡ä¸ªæ•°ç›¸åŒã€‚ æ¡¶è¡¨ä¸“é—¨ç”¨äºæŠ½æ ·æŸ¥è¯¢ï¼Œæ˜¯å¾ˆä¸“ä¸šæ€§çš„ï¼Œä¸æ˜¯æ—¥å¸¸ç”¨æ¥å­˜å‚¨æ•°æ®çš„è¡¨ï¼Œéœ€è¦æŠ½æ ·æŸ¥è¯¢æ—¶ï¼Œæ‰åˆ›å»ºå’Œä½¿ç”¨æ¡¶è¡¨ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:9:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveåº•å±‚ä¸æ•°æ®åº“äº¤äº’åŸç†ï¼Ÿ Hiveçš„æŸ¥è¯¢åŠŸèƒ½æ˜¯ç”±HDFSå’ŒMapReduceç»“åˆèµ·æ¥å®ç°çš„ï¼Œå¯¹äºå¤§è§„æ¨¡æ•°æ®æŸ¥è¯¢è¿˜æ˜¯ä¸å»ºè®®åœ¨hiveä¸­ï¼Œå› ä¸ºè¿‡å¤§æ•°æ®é‡ä¼šé€ æˆæŸ¥è¯¢ååˆ†ç¼“æ…¢ã€‚Hiveä¸MySQLçš„å…³ç³»ï¼šåªæ˜¯å€Ÿç”¨MySQLæ¥å­˜å‚¨hiveä¸­çš„è¡¨çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œç§°ä¸ºmetastoreï¼ˆå…ƒæ•°æ®ä¿¡æ¯ï¼‰ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:10:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveæœ¬åœ°æ¨¡å¼ å¤§å¤šæ•°çš„HadoopJobæ˜¯éœ€è¦Hadoopæä¾›çš„å®Œæ•´çš„å¯æ‰©å±•æ€§æ¥å¤„ç†å¤§æ•°æ®é›†çš„ã€‚ä¸è¿‡ï¼Œæœ‰æ—¶Hiveçš„è¾“å…¥æ•°æ®é‡æ˜¯éå¸¸å°çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºæŸ¥è¯¢è§¦å‘æ‰§è¡Œä»»åŠ¡æ—¶æ¶ˆè€—å¯èƒ½ä¼šæ¯”å®é™…jobçš„æ‰§è¡Œæ—¶é—´è¦å¤šçš„å¤šã€‚å¯¹äºå¤§å¤šæ•°è¿™ç§æƒ…å†µï¼ŒHiveå¯ä»¥é€šè¿‡æœ¬åœ°æ¨¡å¼åœ¨å•å°æœºå™¨ä¸Šå¤„ç†æ‰€æœ‰çš„ä»»åŠ¡ã€‚å¯¹äºå°æ•°æ®é›†ï¼Œæ‰§è¡Œæ—¶é—´å¯ä»¥æ˜æ˜¾è¢«ç¼©çŸ­ã€‚ ç”¨æˆ·å¯ä»¥é€šè¿‡è®¾ç½®hive.exec.mode.local.autoçš„å€¼ä¸ºtrueï¼Œæ¥è®©Hiveåœ¨é€‚å½“çš„æ—¶å€™è‡ªåŠ¨å¯åŠ¨è¿™ä¸ªä¼˜åŒ–ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:11:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveä¸­çš„å‹ç¼©æ ¼å¼TextFileã€SequenceFileã€RCfileã€ORCfileå„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ 1ã€TextFile é»˜è®¤æ ¼å¼ï¼Œå­˜å‚¨æ–¹å¼ä¸ºè¡Œå­˜å‚¨ï¼Œæ•°æ®ä¸åšå‹ç¼©ï¼Œç£ç›˜å¼€é”€å¤§ï¼Œæ•°æ®è§£æå¼€é”€å¤§ã€‚å¯ç»“åˆGzipã€Bzip2ä½¿ç”¨(ç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥ï¼Œæ‰§è¡ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è§£å‹)ï¼Œä½†ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå‹ç¼©åçš„æ–‡ä»¶ä¸æ”¯æŒsplitï¼ŒHiveä¸ä¼šå¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œä»è€Œæ— æ³•å¯¹æ•°æ®è¿›è¡Œå¹¶è¡Œæ“ä½œã€‚å¹¶ä¸”åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå¿…é¡»é€ä¸ªå­—ç¬¦åˆ¤æ–­æ˜¯ä¸æ˜¯åˆ†éš”ç¬¦å’Œè¡Œç»“æŸç¬¦ï¼Œå› æ­¤ååºåˆ—åŒ–å¼€é”€ä¼šæ¯”SequenceFileé«˜å‡ åå€ã€‚ 2ã€SequenceFile SequenceFileæ˜¯HadoopAPIæä¾›çš„ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶æ”¯æŒï¼Œå­˜å‚¨æ–¹å¼ä¸ºè¡Œå­˜å‚¨ï¼Œå…¶å…·æœ‰ä½¿ç”¨æ–¹ä¾¿ã€å¯åˆ†å‰²ã€å¯å‹ç¼©çš„ç‰¹ç‚¹ã€‚ SequenceFileæ”¯æŒä¸‰ç§å‹ç¼©é€‰æ‹©ï¼šNONEï¼ŒRECORDï¼ŒBLOCKã€‚Recordå‹ç¼©ç‡ä½ï¼Œä¸€èˆ¬å»ºè®®ä½¿ç”¨BLOCKå‹ç¼©ã€‚ ä¼˜åŠ¿æ˜¯æ–‡ä»¶å’Œhadoopapiä¸­çš„MapFileæ˜¯ç›¸äº’å…¼å®¹çš„ 3ã€RCFile å­˜å‚¨æ–¹å¼ï¼šæ•°æ®æŒ‰è¡Œåˆ†å—ï¼Œæ¯å—æŒ‰åˆ—å­˜å‚¨ã€‚ç»“åˆäº†è¡Œå­˜å‚¨å’Œåˆ—å­˜å‚¨çš„ä¼˜ç‚¹ï¼š é¦–å…ˆï¼ŒRCFileä¿è¯åŒä¸€è¡Œçš„æ•°æ®ä½äºåŒä¸€èŠ‚ç‚¹ï¼Œå› æ­¤å…ƒç»„é‡æ„çš„å¼€é”€å¾ˆä½ï¼› å…¶æ¬¡ï¼Œåƒåˆ—å­˜å‚¨ä¸€æ ·ï¼ŒRCFileèƒ½å¤Ÿåˆ©ç”¨åˆ—ç»´åº¦çš„æ•°æ®å‹ç¼©ï¼Œå¹¶ä¸”èƒ½è·³è¿‡ä¸å¿…è¦çš„åˆ—è¯»å–ï¼› 4ã€ORCFile å­˜å‚¨æ–¹å¼ï¼šæ•°æ®æŒ‰è¡Œåˆ†å—æ¯å—æŒ‰ç…§åˆ—å­˜å‚¨ã€‚ å‹ç¼©å¿«ã€å¿«é€Ÿåˆ—å­˜å–ã€‚ æ•ˆç‡æ¯”rcfileé«˜ï¼Œæ˜¯rcfileçš„æ”¹è‰¯ç‰ˆæœ¬ã€‚ å°ç»“ï¼š ç›¸æ¯”TEXTFILEå’ŒSEQUENCEFILEï¼ŒRCFILEç”±äºåˆ—å¼å­˜å‚¨æ–¹å¼ï¼Œæ•°æ®åŠ è½½æ—¶æ€§èƒ½æ¶ˆè€—è¾ƒå¤§ï¼Œä½†æ˜¯å…·æœ‰è¾ƒå¥½çš„å‹ç¼©æ¯”å’ŒæŸ¥è¯¢å“åº”ã€‚ æ•°æ®ä»“åº“çš„ç‰¹ç‚¹æ˜¯ä¸€æ¬¡å†™å…¥ã€å¤šæ¬¡è¯»å–ï¼Œå› æ­¤ï¼Œæ•´ä½“æ¥çœ‹ï¼ŒRCFILEç›¸æ¯”å…¶ä½™ä¸¤ç§æ ¼å¼å…·æœ‰è¾ƒæ˜æ˜¾çš„ä¼˜åŠ¿ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:12:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Hiveè¡¨å…³è”æŸ¥è¯¢ï¼Œå¦‚ä½•è§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Ÿ 1ï¼‰å€¾æ–œåŸå› ï¼šmapè¾“å‡ºæ•°æ®æŒ‰keyHashçš„åˆ†é…åˆ°reduceä¸­ï¼Œç”±äºkeyåˆ†å¸ƒä¸å‡åŒ€ã€ä¸šåŠ¡æ•°æ®æœ¬èº«çš„ç‰¹ã€å»ºè¡¨æ—¶è€ƒè™‘ä¸å‘¨ã€ç­‰åŸå› é€ æˆçš„reduceä¸Šçš„æ•°æ®é‡å·®å¼‚è¿‡å¤§ã€‚ ï¼ˆ1ï¼‰keyåˆ†å¸ƒä¸å‡åŒ€; ï¼ˆ2ï¼‰ä¸šåŠ¡æ•°æ®æœ¬èº«çš„ç‰¹æ€§; ï¼ˆ3ï¼‰å»ºè¡¨æ—¶è€ƒè™‘ä¸å‘¨; ï¼ˆ4ï¼‰æŸäº›SQLè¯­å¥æœ¬èº«å°±æœ‰æ•°æ®å€¾æ–œ; å¦‚ä½•é¿å…ï¼šå¯¹äºkeyä¸ºç©ºäº§ç”Ÿçš„æ•°æ®å€¾æ–œï¼Œå¯ä»¥å¯¹å…¶èµ‹äºˆä¸€ä¸ªéšæœºå€¼ã€‚ 2ï¼‰è§£å†³æ–¹æ¡ˆ ï¼ˆ1ï¼‰å‚æ•°è°ƒèŠ‚ï¼š hive.map.aggr=true hive.groupby.skewindata=true æœ‰æ•°æ®å€¾æ–œçš„æ—¶å€™è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå½“é€‰é¡¹è®¾å®šä½true,ç”Ÿæˆçš„æŸ¥è¯¢è®¡åˆ’ä¼šæœ‰ä¸¤ä¸ªMRJobã€‚ç¬¬ä¸€ä¸ªMRJobä¸­ï¼ŒMapçš„è¾“å‡ºç»“æœé›†åˆä¼šéšæœºåˆ†å¸ƒåˆ°Reduceä¸­ï¼Œæ¯ä¸ªReduceåšéƒ¨åˆ†èšåˆæ“ä½œï¼Œå¹¶è¾“å‡ºç»“æœï¼Œè¿™æ ·å¤„ç†çš„ç»“æœæ˜¯ç›¸åŒçš„GroupByKeyæœ‰å¯èƒ½è¢«åˆ†å‘åˆ°ä¸åŒçš„Reduceä¸­ï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ï¼›ç¬¬äºŒä¸ªMRJobå†æ ¹æ®é¢„å¤„ç†çš„æ•°æ®ç»“æœæŒ‰ç…§GroupByKeyåˆ†å¸ƒåˆ°Reduceä¸­ï¼ˆè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä¿è¯ç›¸åŒçš„GroupByKeyè¢«åˆ†å¸ƒåˆ°åŒä¸€ä¸ªReduceä¸­ï¼‰ï¼Œæœ€åå®Œæˆæœ€ç»ˆçš„èšåˆæ“ä½œã€‚ ï¼ˆ2ï¼‰SQLè¯­å¥è°ƒèŠ‚ï¼š â‘ é€‰ç”¨joinkeyåˆ†å¸ƒæœ€å‡åŒ€çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨ã€‚åšå¥½åˆ—è£å‰ªå’Œfilteræ“ä½œï¼Œä»¥è¾¾åˆ°ä¸¤è¡¨åšjoinçš„æ—¶å€™ï¼Œæ•°æ®é‡ç›¸å¯¹å˜å°çš„æ•ˆæœã€‚ â‘¡å¤§å°è¡¨Joinï¼š ä½¿ç”¨mapjoinè®©å°çš„ç»´åº¦è¡¨ï¼ˆ1000æ¡ä»¥ä¸‹çš„è®°å½•æ¡æ•°ï¼‰å…ˆè¿›å†…å­˜ã€‚åœ¨mapç«¯å®Œæˆreduceã€‚ â‘¢å¤§è¡¨Joinå¤§è¡¨ï¼š æŠŠç©ºå€¼çš„keyå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²åŠ ä¸Šéšæœºæ•°ï¼ŒæŠŠå€¾æ–œçš„æ•°æ®åˆ†åˆ°ä¸åŒçš„reduceä¸Šï¼Œç”±äºnullå€¼å…³è”ä¸ä¸Šï¼Œå¤„ç†åå¹¶ä¸å½±å“æœ€ç»ˆç»“æœã€‚ â‘£countdistinctå¤§é‡ç›¸åŒç‰¹æ®Šå€¼: countdistinctæ—¶ï¼Œå°†å€¼ä¸ºç©ºçš„æƒ…å†µå•ç‹¬å¤„ç†ï¼Œå¦‚æœæ˜¯è®¡ç®—countdistinctï¼Œå¯ä»¥ä¸ç”¨å¤„ç†ï¼Œç›´æ¥è¿‡æ»¤ï¼Œåœ¨æœ€åç»“æœä¸­åŠ 1ã€‚å¦‚æœè¿˜æœ‰å…¶ä»–è®¡ç®—ï¼Œéœ€è¦è¿›è¡Œgroupbyï¼Œå¯ä»¥å…ˆå°†å€¼ä¸ºç©ºçš„è®°å½•å•ç‹¬å¤„ç†ï¼Œå†å’Œå…¶ä»–è®¡ç®—ç»“æœè¿›è¡Œunionã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:13:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"FetchæŠ“å– FetchæŠ“å–æ˜¯æŒ‡ï¼ŒHiveä¸­å¯¹æŸäº›æƒ…å†µçš„æŸ¥è¯¢å¯ä»¥ä¸å¿…ä½¿ç”¨MapReduceè®¡ç®—ã€‚ä¾‹å¦‚ï¼šSELECT*FROMemployees;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒHiveå¯ä»¥ç®€å•åœ°è¯»å–employeeå¯¹åº”çš„å­˜å‚¨ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç„¶åè¾“å‡ºæŸ¥è¯¢ç»“æœåˆ°æ§åˆ¶å°ã€‚ åœ¨hive-default.xml.templateæ–‡ä»¶ä¸­hive.fetch.task.conversioné»˜è®¤æ˜¯moreï¼Œè€ç‰ˆæœ¬hiveé»˜è®¤æ˜¯minimalï¼Œè¯¥å±æ€§ä¿®æ”¹ä¸ºmoreä»¥åï¼Œåœ¨å…¨å±€æŸ¥æ‰¾ã€å­—æ®µæŸ¥æ‰¾ã€limitæŸ¥æ‰¾ç­‰éƒ½ä¸èµ°mapreduceã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:14:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"å°è¡¨ã€å¤§è¡¨Join å°†keyç›¸å¯¹åˆ†æ•£ï¼Œå¹¶ä¸”æ•°æ®é‡å°çš„è¡¨æ”¾åœ¨joinçš„å·¦è¾¹ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆå‡å°‘å†…å­˜æº¢å‡ºé”™è¯¯å‘ç”Ÿçš„å‡ ç‡ï¼›å†è¿›ä¸€æ­¥ï¼Œå¯ä»¥ä½¿ç”¨Groupè®©å°çš„ç»´åº¦è¡¨ï¼ˆ1000æ¡ä»¥ä¸‹çš„è®°å½•æ¡æ•°ï¼‰å…ˆè¿›å†…å­˜ã€‚åœ¨mapç«¯å®Œæˆreduceã€‚ å®é™…æµ‹è¯•å‘ç°ï¼šæ–°ç‰ˆçš„hiveå·²ç»å¯¹å°è¡¨JOINå¤§è¡¨å’Œå¤§è¡¨JOINå°è¡¨è¿›è¡Œäº†ä¼˜åŒ–ã€‚å°è¡¨æ”¾åœ¨å·¦è¾¹å’Œå³è¾¹å·²ç»æ²¡æœ‰æ˜æ˜¾åŒºåˆ«ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:15:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"å¤§è¡¨Joinå¤§è¡¨ 1ï¼‰ç©ºKEYè¿‡æ»¤â€ƒæœ‰æ—¶joinè¶…æ—¶æ˜¯å› ä¸ºæŸäº›keyå¯¹åº”çš„æ•°æ®å¤ªå¤šï¼Œè€Œç›¸åŒkeyå¯¹åº”çš„æ•°æ®éƒ½ä¼šå‘é€åˆ°ç›¸åŒçš„reducerä¸Šï¼Œä»è€Œå¯¼è‡´å†…å­˜ä¸å¤Ÿã€‚æ­¤æ—¶æˆ‘ä»¬åº”è¯¥ä»”ç»†åˆ†æè¿™äº›å¼‚å¸¸çš„keyï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™äº›keyå¯¹åº”çš„æ•°æ®æ˜¯å¼‚å¸¸æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨SQLè¯­å¥ä¸­è¿›è¡Œè¿‡æ»¤ã€‚ä¾‹å¦‚keyå¯¹åº”çš„å­—æ®µä¸ºç©ºã€‚2ï¼‰ç©ºkeyè½¬æ¢â€ƒæœ‰æ—¶è™½ç„¶æŸä¸ªkeyä¸ºç©ºå¯¹åº”çš„æ•°æ®å¾ˆå¤šï¼Œä½†æ˜¯ç›¸åº”çš„æ•°æ®ä¸æ˜¯å¼‚å¸¸æ•°æ®ï¼Œå¿…é¡»è¦åŒ…å«åœ¨joinçš„ç»“æœä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è¡¨aä¸­keyä¸ºç©ºçš„å­—æ®µèµ‹ä¸€ä¸ªéšæœºçš„å€¼ï¼Œä½¿å¾—æ•°æ®éšæœºå‡åŒ€åœ°åˆ†ä¸åˆ°ä¸åŒçš„reducerä¸Šã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:16:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"GroupBy é»˜è®¤æƒ…å†µä¸‹ï¼ŒMapé˜¶æ®µåŒä¸€Keyæ•°æ®åˆ†å‘ç»™ä¸€ä¸ªreduceï¼Œå½“ä¸€ä¸ªkeyæ•°æ®è¿‡å¤§æ—¶å°±å€¾æ–œäº†ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„èšåˆæ“ä½œéƒ½éœ€è¦åœ¨Reduceç«¯å®Œæˆï¼Œå¾ˆå¤šèšåˆæ“ä½œéƒ½å¯ä»¥å…ˆåœ¨Mapç«¯è¿›è¡Œéƒ¨åˆ†èšåˆï¼Œæœ€ååœ¨Reduceç«¯å¾—å‡ºæœ€ç»ˆç»“æœã€‚ 1ï¼‰å¼€å¯Mapç«¯èšåˆå‚æ•°è®¾ç½®â€ƒï¼ˆ1ï¼‰æ˜¯å¦åœ¨Mapç«¯è¿›è¡Œèšåˆï¼Œé»˜è®¤ä¸ºTrueâ€ƒhive.map.aggr=trueâ€ƒï¼ˆ2ï¼‰åœ¨Mapç«¯è¿›è¡Œèšåˆæ“ä½œçš„æ¡ç›®æ•°ç›®â€ƒhive.groupby.mapaggr.checkinterval=100000â€ƒï¼ˆ3ï¼‰æœ‰æ•°æ®å€¾æ–œçš„æ—¶å€™è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼ˆé»˜è®¤æ˜¯falseï¼‰â€ƒhive.groupby.skewindata=trueå½“é€‰é¡¹è®¾å®šä¸ºtrueï¼Œç”Ÿæˆçš„æŸ¥è¯¢è®¡åˆ’ä¼šæœ‰ä¸¤ä¸ªMRJobã€‚ç¬¬ä¸€ä¸ªMRJobä¸­ï¼ŒMapçš„è¾“å‡ºç»“æœä¼šéšæœºåˆ†å¸ƒåˆ°Reduceä¸­ï¼Œæ¯ä¸ªReduceåšéƒ¨åˆ†èšåˆæ“ä½œï¼Œå¹¶è¾“å‡ºç»“æœï¼Œè¿™æ ·å¤„ç†çš„ç»“æœæ˜¯ç›¸åŒçš„GroupByKeyæœ‰å¯èƒ½è¢«åˆ†å‘åˆ°ä¸åŒçš„Reduceä¸­ï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ï¼›ç¬¬äºŒä¸ªMRJobå†æ ¹æ®é¢„å¤„ç†çš„æ•°æ®ç»“æœæŒ‰ç…§GroupByKeyåˆ†å¸ƒåˆ°Reduceä¸­ï¼ˆè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä¿è¯ç›¸åŒçš„GroupByKeyè¢«åˆ†å¸ƒåˆ°åŒä¸€ä¸ªReduceä¸­ï¼‰ï¼Œæœ€åå®Œæˆæœ€ç»ˆçš„èšåˆæ“ä½œã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:17:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Count(Distinct)å»é‡ç»Ÿè®¡ æ•°æ®é‡å°çš„æ—¶å€™æ— æ‰€è°“ï¼Œæ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ï¼Œç”±äºCOUNTDISTINCTæ“ä½œéœ€è¦ç”¨ä¸€ä¸ªReduceTaskæ¥å®Œæˆï¼Œè¿™ä¸€ä¸ªReduceéœ€è¦å¤„ç†çš„æ•°æ®é‡å¤ªå¤§ï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªJobå¾ˆéš¾å®Œæˆï¼Œä¸€èˆ¬COUNTDISTINCTä½¿ç”¨å…ˆGROUPBYå†COUNTçš„æ–¹å¼æ›¿æ¢ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:18:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"ç¬›å¡å°”ç§¯ å°½é‡é¿å…ç¬›å¡å°”ç§¯ï¼Œjoinçš„æ—¶å€™ä¸åŠ onæ¡ä»¶ï¼Œæˆ–è€…æ— æ•ˆçš„onæ¡ä»¶ï¼ŒHiveåªèƒ½ä½¿ç”¨1ä¸ªreduceræ¥å®Œæˆç¬›å¡å°”ç§¯ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:19:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"è¡Œåˆ—è¿‡æ»¤ åˆ—å¤„ç†ï¼šåœ¨SELECTä¸­ï¼Œåªæ‹¿éœ€è¦çš„åˆ—ï¼Œå¦‚æœæœ‰ï¼Œå°½é‡ä½¿ç”¨åˆ†åŒºè¿‡æ»¤ï¼Œå°‘ç”¨SELECT*ã€‚ è¡Œå¤„ç†ï¼šåœ¨åˆ†åŒºå‰ªè£ä¸­ï¼Œå½“ä½¿ç”¨å¤–å…³è”æ—¶ï¼Œå¦‚æœå°†å‰¯è¡¨çš„è¿‡æ»¤æ¡ä»¶å†™åœ¨Whereåé¢ï¼Œé‚£ä¹ˆå°±ä¼šå…ˆå…¨è¡¨å…³è”ï¼Œä¹‹åå†è¿‡æ»¤ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:20:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"å¹¶è¡Œæ‰§è¡Œ Hiveä¼šå°†ä¸€ä¸ªæŸ¥è¯¢è½¬åŒ–æˆä¸€ä¸ªæˆ–è€…å¤šä¸ªé˜¶æ®µã€‚è¿™æ ·çš„é˜¶æ®µå¯ä»¥æ˜¯MapReduceé˜¶æ®µã€æŠ½æ ·é˜¶æ®µã€åˆå¹¶é˜¶æ®µã€limité˜¶æ®µã€‚æˆ–è€…Hiveæ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦çš„å…¶ä»–é˜¶æ®µã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒHiveä¸€æ¬¡åªä¼šæ‰§è¡Œä¸€ä¸ªé˜¶æ®µã€‚ä¸è¿‡ï¼ŒæŸä¸ªç‰¹å®šçš„jobå¯èƒ½åŒ…å«ä¼—å¤šçš„é˜¶æ®µï¼Œè€Œè¿™äº›é˜¶æ®µå¯èƒ½å¹¶éå®Œå…¨äº’ç›¸ä¾èµ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰äº›é˜¶æ®µæ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè¿™æ ·å¯èƒ½ä½¿å¾—æ•´ä¸ªjobçš„æ‰§è¡Œæ—¶é—´ç¼©çŸ­ã€‚ä¸è¿‡ï¼Œå¦‚æœæœ‰æ›´å¤šçš„é˜¶æ®µå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆjobå¯èƒ½å°±è¶Šå¿«å®Œæˆã€‚ é€šè¿‡è®¾ç½®å‚æ•°hive.exec.parallelå€¼ä¸ºtrueï¼Œå°±å¯ä»¥å¼€å¯å¹¶å‘æ‰§è¡Œã€‚ä¸è¿‡ï¼Œåœ¨å…±äº«é›†ç¾¤ä¸­ï¼Œéœ€è¦æ³¨æ„ä¸‹ï¼Œå¦‚æœjobä¸­å¹¶è¡Œé˜¶æ®µå¢å¤šï¼Œé‚£ä¹ˆé›†ç¾¤åˆ©ç”¨ç‡å°±ä¼šå¢åŠ ã€‚ ","date":"2020-06-15","objectID":"/20200615_hive-key-point/:21:0","tags":["Hdfs","Hive"],"title":"Hive Key Points","uri":"/20200615_hive-key-point/"},{"categories":["Technology"],"content":"Article description.","date":"2020-05-27","objectID":"/20200527_spark-guide1/","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Apache Spark has its architectural foundation in the resilient distributed dataset (RDD), a read-only multiset of data items distributed over a cluster of machines, that is maintained in a fault-tolerant way. The Dataframe API was released as an abstraction on top of the RDD, followed by the Dataset API. ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:0:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Spark Introduction 1 Spark Component Sparkæä¾›äº†æ‰¹å¤„ç†ï¼ˆRDDsï¼‰ï¼Œç»“æ„åŒ–æŸ¥è¯¢ï¼ˆDataFrameï¼‰ï¼Œæµè®¡ç®—ï¼ˆSparkStreamingï¼‰ï¼Œæœºå™¨å­¦ä¹ ï¼ˆMLibï¼‰ï¼Œå›¾è®¡ç®—ï¼ˆGraphXï¼‰ç­‰ç»„ä»¶ è¿™äº›ç»„ä»¶å‡æ˜¯ä¾æ‰˜äºé€šç”¨çš„è®¡ç®—å¼•æ“RDDsè€Œæ„å»ºå‡ºï¼Œæ‰€ä»¥spark-coreçš„RDDsæ˜¯æ•´ä¸ªSparkçš„åŸºç¡€ sparkStructure 2 Spark \u0026 Hadoop Hadoop Spark ç±»å‹ åŸºç¡€å¹³å°ï¼ŒåŒ…å«è®¡ç®—ï¼Œå­˜å‚¨ï¼Œè°ƒåº¦ åˆ†å¸ƒå¼è®¡ç®—å·¥å…·ï¼ˆä¸»è¦ä»£æ›¿Hadoopçš„è®¡ç®—åŠŸèƒ½ï¼‰ åœºæ™¯ å¤§è§„æ¨¡æ•°æ®é›†ä¸Šçš„æ‰¹å¤„ç† è¿­ä»£è®¡ç®—ï¼Œäº¤äº’å¼è®¡ç®—ï¼Œæµè®¡ç®— å»¶è¿Ÿ å¤§ å° æ˜“ç”¨æ€§ APIè¾ƒä¸ºåº•å±‚ï¼Œç®—æ³•é€‚åº”æ€§å·® APIè¾ƒä¸ºé¡¶å±‚ï¼Œæ–¹ä¾¿ä½¿ç”¨ ä»·æ ¼ æ€§èƒ½è¦æ±‚ä½ï¼Œä¾¿å®œ å¯¹å†…å­˜è¦æ±‚é«˜ï¼Œç›¸å¯¹è¾ƒè´µ ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:1:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Spark Cluster 1 Cluster relation clusterManager Driverï¼šè¯¥è¿›ç¨‹è°ƒç”¨Sparkç¨‹åºçš„mainæ–¹æ³•ï¼Œå¹¶ä¸”å¯åŠ¨SparkContext Cluster Managerï¼šè¯¥è¿›ç¨‹è´Ÿè´£å’Œå¤–éƒ¨é›†ç¾¤å·¥å…·æ‰“äº¤é“ï¼Œç”³è¯·æˆ–é‡Šæ”¾é›†ç¾¤èµ„æº Workerï¼šè¯¥è¿›ç¨‹æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œè´Ÿè´£å¯åŠ¨å’Œç®¡ç†Executor Executorï¼šè¯¥è¿›ç¨‹æ˜¯ä¸€ä¸ªJVMè™šæ‹Ÿæœºï¼Œè´Ÿè´£è¿è¡ŒSpark Task è¿è¡Œä¸€ä¸ªSparkç¨‹åºå¤§è‡´ç»å†å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š å¯åŠ¨Driverï¼Œåˆ›å»ºSparkContext Clientæäº¤ç¨‹åºç»™Driveï¼ŒDriveå‘Cluster Managerç”³è¯·é›†ç¾¤èµ„æº èµ„æºç”³è¯·å®Œæ¯•ï¼Œåœ¨Workerä¸­å¯åŠ¨Executor Driverå°†ç¨‹åºè½¬åŒ–ä¸ºTasksï¼Œåˆ†å‘ç»™Executoræ‰§è¡Œ 2 Build Cluster Download Spark Upload Config HistoryServer Distribute: scp -r spark node02: $PWD Start 3 High Availability å¯¹äº Spark Standalone é›†ç¾¤æ¥è¯´ï¼Œå½“Workerè°ƒåº¦å‡ºç°é—®é¢˜æ—¶ï¼Œä¼šè‡ªåŠ¨çš„å¼¹æ€§å®¹é”™ï¼Œå°†å‡ºé”™çš„Taskè°ƒåº¦åˆ°å…¶ä»–Workeræ‰§è¡Œã€‚ ä½†å¯¹äºMasteræ¥è¯´ï¼Œæ˜¯ä¼šå‡ºç°å•ç‚¹å¤±è´¥çš„ï¼Œä¸ºäº†é¿å…å¯èƒ½å‡ºç°çš„å•ç‚¹å¤±è´¥é—®é¢˜ï¼ŒSparkæä¾›äº†ä¸¤ç§æ–¹å¼æ»¡è¶³é«˜å¯ç”¨ ä½¿ç”¨Zookeeperå®ç°Masterçš„ä¸»å¤‡åˆ‡æ¢(Zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å¼ºä¸€è‡´æ€§çš„åè°ƒæœåŠ¡ï¼ŒZookeeperæœ€åŸºæœ¬çš„ä¸€ä¸ªä¿è¯æ˜¯ï¼šå¦‚æœå¤šä¸ªèŠ‚ç‚¹åŒæ—¶åˆ›å»ºä¸€ä¸ªZNode)åªæœ‰ä¸€ä¸ªèƒ½å¤ŸæˆåŠŸåˆ›å»ºï¼Œè¿™ä¸ªåšæ³•çš„æœ¬è´¨ä½¿ç”¨çš„æ˜¯Zookeeperçš„ZABåè®®ï¼Œèƒ½å¤Ÿåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¾¾æˆä¸€è‡´ã€‚ ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿåšä¸»å¤‡åˆ‡æ¢ ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:2:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Running Process 1 Spark-Shell Run val rdd1 = sc.textFile(\"/data/wordcount.txt\") //Hadoopé»˜è®¤è¯»å–hdfsè·¯å¾„ï¼šhdfs:///data/wordcount.txt val rdd2 = rddflatMap(item =\u003e item.split(\" \")) val rdd3 = rdd2.map(item =\u003e (item,1)) val rdd4 = rdd3.reduceByKey((curr,agg) =\u003e curr + agg) rdd4.collect() sparkRunProcess 2 Local IDEA Run def main(args:Arrary[String]): Unit = { // åˆ›å»ºSparkContext val conf = new SparkConf().setMaster(\"local[6]\").setAppName(\"word_count\") val sc = new SparkContext(conf) //2. åŠ è½½æ–‡ä»¶ // å‡†å¤‡æ–‡ä»¶ // 2.è¯»å–æ–‡ä»¶ val rdd1 = sc.testFile(path = \"dataset/wordcount.txt\") //3. å¤„ç† // æ‹†åˆ†ä¸ºå¤šä¸ªå•è¯ val rdd2 = rddflatMap(item =\u003e item.split(\" \")) // 2.æŠŠæ¯ä¸ªå•è¯æŒ‡å®šä¸€ä¸ªè¯é¢‘ val rdd3 = rdd2.map(item =\u003e (item,1)) // 3.èšåˆ val rdd4 = rdd3.reduceByKey((curr,agg) =\u003e curr + agg) //4.å¾—åˆ°ç»“æœ val result = rdd4.collect() result.foreach(item =\u003e println(item)) } 3 Submit Run ä¿®æ”¹ä»£ç  å»æ‰masterè®¾ç½®ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶è·¯å¾„ Mavenæ‰“åŒ…ä¸Šä¼  åœ¨é›†ç¾¤ä¸­è¿è¡Œ bin/spark -submit --class cn.demo.spark.rdd.WordCount --master spark://node01:7077 ~/original -spark-0.0.jar ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:3:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"RDD 1 Cause of creation åœ¨RDDå‡ºç°ä¹‹å‰ï¼ŒMapReduceæ˜¯æ¯”è¾ƒä¸»æµçš„ ä½†å¤šä¸ªMapReduceä»»åŠ¡ä¹‹é—´æ²¡æœ‰åŸºäºå†…å­˜çš„æ•°æ®å…±äº«æ–¹å¼ï¼Œåªèƒ½é€šè¿‡ç£ç›˜æ¥è¿›è¡Œå…±äº«ï¼Œè¿™ç§æ–¹å¼æ˜æ˜¾æ¯”è¾ƒä½æ•ˆã€‚ RDDå¦‚ä½•è§£å†³è¿­ä»£è®¡ç®—éå¸¸ä½æ•ˆçš„é—®é¢˜ åœ¨Sparkä¸­ï¼Œæœ€ç»ˆJob3ä»é€»è¾‘ä¸Šçš„è®¡ç®—è¿‡ç¨‹æ˜¯ï¼šJob3 = (Job1.map).filterï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯å…±äº«å†…å­˜çš„ï¼Œè€Œä¸éœ€è¦ä¸­é—´ç»“æœå­˜æ”¾åœ¨å¯é çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ 2 Resilient Distributed Datasets åˆ†å¸ƒå¼ RDDæ”¯æŒåˆ†åŒºï¼Œå¯ä»¥è¿è¡Œåœ¨é›†ç¾¤ä¸­ å¼¹æ€§ RDDæ”¯æŒé«˜æ•ˆçš„å®¹é”™ RDDä¸­çš„æ•°æ®å³å¯ä»¥ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œä¹Ÿå¯ä»¥ç¼“å­˜åœ¨ç£ç›˜ä¸­ï¼Œä¹Ÿå¯ä»¥ç¼“å­˜åœ¨å¤–éƒ¨å­˜å‚¨ä¸­ æ•°æ®é›† RDDå¯ä»¥ä¸ä¿å­˜å…·ä½“æ•°æ®ï¼Œåªä¿ç•™åˆ›å»ºè‡ªå·±çš„å¿…å¤‡ä¿¡æ¯ï¼Œä¾‹å¦‚ä¾èµ–å’Œè®¡ç®—å‡½æ•° RDDä¹Ÿå¯ä»¥ç¼“å­˜èµ·æ¥ï¼Œç›¸å½“äºå­˜å‚¨å…·ä½“æ•°æ® 3 Feature RDDæ˜¯æ•°æ®é›† RDDä¸ä»…æ˜¯æ•°æ®é›†ï¼Œä¹Ÿæ˜¯ç¼–ç¨‹æ¨¡å‹ RDDçš„ç®—å­å¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š Transformationè½¬åŒ–æ“ä½œï¼Œä¾‹å¦‚ï¼šmapã€flatMapã€filterç­‰ ActionåŠ¨ä½œæ“ä½œï¼Œä¾‹å¦‚ï¼šreduceã€collectã€showç­‰ RDDæ˜¯ç¼–ç¨‹æ¨¡å‹ RDDç›¸äº’ä¹‹é—´æœ‰ä¾èµ–å…³ç³» RDDæ˜¯å¯ä»¥åˆ†åŒºçš„ RDDæ˜¯åªè¯»çš„ RDDéœ€è¦å®¹é”™ï¼Œå¯ä»¥æƒ°æ€§æ±‚å€¼ï¼Œå¯ä»¥ç§»åŠ¨è®¡ç®—ï¼Œæ‰€ä»¥å¾ˆéš¾æ”¯æŒä¿®æ”¹ï¼Œæ˜¾è‘—é™ä½é—®é¢˜çš„å¤æ‚åº¦ã€‚ sparkRdd 4 sparkContext SparkContextæ˜¯sparkåŠŸèƒ½çš„ä¸»è¦å…¥å£ã€‚å…¶ä»£è¡¨ä¸sparké›†ç¾¤çš„è¿æ¥ï¼Œèƒ½å¤Ÿç”¨æ¥åœ¨é›†ç¾¤ä¸Šåˆ›å»ºRDDã€ç´¯åŠ å™¨ã€å¹¿æ’­å˜é‡ã€‚æ¯ä¸ªJVMé‡Œåªèƒ½å­˜åœ¨ä¸€ä¸ªå¤„äºæ¿€æ´»çŠ¶æ€çš„SparkContextï¼Œåœ¨åˆ›å»ºæ–°çš„SparkContextä¹‹å‰å¿…é¡»è°ƒç”¨stop()æ¥å…³é—­ä¹‹å‰çš„SparkContextã€‚ æ¯ä¸€ä¸ªSparkåº”ç”¨éƒ½æ˜¯ä¸€ä¸ªSparkContextå®ä¾‹ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªSparkContextå°±æ˜¯ä¸€ä¸ªspark applicationçš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦SparkContextåˆ›å»ºä¹‹åï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªSparkContextæ¥åˆ›å»ºRDDã€ç´¯åŠ å™¨ã€å¹¿æ’­å˜é‡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡SparkContextè®¿é—®Sparkçš„æœåŠ¡ï¼Œè¿è¡Œä»»åŠ¡ã€‚spark contextè®¾ç½®å†…éƒ¨æœåŠ¡ï¼Œå¹¶å»ºç«‹ä¸sparkæ‰§è¡Œç¯å¢ƒçš„è¿æ¥ã€‚ @Test def sparkContext(): Unit = { // Spark Context ç¼–å†™ // åˆ›å»ºSparkConf val conf = new SparkConf().setMaster(\"local[6]\").setAppName(\"spark_context\") // 2.åˆ›å»ºSparkContext val sc = new SparkContext(conf) //SparkContextèº«ä¸ºå¤§å…¥å£APIï¼Œåº”è¯¥èƒ½å¤Ÿåˆ›å»ºRDDï¼Œå¹¶ä¸”è®¾ç½®å‚æ•°ï¼Œè®¾ç½®JaråŒ… //sc... //2. å…³é—­SparkContextï¼Œé‡Šæ”¾é›†ç¾¤èµ„æº } 5 Creation Way ä¸‰ç§RDDçš„åˆ›å»ºæ–¹å¼ é€šè¿‡æœ¬åœ°é›†åˆåˆ›å»ºRDD @Test def rddCreationLocal(): Unit = { val conf = new SparkConf().setMaster(\"local[6]\").setAppName(\"spark_context\") val sc = new SparkContext(conf) val rdd1 = sc.parallelize(Seq(\"Hello1\", \"Hello2\", \"Hello3\"), 2) val rdd2 = sc.makeRDD(seq, 2) // parallelizeå’ŒmakeRDDåŒºåˆ«ï¼šparallelizeå¯ä»¥ä¸æŒ‡å®šåˆ†åŒºæ•° } 2. é€šè¿‡å¤–éƒ¨æ•°æ®åˆ›å»ºRDD @Test def rddCreationFiles(): Unit = { sc.textFile(\"/.../...\") //testFile: ä¼ å…¥* hdfs:// file:// /.../...(è¿™ç§æ–¹å¼åˆ†ä¸ºåœ¨é›†ç¾¤è¿˜æ˜¯æœ¬åœ°æ‰§è¡Œï¼Œåœ¨é›†ç¾¤ä¸­è¯»çš„æ˜¯hdfsï¼Œæœ¬åœ°è¯»æœ¬åœ°æ–‡ä»¶) //2.æ˜¯å¦æ”¯æŒåˆ†åŒºï¼šæ”¯æŒï¼Œåœ¨hdfsä¸­ç”±hdfsæ–‡ä»¶çš„blockå†³å®š //3.æ”¯æŒä»€ä¹ˆå¹³å°ï¼šæ”¯æŒawså’Œé˜¿é‡Œäº‘... } 3. é€šè¿‡RDDè¡ç”Ÿæ–°çš„RDD @Test def rddCreationFromRDD(): Unit = { val rdd1 = sc.parallelize(Seq(1,2,3)) //é€šè¿‡åœ¨rddä¸Šæ‰§è¡Œç®—å­æ“ä½œï¼Œä¼šç”Ÿæˆæ–°çš„rdd //éåŸåœ°è®¡ç®—ï¼šstr.substr è¿”å›æ–°çš„å­—ç¬¦ä¸²ï¼ŒéåŸåœ°è®¡ç®—ã€‚å­—ç¬¦ä¸²ä¸å¯å˜ï¼ŒRDDä¹Ÿä¸å¯å˜ val rdd2: RDD[Int] = rddmap(item =\u003e item) } ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:4:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Transformation Operator map() @Test def mapTest(): Unit = { //åˆ›å»ºRDD val rdd1 = sc.parallelize(Seq(1,2,3)) //2.æ‰§è¡Œmapæ“ä½œ val rdd2 = rdd1.map(item =\u003e item * 10) //3.å¾—åˆ°ç»“æœ val result = rdd2.collect() result.foreach(item =\u003e println(item)) } flatmap() æŠŠrddä¸­çš„æ•°æ®è½¬åŒ–æˆæ•°ç»„æˆ–é›†åˆå½¢å¼ æŠŠé›†åˆå±•å¼€ ç”Ÿæˆäº†å¤šæ¡æ•°æ® flatmapæ˜¯ä¸€å¯¹å¤š @Test def flatMapTest(): Unit = { val rdd1 = sc.parallelize(Seq(\"Hello a\",\"Hello b\",\"Hello c\")) val rdd2 = rddf1.latMap( item =\u003e item.split(\" \")) val result = rdd2.collect() result.foreach(item =\u003e println(item)) sc.stop() } reducebykey() reduceByKeyç¬¬ä¸€æ­¥å…ˆæŒ‰ç…§keyåˆ†ç»„ï¼Œç„¶åå¯¹æ¯ä¸€ç»„è¿›è¡Œèšåˆï¼Œå¾—åˆ°ç»“æœã€‚ @Test def reduceBykeyTest(): Unit = { //åˆ›å»ºRDD val rdd1 = sc.parallelize(Seq(\"Hello a\",\"Hello b\",\"Hello c\")) //2.å¤„ç†æ•°æ® val rdd2 = rdd1.flatMap( item =\u003e item.split(\" \")) .map( item =\u003e (item,1) ) .reduceByKey( (curr, agg) =\u003e curr + agg)//curræ˜¯å½“å‰çš„æ€»å€¼ï¼Œaggæ˜¯å•ä¸ªitemçš„å€¼ //3.å¾—åˆ°ç»“æœ val result = rdd2.collect() result.foreach(item =\u003e println(item)) //4.å…³é—­sc sc.stop() } Q\u0026A æ•°æ®é‡è¿‡å¤§ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ é›†ç¾¤ä¸­å¤„ç†ï¼Œåˆ©ç”¨é›†ç¾¤å¤šå°è®¡ç®—æœºæ¥å¹¶è¡Œå¤„ç† å¦‚ä½•æ”¾åœ¨é›†ç¾¤ä¸­è¿è¡Œ? sparkPutFile2Cluster å¹¶è¡Œè®¡ç®—å°±æ˜¯åŒæ—¶ä½¿ç”¨å¤šä¸ªè®¡ç®—èµ„æºè§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œæœ‰å››ä¸ªè¦ç‚¹ è§£å†³çš„é—®é¢˜å¯ä»¥åˆ†è§£ä¸ºå¤šä¸ªå¯ä»¥å¹¶å‘è®¡ç®—çš„éƒ¨åˆ† æ¯ä¸ªéƒ¨åˆ†å¯ä»¥åœ¨ä¸åŒå¤„ç†å™¨ä¸Šè¢«åŒæ—¶æ‰§è¡Œ éœ€è¦ä¸€ä¸ªå…±äº«å†…å­˜çš„æœºåˆ¶ éœ€è¦ä¸€ä¸ªæ€»ä½“ä¸Šçš„åä½œæœºåˆ¶æ¥è¿›è¡Œè°ƒåº¦ å¦‚æœæ”¾åœ¨é›†ç¾¤ä¸­ï¼Œå¦‚ä½•å¯¹æ•´ä¸ªè®¡ç®—ä»»åŠ¡è¿›è¡Œåˆ†è§£ï¼Ÿ sparkFile2Cluster2 æ¦‚è¿° å¯¹äºHDFSä¸­çš„æ–‡ä»¶ï¼Œæ˜¯åˆ†ä¸ºä¸åŒçš„Block åœ¨è¿›è¡Œè®¡ç®—çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŒ‰ç…§Blockæ¥åˆ’åˆ†ï¼Œæ¯ä¸€ä¸ªBlockå¯¹åº”ä¸€ä¸ªä¸åŒçš„è®¡ç®—å•å…ƒ æ‰©å±• RDDå¹¶æ²¡æœ‰çœŸå®çš„å­˜æ”¾æ•°æ®ï¼Œæ•°æ®æ˜¯ä»HDFSä¸­è¯»å–çš„ï¼Œåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­è¯»å–å³å¯ RDDè‡³å°‘æ˜¯éœ€è¦å¯ä»¥åˆ†ç‰‡çš„ï¼Œå› ä¸ºHDFSä¸­çš„æ–‡ä»¶å°±æ˜¯åˆ†ç‰‡çš„ï¼ŒRDDå¯ä»¥åˆ†ç‰‡ä¹Ÿæ„å‘³ç€å¯ä»¥å¹¶è¡Œè®¡ç®— ç§»åŠ¨æ•°æ®ä¸å¦‚ç§»åŠ¨è®¡ç®—æ˜¯ä¸€ä¸ªåŸºç¡€çš„ä¼˜åŒ–ï¼Œå¦‚ä½•åšåˆ°ï¼Ÿ æ¯ä¸€ä¸ªè®¡ç®—å•å…ƒéœ€è¦è®°å½•å…¶å­˜å‚¨å•å…ƒçš„ä½ç½®ï¼Œå°½é‡è°ƒåº¦è¿‡å» é›†ç¾¤ä¸­è¿è¡Œï¼Œéœ€è¦å¤šèŠ‚ç‚¹é…åˆï¼Œå‡ºé”™çš„æ¦‚ç‡ä¹Ÿæ›´é«˜ï¼Œå‡ºé”™äº†æ€ä¹ˆåŠï¼Ÿ RDD1-\u003eRDD2-\u003eRDD3è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒRDD2å‡ºé”™äº†ï¼Œæœ‰ä¸¤ç§è§£å†³åŠæ³• ç¼“å­˜RDD2çš„æ•°æ®ï¼Œç›´æ¥æ¢å¤RDD2ï¼Œç±»ä¼¼HDFSçš„å¤‡ä»½æœºåˆ¶ è®°å½•RDD2çš„ä¾èµ–å…³ç³»ï¼Œé€šè¿‡å…¶çˆ¶çº§çš„RDDæ¥æ¢å¤RDD2ï¼Œè¿™ç§æ–¹å¼ä¼šå°‘å¾ˆå¤šæ•°æ®çš„äº¤äº’å’Œä¿å­˜ å¦‚ä½•é€šè¿‡çˆ¶çº§RDDæ¢å¤ï¼Ÿ è®°å½•RDD2çš„çˆ¶äº²æ˜¯RDD1 è®°å½•RDD2çš„è®¡ç®—å‡½æ•°ï¼Œä¾‹å¦‚RDD2 = RDD1.map(â€¦)ç­‰è®¡ç®—å‡½æ•° é€šè¿‡çˆ¶çº§RDDå’Œè®¡ç®—å‡½æ•°æ¥æ¢å¤RDD2 ä»»åŠ¡ç‰¹åˆ«å¤æ‚ï¼Œæµç¨‹ç‰¹åˆ«é•¿ï¼Œæœ‰å¾ˆå¤šRDDä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ ä¸Šé¢æåˆ°äº†å¯ä»¥ä½¿ç”¨ä¾èµ–å…³ç³»æ¥è¿›è¡Œå®¹é”™ï¼Œä½†æ˜¯å¦‚æœä¾èµ–å…³ç³»ç‰¹åˆ«é•¿çš„æ—¶å€™ï¼Œè¿™ç§æ–¹å¼å…¶å®ä¹Ÿæ¯”è¾ƒä½æ•ˆï¼Œè¿™ä¸ªæ—¶å€™å°±åº”è¯¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è®°å½•æ•°æ®é›†çš„çŠ¶æ€ åœ¨Sparkä¸­æœ‰ä¸¤ä¸ªæ‰‹æ®µå¯ä»¥åšåˆ° ç¼“å­˜ Checkpoint map() \u0026 mapPartitions() mapPartitions å’Œ map ç®—å­æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡mapæ˜¯é’ˆå¯¹æ¯ä¸€æ¡æ•°æ®è¿›è¡Œè½¬æ¢ï¼ŒmapPartitionsé’ˆå¯¹ä¸€æ•´ä¸ªåˆ†åŒºçš„æ•°æ®è¿›è¡Œè½¬æ¢ æ‰€ä»¥ map çš„ func å‚æ•°æ˜¯å•æ¡æ•°æ®ï¼ŒmapPartitions çš„ func å‚æ•°æ˜¯ä¸€ä¸ªé›†åˆ(ä¸€ä¸ªåˆ†åŒºæ•´ä¸ªæ‰€æœ‰çš„æ•°æ®) map çš„ func è¿”å›å€¼ä¹Ÿæ˜¯å•æ¡æ•°æ®ï¼ŒmapPartition çš„ func è¿”å›å€¼æ˜¯ä¸€ä¸ªé›†åˆ mapPartitionWithIndex å’Œ mapPartition çš„åŒºåˆ«æ˜¯ func ä¸­å¤šåˆ†åŒºæ•°é‡å‚æ•° filter() ä¿ç•™æ»¡è¶³æ¡ä»¶çš„å…ƒç´  sample() filteræŒ‰ç…§è§„å¾‹è¿‡æ»¤ï¼Œsampleåˆ™æ˜¯éšæœºé‡‡æ · def sample( withReplacement: Boolean, //æ˜¯å¦é‡å¤å–æ · fraction: Double, //å–æ ·æ¯”ä¾‹ seed: Long = Utils.random.nextLong): RDD[T] = {...} mapValues() mapValueä¹Ÿæ˜¯mapï¼Œmapä½œç”¨äºå…¨éƒ¨æ•°æ®ï¼ŒmapValueä½œç”¨äºvalue collection operation äº¤é›†ï¼šrdd1.intersection(rdd2) å¹¶é›†ï¼šrdd1.union(rdd2) å·®é›†ï¼šrdd1.subract(rdd2) groupByKey() èšåˆæ“ä½œï¼š reduceByKey -\u003eæŒ‰ç…§keyåˆ†ç»„ï¼Œç„¶åæŠŠæ¯ä¸€ç»„æ•°æ®reduceã€‚reduceByKeyåœ¨mapç«¯combinerèƒ½å‡å°‘IOï¼Œä¸€ä¸ªåˆ†åŒºæ”¾å¤šä¸ªæ•°æ®ã€‚ groupByKey è¿ç®—ç»“æœçš„æ ¼å¼ï¼šï¼ˆkï¼Œï¼ˆvalue1ï¼Œvalue2ï¼‰ï¼‰ï¼Œæ²¡æœ‰å‡å°‘IO sc.parallelize(Seq((\"a\",1),(\"a\",1),(\"b\",1))) .groupByKey() .collect() .foreach(println(_)) combineByKey() æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š è½¬åŒ–æ•°æ®çš„å‡½æ•°ï¼ˆåˆå§‹å‡½æ•°ï¼Œä½œç”¨äºç¬¬ä¸€æ¡æ•°æ®ï¼Œç”¨äºå¼€å¯æ•´ä¸ªè®¡ç®—ï¼‰ åœ¨åˆ†åŒºä¸Šè¿›è¡Œèšåˆ æŠŠæ‰€æœ‰çš„åˆ†åŒºçš„èšåˆç»“æœèšåˆä¸ºæœ€ç»ˆç»“æœ val result = rdd.combineBykey( createCombiner = curr =\u003e (curr,1), mergeValue = (curr: (Double, Int), nextValue: Double) =\u003e (curr._1 + nextValue, curr._2 + 1)), mergeCombiners = (curr: (Double,Int), agg: (Double, Int)) =\u003e (curr._1 + agg._1, curr._2 + agg._2) ) result.map(item =\u003e (item._1, item._2._1 / item._2._2)) foldByKey() åŠŸèƒ½ç­‰åŒäºreduceByKey()ï¼Œå¢åŠ äº†åˆå§‹å€¼ã€‚reduceByKeyåº•å±‚æ˜¯combineByKey()ï¼ŒfoldByKey()åº•å±‚æ˜¯aggregateByKey()ã€‚ aggregateByKey() join() æŒ‰ç…§ç›¸åŒçš„Keyè¿›è¡Œè¿æ¥ sortBy() æ’åºï¼šsortBy()ï¼ŒsortByKey() coalesce() ä¸€èˆ¬æ¶‰åŠåˆ°åˆ†åŒºæ“ä½œçš„ç®—å­å¸¸è§çš„æœ‰ä¸¤ä¸ªï¼Œrepartitionå’Œcoalesceï¼Œéƒ½å¯ä»¥è°ƒå¤§æˆ–è€…è°ƒå°åˆ†åŒºæ•°é‡ summary æ‰€æœ‰çš„è½¬åŒ–æ“ä½œçš„ç®—å­éƒ½æ˜¯æƒ°æ€§çš„ï¼Œåœ¨æ‰§è¡Œæ—¶å€™ä¸ä¼šè°ƒåº¦è¿è¡Œæ±‚å¾—ç»“æœï¼Œè€Œåªæ˜¯ç”Ÿæˆäº†å¯¹åº”çš„RDD åªæœ‰åœ¨Actionæ“ä½œçš„æ—¶å€™ï¼Œæ‰ä¼šçœŸçš„è¿è¡Œ ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:5:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Action Operator reduce((T, T) - U) å¯¹æ•´ä¸ªç»“æœé›†è§„çº¦ï¼Œæœ€ç»ˆç”Ÿæˆä¸€æ¡æ•°æ®ï¼Œæ˜¯æ•´ä¸ªæ•°æ®é›†çš„æ€»æ±‡ reduceByKeyå’Œreduceæœ‰ä»€ä¹ˆåŒºåˆ«ï¼š reduceæ˜¯actionç®—å­ï¼ŒreduceByKeyæ˜¯ä¸€ä¸ªè½¬æ¢ç®—å­ RDDé‡Œæœ‰ä¸€ä¸‡æ¡æ•°æ®ï¼Œå¤§éƒ¨åˆ†keyæ˜¯ç›¸åŒçš„ï¼Œæœ‰10ä¸ªä¸åŒçš„keyç”Ÿæˆ10æ¡æ•°æ® reduceç”Ÿæˆ1æ¡æ•°æ® reduceByKeyæ˜¯æŒ‰Keyåˆ†ç»„ï¼Œç„¶åæŠŠæ¯ç»„èšåˆ reduceæ˜¯é’ˆå¯¹ä¸€æ•´ä¸ªæ•°æ®é›†è¿›è¡Œèšåˆ reduceByKeyæ˜¯å¯¹KVæ•°æ®è¿›è¡Œè®¡ç®— reduceå¯é’ˆå¯¹æ‰€æœ‰ç±»å‹æ•°æ® reduceç®—å­æ˜¯ä¸€ä¸ªshuffleæ“ä½œå—ï¼Ÿ shuffleæ“ä½œåˆ†ä¸ºmapperå’Œreducerï¼Œmapperå°†æ•°æ®æ”¾å…¥paritionerçš„å‡½æ•°è®¡ç®—ï¼Œæ±‚å¾—å¾€å“ªä¸ªreduceré‡Œæ”¾ reduceæ“ä½œæ²¡æœ‰mapperå’Œreducerï¼Œå› ä¸ºreduceç®—å­ä¼šä½œç”¨äºRDDä¸­çš„æ¯ä¸ªåˆ†åŒºï¼Œç„¶ååˆ†åŒºæ±‚å¾—å±€éƒ¨ç»“æœï¼Œæœ€ç»ˆæ±‡æ€»åˆ°Driverä¸­æ±‚å¾—æœ€ç»ˆç»“æœ RDDæœ‰äº”å¤§å±æ€§ï¼Œpartitioneråœ¨shuffleè¿‡ç¨‹ä¸­ä½¿ç”¨ paritioneråªæœ‰kvå‹çš„RDDæ‰æœ‰ collect() ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ•°æ®é›†ä¸­æ‰€æœ‰å…ƒç´  countByKey() countå’ŒcountByKey countByKeyç»“æœï¼šMap(Key -\u003e Keyçš„count) è°ƒç”¨Actionä¼šç”Ÿæˆä¸€ä¸ªjobï¼Œjobä¼šè¿è¡Œè·å–ç»“æœï¼Œæ‰€ä»¥åœ¨ä¸¤ä¸ªjobä¸­æœ‰å¤§é‡çš„log æ•°æ®å€¾æ–œï¼šè§£å†³æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œéœ€è¦å…ˆé€šè¿‡countByKeyæŸ¥çœ‹Keyå¯¹åº”çš„æ•°é‡ first() è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  take(N) è¿”å›å‰Nä¸ªå…ƒç´  takeSample(withReplacement, num) ç±»ä¼¼äºsampleï¼ŒåŒºåˆ«è¿™æ˜¯actionï¼Œç›´æ¥è¿”å›ç»“æœ withReplacementï¼šå–æ•°æ®æœ‰æ— æ”¾å› first() first()é€Ÿåº¦ç›¸æ¯”å…¶ä»–æ–¹æ³•æœ€å¿« ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:6:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Data Type in RDD RDDä¸­å­˜æ”¾çš„æ•°æ®ç±»å‹ åŸºæœ¬ç±»å‹ï¼ŒStringï¼Œå¯¹è±¡ KVç±»å‹ æ•°å­—ç±»å‹ ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:7:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Practice @Test def process(): Unit = { //1. åˆ›å»ºscå¯¹è±¡ val conf = new SparkConf().setMaster(\"local[6]\").setAppName(\"practice\") val sc = new SparkContext(conf) //2. è¯»å–æ–‡ä»¶ //1,2010,1,1,0,4,NA,NA,NA,NA,-21,43,1021,-11,NW,1.79,0,0 val source = sc.textFile(\"dataset/parctive.csv\") //3. å¤„ç†æ•°æ® val resultRDD = source.map(item =\u003e ((item.split(\",\")(1), item.split(\",\")(2)),item.split(\",\")(6))) .filter(item =\u003e StringUtils.isNotEmpty(item._2) \u0026\u0026 ! item._2.equalsIgnoreCase(\"NA\")) .map(item =\u003e (item._1, item._2.toInt)) .reduceByKey((curr,agg) =\u003e curr + agg) .sortBy(item =\u003e item._2, ascending = false) //4. è·å–ç»“æœ resultRDD.take(10).foreach(item =\u003e println(item)) //5. å…³é—­sc sc.stop() } ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:8:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"RDD Feature RDDâ€™s shuffle and partition RDDç»å¸¸éœ€è¦é€šè¿‡è¯»å–å¤–éƒ¨ç³»ç»Ÿçš„æ•°æ®æ¥åˆ›å»ºï¼Œå¤–éƒ¨å­˜å‚¨ç³»ç»Ÿå¾€å¾€æ˜¯æ”¯æŒåˆ†ç‰‡çš„ã€‚RDDéœ€è¦æ”¯æŒåˆ†åŒºï¼Œæ¥å’Œå¤–éƒ¨ç³»ç»Ÿçš„åˆ†ç‰‡ä¸€ä¸€å¯¹åº” RDDçš„åˆ†åŒºæ˜¯ä¸€ä¸ªå¹¶è¡Œè®¡ç®—çš„å®ç°æ‰‹æ®µ partition function RDDä½¿ç”¨åˆ†åŒºæ¥åˆ†å¸ƒå¼å¤„ç†ï¼Œå½“ä½¿ç”¨RDDè¯»å–æ•°æ®æ—¶ï¼Œä¼šå°½é‡åœ¨å±‹é‡Œä¸Šé è¿‘æ•°æ®æºã€‚æ¯”å¦‚è¯»HDFSæˆ–Cassandraæ—¶ï¼Œä¼šå°½é‡çš„ä¿æŒRDDçš„åˆ†åŒºå’Œæ•°æ®æºçš„åˆ†åŒºæ•°ï¼Œåˆ†åŒºæ¨¡å¼ä¸€ä¸€å¯¹åº” shuffle ä»mapperç«¯åˆ°reducerç«¯ Sparkæ”¯æŒå®½ä¾èµ–çš„è½¬æ¢ï¼Œä¾‹å¦‚groupByKeyå’ŒreduceByKeyã€‚åœ¨è¿™äº›ä¾èµ–é¡¹ä¸­ï¼Œè®¡ç®—å•ä¸ªåˆ†åŒºä¸­çš„è®°å½•æ‰€éœ€çš„æ•°æ®å¯ä»¥æ¥è‡ªäºçˆ¶æ•°æ®é›†çš„è®¸å¤šåˆ†åŒºä¸­ã€‚è¦æ‰§è¡Œè¿™äº›è½¬æ¢ï¼Œå…·æœ‰ç›¸åŒkeyçš„æ‰€æœ‰å…ƒç»„å¿…é¡»æœ€ç»ˆä½äºåŒä¸€åˆ†åŒºä¸­ï¼Œç”±åŒä¸€ä»»åŠ¡å¤„ç†ã€‚ä¸ºäº†æ»¡è¶³è¿™ä¸€è¦æ±‚ï¼ŒSparkäº§ç”Ÿä¸€ä¸ªshuffleï¼Œå®ƒåœ¨é›†ç¾¤å†…éƒ¨ä¼ è¾“æ•°æ®ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªå¸¦æœ‰ä¸€ç»„æ–°åˆ†åŒºçš„æ–°stageã€‚ Hash base shuffle Reduce æ‰¾åˆ°æ¯ä¸ªMapperä¸­å¯¹åº”è‡ªå·±å“ˆå¸Œæ¡¶æ‹‰å–æ•°æ® ç¼ºç‚¹ï¼šè¿‡å¤šå ç”¨èµ„æºå ç”¨ Sort base shuffle å…ˆæŒ‰ç…§partition ID æ’åºï¼Œ åæŒ‰ç…§Keyçš„HashCodeæ’åº partition and shuffle relation åˆ†åŒºä¸»è¦ç”¨æ¥å®ç°å¹¶è¡Œè®¡ç®—ï¼Œå’Œshuffleæ²¡ä»€ä¹ˆå…³ç³»ï¼Œä½†æ•°æ®å¤„ç†æ—¶ï¼Œä¾‹å¦‚reduceByKeyï¼ŒgroupByKeyç­‰èšåˆæ“ä½œï¼Œéœ€è¦æŠŠKeyç›¸åŒçš„Valueæ‹‰å–åˆ°ä¸€èµ·è¿›è¡Œè®¡ç®—ï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºè¿™äº›Keyçš„ç›¸åŒçš„Valueå¯èƒ½ä¼šåœ¨ä¸åŒçš„åˆ†åŒºï¼Œæ‰€ä»¥ç†è§£åˆ†åŒºæ‰èƒ½ç†è§£shuffleçš„æ ¹æœ¬åŸç† shuffle feature åªæœ‰KVå‹çš„RDDæ‰ä¼šæœ‰Shuffleæ“ä½œ æ—©æœŸç‰ˆæœ¬sparkçš„shuffleç®—æ³•æ˜¯ hash base shuffleï¼Œåæ¥æ”¹ä¸º sort base shuffleï¼Œæ›´é€‚åˆå¤§ååé‡çš„åœºæ™¯ check partition æŒ‡å®šåˆ†åŒºæ•° é€šè¿‡æœ¬åœ°é›†åˆåˆ›å»ºçš„æ—¶å€™æŒ‡å®šåˆ†åŒºæ•° val conf = new SparkConf().setMaster(\"local[6]\").setAppName(\"practice\")//åˆ›å»ºAppå¹¶å¼€å¯6ä¸ªåˆ†åŒº val sc = new SparkContext(conf) é€šè¿‡è¯»å–æ–‡ä»¶åˆ›å»ºçš„æ—¶å€™æŒ‡å®šåˆ†åŒºæ•° val rdd1 = sc.parallelize(Seq(1, 2, 3, 4, 5, 6, 7), 3) //æŒ‡å®šåˆ†åŒºæ•°3 val rdd2 = sc.testFile(\"hdfs://node01:8020/data/test.txt\", 6) //è¿™é‡ŒæŒ‡å®šçš„æ˜¯æœ€å°åˆ†åŒºæ•°6 æŸ¥çœ‹æ–¹æ³• é€šè¿‡WebUIæŸ¥çœ‹ã€‚ç«¯å£ï¼š4040 é€šè¿‡partitionsæ¥æŸ¥çœ‹ã€‚rdd1.partitions.size é‡åˆ†åŒº coalesce(num, true) repartitions(num) RDD Cache //1. å–å‡ºIP val countRDD = source.map(item =\u003e (item.split(\" \")(0), 1)) //2. æ•°æ®æ¸…æ´— val cleanRDD = countRDD.filter(item =\u003e StingUtils.isNotEmpty(item._1)) //3. ç»Ÿè®¡ipçš„å‡ºç°æ¬¡æ•° val aggRDD = cleanRDD.reduceBykey((curr,agg) =\u003e curr + agg) //4. ç»Ÿè®¡å‡ºç°æœ€å°‘çš„ip val leastIP = aggRDD.sortBy(item =\u003e item._2, ascending = true).first() //5. ç»Ÿè®¡å‡ºç°æœ€å¤šçš„ip val mostIP = aggRDD.sortBy(item =\u003e item._2, ascending = false).first() println(leastIP, mostIP) sc.stop() ç¬¬ä¸€æ¬¡ç»Ÿè®¡jobï¼ˆä¸€ä¸ªActionç®—å­ï¼‰æ‰§è¡Œäº†ä¸¤ä¸ªshuffle(reduceByKeyï¼ŒsortByKey) ç¬¬äºŒæ¬¡ç»Ÿè®¡jobï¼ˆä¸€ä¸ªActionç®—å­ï¼‰æ‰§è¡Œäº†ä¸¤ä¸ªshuffle(reduceByKeyï¼ŒsortByKey) è½¬æ¢ç®—å­çš„ä½œç”¨ï¼šç”ŸæˆRDDï¼Œä»¥åŠRDDä¹‹é—´çš„ä¾èµ–å…³ç³» Actionç®—å­çš„ä½œç”¨ï¼šç”Ÿæˆjobï¼Œæ‰§è¡Œjob å…¨å±€æ‰§è¡Œäº†å››ä¸ªshuffle ä½¿ç”¨ç¼“å­˜çš„æ„ä¹‰ï¼š å‡å°‘shuffleæ“ä½œ å®¹é”™ï¼Œå‡å°‘å¼€é”€ï¼šrdd1-\u003erdd2-\u003erdd3ï¼Œè‹¥rdd3ç®—é”™ä¼šå†æ¬¡è®¡ç®—rdd1å’Œrdd2æ•´ä¸ªæµç¨‹ã€‚ ç¼“å­˜API: cache()æˆ–persist(null/level) //1. å¤„ç† val countRDD = source.map(item =\u003e (item.split(\" \")(0), 1)) val cleanRDD = countRDD.filter(item =\u003e StingUtils.isNotEmpty(item._1)) val aggRDD = cleanRDD.reduceBykey((curr,agg) =\u003e curr + agg) //2. cache aggRDD = aggRDD.cache() //3. ä¸¤ä¸ªRDDçš„actionæ“ä½œ val leastIP = aggRDD.sortBy(item =\u003e item._2, ascending = true).first() val mostIP = aggRDD.sortBy(item =\u003e item._2, ascending = false).first() println(leastIP, mostIP) sc.stop() //1. å¤„ç† val countRDD = source.map(item =\u003e (item.split(\" \")(0), 1)) val cleanRDD = countRDD.filter(item =\u003e StingUtils.isNotEmpty(item._1)) val aggRDD = cleanRDD.reduceBykey((curr,agg) =\u003e curr + agg) //2. cache aggRDD = aggRDD.persist(storageLevel.MEMORY_ONLY) //3. ä¸¤ä¸ªRDDçš„actionæ“ä½œ val leastIP = aggRDD.sortBy(item =\u003e item._2, ascending = true).first() val mostIP = aggRDD.sortBy(item =\u003e item._2, ascending = false).first() println(leastIP, mostIP) sc.stop() ç¼“å­˜çº§åˆ«ï¼š MEMORY_ONLY: CPUæ•ˆç‡æœ€é«˜ MEMORY_ONLY_SER: æ›´åŠ èŠ‚çœç©ºé—´ Checkpoint æ–©æ–­RDDçš„ä¾èµ–é“¾ï¼Œå¹¶ä¸”å°†æ•°æ®å­˜å‚¨åœ¨å¯é çš„å­˜å‚¨å¼•æ“ä¸­ï¼Œä¾‹å¦‚HDFS HDFSçš„NameNodeä¸­ä¸»è¦èŒè´£å°±æ˜¯ç»´æŠ¤ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯editsï¼Œå¦ä¸€ä¸ªæ˜¯fsimageã€‚ editsä¸­ä¸»è¦å­˜æ”¾Editlogï¼ŒFsImageä¿å­˜äº†å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¿™ä¸ªFsImageå…¶å®å°±æ˜¯ä¸€ä¸ªCheckpointã€‚ æ¯ä¸€æ¬¡ä¿®æ”¹æ–‡ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šåœ¨Editsä¸­æ·»åŠ ä¸€æ¡è®°å½•ã€‚ åœ¨ä¸€å®šæ¡ä»¶æ»¡è¶³çš„æƒ…å†µä¸‹ï¼ŒæŠŠeditsåˆ æ‰æ·»åŠ ä¸€ä¸ªæ–°çš„FSimageï¼ŒåŒ…å«äº†ç³»ç»Ÿå½“å‰æœ€æ–°çš„çŠ¶æ€ã€‚å¥½å¤„ï¼šå¢åŠ é€Ÿåº¦ï¼Œæé«˜ç¨³å®šæ€§ Checkpointå’ŒCacheçš„åŒºåˆ«ï¼š Cacheå¯ä»¥å§RDDè®¡ç®—å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­ï¼Œä½†RDDçš„ä¾èµ–é“¾(ç›¸å½“äºNameNodeä¸­çš„Editsæ—¥å¿—)æ˜¯ä¸èƒ½ä¸¢çš„ï¼Œè‹¥å‡ºç°é”™è¯¯ï¼Œåªèƒ½é‡è®¡ç®—å‡ºæ¥ã€‚ CheckpointæŠŠç»“æœå­˜æ”¾åœ¨HDFSè¿™ç±»å­˜å‚¨ä¸­ï¼Œå°±å˜æˆäº†å¯é çš„æ•°æ®ï¼Œå¦‚æœå‡ºé”™äº†ï¼Œåˆ™é€šè¿‡å¤åˆ¶HDFSä¸­çš„æ–‡ä»¶æ¥å®ç°å®¹é”™ã€‚ å¦‚ä½•ä½¿ç”¨ï¼š ä¸¤æ­¥ï¼š val conf = new.SparkConf().setMaster(\"local[6]\").setAppName(\"debug_string\") //1. setCheckPointDirï¼šè®¾ç½®ä¿å­˜ç›®å½•ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºHDFSä¸Šçš„ç›®å½• sc.setCheckpointDir(\"checkpoint\") val interimRDD = sc.textFile(\"dataset/test.txt\") .map(item =\u003e (item.split(\" \")(0), 1)) .filter(item =\u003e StringUtils.isNotBlank(item._1)) .reduceByKey((curr, agg) =\u003e curr + agg) //2. setCheckPointï¼šæ˜¯ä¸€ä¸ªactionæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè°ƒç”¨checkpointï¼Œåˆ™ä¼šé‡æ–°è®¡ç®—ä¸€ä¸‹RDDï¼Œç„¶åæŠŠç»“æœå­˜åœ¨HDFSæˆ–è€…æœ¬åœ°ç›®å½•ä¸­ interimRDD.checkpoint() interimRDD.collect().foreach(println(_)) sc.stop() ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:9:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Spark Running Process //1. åˆ›å»ºscå¯¹è±¡ //2. åˆ›å»ºæ•°æ®é›† val textRDD = sc.parallelize(Seq(\"hadoop spark\", \"hadoop flume\", \"spark soo\")) //3. æ•°æ®å¤„ç† // 1.æ‹†è¯2.èµ‹äºˆåˆå§‹è¯é¢‘3.èšåˆ4.å°†ç»“æœè½¬ä¸ºå­—ç¬¦ä¸² val splitRDD = textRDD.flatMap(_.split(\" \")) val tupleRDD = splitRDD.map((_, 1)) val reduceRDD = tupleRDD.reduceByKey(_ + _) val strRDD = reduceRDD.map(item =\u003e s\"${item._1}, ${item._2}\") //4. ç»“æœè·å– strRDD.collect().foreach(item =\u003e println(_)) //5. å…³é—­sc sc.stop() é›†ç¾¤ç»„æˆ Node1ä¸»èŠ‚ç‚¹: Master Daemonï¼š è´Ÿè´£ç®¡ç†MasterèŠ‚ç‚¹ï¼Œ åè°ƒèµ„æºçš„è·å–ï¼Œä»¥åŠè¿æ¥WorkerèŠ‚ç‚¹æ¥è¿è¡ŒExecutorï¼Œæ˜¯sparké›†ç¾¤ä¸­çš„åè°ƒèŠ‚ç‚¹ Node2: Worker Daemonï¼š ä¹Ÿç§°ä¹‹ä¸ºSlavesï¼Œæ˜¯sparké›†ç¾¤ä¸­çš„è®¡ç®—èŠ‚ç‚¹ï¼Œç”¨äºå’ŒMasteräº¤äº’å’Œå¹¶ç®¡ç†Driverï¼Œ å½“ä¸€ä¸ªspark job æäº¤åï¼Œä¼šåˆ›å»ºsparkContextï¼Œworkerä¼šå¯åŠ¨å¯¹åº”çš„Executor Driver: ctionç®—å­æ“ä½œè·å–çš„ç»“æœï¼Œä¼šæŠŠç»“æœå­˜æ”¾åœ¨Driverä¸­ Executor Backendï¼š Workerç”¨äºæ§åˆ¶Executorçš„å¯åœï¼Œå…¶å®workeræ˜¯é€šè¿‡ Executor Backendæ¥è¿›è¡Œæ§åˆ¶çš„ã€‚ Executor Backendæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ˆæ˜¯ä¸€ä¸ªJVMå®ä¾‹ï¼‰ï¼ŒæŒæœ‰ä¸€ä¸ªExecutorå¯¹è±¡ã€‚ Executor Task1 Task2 Task3 é€»è¾‘æ‰§è¡Œå›¾ val textRDD = sc.parallelize(Seq(\"hadoop spark\", \"hadoop flume\", \"spark soo\")) val splitRDD = textRDD.flatMap(_.split(\" \")) val tupleRDD = splitRDD.map((_, 1)) val reduceRDD = tupleRDD.reduceByKey(_ + _) val strRDD = reduceRDD.map(item =\u003e s\"${item._1}, ${item._2}\") println(strRDD.toDebugString) (8) MapPartitionsRDD[4] at map at test.scala:12 [] | ShuffledRDD[3] at reduceByKey at test.scala:11 [] +-(8) MapPartitionsRDD[2] at map at test.scala:10 [] | MapPartitionsRDD[1] at flatMap at test.scala:9 [] | ParallelCollectionRDD[0] at parallelize at test.scala:6 [] RDDlogic ç‰©ç†æ‰§è¡Œå›¾ å½“è§¦å‘Actionæ‰§è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸€ç»„äº’ç›¸ä¾èµ–çš„RDDè¦è¢«å¤„ç†ï¼Œæ‰€ä»¥è¦è½¬åŒ–ä¸ºå¯è¿è¡Œçš„ç‰©ç†æ‰§è¡Œå›¾ï¼Œè°ƒåº¦åˆ°é›†ç¾¤ä¸­æ‰§è¡Œã€‚ å› ä¸ºå¤§éƒ¨åˆ†RDDæ˜¯ä¸çœŸæ­£å­˜æ”¾æ•°æ®çš„ï¼Œåªæ˜¯æ•°æ®ä»ä¸­æµè½¬ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥åœ¨é›†ç¾¤ä¸­è¿è¡ŒRDDï¼Œè¦æœ‰ä¸€ç§pipelineçš„æ€æƒ³ï¼Œéœ€è¦å°†è¿™ç»„RDDè½¬ä¸ºStageå’ŒTaskï¼Œä»è€Œè¿è¡ŒTaskï¼Œä¼˜åŒ–æ•´ä½“æ‰§è¡Œé€Ÿåº¦ã€‚ RDDphysic å°ç»“ï¼š â‘  -\u003e â‘  -\u003e â‘  åœ¨ç¬¬ä¸€ä¸ªstageä¸­ï¼Œæ¯ä¸€ä¸ªè¿™æ ·çš„æ‰§è¡Œæµç¨‹æ˜¯ä¸€ä¸ªTaskï¼Œä¹Ÿå°±æ˜¯åœ¨åŒä¸€ä¸ªStageä¸­çš„æ‰€æœ‰RDDçš„å¯¹åº”åˆ†åŒºï¼Œåœ¨åŒä¸€ä¸ªTaskä¸­æ‰§è¡Œ Stageçš„åˆ’åˆ†æ˜¯ç”±Shuffleæ“ä½œæ¥ç¡®å®šçš„ï¼Œæœ‰Shuffleçš„åœ°æ–¹ï¼ŒStageæ–­å¼€ æ•°æ®æµåŠ¨ val sc = ... val textRDD = sc.parallelize(Seq(\"Hadoop Spark\", \"Hadoop Flume\", \"Spark Squad\")) val splitRDD = textRDD.flatMap(_.split(\" \")) val tupleRDD = splitRDD.map((_,1)) val reduceRDD = tupleRDD.reduceByKey(_ + _) val strRDD = reduceRDD.map(item =\u003e s\"${item._1, ${item._2}}\") strRDD.collect.foreach(item =\u003e println(item)) Jobå’ŒStageçš„å…³ç³» Jobæ˜¯ä¸€ä¸ªæœ€å¤§çš„è°ƒåº¦å•ä½ï¼ŒDAGSchedulerä¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªJobçš„ç›¸å…³ä¿¡æ¯ï¼Œç„¶åå»è°ƒåº¦Jobï¼Œä½†æ˜¯æ²¡åŠæ³•ç›´æ¥è°ƒåº¦Jobã€‚ â€‹ ä¸ºä»€ä¹ˆJobéœ€è¦åˆ‡åˆ† å› ä¸ºjobçš„å«ä¹‰æ˜¯å¯¹æ•´ä¸ªRDDæ±‚å€¼ï¼Œä½†RDDä¹‹é—´å¯èƒ½æœ‰ä¸€äº›å®½ä¾èµ– å¦‚æœé‡åˆ°å®½ä¾èµ–çš„è¯ï¼Œä¸¤ä¸ªRDDä¹‹é—´éœ€è¦è¿›è¡Œæ•°æ®æ‹‰å–å’Œå¤åˆ¶ é‚£ä¹ˆä¸€ä¸ªRDDå°±å¿…é¡»ç­‰å¾…å®ƒæ‰€ä¾èµ–çš„RDDæ‰€æœ‰åˆ†åŒºå…ˆè®¡ç®—å®Œæˆï¼Œç„¶åå†è¿›è¡Œæ‹‰å– æ‰€ä»¥ï¼Œä¸€ä¸ªJobæ˜¯æ— æ³•è®¡ç®—å®Œæ•´çš„RDDè¡€ç»Ÿçš„ â€‹ Stageå’ŒTaskçš„å…³ç³» Stageä¸­çš„RDDä¹‹é—´æ˜¯çª„ä¾èµ–ï¼š çª„ä¾èµ–RDDç†è®ºä¸Šå¯ä»¥æ”¾åœ¨åŒä¸€ä¸ªPipelineä¸­æ‰§è¡Œçš„ RDDè¿˜æœ‰åˆ†åŒºï¼š ä¸€ä¸ªRDDåªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè€ŒçœŸæ­£å­˜æ”¾å’Œå¤„ç†æ•°æ®æ—¶ï¼Œéƒ½æ˜¯ä»¥åˆ†åŒºä½œä¸ºå•ä½çš„ Stageå¯¹åº”çš„æ˜¯å¤šä¸ªæ•´ä½“ä¸Šçš„RDDï¼Œè€ŒçœŸæ­£çš„è¿è¡Œæ˜¯éœ€è¦é’ˆå¯¹RDDçš„åˆ†åŒºæ¥è¿›è¡Œçš„ ä¸€ä¸ªTaskå¯¹åº”ä¸€ä¸ªRDDçš„åˆ†åŒºï¼š ä¸€ä¸ªæ¯”Stageç²’åº¦æ›´ç»†çš„å•å…ƒå«åšTaskï¼ŒStageæ˜¯ç”±Taskç»„æˆçš„ï¼Œä¹‹æ‰€ä»¥æœ‰Taskè¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯å› ä¸ºStageé’ˆå¯¹æ•´ä¸ªRDDï¼Œè€Œè®¡ç®—çš„æ—¶å€™ï¼Œè¦é’ˆå¯¹RDDçš„åˆ†åŒºã€‚ æ€»ç»“ï¼š Job\u003eStage\u003eTask ä¸€ä¸ªJobç”±å¤šä¸ªStageç»„æˆ(è¿™ä¸ªå–å†³æœ‰å¤šå°‘ä¸ªå®½ä¾èµ–)ï¼Œä¸€ä¸ªStageç”±å¤šä¸ªTaskç»„æˆï¼ˆè¿™ä¸ªå–å†³æœ‰å¤šå°‘ä¸ªåˆ†åŒºæ•°é‡ è€ŒStageä¸­ç»å¸¸ä¼šæœ‰ä¸€ç»„Taskéœ€è¦åŒæ—¶æ‰§è¡Œï¼Œæ‰€ä»¥é’ˆå¯¹æ¯ä¸€ä¸ªTaskæ¥è¿›è¡Œè°ƒåº¦å¤ªè¿‡é¢‘ç¹æ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥æ¯ä¸ªStageä¸­çš„Taskä»¬ä¼šè¢«æ”¶é›†èµ·æ¥ï¼Œæ”¾å…¥ä¸€ä¸ªTaskSeté›†åˆä¸­ã€‚ ä¸€ä¸ªStageæœ‰ä¸€ä¸ªTaskSet TaskSetä¸­Taskçš„ä¸ªæ•°ç”±Stageä¸­çš„æœ€å¤§åˆ†åŒºæ•°å†³å®š sparkFlow ","date":"2020-05-27","objectID":"/20200527_spark-guide1/:10:0","tags":["Java","Spark"],"title":"Spark Guide, Part â… ","uri":"/20200527_spark-guide1/"},{"categories":["Technology"],"content":"Article description.","date":"2020-05-26","objectID":"/20200526_app-architecture-development/","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"The features of large applications: high availability, high concurrency and big data. High availability: system need to provide service without interruption. High concurrency: still stable under the big access. Big data: store and manage big data well. ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:0:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"ç®€å•çš„æ¶æ„ å¼€å§‹æ•°æ®é‡å°‘ï¼Œæ‰€ä»¥åªéœ€ä¸€å°æœåŠ¡å™¨ smapleArchitecture åº”ç”¨ç¨‹åºã€æ–‡ä»¶ã€æ•°æ®åº“å¾€å¾€éƒ½éƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œåº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨TomcatæœåŠ¡å™¨ä¸Šï¼Œæ•°æ®åº“å¯ä»¥ä½¿ç”¨MySQL ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:1:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"åº”ç”¨äºæ•°æ®æœåŠ¡åˆ†éš” éšç€ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ï¼Œè®¿é—®é‡è¶Šæ¥è¶Šå¤§ï¼Œå¯¼è‡´æ€§èƒ½è¶Šæ¥è¶Šå·®ï¼Œå­˜å‚¨ç©ºé—´ä¸¥é‡ä¸è¶³ï¼Œè¿™æ—¶æˆ‘ä»¬è€ƒè™‘æŠŠæœåŠ¡å™¨å¢åŠ åˆ°ä¸‰å°ã€‚åˆ†ç¦»å‡ºåº”ç”¨æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨ã€‚ åº”ç”¨æœåŠ¡å™¨éœ€è¦å¤„ç†å¤§é‡çš„è®¿é—®ï¼Œæ‰€ä»¥éœ€è¦æ€§èƒ½æ›´å¥½çš„CPU æ•°æ®åº“æœåŠ¡å™¨éœ€è¦å­˜å‚¨å¤§é‡çš„æ•°æ®ä»¥åŠå¿«é€Ÿçš„æ£€ç´¢ï¼Œæ‰€ä»¥éœ€ç£ç›˜çš„æ£€ç´¢é€Ÿåº¦è¾ƒå¿«ä»¥åŠå­˜å‚¨ç©ºé—´å¤§ æ–‡ä»¶æœåŠ¡å™¨éœ€è¦å­˜å‚¨ä¸Šä¼ çš„æ–‡ä»¶ï¼Œéœ€è¦æ›´å¤§çš„ç£ç›˜ï¼›ç°åœ¨é€šå¸¸æƒ…å†µä¸‹ä¼šé€‰æ‹©ç¬¬ä¸‰æ–¹çš„å­˜å‚¨æœåŠ¡ appSeparateData ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:2:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"åº”ç”¨æœåŠ¡å™¨é›†ç¾¤ åœ¨é«˜å¹¶å‘ã€å¤§æµé‡çš„æƒ…å†µä¸‹ï¼Œä¸€å°æœåŠ¡å™¨æ˜¯è‚¯å®šå¤„ç†ä¸è¿‡æ¥çš„ï¼Œè¿™ä¸ªæ—¶å€™å¢åŠ æœåŠ¡å™¨ï¼Œéƒ¨ç½²é›†ç¾¤æä¾›æœåŠ¡ï¼Œæ¥åˆ†æ‹…æ¯å°æœåŠ¡å™¨çš„å‹åŠ›ã€‚éƒ¨ç½²é›†ç¾¤çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä¼¸ç¼©æ€§ã€‚æ¯”å¦‚åŒåä¸€å¢åŠ æœåŠ¡å™¨åˆ†æ‘Šæµé‡ï¼ŒåŒåä¸€è¿‡åå†å‡å°‘æœåŠ¡å™¨ã€‚ Cluster å¦‚æœåº”ç”¨æœåŠ¡å™¨æ˜¯Tomcatï¼Œé‚£ä¹ˆå¯ä»¥éƒ¨ç½²ä¸€ä¸ªTomcatçš„é›†ç¾¤ï¼Œå¤–éƒ¨åœ¨éƒ¨ç½²ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œå¯ä»¥é‡‡ç”¨éšæœºã€è½®è¯¢æˆ–è€…ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•è¾¾å°†ç”¨æˆ·çš„è¯·æ±‚åˆ†å‘åˆ°ä¸åŒåº”ç”¨æœåŠ¡é›†ç¾¤ï¼›é€šå¸¸é€‰æ‹©çš„å…è´¹çš„è´Ÿè½½å‡è¡¡æ˜¯nginxã€‚åœ¨è¿™ç§æ¶æ„ä¸‹ï¼Œåº”ç”¨æœåŠ¡å™¨çš„è´Ÿè½½å°†ä¸ä¼šæ˜¯æ•´ä¸ªåº”ç”¨çš„ç“¶é¢ˆç‚¹ï¼› è™½ç„¶åº”ç”¨ç¨‹åºçš„å¤„ç†é€Ÿåº¦åœ¨è¿™ç§æ¶æ„ä¸‹æå‡äº†è®¸å¤šï¼Œä½†æ˜¯åˆä¼šæš´éœ²ä¸€ä¸ªé—®é¢˜ï¼Œæ•°æ®åº“çš„å‹åŠ›å¤§å¤§å¢å¤§ï¼Œå¯¼è‡´è®¿é—®å“åº”å»¶è¿Ÿï¼Œå½±å“æ•´ä¸ªåº”ç”¨çš„æ€§èƒ½ã€‚è¿™ç§æ¶æ„è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œé€šå¸¸åº”ç”¨æ˜¯æœ‰çŠ¶æ€çš„ï¼Œéœ€è¦è®°å½•ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œå¦‚æœæ¯æ¬¡ç”¨æˆ·çš„è¯·æ±‚éƒ½æ˜¯éšæœºè·¯ç”±åˆ°åç«¯çš„åº”ç”¨æœåŠ¡å™¨ï¼Œé‚£ä¹ˆç”¨æˆ·çš„ä¼šè¯å°†ä¼šä¸¢å¤±ï¼›è§£å†³è¿™ä¸ªé—®é¢˜ä¸¤ä¸ªæ–¹æ¡ˆï¼š é‡‡ç”¨ä¸€è‡´æ€§hashæŠŠç”¨æˆ·çš„è¯·æ±‚è·¯ç”±åˆ°åŒä¸€ä¸ªTomcatï¼Œå¦‚æœæœ‰ä¸€å°æœåŠ¡å™¨è·ªäº†ï¼Œé‚£ä¹ˆè¿™å°æœåŠ¡å™¨ä¸Šé¢çš„ç”¨æˆ·ä¿¡æ¯å°†ä¼šä¸¢å¤± Tomcaté›†ç¾¤ä¹‹é—´é€šè¿‡é…ç½®sessionå¤åˆ¶ï¼Œè¾¾åˆ°å…±äº«ï¼Œæ­¤æ–¹æ¡ˆæ•ˆç‡è¾ƒä½ ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:3:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"ç¼“å­˜ æ ¹æ®äºŒå…«åŸåˆ™ï¼Œ80%çš„çš„ä¸šåŠ¡éƒ½æ˜¯é›†ä¸­è®¿é—®20%çš„æ•°æ®ï¼Œè¿™20%çš„æ•°æ®é€šå¸¸ç§°ä¸ºçƒ­ç‚¹æ•°æ®ï¼Œä½†æ˜¯è¿™20%çš„æ•°æ®å ç”¨çš„å†…å­˜ä¹Ÿä¸ä¼šå°ï¼Œå¦‚æœæ¯ä¸ªåº”ç”¨æœåŠ¡å™¨éƒ½å­˜æ”¾ä¸€ä»½ï¼Œæœ‰äº›æµªè´¹å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥è¿™æ—¶å€™éœ€è¦è€ƒè™‘åŠ å…¥åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ï¼ˆå¸¸ç”¨çš„æ˜¯Redisï¼‰ï¼›å½“å¼•å…¥äº†åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ï¼Œå†æ¥çœ‹ä¸Šé¢é‚£ä¸ªæ–¹æ¡ˆçš„é—®é¢˜ï¼Œå°±å¯ä»¥è§£å†³äº†ï¼ŒæŠŠç”¨æˆ·çš„ä¼šè¯å­˜æ”¾åˆ°ç¼“å­˜æœåŠ¡å™¨ï¼Œä¸ä»…å¯ä»¥é˜²æ­¢ç”¨æˆ·æ•°æ®ä¸¢å¤±ï¼Œæ•ˆç‡ä¹Ÿä¸ä½ï¼›æ¶æ„å›¾å¦‚ä¸‹ï¼š cache ç”±äºåˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨æ¯•ç«Ÿå­˜æ”¾åœ¨è¿œç¨‹ï¼Œéœ€è¦ç»è¿‡ç½‘ç»œï¼Œæ‰€ä»¥å–æ•°æ®è¿˜æ˜¯è¦èŠ±ä¸€ç‚¹æ—¶é—´ï¼›æœ¬åœ°ç¼“å­˜è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œä½†æ˜¯å†…å­˜ç©ºé—´æœ‰é™ï¼Œå¹¶ä¸”è¿˜ä¼šå‡ºç°å’Œåº”ç”¨ç¨‹åºäº‰æŠ¢èµ„æºï¼›æ‰€ä»¥è¿™ç§æ¶æ„æ­é…äº†åˆ†å¸ƒå¼ç¼“å­˜å’Œæœ¬åœ°ç¼“å­˜ï¼Œæœ¬åœ°ç¼“å­˜å­˜æ”¾å°‘é‡å¸¸ç”¨çƒ­ç‚¹æ•°æ®ï¼Œå½“æœ¬åœ°ç¼“å­˜ä¸­æ²¡æœ‰å‘½ä¸­æ—¶åœ¨å»é›†ä¸­å¼ç¼“å­˜å– åœ¨å¼•è¿›ç¼“å­˜ä¹‹åï¼Œæ•°æ®åº“çš„è®¿é—®å‹åŠ›å¯ä»¥çš„ä¸€å®šçš„ç¼“è§£ ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:4:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"æ•°æ®åº“è¯»å†™åˆ†ç¦» è™½ç„¶åœ¨åŠ å…¥äº†ç¼“å­˜ä¹‹åï¼Œéƒ¨åˆ†æ•°æ®å¯ä»¥ç›´æ¥èµ°ç¼“å­˜ï¼Œä¸éœ€è¦è®¿é—®æ•°æ®åº“ï¼Œä½†æ˜¯ä»»ç„¶ä¼šæœ‰ä¸€äº›è¯·æ±‚ï¼Œä¼šè®¿é—®æ•°æ®åº“ï¼Œæ¯”å¦‚ï¼šç¼“å­˜å¤±æ•ˆï¼Œç¼“å­˜æœªå‘½ä¸­ï¼›å½“æµé‡å¤§çš„æ—¶å€™ï¼Œæ•°æ®åº“çš„è®¿é—®é‡ä¹Ÿä¸å°ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦è€ƒè™‘æ­å»ºæ•°æ®åº“é›†ç¾¤ï¼Œè¯»å†™åˆ†ç¦» rwSeparate å½“åº”ç”¨æœåŠ¡å™¨æœ‰å†™æ“ä½œæ—¶ï¼Œè®¿é—®ä¸»åº“ï¼Œå½“åº”ç”¨ç¨‹åºæœ‰è¯»æ“ä½œæ—¶ï¼Œè®¿é—®ä»åº“ï¼›å¤§å¤šæ•°çš„åº”ç”¨éƒ½æ˜¯è¯»çš„æ“ä½œè¿œè¿œå¤§äºå†™çš„æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥é…ç½®æ•°æ®åº“ä¸€ä¸»å¤šä»æ¥åˆ†æ‹…æ•°æ®åº“çš„å‹åŠ›ï¼›ä¸ºäº†è®©åº”ç”¨ç¨‹åºå¯¹åº”ä¸»åº“å’Œä»åº“æ— æ„ŸçŸ¥ï¼Œé€šå¸¸éœ€è¦å¼•å…¥ä¸€äº›è¯»å†™åˆ†ç¦»çš„æ¡†æ¶åšä¸€ä¸ªç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¨¡å—ã€‚ è¿™ç§æ¶æ„é€šå¸¸éœ€è¦è­¦æƒ•çš„ä¸€ä¸ªé—®é¢˜æ˜¯ä¸»ä»å»¶è¿Ÿï¼Œå½“åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œä¸»åº“åˆšå†™æˆåŠŸï¼Œæ•°æ®åº“è¿˜æœªæˆåŠŸåŒæ­¥å®Œä»åº“ï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªè¯·æ±‚è¿›å…¥è¯»å–æ•°æ®å‘ç°ä¸å­˜åœ¨ï¼›è§£æ”¾æ–¹æ¡ˆæ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­é«˜å¹¶å‘çš„åœºæ™¯ä¸‹è®¾ç½®å¼ºåˆ¶èµ°ä¸»åº“æŸ¥è¯¢ ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:5:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"åå‘ä»£ç†å’ŒCDN å‡å¦‚éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å¤§ï¼Œå…¨å›½å„åœ°éƒ½ä¼šä½¿ç”¨åˆ°æˆ‘ä»¬çš„åº”ç”¨ï¼Œç”±äºå„åœ°åŒºçš„ç½‘ç»œæƒ…å†µä¸åŒï¼Œæ‰€ä»¥æœ‰çš„äººè¯·æ±‚å“åº”é€Ÿåº¦å¿«ï¼Œæœ‰çš„äººè¯·æ±‚å“åº”é€Ÿåº¦æ…¢ï¼Œè¿™ä¼šä¸¥é‡çš„å½±å“åˆ°ç”¨æˆ·çš„ä½“éªŒã€‚ä¸ºäº†æé«˜å“åº”é€Ÿåº¦éœ€è¦å¼•å…¥åå‘ä»£ç†å’ŒCDNï¼›CDNå’Œåå‘ä»£ç†éƒ½æ˜¯é‡‡ç”¨çš„ç¼“å­˜ï¼Œç›®çš„ï¼š å°½å¯èƒ½å¿«çš„æŠŠæ•°æ®å‘ˆç°ç»™ç”¨æˆ· å‡è½»åç«¯æœåŠ¡å™¨çš„å‹åŠ› æ¶æ„å›¾å¦‚ä¸‹ï¼š cdn CDN: éƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼Œå½“ç”¨æˆ·æ¥è®¿é—®çš„æ—¶å€™ï¼Œä»è·ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨è¿”å›æ•°æ®ï¼Œå°½å¿«å‘ˆç°ç»™ç”¨æˆ·ï¼›é€šå¸¸æƒ…å†µä¸‹åœ¨CDNä¸­ç¼“å­˜çš„æ˜¯é™æ€èµ„æºï¼ˆhtml,js,cssï¼‰ï¼Œè¾¾åˆ°åŠ¨é™åˆ†ç¦»ï¼›ä½†æ˜¯æœ‰æ—¶å€™é‡åˆ°äº†æŸäº›æ•°æ®è®¿é—®é‡ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œåç«¯ä¼šç”Ÿæˆé™æ€èµ„æºæ”¾å…¥åˆ°CDNï¼Œæ¯”å¦‚ï¼šå•†åŸçš„é¦–é¡µï¼Œæ¯ä¸ªç”¨æˆ·è¿›å…¥éƒ½éœ€è¦è®¿é—®çš„é¡µé¢ï¼Œå¦‚æœæ¯æ¬¡è¯·æ±‚éƒ½è¿›å…¥åˆ°åç«¯ï¼Œé‚£ä¹ˆæœåŠ¡å™¨çš„å‹åŠ›è‚¯å®šä¸å°ï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šæŠŠé¦–é¡µç”Ÿæˆé™æ€çš„æ–‡ä»¶ç¼“å­˜åˆ°cdnå’Œåå‘ä»£ç†æœåŠ¡å™¨ åå‘ä»£ç†ï¼šéƒ¨ç½²åœ¨åº”ç”¨çš„ä¸­å¿ƒæœºæˆ¿ï¼Œé€šå¸¸ä¹Ÿæ˜¯ç¼“å­˜çš„é™æ€èµ„æºï¼Œå½“ç”¨æˆ·é€šè¿‡CDNæœªè¯·æ±‚åˆ°éœ€è¦çš„æ•°æ®æ—¶ï¼Œå…ˆè¿›å…¥åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœæœ‰ç¼“å­˜ç”¨æˆ·è®¿é—®çš„æ•°æ®ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼›è¿™é‡Œä¹Ÿæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå¯¹äºæœ‰äº›åœºæ™¯ä¸‹çš„çƒ­ç‚¹æ•°æ®ï¼Œåœ¨è¿™é‡Œæ ¹æ®ç”¨æˆ·çš„è¯·æ±‚å»åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸­è·å–ï¼Œèƒ½æ‹¿åˆ°å°±ç›´æ¥è¿”å›ã€‚ è¿™ç§æ¶æ„å·²ç»æŠŠç¼“å­˜åšåˆ°äº†4çº§ ç¬¬ä¸€çº§ï¼šCDN ç¼“å­˜é™æ€èµ„æº ç¬¬äºŒçº§ï¼šåå‘ä»£ç†ç¼“å­˜é™æ€èµ„æºä»¥åŠéƒ¨åˆ†çƒ­ç‚¹æ•°æ® ç¬¬ä¸‰çº§ï¼šåº”ç”¨æœåŠ¡å™¨çš„æœ¬åœ°ç¼“å­˜ ç¬¬å››çº§ï¼šåˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ é€šå¸¸æƒ…å†µä¸‹ç»è¿‡äº†è¿™4çº§ç¼“å­˜ï¼Œèƒ½å¤Ÿè¿›å…¥åˆ°æ•°æ®åº“çš„è¯·æ±‚ä¹Ÿä¸å¤šäº†ï¼Œå¾ˆå¥½çš„é‡Šæ”¾äº†æ•°æ®åº“çš„å‹åŠ› ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:6:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"æœç´¢å¼•æ“å’ŒNoSQL éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å¤§ï¼Œå¯¹äºæ•°æ®çš„å­˜å‚¨å’ŒæŸ¥è¯¢çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œé€šå¸¸æƒ…å†µæˆ‘ä»¬éœ€è¦å¼•å…¥éå…³ç³»å‹æ•°æ®åº“ï¼Œæ¯”å¦‚æœç´¢å¼•æ“å’ŒNoSQLæ•°æ®åº“ NoSQL æœ‰æ—¶å€™æˆ‘ä»¬çš„æŸ¥è¯¢åœºæ™¯å¾ˆå¤æ‚ï¼Œéœ€è¦æŸ¥è¯¢å¾ˆå¤šæ•°æ®è¡¨ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„è®¡ç®—æ‰èƒ½å®Œæˆï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘é€šè¿‡æ•°æ®åŒæ­¥å·¥å…·ï¼ˆæ¯”å¦‚canalï¼‰æ‹‰å»æ•°æ®åˆ°å¤§æ•°æ®å¹³å°ï¼Œä½¿ç”¨æ‰¹å¤„ç†æ¡†æ¶ç¦»çº¿è®¡ç®—ï¼ŒæŠŠè¾“å‡ºçš„ç»“æœå­˜æ”¾åˆ°æœç´¢å¼•æ“æˆ–è€…NoSQLæ•°æ®åº“ä¸­ï¼Œåº”ç”¨ç¨‹åºç›´æ¥æŸ¥è¯¢è®¡ç®—çš„ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚ä¹Ÿæœ‰å¯èƒ½æˆ‘ä»¬éœ€è¦æ±‡æ€»å¤šä¸ªè¡¨çš„æ•°æ®åšä¸€å¼ å®½è¡¨ï¼Œæ–¹ä¾¿åº”ç”¨ç¨‹åºæŸ¥è¯¢ ç”±äºå¼•å…¥çš„æ•°æ®å­˜å‚¨æ–¹å¼å¢å¤šï¼Œä¸ºäº†å‡è½»åº”ç”¨ç¨‹åºçš„ç®¡ç†å¤šä¸ªæ•°æ®æºçš„éº»çƒ¦ï¼Œéœ€è¦å°è£…ç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å—ï¼Œå¦‚æœä½¿ç”¨çš„æ—¶Javaï¼Œå¯ä»¥è€ƒè™‘spring-data ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:7:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"ä¸šåŠ¡çºµå‘æ‹†åˆ† äº’è”ç½‘å…¬å¸é€šå¸¸çš„å®—æ—¨æ˜¯å°æ­¥è¿­ä»£è¯•é”™å¿«è·‘ï¼Œå½“ä¸šåŠ¡å‘å±•åˆ°è¶³å¤Ÿå¤§ï¼Œå¯¹äºå•ä½“åº”ç”¨æƒ³è¦è¾¾åˆ°è¿™ä¸ªå®—æ—¨æ˜¯æœ‰éš¾åº¦çš„ï¼Œéšç€ä¸šåŠ¡çš„å‘å±•ï¼Œåº”ç”¨ç¨‹åºè¶Šæ¥è¶Šå¤§ï¼Œç ”å‘ã€ç»´æŠ¤ã€å‘å¸ƒçš„æˆæœ¬ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œè¿™æ—¶å€™å°±éœ€è¦è€ƒè™‘æ ¹æ®ä¸šåŠ¡æŠŠå•ä½“åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªæœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´å¯ä»¥é€šè¿‡RPCè¿œç¨‹è°ƒç”¨å’Œæ¶ˆæ¯é˜Ÿåˆ—æ¥ä¸€èµ·å®Œæˆç”¨æˆ·çš„è¯·æ±‚ã€‚ ç”±äºä¸šåŠ¡çš„æ‹†åˆ†ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¹Ÿä¼šç›¸åº”çš„å¯¹æ•°æ®åº“è¿›è¡Œæ‹†åˆ†ï¼Œè¾¾åˆ°ä¸€ä¸ªæœåŠ¡å¯¹åº”ä¸€ä¸ªæ•°æ®åº“çš„ç†æƒ³çŠ¶æ€ vertical å¼•å…¥MQçš„å¥½å¤„ï¼š æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§ï¼šå½“æ¶ˆè´¹æœåŠ¡å™¨å‘é€æ•…éšœæ—¶ï¼Œæ¶ˆæ¯è¿˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤± åŠ å¿«è¯·æ±‚çš„å“åº”ï¼šå½“ç”¨æˆ·è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨åï¼ŒæŠŠè¯·æ±‚ä¸­å¯ä»¥å¼‚æ­¥å¤„ç†çš„æ•°æ®æ”¾å…¥åˆ°MQï¼Œè®©ç³»ç»Ÿé€ä¸€æ¶ˆè´¹ï¼Œä¸éœ€è¦ç”¨æˆ·ç­‰å¾…ï¼ŒåŠ å¿«äº†å“åº”é€Ÿåº¦ å‰Šå³°å¡«è°·ï¼šå½“å¤§é‡è¯·æ±‚éƒ½åŒæ—¶è¿›å…¥åˆ°ç³»ç»Ÿä¹‹åï¼Œä¼šå…¨éƒ¨æ”¾å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç³»ç»Ÿé€ä¸€æ¶ˆè´¹ï¼Œä¸ä¼šå¯¹ç³»ç»Ÿé€ æˆå¾ˆå¤§çš„å†²å‡» ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:8:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"æ€»ç»“ è¿˜æœ‰ä¸€ä¸ªæƒ…å†µæœªè°ˆåŠåˆ°ï¼Œå°±æ˜¯æ•°æ®åº“çš„æ°´å¹³æ‹†åˆ†ï¼Œè¿™ä¹Ÿæ˜¯æ•°æ®åº“æ‹†åˆ†çš„æœ€åæ‰‹æ®µï¼Œåªæœ‰å½“å•è¡¨æ•°æ®ç‰¹åˆ«å¤§ï¼Œä¸èƒ½æ»¡è¶³ä¸šåŠ¡çš„éœ€è¦æ‰ä½¿ç”¨ã€‚ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯è¿›è¡Œæ•°æ®åº“çš„ä¸šåŠ¡çºµå‘æ‹†åˆ†ï¼ŒæŠŠæ•°æ®åº“ä¸­ä¸åŒä¸šåŠ¡çš„æ•°æ®æ”¾åˆ°ä¸åŒçš„ç‰©ç†æœåŠ¡å™¨ä¸Šã€‚ åº”ç”¨å½“å‰åˆ°åº•é€‰æ‹©ä»€ä¹ˆæ¶æ„ï¼Œä¸€å®šè¦æ ¹æ®å®é™…ä¸šåŠ¡çš„éœ€æ±‚è¿›è¡Œçµæ´»çš„é€‰æ‹©ï¼Œé©±åŠ¨æŠ€æœ¯æ¶æ„å‘å±•çš„ä¸»è¦åŠ¨åŠ›è¿˜æ˜¯åœ¨äºä¸šåŠ¡çš„å‘å±•ï¼Œä¸è¦ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ã€‚ ","date":"2020-05-26","objectID":"/20200526_app-architecture-development/:9:0","tags":["Distribution"],"title":"The Development of App Architecture","uri":"/20200526_app-architecture-development/"},{"categories":["Technology"],"content":"Article description.","date":"2020-05-26","objectID":"/20200526_final-key-word-java/","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"Final key word no doubt be mentioned most time in Java language. There are some points about final key word. First of all, final key word can modify three objects: first is modify variables, second is modify way, third is modify class. ","date":"2020-05-26","objectID":"/20200526_final-key-word-java/:0:0","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"final å…³é”®å­—ä¿®é¥°å˜é‡ åœ¨ä½¿ç”¨finalä¿®é¥°å˜é‡æ—¶ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œå¦ä¸€ç§æ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡ã€‚finalå…³é”®å­—åœ¨ä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹æ—¶å¿…é¡»å¯¹å˜é‡èµ‹äºˆåˆå§‹å€¼ï¼Œå› æ­¤finalä¹Ÿå¸¸å¸¸å’Œstaticå…³é”®å­—ä¸€èµ·ç”¨æ¥å£°æ˜å¸¸é‡å€¼ã€‚finalæ­£å¥½é™åˆ¶äº†å¿…é¡»èµ‹å€¼ï¼Œstaticå£°æ˜äº†é™æ€å˜é‡ã€‚ final static String str = \"Hollow world\"; ä¿®é¥°å¼•ç”¨å˜é‡æ—¶ï¼Œè¯¥å¼•ç”¨å˜é‡å¦‚æœå·²ç»è¢«èµ‹å€¼åˆ™ä¸å¯ä»¥å†è¢«èµ‹å€¼ï¼Œå¦åˆ™ä¹Ÿä¼šå‡ºç°ä¸èƒ½ç¼–è¯‘çš„æƒ…å†µ //å®šä¹‰ä¸€ä¸ªmainå¯¹è±¡å¹¶å®ä¾‹åŒ– final Main main = new Main(); //è¢«finalå…³é”®å­—ä¿®é¥°åï¼Œå†æ¬¡å¯¹Mainå¯¹è±¡è¿›è¡Œèµ‹å€¼å°±ä¼šæŠ¥é”™ main = new Main(); ","date":"2020-05-26","objectID":"/20200526_final-key-word-java/:1:0","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"finalå…³é”®å­—ä¿®é¥°æ–¹æ³• é€šè¿‡finalä¿®é¥°çš„æ–¹æ³•æ˜¯ä¸èƒ½è¢«å­ç±»çš„æ–¹æ³•é‡å†™çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ–¹æ³•ç¡®å®šå¥½ä¸å†ä¿®æ”¹å¯ä»¥ä½¿ç”¨finalï¼Œå› ä¸ºfinalä¿®é¥°çš„æ–¹æ³•æ˜¯åœ¨ç¨‹åºç¼–è¯‘çš„æ—¶å€™å°±è¢«åŠ¨æ€ç»‘å®šäº†ä¸ç”¨ç­‰åˆ°ç¨‹åºè¿è¡Œçš„æ—¶å€™è¢«åŠ¨æ€ç»‘å®šï¼Œè¿™æ ·å°±å¤§å¤§æé«˜äº†æ‰§è¡Œæ•ˆç‡ã€‚ public final void method(){ System.out.println(\"It is final method\"); } ","date":"2020-05-26","objectID":"/20200526_final-key-word-java/:2:0","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"finalå…³é”®å­—ä¿®é¥°ç±» è¢«finalä¿®é¥°çš„ç±»å«finalç±»ï¼Œfinalç±»æ˜¯ä¸èƒ½è¢«ç»§æ‰¿çš„ï¼Œè¿™ä¹Ÿå°±ä»¥ä¸ºè¿™finalç±»çš„åŠŸèƒ½æ˜¯æ¯”è¾ƒå®Œæ•´çš„ã€‚å› æ­¤ï¼Œjdkä¸­æœ‰å¾ˆå¤šç±»ä½¿ç”¨finalä¿®é¥°çš„ï¼Œå®ƒä»¬ä¸éœ€è¦è¢«ç»§æ‰¿ï¼Œå…¶ä¸­ï¼Œæœ€å¸¸è§çš„å°±æ˜¯Stringç±»ã€‚ public final class String implements java.io.Serializable, Comparable\u003cString\u003e public final class Integer extends Number implements ... public final class Long extends Number implements ... åŒ…æ‹¬å…¶ä»–çš„è£…é¥°ç±»éƒ½æ˜¯è¢«finalå…³é”®å­—ä¿®é¥°çš„ï¼Œå®ƒè‡ªèº«æä¾›çš„æ–¹æ³•å’ŒåŠŸèƒ½ä¹Ÿæ˜¯éå¸¸å®Œå¤‡çš„ã€‚ ","date":"2020-05-26","objectID":"/20200526_final-key-word-java/:3:0","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"staticå…³é”®å­—çš„ä¸åŒ final static æˆå¯¹å‡ºç°çš„é¢‘ç‡ä¹Ÿæ˜¯æ¯”è¾ƒé«˜çš„ï¼Œä½¿ç”¨staticä¿®é¥°çš„å˜é‡åªä¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™è¢«åˆå§‹åŒ–ï¼Œä¸ä¼šå› ä¸ºå¯¹è±¡çš„å†æ¬¡åˆ›å»ºè€Œæ”¹å˜ã€‚ static double num = Math.random(); ","date":"2020-05-26","objectID":"/20200526_final-key-word-java/:4:0","tags":["Java"],"title":"The Final Key Word In Java","uri":"/20200526_final-key-word-java/"},{"categories":["Technology"],"content":"Article description.","date":"2020-05-19","objectID":"/20200519_zookeeper/","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"ZooKeeper is an open source distributed coordination framework. It is positioned to provide consistent services for distributed applications and is the administrator of the entire big data system. ZooKeeper will encapsulate key services that are complex and error-prone, and provide users with efficient, stable, and easy-to-use services. ","date":"2020-05-19","objectID":"/20200519_zookeeper/:0:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"1. Introduce ZooKeeper æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼åè°ƒæ¡†æ¶ï¼Œå®ƒçš„å®šä½æ˜¯ä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡ï¼Œæ˜¯æ•´ä¸ªå¤§æ•°æ®ä½“ç³»çš„ç®¡ç†å‘˜ã€‚ZooKeeper ä¼šå°è£…å¥½å¤æ‚æ˜“å‡ºé”™çš„å…³é”®æœåŠ¡ï¼Œå°†é«˜æ•ˆã€ç¨³å®šã€æ˜“ç”¨çš„æœåŠ¡æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚ å¦‚æœä¸Šé¢çš„å®˜æ–¹è¨€è¯­ä½ ä¸å¤ªç†è§£ï¼Œä½ å¯ä»¥è®¤ä¸º ZooKeeper = æ–‡ä»¶ç³»ç»Ÿ + ç›‘å¬é€šçŸ¥æœºåˆ¶ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:1:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"1.1 File System filesys Zookeeperç»´æŠ¤ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶ç³»ç»Ÿçš„æ ‘çŠ¶æ•°æ®ç»“æ„ï¼Œè¿™ç§ç‰¹æ€§ä½¿å¾— Zookeeper ä¸èƒ½ç”¨äºå­˜æ”¾å¤§é‡çš„æ•°æ®ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å­˜æ”¾æ•°æ®ä¸Šé™ä¸º1Mã€‚æ¯ä¸ªå­ç›®å½•é¡¹å¦‚ NameService éƒ½è¢«ç§°ä½œä¸º znode(ç›®å½•èŠ‚ç‚¹)ã€‚å’Œæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè‡ªç”±çš„å¢åŠ ã€åˆ é™¤znodeï¼Œåœ¨ä¸€ä¸ªznodeä¸‹å¢åŠ ã€åˆ é™¤å­znodeï¼Œå”¯ä¸€çš„ä¸åŒåœ¨äºznodeæ˜¯å¯ä»¥å­˜å‚¨æ•°æ®çš„ã€‚é»˜è®¤æœ‰å››ç§ç±»å‹çš„znodeï¼š æŒä¹…åŒ–ç›®å½•èŠ‚ç‚¹ PERSISTENTï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ã€‚ æŒä¹…åŒ–é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ PERSISTENT_SEQUENTIALï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·ã€‚ ä¸´æ—¶ç›®å½•èŠ‚ç‚¹ EPHEMERALï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ã€‚ ä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ EPHEMERAL_SEQUENTIALï¼šå®¢æˆ·ç«¯ä¸zookeeperæ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåªæ˜¯Zookeeperç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:1:1","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"1.2 Watcher Watcher ç›‘å¬æœºåˆ¶æ˜¯ Zookeeper ä¸­éå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åŸºäº Zookeeper ä¸Šåˆ›å»ºçš„èŠ‚ç‚¹ï¼Œå¯ä»¥å¯¹è¿™äº›èŠ‚ç‚¹ç»‘å®šç›‘å¬äº‹ä»¶ï¼Œæ¯”å¦‚å¯ä»¥ç›‘å¬èŠ‚ç‚¹æ•°æ®å˜æ›´ã€èŠ‚ç‚¹åˆ é™¤ã€å­èŠ‚ç‚¹çŠ¶æ€å˜æ›´ç­‰äº‹ä»¶ï¼Œé€šè¿‡è¿™ä¸ªäº‹ä»¶æœºåˆ¶ï¼Œå¯ä»¥åŸºäº Zookeeper å®ç°åˆ†å¸ƒå¼é”ã€é›†ç¾¤ç®¡ç†ç­‰åŠŸèƒ½ã€‚ Watcher ç‰¹æ€§ï¼š å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œ Zookeeper ä¼šäº§ç”Ÿä¸€ä¸ª Watcher äº‹ä»¶ï¼Œå¹¶ä¸”ä¼šå‘é€åˆ°å®¢æˆ·ç«¯ã€‚ä½†æ˜¯å®¢æˆ·ç«¯åªä¼šæ”¶åˆ°ä¸€æ¬¡é€šçŸ¥ã€‚å¦‚æœåç»­è¿™ä¸ªèŠ‚ç‚¹å†æ¬¡å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆä¹‹å‰è®¾ç½® Watcher çš„å®¢æˆ·ç«¯ä¸ä¼šå†æ¬¡æ”¶åˆ°æ¶ˆæ¯ã€‚ï¼ˆWatcher æ˜¯ä¸€æ¬¡æ€§çš„æ“ä½œï¼‰ã€‚å¯ä»¥é€šè¿‡å¾ªç¯ç›‘å¬å»è¾¾åˆ°æ°¸ä¹…ç›‘å¬æ•ˆæœã€‚ ZooKeeper çš„ Watcher æœºåˆ¶ï¼Œæ€»çš„æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªè¿‡ç¨‹ï¼š å®¢æˆ·ç«¯æ³¨å†Œ Watcherï¼Œæ³¨å†Œ watcher æœ‰ 3 ç§æ–¹å¼ï¼ŒgetDataã€existsã€getChildrenã€‚ æœåŠ¡å™¨å¤„ç† Watcher ã€‚ å®¢æˆ·ç«¯å›è°ƒ Watcher å®¢æˆ·ç«¯ã€‚ ç›‘å¬æµç¨‹ï¼š é¦–å…ˆè¦æœ‰ä¸€ä¸ªmain()çº¿ç¨‹ åœ¨mainçº¿ç¨‹ä¸­åˆ›å»ºZookeeperå®¢æˆ·ç«¯ï¼Œè¿™æ—¶å°±ä¼šåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè´Ÿè´£ç½‘ç»œè¿æ¥é€šä¿¡ï¼ˆconnetï¼‰ï¼Œä¸€ä¸ªè´Ÿè´£ç›‘å¬ï¼ˆlistenerï¼‰ã€‚ é€šè¿‡connectçº¿ç¨‹å°†æ³¨å†Œçš„ç›‘å¬äº‹ä»¶å‘é€ç»™Zookeeperã€‚ åœ¨Zookeeperçš„æ³¨å†Œç›‘å¬å™¨åˆ—è¡¨ä¸­å°†æ³¨å†Œçš„ç›‘å¬äº‹ä»¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­ã€‚ Zookeeperç›‘å¬åˆ°æœ‰æ•°æ®æˆ–è·¯å¾„å˜åŒ–ï¼Œå°±ä¼šå°†è¿™ä¸ªæ¶ˆæ¯å‘é€ç»™listenerçº¿ç¨‹ã€‚ listenerçº¿ç¨‹å†…éƒ¨è°ƒç”¨äº†process()æ–¹æ³•ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:1:2","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"1.3 Feature feature é›†ç¾¤ï¼šZookeeperæ˜¯ä¸€ä¸ªé¢†å¯¼è€…ï¼ˆLeaderï¼‰ï¼Œå¤šä¸ªè·Ÿéšè€…ï¼ˆFollowerï¼‰ç»„æˆçš„é›†ç¾¤ã€‚ é«˜å¯ç”¨æ€§ï¼šé›†ç¾¤ä¸­åªè¦æœ‰åŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹å­˜æ´»ï¼ŒZookeeperé›†ç¾¤å°±èƒ½æ­£å¸¸æœåŠ¡ã€‚ å…¨å±€æ•°æ®ä¸€è‡´ï¼šæ¯ä¸ªServerä¿å­˜ä¸€ä»½ç›¸åŒçš„æ•°æ®å‰¯æœ¬ï¼ŒClientæ— è®ºè¿æ¥åˆ°å“ªä¸ªServerï¼Œæ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚ æ›´æ–°è¯·æ±‚é¡ºåºè¿›è¡Œï¼šæ¥è‡ªåŒä¸€ä¸ªClientçš„æ›´æ–°è¯·æ±‚æŒ‰å…¶å‘é€é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ æ•°æ®æ›´æ–°åŸå­æ€§ï¼šä¸€æ¬¡æ•°æ®æ›´æ–°è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚ å®æ—¶æ€§ï¼šåœ¨ä¸€å®šæ—¶é—´èŒƒå›´å†…ï¼ŒClientèƒ½è¯»åˆ°æœ€æ–°æ•°æ®ã€‚ ä»è®¾è®¡æ¨¡å¼è§’åº¦æ¥çœ‹ï¼Œzkæ˜¯ä¸€ä¸ªåŸºäºè§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼çš„æ¡†æ¶ï¼Œå®ƒè´Ÿè´£ç®¡ç†è·Ÿå­˜å‚¨å¤§å®¶éƒ½å…³å¿ƒçš„æ•°æ®ï¼Œç„¶åæ¥å—è§‚å¯Ÿè€…çš„æ³¨å†Œï¼Œæ•°æ®åç”Ÿå˜åŒ–zkä¼šé€šçŸ¥åœ¨zkä¸Šæ³¨å†Œçš„è§‚å¯Ÿè€…åšå‡ºååº”ã€‚ Zookeeperæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åè°ƒç³»ç»Ÿï¼Œæ»¡è¶³CPæ€§ï¼Œè·ŸSpringCloudä¸­çš„Eurekaæ»¡è¶³APä¸ä¸€æ ·ã€‚ åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿï¼šLeaderä¼šåŒæ­¥æ•°æ®åˆ°followerï¼Œç”¨æˆ·è¯·æ±‚å¯é€šè¿‡followerå¾—åˆ°æ•°æ®ï¼Œè¿™æ ·ä¸ä¼šå‡ºç°å•ç‚¹æ•…éšœï¼Œå¹¶ä¸”åªè¦åŒæ­¥æ—¶é—´æ— é™çŸ­ï¼Œé‚£è¿™å°±æ˜¯ä¸ªå¥½çš„ åˆ†å¸ƒå¼åè°ƒç³»ç»Ÿã€‚ CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ã€‚CAP åŸåˆ™æŒ‡çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ªè¦ç´ æœ€å¤šåªèƒ½åŒæ—¶å®ç°ä¸¤ç‚¹ï¼Œä¸å¯èƒ½ä¸‰è€…å…¼é¡¾ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:1:3","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"2. Function é€šè¿‡å¯¹ Zookeeper ä¸­ä¸°å¯Œçš„æ•°æ®èŠ‚ç‚¹è¿›è¡Œäº¤å‰ä½¿ç”¨ï¼Œé…åˆ Watcher äº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„æ„å»ºä¸€ç³»åˆ—åˆ†å¸ƒå¼åº”ç”¨ä¸­æ¶‰åŠçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ¯”å¦‚ æ•°æ®å‘å¸ƒ/è®¢é˜…ã€è´Ÿè½½å‡è¡¡ã€å‘½åæœåŠ¡ã€åˆ†å¸ƒå¼åè°ƒ/é€šçŸ¥ã€é›†ç¾¤ç®¡ç†ã€Master é€‰ä¸¾ã€åˆ†å¸ƒå¼é”å’Œåˆ†å¸ƒå¼é˜Ÿåˆ— ç­‰åŠŸèƒ½ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"1. æ•°æ®å‘å¸ƒ/è®¢é˜… å½“æŸäº›æ•°æ®ç”±å‡ ä¸ªæœºå™¨å…±äº«ï¼Œä¸”è¿™äº›ä¿¡æ¯ç»å¸¸å˜åŒ–æ•°æ®é‡è¿˜å°çš„æ—¶å€™ï¼Œè¿™äº›æ•°æ®å°±é€‚åˆå­˜å‚¨åˆ°ZKä¸­ã€‚ æ•°æ®å­˜å‚¨ï¼šå°†æ•°æ®å­˜å‚¨åˆ° Zookeeper ä¸Šçš„ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹ã€‚ æ•°æ®è·å–ï¼šåº”ç”¨åœ¨å¯åŠ¨åˆå§‹åŒ–èŠ‚ç‚¹ä» Zookeeper æ•°æ®èŠ‚ç‚¹è¯»å–æ•°æ®ï¼Œå¹¶åœ¨è¯¥èŠ‚ç‚¹ä¸Šæ³¨å†Œä¸€ä¸ªæ•°æ®å˜æ›´ Watcher æ•°æ®å˜æ›´ï¼šå½“å˜æ›´æ•°æ®æ—¶ä¼šæ›´æ–° Zookeeper å¯¹åº”èŠ‚ç‚¹æ•°æ®ï¼ŒZookeeperä¼šå°†æ•°æ®å˜æ›´é€šçŸ¥å‘åˆ°å„å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ¥åˆ°é€šçŸ¥åé‡æ–°è¯»å–å˜æ›´åçš„æ•°æ®å³å¯ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:1","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"2. åˆ†å¸ƒå¼é” å…³äºåˆ†å¸ƒå¼é”å…¶å®åœ¨ Redis ä¸­å·²ç»è®²è¿‡äº†ï¼Œå¹¶ä¸”Redisæä¾›çš„åˆ†å¸ƒå¼é”æ˜¯æ¯”ZKæ€§èƒ½å¼ºçš„ã€‚åŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”ä¸€èˆ¬æœ‰å¦‚ä¸‹ä¸¤ç§ã€‚ ä¿æŒç‹¬å  æ ¸å¿ƒæ€æƒ³ï¼šåœ¨zkä¸­æœ‰ä¸€ä¸ªå”¯ä¸€çš„ä¸´æ—¶èŠ‚ç‚¹ï¼Œåªæœ‰æ‹¿åˆ°èŠ‚ç‚¹çš„æ‰å¯ä»¥æ“ä½œæ•°æ®ï¼Œæ²¡æ‹¿åˆ°çš„çº¿ç¨‹å°±éœ€è¦ç­‰å¾…ã€‚ç¼ºç‚¹ï¼šå¯èƒ½å¼•å‘ç¾Šç¾¤æ•ˆåº”ï¼Œç¬¬ä¸€ä¸ªç”¨å®Œåç¬é—´æœ‰999ä¸ªåŒæ—¶å¹¶å‘çš„çº¿ç¨‹å‘zkè¯·æ±‚è·å¾—é”ã€‚ æ§åˆ¶æ—¶åº ä¸»è¦æ˜¯é¿å…äº†ç¾Šç¾¤æ•ˆåº”ï¼Œä¸´æ—¶èŠ‚ç‚¹å·²ç»é¢„å…ˆå­˜åœ¨ï¼Œæ‰€æœ‰æƒ³è¦è·å¾—é”çš„çº¿ç¨‹åœ¨å®ƒä¸‹é¢åˆ›å»ºä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ï¼Œç¼–å·æœ€å°çš„è·å¾—é”ï¼Œç”¨å®Œåˆ é™¤ï¼Œåé¢çš„ä¾æ¬¡æ’é˜Ÿè·å–ã€‚ distributedLock ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:2","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3. è´Ÿè½½å‡è¡¡ å¤šä¸ªç›¸åŒçš„jaråŒ…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šå¼€å¯ç›¸åŒçš„æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡nginxåœ¨æœåŠ¡ç«¯è¿›è¡Œè´Ÿè½½å‡è¡¡çš„é…ç½®ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ZooKeeperåœ¨å®¢æˆ·ç«¯è¿›è¡Œè´Ÿè½½å‡è¡¡é…ç½®ã€‚ å¤šä¸ªæœåŠ¡æ³¨å†Œ å®¢æˆ·ç«¯è·å–ä¸­é—´ä»¶åœ°å€é›†åˆ ä»é›†åˆä¸­éšæœºé€‰ä¸€ä¸ªæœåŠ¡æ‰§è¡Œä»»åŠ¡ ZooKeeperè´Ÿè½½å‡è¡¡å’ŒNginxè´Ÿè½½å‡è¡¡åŒºåˆ«ï¼š ZooKeeperä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œzabæœºåˆ¶ä¿è¯å•ç‚¹æ•…éšœå¯é‡æ–°é€‰ä¸¾ä¸€ä¸ªleaderåªè´Ÿè´£æœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œä¸è´Ÿè´£è½¬å‘ï¼Œå‡å°‘ä¸€æ¬¡æ•°æ®äº¤æ¢ï¼ˆæ¶ˆè´¹æ–¹ä¸æœåŠ¡æ–¹ç›´æ¥é€šä¿¡ï¼‰ï¼Œéœ€è¦è‡ªå·±å®ç°ç›¸åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚ Nginxå­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå•ç‚¹è´Ÿè½½é«˜æ•°æ®é‡å¤§,éœ€è¦é€šè¿‡ KeepAlived + LVS å¤‡æœºå®ç°é«˜å¯ç”¨ã€‚æ¯æ¬¡è´Ÿè½½ï¼Œéƒ½å……å½“ä¸€æ¬¡ä¸­é—´äººè½¬å‘è§’è‰²ï¼Œå¢åŠ ç½‘ç»œè´Ÿè½½é‡ï¼ˆæ¶ˆè´¹æ–¹ä¸æœåŠ¡æ–¹é—´æ¥é€šä¿¡ï¼‰ï¼Œè‡ªå¸¦è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:3","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4. å‘½åæœåŠ¡ å‘½åæœåŠ¡æ˜¯æŒ‡é€šè¿‡æŒ‡å®šçš„åå­—æ¥è·å–èµ„æºæˆ–è€…æœåŠ¡çš„åœ°å€ï¼Œåˆ©ç”¨ zk åˆ›å»ºä¸€ä¸ªå…¨å±€å”¯ä¸€çš„è·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªåå­—ï¼ŒæŒ‡å‘é›†ç¾¤ä¸­çš„é›†ç¾¤ï¼Œæä¾›çš„æœåŠ¡çš„åœ°å€ï¼Œæˆ–è€…ä¸€ä¸ªè¿œç¨‹çš„å¯¹è±¡ç­‰ç­‰ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:4","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5. åˆ†å¸ƒå¼åè°ƒ/é€šçŸ¥ å¯¹äºç³»ç»Ÿè°ƒåº¦æ¥è¯´ï¼Œç”¨æˆ·æ›´æ”¹zkæŸä¸ªèŠ‚ç‚¹çš„valueï¼Œ ZooKeeperä¼šå°†è¿™äº›å˜åŒ–å‘é€ç»™æ³¨å†Œäº†è¿™ä¸ªèŠ‚ç‚¹çš„ watcher çš„æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œè¿›è¡Œé€šçŸ¥ã€‚ å¯¹äºæ‰§è¡Œæƒ…å†µæ±‡æŠ¥æ¥è¯´ï¼Œæ¯ä¸ªå·¥ä½œè¿›ç¨‹éƒ½åœ¨ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæºå¸¦å·¥ä½œè¿›åº¦çš„ä¸´æ—¶èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ±‡æ€»çš„è¿›ç¨‹å¯ä»¥ç›‘æ§ç›®å½•å­èŠ‚ç‚¹çš„å˜åŒ–è·å¾—å·¥ä½œè¿›åº¦çš„å®æ—¶çš„å…¨å±€æƒ…å†µã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:5","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"6. é›†ç¾¤ç®¡ç† å¤§æ•°æ®ä½“ç³»ä¸‹çš„å¤§éƒ¨åˆ†é›†ç¾¤æœåŠ¡å¥½åƒéƒ½é€šè¿‡ZooKeeperç®¡ç†çš„ï¼Œå…¶å®ç®¡ç†çš„æ—¶å€™ä¸»è¦å…³æ³¨çš„å°±æ˜¯æœºå™¨çš„åŠ¨æ€ä¸Šä¸‹çº¿è·ŸLeaderé€‰ä¸¾ã€‚ åŠ¨æ€ä¸Šä¸‹çº¿ï¼š æ¯”å¦‚åœ¨zookeeperæœåŠ¡å™¨ç«¯æœ‰ä¸€ä¸ªznodeå« /Configurationï¼Œé‚£ä¹ˆé›†ç¾¤ä¸­æ¯ä¸€ä¸ªæœºå™¨å¯åŠ¨çš„æ—¶å€™éƒ½å»è¿™ä¸ªèŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªEPHEMERALç±»å‹çš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚server1 åˆ›å»º /Configuration/Server1ï¼Œserver2åˆ›å»º**/Configuration /Server1**ï¼Œç„¶åServer1å’ŒServer2éƒ½watch /Configuration è¿™ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¿™ä¸ªçˆ¶èŠ‚ç‚¹ä¸‹æ•°æ®æˆ–è€…å­èŠ‚ç‚¹å˜åŒ–éƒ½ä¼šé€šçŸ¥åˆ°è¯¥èŠ‚ç‚¹è¿›è¡Œwatchçš„å®¢æˆ·ç«¯ã€‚ Leaderé€‰ä¸¾ï¼š åˆ©ç”¨ZooKeeperçš„å¼ºä¸€è‡´æ€§ï¼Œèƒ½å¤Ÿä¿è¯åœ¨åˆ†å¸ƒå¼é«˜å¹¶å‘æƒ…å†µä¸‹èŠ‚ç‚¹åˆ›å»ºçš„å…¨å±€å”¯ä¸€æ€§ï¼Œå³ï¼šåŒæ—¶æœ‰å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ›å»º /Master èŠ‚ç‚¹ï¼Œæœ€ç»ˆä¸€å®šåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚èƒ½å¤Ÿåˆ›å»ºæˆåŠŸã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå°±èƒ½å¾ˆè½»æ˜“çš„åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è¿›è¡Œé›†ç¾¤é€‰ä¸¾äº†ã€‚ å°±æ˜¯åŠ¨æ€Masteré€‰ä¸¾ã€‚è¿™å°±è¦ç”¨åˆ° EPHEMERAL_SEQUENTIALç±»å‹èŠ‚ç‚¹çš„ç‰¹æ€§äº†ï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹ä¼šè‡ªåŠ¨è¢«ç¼–å·ã€‚å…è®¸æ‰€æœ‰è¯·æ±‚éƒ½èƒ½å¤Ÿåˆ›å»ºæˆåŠŸï¼Œä½†æ˜¯å¾—æœ‰ä¸ªåˆ›å»ºé¡ºåºï¼Œæ¯æ¬¡é€‰å–åºåˆ—å·æœ€å°çš„é‚£ä¸ªæœºå™¨ä½œä¸ºMaster ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:2:6","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3. Choose Leader ZooKeeperé›†ç¾¤èŠ‚ç‚¹ä¸ªæ•°ä¸€å®šæ˜¯å¥‡æ•°ä¸ªï¼Œä¸€èˆ¬3ä¸ªæˆ–è€…5ä¸ªå°±OKã€‚ä¸ºé¿å…é›†ç¾¤ç¾¤é¾™æ— é¦–ï¼Œä¸€å®šè¦é€‰ä¸ªå¤§å“¥å‡ºæ¥å½“Leaderã€‚è¿™æ˜¯ä¸ªé«˜é¢‘è€ƒç‚¹ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:3:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3.1 é¢„å¤‡çŸ¥è¯† 3.1.1. èŠ‚ç‚¹å››ç§çŠ¶æ€ã€‚ LOOKINGï¼šå¯» æ‰¾ Leader çŠ¶æ€ã€‚å½“æœåŠ¡å™¨å¤„äºè¯¥çŠ¶æ€æ—¶ä¼šè®¤ä¸ºå½“å‰é›†ç¾¤ä¸­æ²¡æœ‰ Leaderï¼Œå› æ­¤éœ€è¦è¿›å…¥ Leader é€‰ä¸¾çŠ¶æ€ã€‚ FOLLOWINGï¼šè·Ÿéšè€…çŠ¶æ€ã€‚å¤„ç†å®¢æˆ·ç«¯çš„éäº‹åŠ¡è¯·æ±‚ï¼Œè½¬å‘äº‹åŠ¡è¯·æ±‚ç»™ Leader æœåŠ¡å™¨ï¼Œå‚ä¸äº‹åŠ¡è¯·æ±‚ Proposal(æè®®) çš„æŠ•ç¥¨ï¼Œå‚ä¸ Leader é€‰ä¸¾æŠ•ç¥¨ã€‚ LEADINGï¼šé¢†å¯¼è€…çŠ¶æ€ã€‚äº‹åŠ¡è¯·æ±‚çš„å”¯ä¸€è°ƒåº¦å’Œå¤„ç†è€…ï¼Œä¿è¯é›†ç¾¤äº‹åŠ¡å¤„ç†çš„é¡ºåºæ€§ï¼Œé›†ç¾¤å†…éƒ¨ä¸ªæœåŠ¡å™¨çš„è°ƒåº¦è€…(ç®¡ç†follower,æ•°æ®åŒæ­¥)ã€‚ OBSERVINGï¼šè§‚å¯Ÿè€…çŠ¶æ€ã€‚3.0 ç‰ˆæœ¬ä»¥åå¼•å…¥çš„ä¸€ä¸ªæœåŠ¡å™¨è§’è‰²ï¼Œåœ¨ä¸å½±å“é›†ç¾¤äº‹åŠ¡å¤„ç†èƒ½åŠ›çš„åŸºç¡€ä¸Šæå‡é›†ç¾¤çš„éäº‹åŠ¡å¤„ç†èƒ½åŠ›ï¼Œå¤„ç†å®¢æˆ·ç«¯çš„éäº‹åŠ¡è¯·æ±‚ï¼Œè½¬å‘äº‹åŠ¡è¯·æ±‚ç»™ Leader æœåŠ¡å™¨ï¼Œä¸å‚ä¸ä»»ä½•å½¢å¼çš„æŠ•ç¥¨ã€‚ 3.1.2 æœåŠ¡å™¨ID æ—¢Server idï¼Œä¸€èˆ¬åœ¨æ­å»ºZKé›†ç¾¤æ—¶ä¼šåœ¨myidæ–‡ä»¶ä¸­ç»™æ¯ä¸ªèŠ‚ç‚¹æä¸ªå”¯ä¸€ç¼–å·ï¼Œç¼–å·è¶Šå¤§åœ¨Leaderé€‰æ‹©ç®—æ³•ä¸­çš„æƒé‡è¶Šå¤§ï¼Œæ¯”å¦‚åˆå§‹åŒ–å¯åŠ¨æ—¶å°±æ˜¯æ ¹æ®æœåŠ¡å™¨IDè¿›è¡Œæ¯”è¾ƒã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:3:1","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3.1.3 ZXID ZooKeeper é‡‡ç”¨å…¨å±€é€’å¢çš„äº‹åŠ¡ Id æ¥æ ‡è¯†ï¼Œæ‰€æœ‰ proposal(æè®®)åœ¨è¢«æå‡ºçš„æ—¶å€™åŠ ä¸Šäº†ZooKeeper Transaction Id ï¼Œzxidæ˜¯64ä½çš„Longç±»å‹ï¼Œè¿™æ˜¯ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å…³é”®ã€‚zxidä¸­é«˜32ä½è¡¨ç¤ºçºªå…ƒepochï¼Œä½32ä½è¡¨ç¤ºäº‹åŠ¡æ ‡è¯†xidã€‚ä½ å¯ä»¥è®¤ä¸ºzxidè¶Šå¤§è¯´æ˜å­˜å‚¨æ•°æ®è¶Šæ–°ã€‚ æ¯ä¸ªleaderéƒ½ä¼šå…·æœ‰ä¸åŒçš„epochå€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªçºªå…ƒ/æœä»£ï¼Œç”¨æ¥æ ‡è¯† leader å‘¨æœŸã€‚æ¯ä¸ªæ–°çš„é€‰ä¸¾å¼€å¯æ—¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„epochï¼Œæ–°çš„leaderäº§ç”Ÿçš„è¯epochä¼šè‡ªå¢ï¼Œä¼šå°†è¯¥å€¼æ›´æ–°åˆ°æ‰€æœ‰çš„zkServerçš„zxidå’Œepochï¼Œ xidæ˜¯ä¸€ä¸ªä¾æ¬¡é€’å¢çš„äº‹åŠ¡ç¼–å·ã€‚æ•°å€¼è¶Šå¤§è¯´æ˜æ•°æ®è¶Šæ–°ï¼Œæ‰€æœ‰ proposalï¼ˆæè®®ï¼‰åœ¨è¢«æå‡ºçš„æ—¶å€™åŠ ä¸Šäº†zxidï¼Œç„¶åä¼šä¾æ®æ•°æ®åº“çš„ä¸¤é˜¶æ®µè¿‡ç¨‹ï¼Œé¦–å…ˆä¼šå‘å…¶ä»–çš„ server å‘å‡ºäº‹åŠ¡æ‰§è¡Œè¯·æ±‚ï¼Œå¦‚æœè¶…è¿‡åŠæ•°çš„æœºå™¨éƒ½èƒ½æ‰§è¡Œå¹¶ä¸”èƒ½å¤ŸæˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šå¼€å§‹æ‰§è¡Œã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:3:2","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3.2 Leaderé€‰ä¸¾ Leaderçš„é€‰ä¸¾ä¸€èˆ¬åˆ†ä¸ºå¯åŠ¨æ—¶é€‰ä¸¾è·ŸLeaderæŒ‚æ‰åçš„è¿è¡Œæ—¶é€‰ä¸¾ã€‚ 3.2.1 å¯åŠ¨æ—¶Leaderé€‰ä¸¾ æˆ‘ä»¬ä»¥5å°æœºå™¨ä¸ºä¾‹ï¼Œåªæœ‰è¶…è¿‡åŠæ•°ä»¥ä¸Šï¼Œå³æœ€å°‘å¯åŠ¨3å°æœåŠ¡å™¨ï¼Œé›†ç¾¤æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚ æœåŠ¡å™¨1å¯åŠ¨ï¼Œå‘èµ·ä¸€æ¬¡é€‰ä¸¾ã€‚ æœåŠ¡å™¨1æŠ•è‡ªå·±ä¸€ç¥¨ã€‚æ­¤æ—¶æœåŠ¡å™¨1ç¥¨æ•°ä¸€ç¥¨ï¼Œä¸å¤ŸåŠæ•°ä»¥ä¸Šï¼ˆ3ç¥¨ï¼‰ï¼Œé€‰ä¸¾æ— æ³•å®Œæˆï¼ŒæœåŠ¡å™¨1çŠ¶æ€ä¿æŒä¸ºLOOKINGã€‚ æœåŠ¡å™¨2å¯åŠ¨ï¼Œå†å‘èµ·ä¸€æ¬¡é€‰ä¸¾ã€‚ æœåŠ¡å™¨1å’Œ2åˆ†åˆ«æŠ•è‡ªå·±ä¸€ç¥¨ï¼Œæ­¤æ—¶æœåŠ¡å™¨1å‘ç°æœåŠ¡å™¨2çš„idæ¯”è‡ªå·±å¤§ï¼Œæ›´æ”¹é€‰ç¥¨æŠ•ç»™æœåŠ¡å™¨2ã€‚æ­¤æ—¶æœåŠ¡å™¨1ç¥¨æ•°0ç¥¨ï¼ŒæœåŠ¡å™¨2ç¥¨æ•°2ç¥¨ï¼Œä¸å¤ŸåŠæ•°ä»¥ä¸Šï¼ˆ3ç¥¨ï¼‰ï¼Œé€‰ä¸¾æ— æ³•å®Œæˆã€‚æœåŠ¡å™¨1ï¼Œ2çŠ¶æ€ä¿æŒLOOKINGã€‚ æœåŠ¡å™¨3å¯åŠ¨ï¼Œå‘èµ·ä¸€æ¬¡é€‰ä¸¾ã€‚ ä¸ä¸Šé¢è¿‡ç¨‹ä¸€æ ·ï¼ŒæœåŠ¡å™¨1å’Œ2å…ˆæŠ•è‡ªå·±ä¸€ç¥¨ï¼Œç„¶åå› ä¸ºæœåŠ¡å™¨3idæœ€å¤§ï¼Œä¸¤è€…æ›´æ”¹é€‰ç¥¨æŠ•ç»™ä¸ºæœåŠ¡å™¨3ã€‚æ­¤æ¬¡æŠ•ç¥¨ç»“æœï¼šæœåŠ¡å™¨1ä¸º0ç¥¨ï¼ŒæœåŠ¡å™¨2ä¸º0ç¥¨ï¼ŒæœåŠ¡å™¨3ä¸º3ç¥¨ã€‚æ­¤æ—¶æœåŠ¡å™¨3çš„ç¥¨æ•°å·²ç»è¶…è¿‡åŠæ•°ï¼ˆ3ç¥¨ï¼‰ï¼ŒæœåŠ¡å™¨3å½“é€‰Leaderã€‚æœåŠ¡å™¨1ï¼Œ2æ›´æ”¹çŠ¶æ€ä¸ºFOLLOWINGï¼ŒæœåŠ¡å™¨3æ›´æ”¹çŠ¶æ€ä¸ºLEADINGï¼› æœåŠ¡å™¨4å¯åŠ¨ï¼Œå‘èµ·ä¸€æ¬¡é€‰ä¸¾ã€‚ æ­¤æ—¶æœåŠ¡å™¨1ã€2ã€3å·²ç»ä¸æ˜¯LOOKINGçŠ¶æ€ï¼Œä¸ä¼šæ›´æ”¹é€‰ç¥¨ä¿¡æ¯ï¼Œäº¤æ¢é€‰ç¥¨ä¿¡æ¯ç»“æœã€‚æœåŠ¡å™¨3ä¸º3ç¥¨ï¼ŒæœåŠ¡å™¨4ä¸º1ç¥¨ã€‚æ­¤æ—¶æœåŠ¡å™¨4æœä»å¤šæ•°ï¼Œæ›´æ”¹é€‰ç¥¨ä¿¡æ¯ä¸ºæœåŠ¡å™¨3ï¼ŒæœåŠ¡å™¨4å¹¶æ›´æ”¹çŠ¶æ€ä¸ºFOLLOWINGã€‚ æœåŠ¡å™¨5å¯åŠ¨ï¼Œå‘èµ·ä¸€æ¬¡é€‰ä¸¾ åŒ4ä¸€æ ·æŠ•ç¥¨ç»™3ï¼Œæ­¤æ—¶æœåŠ¡å™¨3ä¸€å…±5ç¥¨ï¼ŒæœåŠ¡å™¨5ä¸º0ç¥¨ã€‚æœåŠ¡å™¨5å¹¶æ›´æ”¹çŠ¶æ€ä¸ºFOLLOWINGï¼› æœ€ç»ˆ Leaderæ˜¯æœåŠ¡å™¨3ï¼ŒçŠ¶æ€ä¸ºLEADINGã€‚å…¶ä½™æœåŠ¡å™¨æ˜¯Followerï¼ŒçŠ¶æ€ä¸ºFOLLOWINGã€‚ 3.2.2 è¿è¡Œæ—¶Leaderé€‰ä¸¾ è¿è¡Œæ—¶å€™å¦‚æœMasterèŠ‚ç‚¹å´©æºƒäº†ä¼šèµ°æ¢å¤æ¨¡å¼ï¼Œæ–°Leaderé€‰å‡ºå‰ä¼šæš‚åœå¯¹å¤–æœåŠ¡ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µ é€‰ä¸¾ã€å‘ç°ã€åŒæ­¥ã€å¹¿æ’­ã€‚ chooseLeader æ¯ä¸ªServerä¼šå‘å‡ºä¸€ä¸ªæŠ•ç¥¨ï¼Œç¬¬ä¸€æ¬¡éƒ½æ˜¯æŠ•è‡ªå·±ï¼Œå…¶ä¸­æŠ•ç¥¨ä¿¡æ¯ = (myidï¼ŒZXID) æ”¶é›†æ¥è‡ªå„ä¸ªæœåŠ¡å™¨çš„æŠ•ç¥¨ å¤„ç†æŠ•ç¥¨å¹¶é‡æ–°æŠ•ç¥¨ï¼Œå¤„ç†é€»è¾‘ï¼šä¼˜å…ˆæ¯”è¾ƒZXIDï¼Œç„¶åæ¯”è¾ƒmyidã€‚ ç»Ÿè®¡æŠ•ç¥¨ï¼Œåªè¦è¶…è¿‡åŠæ•°çš„æœºå™¨æ¥æ”¶åˆ°åŒæ ·çš„æŠ•ç¥¨ä¿¡æ¯ï¼Œå°±å¯ä»¥ç¡®å®šleaderï¼Œæ³¨æ„epochçš„å¢åŠ è·ŸåŒæ­¥ã€‚ æ”¹å˜æœåŠ¡å™¨çŠ¶æ€Lookingå˜ä¸ºFollowingæˆ–Leadingã€‚ å½“ Follower é“¾æ¥ä¸Š Leader ä¹‹åï¼ŒLeader æœåŠ¡å™¨ä¼šæ ¹æ®è‡ªå·±æœåŠ¡å™¨ä¸Šæœ€åè¢«æäº¤çš„ ZXID å’Œ Follower ä¸Šçš„ ZXID è¿›è¡Œæ¯”å¯¹ï¼Œæ¯”å¯¹ç»“æœè¦ä¹ˆå›æ»šï¼Œè¦ä¹ˆå’Œ Leader åŒæ­¥ï¼Œä¿è¯é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡ä¸€è‡´ã€‚ é›†ç¾¤æ¢å¤åˆ°å¹¿æ’­æ¨¡å¼ï¼Œå¼€å§‹æ¥å—å®¢æˆ·ç«¯çš„å†™è¯·æ±‚ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:3:3","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"3.3 è„‘è£‚ è„‘è£‚é—®é¢˜æ˜¯é›†ç¾¤éƒ¨ç½²å¿…é¡»è€ƒè™‘çš„ä¸€ç‚¹ï¼Œæ¯”å¦‚åœ¨Hadoopè·ŸSparké›†ç¾¤ä¸­ã€‚è€ŒZABä¸ºè§£å†³è„‘è£‚é—®é¢˜ï¼Œè¦æ±‚é›†ç¾¤å†…çš„èŠ‚ç‚¹æ•°é‡ä¸º2N+1ã€‚å½“ç½‘ç»œåˆ†è£‚åï¼Œå§‹ç»ˆæœ‰ä¸€ä¸ªé›†ç¾¤çš„èŠ‚ç‚¹æ•°é‡è¿‡åŠæ•°ï¼Œè€Œå¦ä¸€ä¸ªèŠ‚ç‚¹æ•°é‡å°äºN+1, å› ä¸ºé€‰ä¸¾Leaderéœ€è¦è¿‡åŠæ•°çš„èŠ‚ç‚¹åŒæ„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š æœ‰äº†è¿‡åŠæœºåˆ¶ï¼Œå¯¹äºä¸€ä¸ªZookeeperé›†ç¾¤ï¼Œè¦ä¹ˆæ²¡æœ‰Leaderï¼Œè¦æ²¡åªæœ‰1ä¸ªLeaderï¼Œè¿™æ ·å°±é¿å…äº†è„‘è£‚é—®é¢˜ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:3:4","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4. ZAB of Consistence å»ºè®®å…ˆçœ‹ä¸‹ æµ…è°ˆå¤§æ•°æ®ä¸­çš„2PCã€3PCã€Paxosã€Raftã€ZAB ï¼Œä¸ç„¶å¯èƒ½çœ‹çš„åƒåŠ›ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4.1 ZAB åè®®ä»‹ç» ZAB (Zookeeper Atomic Broadcast åŸå­å¹¿æ’­åè®®) åè®®æ˜¯ä¸ºåˆ†å¸ƒå¼åè°ƒæœåŠ¡ZooKeeperä¸“é—¨è®¾è®¡çš„ä¸€ç§æ”¯æŒå´©æºƒæ¢å¤çš„ä¸€è‡´æ€§åè®®ã€‚åŸºäºè¯¥åè®®ï¼ŒZooKeeper å®ç°äº†ä¸€ç§ä¸»ä»æ¨¡å¼çš„ç³»ç»Ÿæ¶æ„æ¥ä¿æŒé›†ç¾¤ä¸­å„ä¸ªå‰¯æœ¬ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ã€‚ åˆ†å¸ƒå¼ç³»ç»Ÿä¸­leaderè´Ÿè´£å¤–éƒ¨å®¢æˆ·ç«¯çš„å†™è¯·æ±‚ã€‚followeræœåŠ¡å™¨è´Ÿè´£è¯»è·ŸåŒæ­¥ã€‚è¿™æ—¶éœ€è¦è§£å†³ä¿©é—®é¢˜ã€‚ Leader æœåŠ¡å™¨æ˜¯å¦‚ä½•æŠŠæ•°æ®æ›´æ–°åˆ°æ‰€æœ‰çš„Followerçš„ã€‚ Leader æœåŠ¡å™¨çªç„¶é—´å¤±æ•ˆäº†ï¼Œé›†ç¾¤å’‹åŠï¼Ÿ å› æ­¤ZABåè®®ä¸ºäº†è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜è€Œè®¾è®¡äº†ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼Œæ•´ä¸ª Zookeeper å°±æ˜¯åœ¨è¿™ä¸¤ä¸ªæ¨¡å¼ä¹‹é—´åˆ‡æ¢ï¼š åŸå­å¹¿æ’­æ¨¡å¼ï¼šæŠŠæ•°æ®æ›´æ–°åˆ°æ‰€æœ‰çš„followerã€‚ å´©æºƒæ¢å¤æ¨¡å¼ï¼šLeaderå‘ç”Ÿå´©æºƒæ—¶ï¼Œå¦‚ä½•æ¢å¤ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:1","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4.2 åŸå­å¹¿æ’­æ¨¡å¼ ä½ å¯ä»¥è®¤ä¸ºæ¶ˆæ¯å¹¿æ’­æœºåˆ¶æ˜¯ç®€åŒ–ç‰ˆçš„ 2PCåè®®ï¼Œå°±æ˜¯é€šè¿‡å¦‚ä¸‹çš„æœºåˆ¶ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„ã€‚ leaderä»å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªå†™è¯·æ±‚åç”Ÿæˆä¸€ä¸ªæ–°çš„äº‹åŠ¡å¹¶ä¸ºè¿™ä¸ªäº‹åŠ¡ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ZXIDï¼Œ leaderå°†å°†å¸¦æœ‰ zxid çš„æ¶ˆæ¯ä½œä¸ºä¸€ä¸ªææ¡ˆ(proposal)åˆ†å‘ç»™æ‰€æœ‰ FIFOé˜Ÿåˆ—ã€‚ FIFOé˜Ÿåˆ—å–å‡ºé˜Ÿå¤´proposalç»™followerèŠ‚ç‚¹ã€‚ å½“ follower æ¥æ”¶åˆ° proposalï¼Œå…ˆå°† proposal å†™åˆ°ç¡¬ç›˜ï¼Œå†™ç¡¬ç›˜æˆåŠŸåå†å‘ leader å›ä¸€ä¸ª ACKã€‚ FIFOé˜Ÿåˆ—æŠŠACKè¿”å›ç»™Leaderã€‚ å½“leaderæ”¶åˆ°è¶…è¿‡ä¸€åŠä»¥ä¸Šçš„followerçš„ackæ¶ˆæ¯ï¼Œleaderä¼šè¿›è¡Œcommitè¯·æ±‚ï¼Œç„¶åå†ç»™FIFOå‘é€commitè¯·æ±‚ã€‚ å½“followeræ”¶åˆ°commitè¯·æ±‚æ—¶ï¼Œä¼šåˆ¤æ–­è¯¥äº‹åŠ¡çš„ZXIDæ˜¯ä¸æ˜¯æ¯”å†å²é˜Ÿåˆ—ä¸­çš„ä»»ä½•äº‹åŠ¡çš„ZXIDéƒ½å°ï¼Œå¦‚æœæ˜¯åˆ™æäº¤ï¼Œå¦‚æœä¸æ˜¯åˆ™ç­‰å¾…æ¯”å®ƒæ›´å°çš„äº‹åŠ¡çš„commit(ä¿è¯é¡ºåºæ€§) ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:2","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4.3 å´©æºƒæ¢å¤ æ¶ˆæ¯å¹¿æ’­è¿‡ç¨‹ä¸­ï¼ŒLeader å´©æºƒäº†è¿˜èƒ½ä¿è¯æ•°æ®ä¸€è‡´å—ï¼Ÿå½“ Leader å´©æºƒä¼šè¿›å…¥å´©æºƒæ¢å¤æ¨¡å¼ã€‚å…¶å®ä¸»è¦æ˜¯å¯¹å¦‚ä¸‹ä¸¤ç§æƒ…å†µçš„å¤„ç†ã€‚ Leader åœ¨å¤åˆ¶æ•°æ®ç»™æ‰€æœ‰ Follwer ä¹‹åå´©æºƒï¼Œå’‹æï¼Ÿ Leader åœ¨æ”¶åˆ° Ack å¹¶æäº¤äº†è‡ªå·±ï¼ŒåŒæ—¶å‘é€äº†éƒ¨åˆ† commit å‡ºå»ä¹‹åå´©æºƒå’‹åŠï¼Ÿ é’ˆå¯¹æ­¤é—®é¢˜ï¼ŒZAB å®šä¹‰äº† 2 ä¸ªåŸåˆ™ï¼š ZAB åè®®ç¡®ä¿æ‰§è¡Œé‚£äº›å·²ç»åœ¨ Leader æäº¤çš„äº‹åŠ¡æœ€ç»ˆä¼šè¢«æ‰€æœ‰æœåŠ¡å™¨æäº¤ã€‚ ZAB åè®®ç¡®ä¿ä¸¢å¼ƒé‚£äº›åªåœ¨ Leader æå‡º/å¤åˆ¶ï¼Œä½†æ²¡æœ‰æäº¤çš„äº‹åŠ¡ã€‚ è‡³äºå¦‚ä½•å®ç°ç¡®ä¿æäº¤å·²ç»è¢« Leader æäº¤çš„äº‹åŠ¡ï¼ŒåŒæ—¶ä¸¢å¼ƒå·²ç»è¢«è·³è¿‡çš„äº‹åŠ¡å‘¢ï¼Ÿå…³é”®ç‚¹å°±æ˜¯ä¾èµ–ä¸Šé¢è¯´åˆ°è¿‡çš„ ZXIDäº†ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:3","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4.4 ZAB ç‰¹æ€§ ä¸€è‡´æ€§ä¿è¯ å¯é æäº¤(Reliable delivery) ï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡ A è¢«ä¸€ä¸ªserveræäº¤(committed)äº†ï¼Œé‚£ä¹ˆå®ƒæœ€ç»ˆä¸€å®šä¼šè¢«æ‰€æœ‰çš„serveræäº¤ å…¨å±€æœ‰åº(Total order) å‡è®¾æœ‰Aã€Bä¸¤ä¸ªäº‹åŠ¡ï¼Œæœ‰ä¸€å°serverå…ˆæ‰§è¡ŒAå†æ‰§è¡ŒBï¼Œé‚£ä¹ˆå¯ä»¥ä¿è¯æ‰€æœ‰serverä¸ŠAå§‹ç»ˆéƒ½è¢«åœ¨Bä¹‹å‰æ‰§è¡Œ å› æœæœ‰åº(Causal order) å¦‚æœå‘é€è€…åœ¨äº‹åŠ¡Aæäº¤ä¹‹åå†å‘é€B,é‚£ä¹ˆBå¿…å°†åœ¨Aä¹‹åæ‰§è¡Œ é«˜å¯ç”¨æ€§ åªè¦å¤§å¤šæ•°ï¼ˆæ³•å®šæ•°é‡ï¼‰èŠ‚ç‚¹å¯åŠ¨ï¼Œç³»ç»Ÿå°±è¡Œæ­£å¸¸è¿è¡Œ å¯æ¢å¤æ€§ å½“èŠ‚ç‚¹ä¸‹çº¿åé‡å¯ï¼Œå®ƒå¿…é¡»ä¿è¯èƒ½æ¢å¤åˆ°å½“å‰æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:4","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"4.5 ZAB å’Œ Paxos å¯¹æ¯” ç›¸åŒç‚¹ï¼š ä¸¤è€…éƒ½å­˜åœ¨ä¸€ä¸ªç±»ä¼¼äº Leader è¿›ç¨‹çš„è§’è‰²ï¼Œç”±å…¶è´Ÿè´£åè°ƒå¤šä¸ª Follower è¿›ç¨‹çš„è¿è¡Œ. Leader è¿›ç¨‹éƒ½ä¼šç­‰å¾…è¶…è¿‡åŠæ•°çš„ Follower åšå‡ºæ­£ç¡®çš„åé¦ˆåï¼Œæ‰ä¼šå°†ä¸€ä¸ªææ¡ˆè¿›è¡Œæäº¤. ZAB åè®®ä¸­ï¼Œæ¯ä¸ª Proposal ä¸­éƒ½åŒ…å«ä¸€ä¸ª epoch å€¼æ¥ä»£è¡¨å½“å‰çš„ Leaderå‘¨æœŸï¼ŒPaxos ä¸­åå­—ä¸º Ballot ä¸åŒç‚¹ï¼š ZAB ç”¨æ¥æ„å»ºé«˜å¯ç”¨çš„åˆ†å¸ƒå¼æ•°æ®ä¸»å¤‡ç³»ç»Ÿï¼ˆZookeeperï¼‰ï¼ŒPaxos æ˜¯ç”¨æ¥æ„å»ºåˆ†å¸ƒå¼ä¸€è‡´æ€§çŠ¶æ€æœºç³»ç»Ÿã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:4:5","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5. ZooKeeper é›¶æ•£çŸ¥è¯† ","date":"2020-05-19","objectID":"/20200519_zookeeper/:5:0","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5.1 å¸¸è§æŒ‡ä»¤ Zookeeper æœ‰ä¸‰ç§éƒ¨ç½²æ¨¡å¼ï¼š å•æœºéƒ¨ç½²ï¼šä¸€å°æœºå™¨ä¸Šè¿è¡Œã€‚ é›†ç¾¤éƒ¨ç½²ï¼šå¤šå°æœºå™¨è¿è¡Œã€‚ ä¼ªé›†ç¾¤éƒ¨ç½²ï¼šä¸€å°æœºå™¨å¯åŠ¨å¤šä¸ª Zookeeper å®ä¾‹è¿è¡Œã€‚ éƒ¨ç½²å®Œæ¯•åå¸¸è§æŒ‡ä»¤å¦‚ä¸‹ï¼š å‘½ä»¤åŸºæœ¬è¯­æ³• åŠŸèƒ½æè¿° help æ˜¾ç¤ºæ‰€æœ‰æ“ä½œå‘½ä»¤ ls path [watch] æ˜¾ç¤ºæ‰€æœ‰æ“ä½œå‘½ä»¤ ls path [watch] æŸ¥çœ‹å½“å‰èŠ‚ç‚¹æ•°æ®å¹¶èƒ½çœ‹åˆ°æ›´æ–°æ¬¡æ•°ç­‰æ•°æ® create æ™®é€šåˆ›å»ºï¼Œ -s å«æœ‰åºåˆ—ï¼Œ -e ä¸´æ—¶ï¼ˆé‡å¯æˆ–è€…è¶…æ—¶æ¶ˆå¤±ï¼‰ get path [watch] è·å¾—èŠ‚ç‚¹çš„å€¼ set è®¾ç½®èŠ‚ç‚¹çš„å…·ä½“å€¼ stat æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ delete åˆ é™¤èŠ‚ç‚¹ rmr é€’å½’åˆ é™¤èŠ‚ç‚¹ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:5:1","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5.2 Zookeeperå®¢æˆ·ç«¯ 5.2.1. ZookeeperåŸç”Ÿå®¢æˆ·ç«¯ Zookeeperå®¢æˆ·ç«¯æ˜¯å¼‚æ­¥çš„å“¦ï¼éœ€è¦å¼•å…¥CountDownLatch æ¥ç¡®ä¿è¿æ¥å¥½äº†å†åšä¸‹é¢æ“ä½œã€‚ZookeeperåŸç”Ÿapiæ˜¯ä¸æ”¯æŒè¿­ä»£å¼çš„åˆ›å»ºè·Ÿåˆ é™¤è·¯å¾„çš„ï¼Œå…·æœ‰å¦‚ä¸‹å¼Šç«¯ã€‚ ä¼šè¯çš„è¿æ¥æ˜¯å¼‚æ­¥çš„ï¼›å¿…é¡»ç”¨åˆ°å›è°ƒå‡½æ•° ã€‚ Watchéœ€è¦é‡å¤æ³¨å†Œï¼šçœ‹ä¸€æ¬¡watchæ³¨å†Œä¸€æ¬¡ ã€‚ Sessioné‡è¿æœºåˆ¶ï¼šæœ‰æ—¶sessionæ–­å¼€è¿˜éœ€è¦é‡è¿æ¥ã€‚ å¼€å‘å¤æ‚æ€§è¾ƒé«˜ï¼šå¼€å‘ç›¸å¯¹æ¥è¯´æ¯”è¾ƒçç¢ã€‚ 5.2.2. ZkClient å¼€æºçš„zkå®¢æˆ·ç«¯ï¼Œåœ¨åŸç”ŸAPIåŸºç¡€ä¸Šå°è£…ï¼Œæ˜¯ä¸€ä¸ªæ›´æ˜“äºä½¿ç”¨çš„zookeeperå®¢æˆ·ç«¯ï¼Œåšäº†å¦‚ä¸‹ä¼˜åŒ–ã€‚ ä¼˜åŒ–ä¸€ ã€åœ¨session losså’Œsession expireæ—¶è‡ªåŠ¨åˆ›å»ºæ–°çš„ZooKeeperå®ä¾‹è¿›è¡Œé‡è¿ã€‚ä¼˜åŒ–äºŒã€ å°†ä¸€æ¬¡æ€§watcheråŒ…è£…ä¸ºæŒä¹…watcherã€‚ 5.2.3. Curator å¼€æºçš„zkå®¢æˆ·ç«¯ï¼Œåœ¨åŸç”ŸAPIåŸºç¡€ä¸Šå°è£…ï¼Œapacheé¡¶çº§é¡¹ç›®ã€‚æ˜¯Netflixå…¬å¸å¼€æºçš„ä¸€å¥—Zookeeperå®¢æˆ·ç«¯æ¡†æ¶ã€‚äº†è§£è¿‡ZookeeperåŸç”ŸAPIéƒ½ä¼šæ¸…æ¥šå…¶å¤æ‚åº¦ã€‚Curatorå¸®åŠ©æˆ‘ä»¬åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œå°è£…ã€å®ç°ä¸€äº›å¼€å‘ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ¥è¿é‡è¿ã€åå¤æ³¨å†ŒWatcherå’ŒNodeExistsExceptionç­‰ã€‚ç›®å‰å·²ç»ä½œä¸ºApacheçš„é¡¶çº§é¡¹ç›®å‡ºç°ï¼Œæ˜¯æœ€æµè¡Œçš„Zookeeperå®¢æˆ·ç«¯ä¹‹ä¸€ã€‚ 5.2.4. Zookeeperå›¾å½¢åŒ–å®¢æˆ·ç«¯å·¥å…· ZooInspectorå·¥å…· ","date":"2020-05-19","objectID":"/20200519_zookeeper/:5:2","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5.3 ACL æƒé™æ§åˆ¶æœºåˆ¶ ACLå…¨ç§°ä¸ºAccess Control List å³è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼Œç”¨äºæ§åˆ¶èµ„æºçš„è®¿é—®æƒé™ã€‚zookeeperåˆ©ç”¨ACLç­–ç•¥æ§åˆ¶èŠ‚ç‚¹çš„è®¿é—®æƒé™ï¼Œå¦‚èŠ‚ç‚¹æ•°æ®è¯»å†™ã€èŠ‚ç‚¹åˆ›å»ºã€èŠ‚ç‚¹åˆ é™¤ã€è¯»å–å­èŠ‚ç‚¹åˆ—è¡¨ã€è®¾ç½®èŠ‚ç‚¹æƒé™ç­‰ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:5:3","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"5.4 Zookeeperä½¿ç”¨æ³¨æ„äº‹é¡¹ é›†ç¾¤ä¸­æœºå™¨çš„æ•°é‡å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œä¸€ä¸ªå†™æ“ä½œéœ€è¦åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹ackï¼Œæ‰€ä»¥é›†ç¾¤èŠ‚ç‚¹æ•°è¶Šå¤šï¼Œæ•´ä¸ªé›†ç¾¤å¯ä»¥æŠ—æŒ‚ç‚¹çš„èŠ‚ç‚¹æ•°è¶Šå¤š(è¶Šå¯é )ï¼Œä½†æ˜¯ååé‡è¶Šå·®ã€‚é›†ç¾¤çš„æ•°é‡å¿…é¡»ä¸ºå¥‡æ•°ã€‚ zkæ˜¯åŸºäºå†…å­˜è¿›è¡Œè¯»å†™æ“ä½œçš„ï¼Œæœ‰æ—¶å€™ä¼šè¿›è¡Œæ¶ˆæ¯å¹¿æ’­ï¼Œå› æ­¤ä¸å»ºè®®åœ¨èŠ‚ç‚¹å­˜å–å®¹é‡æ¯”è¾ƒå¤§çš„æ•°æ®ã€‚ dataDirç›®å½•ã€dataLogDirä¸¤ä¸ªç›®å½•ä¼šéšç€æ—¶é—´æ¨ç§»å˜å¾—åºå¤§ï¼Œå®¹æ˜“é€ æˆç¡¬ç›˜æ»¡äº†ã€‚å»ºè®®è‡ªå·±ç¼–å†™æˆ–ä½¿ç”¨è‡ªå¸¦çš„è„šæœ¬ä¿ç•™æœ€æ–°çš„nä¸ªæ–‡ä»¶ã€‚ é»˜è®¤æœ€å¤§è¿æ¥æ•° é»˜è®¤ä¸º60ï¼Œé…ç½®maxClientCnxnså‚æ•°ï¼Œé…ç½®å•ä¸ªå®¢æˆ·ç«¯æœºå™¨åˆ›å»ºçš„æœ€å¤§è¿æ¥æ•°ã€‚ ","date":"2020-05-19","objectID":"/20200519_zookeeper/:5:4","tags":["Zookeeper","Distribution"],"title":"Key points of ZooKeeper","uri":"/20200519_zookeeper/"},{"categories":["Technology"],"content":"Article description.","date":"2020-04-27","objectID":"/20200427_kafka/","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"Apache Kafka aims to provide a unified, high-throughput, low-latency platform for handling real-time data feeds. Kafka can connect to external systems (for data import/export) via Kafka Connect and provides Kafka Streams, a Java stream processing library. Kafka uses a binary TCP-based protocol that is optimized for efficiency and relies on a â€œmessage setâ€ abstraction that naturally groups messages together to reduce the overhead of the network roundtrip. This â€œleads to larger network packets, larger sequential disk operations, contiguous memory blocks [â€¦] which allows Kafka to turn a bursty stream of random message writes into linear writes.â€ ","date":"2020-04-27","objectID":"/20200427_kafka/:0:0","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"Message queue ","date":"2020-04-27","objectID":"/20200427_kafka/:1:0","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"1. Why ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ ä»ç³»ç»Ÿä¹‹é—´æœ‰é€šä¿¡éœ€æ±‚å¼€å§‹ï¼Œå°±è‡ªç„¶äº§ç”Ÿäº†æ¶ˆæ¯é˜Ÿåˆ—ã€‚ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆè‹±è¯­ï¼šMessage queueï¼‰æ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æˆ–åŒä¸€è¿›ç¨‹çš„ä¸åŒçº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ï¼Œè½¯ä»¶çš„è´®åˆ—ç”¨æ¥å¤„ç†ä¸€ç³»åˆ—çš„è¾“å…¥ï¼Œé€šå¸¸æ˜¯æ¥è‡ªç”¨æˆ·ã€‚æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å¼‚æ­¥çš„é€šä¿¡åè®®ï¼Œæ¯ä¸€ä¸ªè´®åˆ—ä¸­çš„çºªå½•åŒ…å«è¯¦ç»†è¯´æ˜çš„èµ„æ–™ï¼ŒåŒ…å«å‘ç”Ÿçš„æ—¶é—´ï¼Œè¾“å…¥è®¾å¤‡çš„ç§ç±»ï¼Œä»¥åŠç‰¹å®šçš„è¾“å…¥å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šæ¶ˆæ¯çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¸éœ€è¦åŒæ—¶ä¸æ¶ˆæ¯é˜Ÿåˆ—äº¤äº’ã€‚æ¶ˆæ¯ä¼šä¿å­˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°æ¥æ”¶è€…å–å›å®ƒã€‚ ","date":"2020-04-27","objectID":"/20200427_kafka/:1:1","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"2. Feature è§£è€¦ï¼š å…è®¸ä½ ç‹¬ç«‹çš„æ‰©å±•æˆ–ä¿®æ”¹ä¸¤è¾¹çš„å¤„ç†è¿‡ç¨‹ï¼Œåªè¦ç¡®ä¿å®ƒä»¬éµå®ˆåŒæ ·çš„æ¥å£çº¦æŸã€‚ å†—ä½™ï¼š æ¶ˆæ¯é˜Ÿåˆ—æŠŠæ•°æ®è¿›è¡ŒæŒä¹…åŒ–ç›´åˆ°å®ƒä»¬å·²ç»è¢«å®Œå…¨å¤„ç†ï¼Œé€šè¿‡è¿™ä¸€æ–¹å¼è§„é¿äº†æ•°æ®ä¸¢å¤±é£é™©ã€‚è®¸å¤šæ¶ˆæ¯é˜Ÿåˆ—æ‰€é‡‡ç”¨çš„â€æ’å…¥-è·å–-åˆ é™¤â€èŒƒå¼ä¸­ï¼Œåœ¨æŠŠä¸€ä¸ªæ¶ˆæ¯ä»é˜Ÿåˆ—ä¸­åˆ é™¤ä¹‹å‰ï¼Œéœ€è¦ä½ çš„å¤„ç†ç³»ç»Ÿæ˜ç¡®çš„æŒ‡å‡ºè¯¥æ¶ˆæ¯å·²ç»è¢«å¤„ç†å®Œæ¯•ï¼Œä»è€Œç¡®ä¿ä½ çš„æ•°æ®è¢«å®‰å…¨çš„ä¿å­˜ç›´åˆ°ä½ ä½¿ç”¨å®Œæ¯•ã€‚ æ‰©å±•æ€§ï¼š å› ä¸ºæ¶ˆæ¯é˜Ÿåˆ—è§£è€¦äº†ä½ çš„å¤„ç†è¿‡ç¨‹ï¼Œæ‰€ä»¥å¢å¤§æ¶ˆæ¯å…¥é˜Ÿå’Œå¤„ç†çš„é¢‘ç‡æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œåªè¦å¦å¤–å¢åŠ å¤„ç†è¿‡ç¨‹å³å¯ã€‚ çµæ´»æ€§ \u0026 å³°å€¼å¤„ç†èƒ½åŠ›ï¼š åœ¨è®¿é—®é‡å‰§å¢çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨ä»ç„¶éœ€è¦ç»§ç»­å‘æŒ¥ä½œç”¨ï¼Œä½†æ˜¯è¿™æ ·çš„çªå‘æµé‡å¹¶ä¸å¸¸è§ã€‚å¦‚æœä¸ºä»¥èƒ½å¤„ç†è¿™ç±»å³°å€¼è®¿é—®ä¸ºæ ‡å‡†æ¥æŠ•å…¥èµ„æºéšæ—¶å¾…å‘½æ— ç–‘æ˜¯å·¨å¤§çš„æµªè´¹ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—èƒ½å¤Ÿä½¿å…³é”®ç»„ä»¶é¡¶ä½çªå‘çš„è®¿é—®å‹åŠ›ï¼Œè€Œä¸ä¼šå› ä¸ºçªå‘çš„è¶…è´Ÿè·çš„è¯·æ±‚è€Œå®Œå…¨å´©æºƒã€‚ å¯æ¢å¤æ€§ï¼š ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ç»„ä»¶å¤±æ•ˆæ—¶ï¼Œä¸ä¼šå½±å“åˆ°æ•´ä¸ªç³»ç»Ÿã€‚æ¶ˆæ¯é˜Ÿåˆ—é™ä½äº†è¿›ç¨‹é—´çš„è€¦åˆåº¦ï¼Œæ‰€ä»¥å³ä½¿ä¸€ä¸ªå¤„ç†æ¶ˆæ¯çš„è¿›ç¨‹æŒ‚æ‰ï¼ŒåŠ å…¥é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä»ç„¶å¯ä»¥åœ¨ç³»ç»Ÿæ¢å¤åè¢«å¤„ç†ã€‚ é¡ºåºä¿è¯ï¼š åœ¨å¤§å¤šä½¿ç”¨åœºæ™¯ä¸‹ï¼Œæ•°æ®å¤„ç†çš„é¡ºåºéƒ½å¾ˆé‡è¦ã€‚å¤§éƒ¨åˆ†æ¶ˆæ¯é˜Ÿåˆ—æœ¬æ¥å°±æ˜¯æ’åºçš„ï¼Œå¹¶ä¸”èƒ½ä¿è¯æ•°æ®ä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºæ¥å¤„ç†ã€‚ï¼ˆKafka ä¿è¯ä¸€ä¸ª Partition å†…çš„æ¶ˆæ¯çš„æœ‰åºæ€§ï¼‰ ç¼“å†²ï¼š æœ‰åŠ©äºæ§åˆ¶å’Œä¼˜åŒ–æ•°æ®æµç»è¿‡ç³»ç»Ÿçš„é€Ÿåº¦ï¼Œè§£å†³ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯çš„å¤„ç†é€Ÿåº¦ä¸ä¸€è‡´çš„æƒ…å†µã€‚ å¼‚æ­¥é€šä¿¡ï¼š å¾ˆå¤šæ—¶å€™ï¼Œç”¨æˆ·ä¸æƒ³ä¹Ÿä¸éœ€è¦ç«‹å³å¤„ç†æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å¼‚æ­¥å¤„ç†æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·æŠŠä¸€ä¸ªæ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—ï¼Œä½†å¹¶ä¸ç«‹å³å¤„ç†å®ƒã€‚æƒ³å‘é˜Ÿåˆ—ä¸­æ”¾å…¥å¤šå°‘æ¶ˆæ¯å°±æ”¾å¤šå°‘ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™å†å»å¤„ç†å®ƒä»¬ã€‚ ","date":"2020-04-27","objectID":"/20200427_kafka/:1:2","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"3. Usage æœåŠ¡è§£è€¦ï¼š ä¸‹æ¸¸ç³»ç»Ÿå¯èƒ½åªéœ€è¦å½“å‰ç³»ç»Ÿçš„ä¸€ä¸ªå­é›†ï¼Œåº”å¯¹ä¸æ–­å¢åŠ å˜åŒ–çš„ä¸‹æ¸¸ç³»ç»Ÿï¼Œå½“å‰ç³»ç»Ÿä¸åœåœ°ä¿®æ”¹è°ƒè¯•ä¸è¿™äº›ä¸‹æ¸¸ç³»ç»Ÿçš„æ¥å£ï¼Œç³»ç»Ÿé—´è€¦åˆè¿‡äºç´§å¯†ã€‚å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åï¼Œå½“å‰ç³»ç»Ÿå˜åŒ–æ—¶å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸€ä¸ªä¸»é¢˜ä¸­ï¼Œæ‰€æœ‰ä¸‹æ¸¸ç³»ç»Ÿéƒ½è®¢é˜…ä¸»é¢˜ï¼Œè¿™æ ·æ¯ä¸ªä¸‹æ¸¸ç³»ç»Ÿéƒ½å¯ä»¥è·å¾—ä¸€ä»½å®æ—¶å®Œæ•´çš„è®¢å•æ•°æ®ã€‚ å¼‚æ­¥å¤„ç†ï¼š ä»¥ç§’æ€ä¸ºä¾‹ï¼šé£é™©æ§åˆ¶-\u003eåº“å­˜é”å®š-\u003eç”Ÿæˆè®¢å•-\u003eçŸ­ä¿¡é€šçŸ¥-\u003eæ›´æ–°ç»Ÿè®¡æ•°æ® é™æµå‰Šå³°/æµé‡æ§åˆ¶ ä¸€ä¸ªè®¾è®¡å¥å£®çš„ç¨‹åºæœ‰è‡ªæˆ‘ä¿æŠ¤çš„èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒåº”è¯¥å¯ä»¥åœ¨æµ·é‡çš„è¯·æ±‚ä¸‹ï¼Œè¿˜èƒ½åœ¨è‡ªèº«èƒ½åŠ›èŒƒå›´å†…å°½å¯èƒ½å¤šåœ°å¤„ç†è¯·æ±‚ï¼Œæ‹’ç»å¤„ç†ä¸äº†çš„è¯·æ±‚å¹¶ä¸”ä¿è¯è‡ªèº«è¿è¡Œæ­£å¸¸ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—éš”ç¦»ç½‘å…³å’Œåç«¯æœåŠ¡ï¼Œä»¥è¾¾åˆ°æµé‡æ§åˆ¶å’Œä¿æŠ¤åç«¯æœåŠ¡çš„ç›®çš„ã€‚ ","date":"2020-04-27","objectID":"/20200427_kafka/:1:3","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"4. Realize ç‚¹å¯¹ç‚¹ï¼š ç³»ç»Ÿ A å‘é€çš„æ¶ˆæ¯åªèƒ½è¢«ç³»ç»Ÿ B æ¥æ”¶ï¼Œå…¶ä»–ä»»ä½•ç³»ç»Ÿéƒ½ä¸èƒ½è¯»å– A å‘é€çš„æ¶ˆæ¯ã€‚ æ—¥å¸¸ç”Ÿæ´»çš„ä¾‹å­æ¯”å¦‚ç”µè¯å®¢æœå°±å±äºè¿™ç§æ¨¡å‹ï¼š åŒä¸€ä¸ªå®¢æˆ·å‘¼å…¥ç”µè¯åªèƒ½è¢«ä¸€ä½å®¢æœäººå‘˜å¤„ç†ï¼Œç¬¬äºŒä¸ªå®¢æœäººå‘˜ä¸èƒ½ä¸ºè¯¥å®¢æˆ·æœåŠ¡ã€‚ å‘å¸ƒ/è®¢é˜…æ¨¡å‹ è¿™ä¸ªæ¨¡å‹å¯èƒ½å­˜åœ¨å¤šä¸ªå‘å¸ƒè€…å‘ç›¸åŒçš„ä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œè€Œè®¢é˜…è€…ä¹Ÿå¯èƒ½å­˜åœ¨å¤šä¸ªï¼Œå®ƒä»¬éƒ½èƒ½æ¥æ”¶åˆ°ç›¸åŒä¸»é¢˜çš„æ¶ˆæ¯ã€‚ ç”Ÿæ´»ä¸­çš„æŠ¥çº¸è®¢é˜…å°±æ˜¯ä¸€ç§å…¸å‹çš„å‘å¸ƒ / è®¢é˜…æ¨¡å‹ã€‚ ","date":"2020-04-27","objectID":"/20200427_kafka/:1:4","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"Kafka ","date":"2020-04-27","objectID":"/20200427_kafka/:2:0","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"1. Intro kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµå¤„ç†å¹³å°ã€‚ ç±»ä¼¼ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿï¼Œè¯»å†™æµå¼çš„æ•°æ® ç¼–å†™å¯æ‰©å±•çš„æµå¤„ç†åº”ç”¨ç¨‹åºï¼Œç”¨äºå®æ—¶äº‹ä»¶å“åº”çš„åœºæ™¯ å®‰å…¨çš„å°†æµå¼çš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ï¼Œæœ‰å‰¯æœ¬å¤‡ä»½ï¼Œå®¹é”™çš„é›†ç¾¤ ","date":"2020-04-27","objectID":"/20200427_kafka/:2:1","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"2. History Kafkaä»ä½•è€Œæ¥?æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å¼€å‘Kafka? Kafkaåˆ°åº•æ˜¯ä»€ä¹ˆ? Kafka æœ€åˆæ˜¯ LinkedIn çš„ä¸€ä¸ªå†…éƒ¨åŸºç¡€è®¾æ–½ç³»ç»Ÿã€‚æˆ‘ä»¬å‘ç°è™½ç„¶æœ‰å¾ˆå¤šæ•°æ®åº“å’Œç³»ç»Ÿå¯ä»¥ç”¨æ¥å­˜å‚¨æ•°æ®ï¼Œä½†åœ¨æˆ‘ä»¬çš„æ¶æ„é‡Œï¼Œåˆšå¥½ç¼ºä¸€ä¸ªå¯ä»¥å¸®åŠ©å¤„ç†æŒç»­æ•°æ®æµçš„ç»„ä»¶ã€‚åœ¨å¼€å‘Kafkaä¹‹å‰ï¼Œæˆ‘ä»¬å®éªŒäº†å„ç§ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä»æ¶ˆæ¯ç³»ç»Ÿåˆ°æ—¥å¿—èšåˆç³»ç»Ÿï¼Œå†åˆ°ETLå·¥å…·ï¼Œå®ƒä»¬éƒ½æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ æœ€åï¼Œæˆ‘ä»¬å†³å®šä»å¤´å¼€å‘ä¸€ä¸ªç³»ç»Ÿã€‚æˆ‘ä»¬ä¸æƒ³åªæ˜¯å¼€å‘ä¸€ä¸ªèƒ½å¤Ÿå­˜å‚¨æ•°æ®çš„ç³»ç»Ÿï¼Œæ¯”å¦‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ã€é”®å€¼å­˜å‚¨å¼•æ“ã€æœç´¢å¼•æ“æˆ–ç¼“å­˜ç³»ç»Ÿï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤ŸæŠŠæ•°æ®çœ‹æˆæ˜¯æŒç»­å˜åŒ–å’Œä¸æ–­å¢é•¿çš„æµï¼Œå¹¶åŸºäºè¿™æ ·çš„æƒ³æ³•æ„å»ºå‡ºä¸€ä¸ªæ•°æ®ç³»ç»Ÿã€‚äº‹å®ä¸Šï¼Œæ˜¯ä¸€ä¸ªæ•°æ®æ¶æ„ã€‚ è¿™ä¸ªæƒ³æ³•å®ç°åæ¯”æˆ‘ä»¬æœ€åˆé¢„æƒ³çš„é€‚ç”¨æ€§æ›´å¹¿ã€‚Kafka ä¸€å¼€å§‹è¢«ç”¨åœ¨ç¤¾äº¤ç½‘ç»œçš„å®æ—¶åº”ç”¨å’Œæ•°æ®æµå½“ä¸­ï¼Œè€Œç°åœ¨å·²ç»æˆä¸ºä¸‹ä¸€ä»£æ•°æ®æ¶æ„çš„åŸºç¡€ã€‚å¤§å‹é›¶å”®å•†æ­£åœ¨åŸºäºæŒç»­æ•°æ®æµæ”¹é€ ä»–ä»¬çš„åŸºç¡€ä¸šåŠ¡æµç¨‹ï¼Œæ±½è½¦å…¬å¸æ­£åœ¨ä»äº’è”ç½‘æ±½è½¦é‚£é‡Œæ”¶é›†å’Œå¤„ç†å®æ—¶æ•°æ®æµï¼Œé“¶è¡Œä¹Ÿåœ¨é‡æ–°æ€è€ƒåŸºäº Kafka æ”¹é€ ä»–ä»¬çš„åŸºç¡€ã€‚ å®ƒå¯ä»¥ç”¨äºä¸¤å¤§ç±»åˆ«çš„åº”ç”¨: æ„é€ å®æ—¶æµæ•°æ®ç®¡é“ï¼Œå®ƒå¯ä»¥åœ¨ç³»ç»Ÿæˆ–åº”ç”¨ä¹‹é—´å¯é åœ°è·å–æ•°æ®ã€‚(ç›¸å½“äºmessage queue) æ„å»ºå®æ—¶æµå¼åº”ç”¨ç¨‹åºï¼Œå¯¹è¿™äº›æµæ•°æ®è¿›è¡Œè½¬æ¢æˆ–è€…å½±å“ã€‚(å°±æ˜¯æµå¤„ç†ï¼Œé€šè¿‡kafka stream topicå’Œtopicä¹‹é—´å†…éƒ¨è¿›è¡Œå˜åŒ–) ç‰ˆæœ¬å· å¤‡æ³¨ 0.7 ä¸Šå¤ç‰ˆæœ¬ï¼Œæä¾›äº†æœ€åŸºç¡€çš„æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ 0.8 å¼•å…¥äº†å‰¯æœ¬æœºåˆ¶ï¼Œæˆä¸ºäº†ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šå®Œå¤‡çš„åˆ†å¸ƒå¼é«˜å¯é æ¶ˆæ¯é˜Ÿåˆ—è§£å†³æ–¹æ¡ˆ 0.8.2 æ–°ç‰ˆæœ¬ Producer APIï¼Œå³éœ€è¦æŒ‡å®š Broker åœ°å€çš„ Producer 0.9 å¢åŠ äº†åŸºç¡€çš„å®‰å…¨è®¤è¯ / æƒé™ï¼ŒJava é‡å†™äº†æ–°ç‰ˆæœ¬æ¶ˆè´¹è€… API 0.10.0.0 å¼•å…¥äº† Kafka Streams 0.11.0.0 æä¾›å¹‚ç­‰æ€§ Producer API ä»¥åŠäº‹åŠ¡ï¼ˆTransactionï¼‰ APIï¼Œå¯¹ Kafka æ¶ˆæ¯æ ¼å¼åšäº†é‡æ„ã€‚ 1.0 Kafka Streams çš„å„ç§æ”¹è¿› 2.0 Kafka Streams çš„å„ç§æ”¹è¿› ","date":"2020-04-27","objectID":"/20200427_kafka/:2:2","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"3. Item æ¶ˆæ¯ï¼šRecordã€‚è¿™é‡Œçš„æ¶ˆæ¯å°±æ˜¯æŒ‡ Kafka å¤„ç†çš„ä¸»è¦å¯¹è±¡ã€‚ æœåŠ¡ï¼šBrokerã€‚ä¸€ä¸ª Kafka é›†ç¾¤ç”±å¤šä¸ª Broker ç»„æˆï¼ŒBroker è´Ÿè´£æ¥æ”¶å’Œå¤„ç†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œä»¥åŠå¯¹æ¶ˆæ¯è¿›è¡ŒæŒä¹…åŒ–ã€‚ ä¸»é¢˜ï¼šTopicã€‚ä¸»é¢˜æ˜¯æ‰¿è½½æ¶ˆæ¯çš„é€»è¾‘å®¹å™¨ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­å¤šç”¨æ¥åŒºåˆ†å…·ä½“çš„ä¸šåŠ¡ã€‚ åˆ†åŒºï¼šPartitionã€‚ä¸€ä¸ªæœ‰åºä¸å˜çš„æ¶ˆæ¯åºåˆ—ã€‚æ¯ä¸ªä¸»é¢˜ä¸‹å¯ä»¥æœ‰å¤šä¸ªåˆ†åŒºã€‚ æ¶ˆæ¯ä½ç§»ï¼šOffsetã€‚è¡¨ç¤ºåˆ†åŒºä¸­æ¯æ¡æ¶ˆæ¯çš„ä½ç½®ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªå•è°ƒé€’å¢ä¸”ä¸å˜çš„å€¼ã€‚ å‰¯æœ¬ï¼šReplicaã€‚Kafka ä¸­åŒä¸€æ¡æ¶ˆæ¯èƒ½å¤Ÿè¢«æ‹·è´åˆ°å¤šä¸ªåœ°æ–¹ä»¥æä¾›æ•°æ®å†—ä½™ï¼Œè¿™äº›åœ°æ–¹å°±æ˜¯æ‰€è°“çš„å‰¯æœ¬ã€‚å‰¯æœ¬è¿˜åˆ†ä¸ºé¢†å¯¼è€…å‰¯æœ¬å’Œè¿½éšè€…å‰¯æœ¬ï¼Œå„è‡ªæœ‰ä¸åŒçš„è§’è‰²åˆ’åˆ†ã€‚å‰¯æœ¬æ˜¯åœ¨åˆ†åŒºå±‚çº§ä¸‹çš„ï¼Œå³æ¯ä¸ªåˆ†åŒºå¯é…ç½®å¤šä¸ªå‰¯æœ¬å®ç°é«˜å¯ç”¨ã€‚ ç”Ÿäº§è€…ï¼šProducerã€‚å‘ä¸»é¢˜å‘å¸ƒæ–°æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºã€‚ æ¶ˆè´¹è€…ï¼šConsumerã€‚ä»ä¸»é¢˜è®¢é˜…æ–°æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºã€‚ æ¶ˆè´¹è€…ä½ç§»ï¼šConsumer Offsetã€‚è¡¨å¾æ¶ˆè´¹è€…æ¶ˆè´¹è¿›åº¦ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰è‡ªå·±çš„æ¶ˆè´¹è€…ä½ç§»ã€‚ æ¶ˆè´¹è€…ç»„ï¼šConsumer Groupã€‚å¤šä¸ªæ¶ˆè´¹è€…å®ä¾‹å…±åŒç»„æˆçš„ä¸€ä¸ªç»„ï¼ŒåŒæ—¶æ¶ˆè´¹å¤šä¸ªåˆ†åŒºä»¥å®ç°é«˜ååã€‚ é‡å¹³è¡¡ï¼šRebalanceã€‚æ¶ˆè´¹è€…ç»„å†…æŸä¸ªæ¶ˆè´¹è€…å®ä¾‹æŒ‚æ‰åï¼Œå…¶ä»–æ¶ˆè´¹è€…å®ä¾‹è‡ªåŠ¨é‡æ–°åˆ†é…è®¢é˜…ä¸»é¢˜åˆ†åŒºçš„è¿‡ç¨‹ã€‚Rebalance æ˜¯ Kafka æ¶ˆè´¹è€…ç«¯å®ç°é«˜å¯ç”¨çš„é‡è¦æ‰‹æ®µã€‚ kafkaItem ","date":"2020-04-27","objectID":"/20200427_kafka/:2:3","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"4. Topic æ—¥å¿— æ—¥å¿—å¯èƒ½æ˜¯ä¸€ç§æœ€ç®€å•çš„ä¸èƒ½å†ç®€å•çš„å­˜å‚¨æŠ½è±¡ï¼Œåªèƒ½è¿½åŠ ã€æŒ‰ç…§æ—¶é—´å®Œå…¨æœ‰åºï¼ˆtotally-orderedï¼‰çš„è®°å½•åºåˆ—ã€‚æ—¥å¿—çœ‹èµ·æ¥çš„æ ·å­ï¼š kafkaLog åœ¨æ—¥å¿—çš„æœ«å°¾æ·»åŠ è®°å½•ï¼Œè¯»å–æ—¥å¿—è®°å½•åˆ™ä»å·¦åˆ°å³ã€‚æ¯ä¸€æ¡è®°å½•éƒ½æŒ‡å®šäº†ä¸€ä¸ªå”¯ä¸€çš„é¡ºåºçš„æ—¥å¿—è®°å½•ç¼–å·ã€‚ æ—¥å¿—è®°å½•çš„æ¬¡åºï¼ˆorderingï¼‰å®šä¹‰äº†ã€æ—¶é—´ã€æ¦‚å¿µï¼Œå› ä¸ºä½äºå·¦è¾¹çš„æ—¥å¿—è®°å½•è¡¨ç¤ºæ¯”å³è¾¹çš„è¦æ—©ã€‚æ—¥å¿—è®°å½•ç¼–å·å¯ä»¥çœ‹ä½œæ˜¯è¿™æ¡æ—¥å¿—è®°å½•çš„ã€æ—¶é—´æˆ³ã€ã€‚æŠŠæ¬¡åºç›´æ¥çœ‹æˆæ˜¯æ—¶é—´æ¦‚å¿µï¼Œåˆšå¼€å§‹ä½ ä¼šè§‰å¾—æœ‰ç‚¹æ€ªå¼‚ï¼Œä½†æ˜¯è¿™æ ·çš„åšæ³•æœ‰ä¸ªä¾¿åˆ©çš„æ€§è´¨ï¼šè§£è€¦äº† æ—¶é—´ å’Œ ä»»ä¸€ç‰¹å®šçš„ç‰©ç†æ—¶é’Ÿï¼ˆphysical clockï¼‰ã€‚å¼•å…¥åˆ†å¸ƒå¼ç³»ç»Ÿåï¼Œè¿™ä¼šæˆä¸ºä¸€ä¸ªå¿…ä¸å¯å°‘çš„æ€§è´¨ã€‚ æ—¥å¿— å’Œ æ–‡ä»¶æˆ–æ•°æ®è¡¨ï¼ˆtableï¼‰å¹¶æ²¡æœ‰ä»€ä¹ˆå¤§çš„ä¸åŒã€‚æ–‡ä»¶æ˜¯ä¸€ç³»åˆ—å­—èŠ‚ï¼Œè¡¨æ˜¯ç”±ä¸€ç³»åˆ—è®°å½•ç»„æˆï¼Œè€Œæ—¥å¿—å®é™…ä¸Šåªæ˜¯ä¸€ç§æŒ‰ç…§æ—¶é—´é¡ºåºå­˜å‚¨è®°å½•çš„æ•°æ®è¡¨æˆ–æ–‡ä»¶ã€‚ å¯¹äºæ¯ä¸€ä¸ªtopicï¼Œ Kafkaé›†ç¾¤éƒ½ä¼šç»´æŒä¸€ä¸ªåˆ†åŒºæ—¥å¿—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š kafkaPartitionLog å®æ“ å¯åŠ¨zk cd /usr/local/kara/kafka_2.13-2.6.0/bin zookeeper-server-start.sh ../config/zookeeper.properties å¯åŠ¨kafkaæœåŠ¡å™¨ kafka-server-start.sh ../config/server.properties åˆ›å»ºtopicï¼Œ4ä¸ªåˆ†åŒºï¼Œä¸€ä¸ªå‰¯æœ¬ kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 4 --topic partition_test å‘é€ä¸€äº›æ¶ˆæ¯ kafka-console-producer.sh --broker-list localhost:9092 --topic partition_test å¯åŠ¨ä¸€ä¸ªconsumer kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic partition_test --from-beginning åˆ†åŒº partitionå­˜å‚¨åˆ†å¸ƒ ä¸€ä¸ªtopicä¸‹æœ‰å¤šä¸ªä¸åŒpartitionï¼Œæ¯ä¸ªpartitionä¸ºä¸€ä¸ªç›®å½•ï¼Œpartitonå‘½åè§„åˆ™ä¸ºtopicåç§°+æœ‰åºåºå·ï¼Œç¬¬ä¸€ä¸ªpartitonåºå·ä»0å¼€å§‹ï¼Œåºå·æœ€å¤§å€¼ä¸ºpartitionsæ•°é‡å‡1 partitionæ–‡ä»¶å­˜å‚¨ 1.æ¯ä¸ªpartion(ç›®å½•)ç›¸å½“äºä¸€ä¸ªå·¨å‹æ–‡ä»¶è¢«å¹³å‡åˆ†é…åˆ°å¤šä¸ªå¤§å°ç›¸ç­‰segment(æ®µ)æ•°æ®æ–‡ä»¶ä¸­ã€‚ä½†æ¯ä¸ªæ®µsegment fileæ¶ˆæ¯æ•°é‡ä¸ä¸€å®šç›¸ç­‰ï¼Œè¿™ç§ç‰¹æ€§æ–¹ä¾¿old segment fileå¿«é€Ÿè¢«åˆ é™¤ã€‚ 2.æ¯ä¸ªpartitonåªéœ€è¦æ”¯æŒé¡ºåºè¯»å†™å°±è¡Œäº†ï¼Œsegmentæ–‡ä»¶ç”Ÿå‘½å‘¨æœŸç”±æœåŠ¡ç«¯é…ç½®å‚æ•°å†³å®šã€‚ segmentæ–‡ä»¶å­˜å‚¨ segment fileç»„æˆï¼šç”±2å¤§éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ä¸ºindex fileå’Œdata fileï¼Œæ­¤2ä¸ªæ–‡ä»¶ä¸€ä¸€å¯¹åº”ï¼Œæˆå¯¹å‡ºç°ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸ºsegmentç´¢å¼•æ–‡ä»¶ã€æ•°æ®æ–‡ä»¶. segmentæ–‡ä»¶å‘½åè§„åˆ™ï¼špartionå…¨å±€çš„ç¬¬ä¸€ä¸ªsegmentä»0å¼€å§‹ï¼Œåç»­æ¯ä¸ªsegmentæ–‡ä»¶åä¸ºä¸Šä¸€ä¸ªsegmentæ–‡ä»¶æœ€åä¸€æ¡æ¶ˆæ¯çš„offsetå€¼ã€‚æ•°å€¼æœ€å¤§ä¸º64ä½longå¤§å°ï¼Œ19ä½æ•°å­—å­—ç¬¦é•¿åº¦ï¼Œæ²¡æœ‰æ•°å­—ç”¨0å¡«å……ã€‚segment index fileé‡‡å–ç¨€ç–ç´¢å¼•å­˜å‚¨æ–¹å¼ï¼Œå®ƒå‡å°‘ç´¢å¼•æ–‡ä»¶å¤§å°ï¼Œé€šè¿‡mmapå¯ä»¥ç›´æ¥å†…å­˜æ“ä½œï¼Œç¨€ç–ç´¢å¼•ä¸ºæ•°æ®æ–‡ä»¶çš„æ¯ä¸ªå¯¹åº”messageè®¾ç½®ä¸€ä¸ªå…ƒæ•°æ®æŒ‡é’ˆ,å®ƒæ¯”ç¨ å¯†ç´¢å¼•èŠ‚çœäº†æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œä½†æŸ¥æ‰¾èµ·æ¥éœ€è¦æ¶ˆè€—æ›´å¤šçš„æ—¶é—´ã€‚ segmentä¸­çš„æ¶ˆæ¯messageç‰©ç†ç»“æ„å­—æ®µè¯´æ˜ å…³é”®å­— è§£é‡Šè¯´æ˜ 8 byte offset åœ¨parition(åˆ†åŒº)å†…çš„æ¯æ¡æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªæœ‰åºçš„idå·ï¼Œè¿™ä¸ªidå·è¢«ç§°ä¸ºåç§»(offset),å®ƒå¯ä»¥å”¯ä¸€ç¡®å®šæ¯æ¡æ¶ˆæ¯åœ¨parition(åˆ†åŒº)å†…çš„ä½ç½®ã€‚å³offsetè¡¨ç¤ºpartiionçš„ç¬¬å¤šå°‘message 4 byte message size messageå¤§å° 4 byte CRC32 ç”¨crc32æ ¡éªŒmessage 1 byte â€œmagicâ€ è¡¨ç¤ºæœ¬æ¬¡å‘å¸ƒKafkaæœåŠ¡ç¨‹åºåè®®ç‰ˆæœ¬å· 1 byte â€œattributesâ€ è¡¨ç¤ºä¸ºç‹¬ç«‹ç‰ˆæœ¬ã€æˆ–æ ‡è¯†å‹ç¼©ç±»å‹ã€æˆ–ç¼–ç ç±»å‹ã€‚ 4 byte key length è¡¨ç¤ºkeyçš„é•¿åº¦,å½“keyä¸º-1æ—¶ï¼ŒK byte keyå­—æ®µä¸å¡« K byte key å¯é€‰ value bytes payload è¡¨ç¤ºå®é™…æ¶ˆæ¯æ•°æ®ã€‚ æ–‡ä»¶ç³»ç»Ÿ Kafka å¯¹æ¶ˆæ¯çš„å­˜å‚¨å’Œç¼“å­˜ä¸¥é‡ä¾èµ–äºæ–‡ä»¶ç³»ç»Ÿã€‚äººä»¬å¯¹äºâ€œç£ç›˜é€Ÿåº¦æ…¢â€å…·æœ‰æ™®éå°è±¡ï¼Œäº‹å®ä¸Šï¼Œç£ç›˜çš„é€Ÿåº¦æ¯”äººä»¬é¢„æœŸçš„è¦æ…¢çš„å¤šï¼Œä¹Ÿå¿«å¾—å¤šï¼Œè¿™å–å†³äºäººä»¬ä½¿ç”¨ç£ç›˜çš„æ–¹å¼ã€‚ ä½¿ç”¨6ä¸ª7200rpmã€SATAæ¥å£ã€RAID-5çš„ç£ç›˜é˜µåˆ—åœ¨JBODé…ç½®ä¸‹çš„é¡ºåºå†™å…¥çš„æ€§èƒ½çº¦ä¸º600MB/ç§’ï¼Œä½†éšæœºå†™å…¥çš„æ€§èƒ½ä»…çº¦ä¸º100k/ç§’ï¼Œç›¸å·®6000å€ä»¥ä¸Šã€‚ çº¿æ€§çš„è¯»å–å’Œå†™å…¥æ˜¯ç£ç›˜ä½¿ç”¨æ¨¡å¼ä¸­æœ€æœ‰è§„å¾‹çš„ï¼Œå¹¶ä¸”ç”±æ“ä½œç³»ç»Ÿè¿›è¡Œäº†å¤§é‡çš„ä¼˜åŒ–ã€‚ read-ahead æ˜¯ä»¥å¤§çš„ data block ä¸ºå•ä½é¢„å…ˆè¯»å–æ•°æ® write-behind æ˜¯å°†å¤šä¸ªå°å‹çš„é€»è¾‘å†™åˆå¹¶æˆä¸€æ¬¡å¤§å‹çš„ç‰©ç†ç£ç›˜å†™å…¥ å…³äºè¯¥é—®é¢˜çš„è¿›ä¸€æ­¥è®¨è®ºå¯ä»¥å‚è€ƒ ACM Queue articleï¼Œä»–ä»¬å‘ç°å®é™…ä¸Šé¡ºåºç£ç›˜è®¿é—®åœ¨æŸäº›æƒ…å†µä¸‹æ¯”éšæœºå†…å­˜è®¿é—®è¿˜è¦å¿«ï¼ ä¸ºäº†å¼¥è¡¥è¿™ç§æ€§èƒ½å·®å¼‚ï¼Œç°ä»£æ“ä½œç³»ç»Ÿä¸»åŠ¨å°†æ‰€æœ‰ç©ºé—²å†…å­˜ç”¨ä½œ disk cachingï¼ˆç£ç›˜é«˜é€Ÿç¼“å­˜ï¼‰ï¼Œæ‰€æœ‰å¯¹ç£ç›˜çš„è¯»å†™æ“ä½œéƒ½ä¼šé€šè¿‡è¿™ä¸ªç»Ÿä¸€çš„ cacheï¼ˆ in-process cacheï¼‰ã€‚ å³ä½¿è¿›ç¨‹ç»´æŠ¤äº† in-process cacheï¼Œè¯¥æ•°æ®ä¹Ÿå¯èƒ½ä¼šè¢«å¤åˆ¶åˆ°æ“ä½œç³»ç»Ÿçš„ pagecache ä¸­ï¼Œäº‹å®ä¸Šæ‰€æœ‰å†…å®¹éƒ½è¢«å­˜å‚¨äº†ä¸¤ä»½ã€‚ æ­¤å¤–ï¼ŒKafka å»ºç«‹åœ¨ JVM ä¹‹ä¸Šï¼Œä»»ä½•äº†è§£ Java å†…å­˜ä½¿ç”¨çš„äººéƒ½çŸ¥é“ä¸¤ç‚¹ï¼š å¯¹è±¡çš„å†…å­˜å¼€é”€éå¸¸é«˜ï¼Œé€šå¸¸æ˜¯æ‰€å­˜å‚¨çš„æ•°æ®çš„ä¸¤å€(ç”šè‡³æ›´å¤š)ã€‚ éšç€å †ä¸­æ•°æ®çš„å¢åŠ ï¼ŒJava çš„åƒåœ¾å›æ”¶å˜å¾—è¶Šæ¥è¶Šå¤æ‚å’Œç¼“æ…¢ã€‚ kafkaé€‰æ‹©äº†ä¸€ä¸ªéå¸¸ç®€å•çš„è®¾è®¡ï¼šç›¸æ¯”äºç»´æŠ¤å°½å¯èƒ½å¤šçš„ in-memory cacheï¼Œå¹¶ä¸”åœ¨ç©ºé—´ä¸è¶³çš„æ—¶å€™åŒ†å¿™å°†æ•°æ® flush åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹å€’è¿‡æ¥ã€‚æ‰€æœ‰æ•°æ®ä¸€å¼€å§‹å°±è¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æŒä¹…åŒ–æ—¥å¿—ä¸­ï¼Œè€Œä¸ç”¨åœ¨ cache ç©ºé—´ä¸è¶³çš„æ—¶å€™ flush åˆ°ç£ç›˜ã€‚å®é™…ä¸Šï¼Œè¿™è¡¨æ˜æ•°æ®è¢«è½¬ç§»åˆ°äº†å†…æ ¸çš„ pagecache ä¸­ã€‚ Pagecacheé¡µé¢ç¼“å­˜ Page cacheï¼ˆé¡µé¢ç¼“å­˜ï¼‰ Page cache ä¹Ÿå«é¡µç¼“å†²æˆ–æ–‡ä»¶ç¼“å†²ï¼Œæ˜¯ç”±å¥½å‡ ä¸ªç£ç›˜å—æ„æˆï¼Œå¤§å°é€šå¸¸ä¸º4kï¼Œåœ¨64ä½ç³»ç»Ÿä¸Šä¸º8kï¼Œæ„æˆçš„å‡ ä¸ªç£ç›˜å—åœ¨ç‰©ç†ç£ç›˜ä¸Šä¸ä¸€å®šè¿ç»­ï¼Œæ–‡ä»¶çš„ç»„ç»‡å•ä½ä¸ºä¸€é¡µï¼Œ ä¹Ÿå°±æ˜¯ä¸€ä¸ªpage cacheå¤§å°ï¼Œæ–‡ä»¶è¯»å–æ˜¯ç”±å¤–å­˜ä¸Šä¸è¿ç»­çš„å‡ ä¸ªç£ç›˜å—ï¼Œåˆ°buffer cacheï¼Œç„¶åç»„æˆpage cacheï¼Œç„¶åä¾›ç»™åº”ç”¨ç¨‹åºã€‚ Buffer cacheï¼ˆå—ç¼“å­˜ï¼‰ Buffer cache ä¹Ÿå«å—ç¼“å†²ï¼Œæ˜¯å¯¹ç‰©ç†ç£ç›˜ä¸Šçš„ä¸€ä¸ªç£ç›˜å—è¿›è¡Œçš„ç¼“å†²ï¼Œå…¶å¤§å°ä¸ºé€šå¸¸ä¸º1kï¼Œç£ç›˜å—ä¹Ÿæ˜¯ç£ç›˜çš„ç»„ç»‡å•ä½ã€‚è®¾ç«‹buffer cacheçš„ç›®çš„æ˜¯ä¸ºåœ¨ç¨‹åºå¤šæ¬¡è®¿é—®åŒä¸€ç£ç›˜å—æ—¶ï¼Œå‡å°‘è®¿é—®æ—¶é—´ã€‚ Page cacheï¼ˆé¡µé¢ç¼“å­˜ï¼‰ä¸Buffer cacheï¼ˆå—ç¼“å­˜ï¼‰çš„åŒºåˆ« ç£ç›˜çš„æ“ä½œæœ‰é€»è¾‘çº§ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰å’Œç‰©ç†çº§ï¼ˆç£ç›˜å—ï¼‰ï¼Œè¿™ä¸¤ç§Cacheå°±æ˜¯åˆ†åˆ«ç¼“å­˜é€»è¾‘å’Œç‰©ç†çº§æ•°æ®çš„ã€‚ æˆ‘ä»¬é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–‡ä»¶å°†è¢«ç¼“å­˜åˆ°Page Cacheï¼Œå¦‚æœéœ€è¦åˆ·æ–°æ–‡ä»¶çš„æ—¶å€™ï¼ŒPage Cacheå°†äº¤ç»™Buffer Cacheå»å®Œæˆï¼Œå› ä¸ºBuffer Cacheå°±æ˜¯ç¼“å­˜ç£ç›˜å—çš„ã€‚ ç®€å•è¯´æ¥ï¼Œpage cacheç”¨æ¥ç¼“å­˜æ–‡ä»¶æ•°æ®ï¼Œbuffer cacheç”¨æ¥ç¼“å­˜ç£ç›˜æ•°æ®ã€‚åœ¨æœ‰æ–‡ä»¶ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œå¯¹æ–‡ä»¶æ“ä½œï¼Œé‚£ä¹ˆæ•°æ®ä¼šç¼“å­˜åˆ°page cacheï¼Œå¦‚æœç›´æ¥é‡‡ç”¨ddç­‰å·¥å…·å¯¹ç£ç›˜è¿›è¡Œè¯»å†™ï¼Œé‚£ä¹ˆæ•°æ®ä¼šç¼“å­˜åˆ°buffer cacheã€‚ Buffer(Buffer Cache)ä»¥å—å½¢å¼ç¼“å†²äº†å—è®¾å¤‡çš„æ“ä½œï¼Œå®šæ—¶æˆ–æ‰‹åŠ¨çš„åŒæ­¥åˆ°ç¡¬ç›˜ï¼Œå®ƒæ˜¯ä¸ºäº†ç¼“å†²å†™æ“ä½œç„¶åä¸€æ¬¡æ€§å°†å¾ˆå¤šæ”¹åŠ¨å†™å…¥ç¡¬ç›˜ï¼Œé¿å…é¢‘ç¹å†™ç¡¬ç›˜ï¼Œæé«˜å†™å…¥æ•ˆç‡ã€‚ Cache(Page Cache)ä»¥é¡µé¢å½¢å¼ç¼“å­˜äº†æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œç»™éœ€è¦ä½¿ç”¨çš„ç¨‹åºè¯»å–ï¼Œå®ƒæ˜¯ä¸ºäº†ç»™è¯»æ“ä½œæä¾›ç¼“å†²ï¼Œé¿å…é¢‘ç¹è¯»ç¡¬ç›˜ï¼Œæé«˜è¯»å–æ•ˆç‡ã€‚ é™ä½æ—¶é—´å¤æ‚åº¦ æ¶ˆæ¯ç³»ç»Ÿä½¿ç”¨çš„æŒä¹…åŒ–æ•°æ®ç»“æ„é€šå¸¸æ˜¯å’Œ BTree ç›¸å…³è”çš„æ¶ˆè´¹è€…é˜Ÿåˆ—æˆ–è€…å…¶ä»–ç”¨äºå­˜å‚¨æ¶ˆæ¯æºæ•°æ®çš„é€šç”¨éšæœºè®¿é—®æ•°æ®ç»“æ„ã€‚BTree çš„æ“ä½œå¤æ‚åº¦æ˜¯ O(log N)ï¼Œé€šå¸¸æˆ‘ä»¬è®¤ä¸º O(log N) åŸºæœ¬ç­‰åŒäºå¸¸æ•°æ—¶é—´ï¼Œä½†è¿™æ¡åœ¨ç£ç›˜æ“ä½œä¸­ä¸æˆç«‹ã€‚ å­˜å‚¨ç³»ç»Ÿå°†éå¸¸å¿«çš„cacheæ“ä½œå’Œéå¸¸æ…¢çš„ç‰©ç†ç£ç›˜æ“ä½œæ··åˆåœ¨ä¸€èµ·ï¼Œå½“æ•°æ®éšç€ fixed cache å¢åŠ æ—¶ï¼Œå¯ä»¥çœ‹åˆ°æ ‘çš„æ€§èƒ½é€šå¸¸æ˜¯éçº¿æ€§çš„â€”â€”æ¯”å¦‚æ•°æ®ç¿»å€æ—¶æ€§èƒ½ä¸‹é™ä¸åªä¸¤å€ã€‚ kafkaé€‰æ‹©æŠŠæŒä¹…åŒ–é˜Ÿåˆ—å»ºç«‹åœ¨ç®€å•çš„è¯»å–å’Œå‘æ–‡ä»¶åè¿½åŠ ä¸¤ç§æ“ä½œä¹‹ä¸Šï¼Œè¿™å’Œæ—¥å¿—è§£å†³æ–¹æ¡ˆç›¸åŒã€‚è¿™ç§æ¶æ„çš„ä¼˜ç‚¹åœ¨äºæ‰€æœ‰çš„æ“ä½œå¤æ‚åº¦éƒ½æ˜¯O(1)ï¼Œè€Œä¸”è¯»æ“ä½œä¸ä¼šé˜»å¡å†™æ“ä½œï¼Œè¯»æ“ä½œä¹‹é—´ä¹Ÿä¸ä¼šäº’ç›¸å½±å“ã€‚ åœ¨ä¸äº§ç”Ÿä»»ä½•æ€§èƒ½æŸå¤±çš„æƒ…å†µä¸‹èƒ½å¤Ÿè®¿é—®å‡ ä¹æ— é™çš„ç¡¬ç›˜ç©ºé—´ï¼ŒKafka å¯ä»¥è®©æ¶ˆæ¯ä¿ç•™ç›¸å¯¹è¾ƒé•¿çš„ä¸€æ®µæ—¶é—´(æ¯”å¦‚ä¸€å‘¨)ï¼Œè€Œä¸æ˜¯è¯•å›¾åœ¨è¢«æ¶ˆè´¹åç«‹å³åˆ é™¤ã€‚ é™ä½å¤§é‡å°å‹IOæ“ä½œçš„å½±å“ å°å‹çš„ I/O æ“ä½œå‘ç”Ÿåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä»¥åŠæœåŠ¡ç«¯è‡ªèº«çš„æŒä¹…åŒ–æ“ä½œä¸­ã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œkafkaçš„åè®®æ˜¯å»ºç«‹åœ¨ä¸€ä¸ª â€œæ¶ˆæ¯å—â€ çš„æŠ½è±¡åŸºç¡€ä¸Šï¼Œåˆç†å°†æ¶ˆæ¯åˆ†","date":"2020-04-27","objectID":"/20200427_kafka/:2:4","tags":["Kafka","Distribution"],"title":"Kafka \u0026 Message Queue","uri":"/20200427_kafka/"},{"categories":["Technology"],"content":"Article description.","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"The major difference between the two is Replication/Fault Tolerance. HDFS was designed to survive failures. NFS does not have any fault tolerance built in. Other than fault tolerance, HDFS does support multiple replicas of files. This eliminates (or eases) the common bottleneck of many clients accessing a single file. Since files have multiple replicas, on different physical disks, reading performance scales better than NFS. ","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/:0:0","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"NFS NFS (Network File system): A protocol developed that allows clients to access files over the network. NFS clients allow files to be accessed as if the files reside on the local machine, even though they reside on the disk of a networked machine. In NFS, the data is stored only on one main system. All the other systems in that network can access the data stored in that as if it was stored in their local system. But the problem with this is that, if the main system goes down, then the data is lost and also, the storage depends on the space available on that system. ","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/:1:0","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"HDFS HDFS (Hadoop Distributed File System): A file system that is distributed amongst many networked computers or nodes. HDFS is fault tolerant because it stores multiple replicas of files on the file system, the default replication level is 3. In HDFS, data is distributed among different systems called datanodes. Here, the storage capacity is comparatively high. HDFS is mainly used to store Big Data and enable fast data transaction. ","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/:2:0","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"Similarities ä¸¤è€…çš„æ–‡ä»¶ç³»ç»Ÿæ•°æ®å‡èƒ½å¤Ÿåœ¨ç›¸å…³ç³»ç»Ÿå†…çš„å¤šå°æœºå™¨ä¸Šè¿›è¡Œæ•°æ®è¯»å–å’Œå†™å…¥ï¼Œéƒ½æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ ","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/:3:0","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"Differences NFSæ˜¯é€šè¿‡RPCé€šä¿¡åè®®è¿›è¡Œæ•°æ®å…±äº«çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥NFSå¿…é¡»åœ¨è¿è¡Œçš„åŒæ—¶ç¡®ä¿RPCèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚åœ¨ä¸åŒçš„æ–‡ä»¶è¿›è¡Œè¯»å–å’Œå†™å…¥æ—¶ï¼Œå®é™…ä¸Šæ˜¯å¯¹æœåŠ¡ç«¯çš„å…±äº«æ–‡ä»¶åœ°å€è¿›è¡Œæ“ä½œï¼Œä¸€æ—¦æœåŠ¡ç«¯å‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆå…¶ä»–æ‰€æœ‰çš„æœºå™¨æ— æ³•è¿›è¡Œæ–‡ä»¶è¯»å–å’Œå†™å…¥ï¼Œå¹¶ä¸”æ•°æ®æ— æ³•æ‰¾å›ã€‚æ‰€ä»¥NFSç³»ç»Ÿçš„æ–‡ä»¶å…¶å®å¹¶æ²¡æœ‰å¤‡ä»½ï¼Œå¹¶ä¸”å…¶æœåŠ¡ç«¯æ²¡æœ‰åšé«˜å¯ç”¨å¤„ç†ã€‚ HDFSæ˜¯é€šè¿‡æ•°æ®å¤‡ä»½è¿›è¡Œçš„å¤§æ•°æ®å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿã€‚HDFSæœ‰ç³»ç»Ÿå¤‡ä»½ï¼Œå¹¶ä¸”å…¶namenodeæœ‰secondnamenodeè¿›è¡Œå¤‡ä»½å¤„ç†ï¼Œæ›´åŠ å®‰å…¨å¯é ã€‚æ•°æ®åœ¨ç»è¿‡å¤šå‰¯æœ¬å­˜å‚¨åï¼Œèƒ½å¤ŸæŠµå¾¡å„ç§ç¾éš¾ï¼Œåªè¦æœ‰ä¸€ä¸ªå‰¯æœ¬ä¸ä¸¢å¤±ï¼Œæ•°æ®å°±ä¸ä¼šä¸¢å¤±ã€‚æ‰€ä»¥æ•°æ®çš„å®‰å…¨æ€§å¾ˆé«˜ã€‚ ","date":"2020-03-26","objectID":"/20200326_hdfs-nfs/:4:0","tags":["Hdfs","NFS","Distribution"],"title":"HDFS \u0026 NFS","uri":"/20200326_hdfs-nfs/"},{"categories":["Technology"],"content":"Article description.","date":"2020-02-08","objectID":"/20200208_scalaintroduction/","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"Scala combines object-oriented and functional programming in one concise, high-level language. Scalaâ€™s static types help avoid bugs in complex applications, and its JVM and JavaScript runtimes let you build high-performance systems with easy access to huge ecosystems of libraries. ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:0:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"1. REPL \u0026 Scaladoc Scalaè§£é‡Šå™¨è¯»åˆ°ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¯¹å®ƒè¿›è¡Œæ±‚å€¼ï¼Œå°†å®ƒæ‰“å°å‡ºæ¥ï¼Œæ¥ç€å†ç»§ç»­è¯»ä¸‹ä¸€ä¸ªè¡¨è¾¾å¼ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°åšRead-Eval-Print-Loopï¼Œå³ï¼šREPLã€‚ ä»æŠ€æœ¯ä¸Šè®²ï¼Œscalaç¨‹åºå¹¶ä¸æ˜¯ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®é™…å‘ç”Ÿçš„æ˜¯ï¼Œä½ è¾“å…¥çš„å†…å®¹è¢«å¿«é€Ÿåœ°ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œç„¶åè¿™æ®µå­—èŠ‚ç äº¤ç”±Javaè™šæ‹Ÿæœºæ‰§è¡Œã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå¤§å¤šæ•°scalaç¨‹åºå‘˜æ›´å€¾å‘äºå°†å®ƒç§°åšâ€œREPLâ€ scala apiæ–‡æ¡£ï¼ŒåŒ…å«äº†scalaæ‰€æœ‰çš„apiä»¥åŠä½¿ç”¨è¯´æ˜ï¼Œclassã€objectã€traitã€functionã€methodã€implicitç­‰ ä¸ºä»€ä¹ˆè¦æŸ¥é˜…Scaladocï¼šå¦‚æœåªæ˜¯å†™ä¸€äº›æ™®é€šçš„Scalaç¨‹åºåŸºæœ¬å¤Ÿç”¨äº†ï¼›ä½†æ˜¯å¦‚æœï¼ˆåœ¨ç°åœ¨ï¼Œæˆ–è€…æœªæ¥ï¼Œå®é™…çš„å·¥ä½œç¯å¢ƒä¸­ï¼‰è¦ç¼–å†™å¤æ‚çš„scalaç¨‹åºï¼Œé‚£ä¹ˆè¿˜æ˜¯éœ€è¦å‚è€ƒScaladocçš„ã€‚ï¼ˆçº¯ç²¹ç”¨scalaå¼€å‘sparkåº”ç”¨ç¨‹åºï¼Œåº”è¯¥ä¸ä¼šç‰¹åˆ«å¤æ‚ï¼›ç”¨scalaæ„å»ºç±»ä¼¼äºsparkçš„å…¬å¸å†…çš„åˆ†å¸ƒå¼çš„å¤§å‹ç³»ç»Ÿï¼‰ ä»¥ä¸‹æ˜¯ä¸€äº›Scaladocä½¿ç”¨çš„tipsï¼š ç›´æ¥åœ¨å·¦ä¸Šè§’çš„æœç´¢æ¡†ä¸­ï¼Œæœç´¢ä½ éœ€è¦çš„å¯»æ‰¾çš„åŒ…ã€ç±»å³å¯ Cå’ŒOï¼Œåˆ†åˆ«ä»£è¡¨äº†ç±»å’Œä¼´ç”Ÿå¯¹è±¡çš„æ¦‚å¿µ tå’ŒOï¼Œä»£è¡¨äº†ç‰¹åˆ¶(trait)(ç±»ä¼¼äºJavaçš„æ¥å£) æ ‡è®°ä¸ºimplicitçš„æ–¹æ³•ï¼Œä»£è¡¨çš„æ˜¯éšå¼è½¬æ¢ ä¸¾ä¾‹ï¼šæœç´¢StringOpsï¼Œå¯ä»¥çœ‹åˆ°Stringçš„å¢å¼ºç±»ï¼ŒStringOpsçš„æ‰€æœ‰æ–¹æ³•è¯´æ˜ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:1:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"2. Data Type ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:2:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"2.1 Data Type æ•°æ®ç±»å‹ æè¿° Byte 8ä½æœ‰ç¬¦å·è¡¥ç æ•´æ•°ã€‚æ•°å€¼åŒºé—´ä¸º -128 åˆ° 127 Short 16ä½æœ‰ç¬¦å·è¡¥ç æ•´æ•°ã€‚æ•°å€¼åŒºé—´ä¸º -32768 åˆ° 32767 Int 32ä½æœ‰ç¬¦å·è¡¥ç æ•´æ•°ã€‚æ•°å€¼åŒºé—´ä¸º -2147483648 åˆ° 2147483647 Long 64ä½æœ‰ç¬¦å·è¡¥ç æ•´æ•°ã€‚æ•°å€¼åŒºé—´ä¸º -9223372036854775808 åˆ° 9223372036854775807 Float 32 ä½, IEEE 754 æ ‡å‡†çš„å•ç²¾åº¦æµ®ç‚¹æ•° Double 64 ä½ IEEE 754 æ ‡å‡†çš„åŒç²¾åº¦æµ®ç‚¹æ•° Char 16ä½æ— ç¬¦å·Unicodeå­—ç¬¦, åŒºé—´å€¼ä¸º U+0000 åˆ° U+FFFF String å­—ç¬¦åºåˆ— Boolean trueæˆ–false Unit è¡¨ç¤ºæ— å€¼ï¼Œå’Œå…¶ä»–è¯­è¨€ä¸­voidç­‰åŒã€‚ç”¨ä½œä¸è¿”å›ä»»ä½•ç»“æœçš„æ–¹æ³•çš„ç»“æœç±»å‹ã€‚Unitåªæœ‰ä¸€ä¸ªå®ä¾‹å€¼ï¼Œå†™æˆ()ã€‚ Null null æˆ–ç©ºå¼•ç”¨ Nothing Nothingç±»å‹åœ¨Scalaçš„ç±»å±‚çº§çš„æœ€åº•ç«¯ï¼›å®ƒæ˜¯ä»»ä½•å…¶ä»–ç±»å‹çš„å­ç±»å‹ã€‚ Any Anyæ˜¯æ‰€æœ‰å…¶ä»–ç±»çš„è¶…ç±» AnyRef AnyRefç±»æ˜¯Scalaé‡Œæ‰€æœ‰å¼•ç”¨ç±»(reference class)çš„åŸºç±» ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:2:1","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"2.2 valã€var \u0026 Lazy Value å†…å®¹æ˜¯å¦å¯å˜ï¼švalä¿®é¥°çš„æ˜¯ä¸å¯å˜çš„ï¼Œvarä¿®é¥°æ˜¯å¯å˜çš„ valä¿®é¥°çš„å˜é‡åœ¨ç¼–è¯‘åç±»ä¼¼äºjavaä¸­çš„ä¸­çš„å˜é‡è¢«finalä¿®é¥° lazyä¿®é¥°ç¬¦å¯ä»¥ä¿®é¥°å˜é‡ï¼Œä½†æ˜¯è¿™ä¸ªå˜é‡å¿…é¡»æ˜¯valä¿®é¥°çš„ ps. lazyç›¸å½“äºå»¶è¿ŸåŠ è½½ï¼ˆæ‡’åŠ è½½ï¼‰ï¼Œå½“å‰å˜é‡ä½¿ç”¨lazyä¿®é¥°çš„æ—¶å€™ï¼Œåªè¦å˜é‡ä¸è¢«è°ƒç”¨ï¼Œå°±ä¸ä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼Œä»€ä¹ˆæ—¶å€™è¿›è¡Œåˆå§‹åŒ– lazy val words = scala.io.Source.fromFile(\"/usr/share/dict/words\").mkString //å½“valè¢«å£°æ˜ä¸ºlazyæ—¶ï¼Œå®ƒçš„åˆå§‹åŒ–å°†è¢«æ¨è¿Ÿï¼Œç›´åˆ°æˆ‘ä»¬é¦–æ¬¡å¯¹ä»–å–å€¼ æ‡’å€¼å¯¹äºå¼€é”€å¤§çš„åˆå§‹åŒ–è¯­å¥ååˆ†æœ‰ç”¨ã€‚å®ƒè¿˜å¯ä»¥ç”¨æ¥åº”å¯¹å…¶ä»–åˆå§‹åŒ–é—®é¢˜ï¼Œæ¯”å¦‚å¾ªç¯ä¾èµ–ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ˜¯å¼€å‘æ‡’æ•°æ®ç»“æ„çš„åŸºç¡€ã€‚ val words = ... //åœ¨wordsè¢«å®šä¹‰æ—¶å³è¢«å–å€¼ lazy val words = ... //åœ¨wordsè¢«é¦–æ¬¡ä½¿ç”¨æ—¶å–å€¼ def words = ... //åœ¨æ¯ä¸€æ¬¡wordsè¢«ä½¿ç”¨æ—¶å–å€¼ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:2:2","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"3. Control and Function ifè¡¨è¾¾å¼ä¹Ÿæœ‰å€¼ å—ä¹Ÿæœ‰å€¼ï¼šæ˜¯å®ƒæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ Scalaçš„forå¾ªç¯å°±åƒæ˜¯â€œå¢å¼ºç‰ˆâ€çš„Java forå¾ªç¯ åˆ†å¥½åœ¨ç»å¤§æ•°æƒ…å†µä¸‹ä¸æ˜¯å¿…é¡»çš„ voidç±»å‹æ˜¯Unit é¿å…åœ¨å‡½æ•°ä½¿ç”¨return æ³¨æ„åˆ«å†å‡½æ•°å¼å®šä¹‰ä¸­ä½¿ç”¨return å¼‚å¸¸çš„å·¥ä½œæ–¹å¼å’ŒJavaæˆ–C++åŸºæœ¬ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ä½ åœ¨catchè¯­å¥ä¸­ä½¿ç”¨â€œæ¨¡å¼åŒ¹é…â€ Scalaæ²¡æœ‰å—æ£€å¼‚å¸¸ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:3:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"4. Array è‹¥é•¿åº¦å›ºå®šå¯ç”¨Arrayï¼Œè‹¥é•¿åº¦å¯èƒ½æœ‰å˜åŒ–åˆ™ä½¿ç”¨ArrayBuffer æä¾›åˆå§‹å€¼æ—¶ä¸è¦ä½¿ç”¨new ç”¨()æ¥è®¿é—®å…ƒç´  ç”¨for(elem \u003c- arr)æ¥éå†å…ƒç´  ç”¨for(elem \u003c- arr if â€¦) yield â€¦ æ¥å°†åŸæ•°æ®è½¬å‹ä¸ºæ–°æ•°ç»„ Scalaæ•°ç»„å’ŒJavaæ•°ç»„å¯ä»¥ç›¸äº’æ“ä½œï¼Œç”¨ArrayBufferï¼Œä½¿ç”¨scala.collection.JavaConversionsä¸­çš„è½¬æ¢å‡½æ•° ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:4:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"5. Map and Tuple Scalaæœ‰ååˆ†æ˜“ç”¨çš„è¯­æ³•æ¥åˆ›å»ºã€æŸ¥è¯¢å’Œéå†æ˜ å°„(Map) ä½ éœ€è¦ä»å¯å˜çš„å’Œä¸å¯å˜çš„æ˜ å°„ä¸­åšå‡ºé€‰æ‹© é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå“ˆå¸Œæ˜ å°„(Hash Map)ï¼Œä¸è¿‡ä½ ä¹Ÿå¯ä»¥æŒ‡æ˜è¦æ ‘å½¢æ˜ å°„ ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨Scalaæ˜ å°„å’ŒJavaæ˜ å°„ä¹‹é—´æ¥å›åˆ‡æ¢ å…ƒç»„å¯ä»¥ç”¨æ¥èšé›†å€¼ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:5:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"6. Class ç±»ä¸­çš„å­—æ®µè‡ªåŠ¨å¸¦æœ‰getteræ–¹æ³•å’Œsetteræ–¹æ³• å¯ä»¥ç”¨å®šåˆ¶çš„getter/setteræ–¹æ³•æ›¿æ¢æ‰å­—æ®µçš„å®šä¹‰ï¼Œè€Œä¸å¿…ä¿®æ”¹ä½¿ç”¨ç±»çš„å®¢æˆ·ç«¯â€”â€”è¿™å°±æ˜¯æ‰€è°“çš„â€œç»Ÿä¸€è®¿é—®åŸåˆ™â€ ç”¨@BeanPropertyæ³¨è§£æ¥ç”ŸæˆJavaBeansçš„get*/set*æ–¹æ³• æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªä¸»è¦çš„æ„é€ å™¨ï¼Œè¿™ä¸ªæ„é€ å™¨å’Œç±»å®šä¹‰\"äº¤ç»‡\"åœ¨ä¸€èµ·ã€‚å®ƒçš„å‚æ•°ç›´æ¥ä¸ºç±»çš„å­—æ®µã€‚ä¸»æ„é€ å™¨æ‰§è¡Œç±»ä½“ä¸­æ‰€æœ‰çš„è¯­å¥ è¾…åŠ©æ„é€ å™¨æ˜¯å¯é€‰çš„ã€‚ä»–ä»¬å«åšthis ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:6:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"7. Object å¯¹è±¡ä½œä¸ºå•ä¾‹æˆ–å­˜æ”¾å·¥å…·æ–¹æ³• ç±»å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªåŒåçš„ä¼´ç”Ÿå¯¹è±¡ å¯¹è±¡å¯ä»¥æ‰©å±•ç±»æˆ–ç‰¹è´¨ å¯¹è±¡çš„applyæ–¹æ³•é€šå¸¸ç”¨æ¥æ„é€ ä¼´ç”Ÿç±»çš„æ–°å®ä¾‹ å¦‚æœä¸æƒ³æ˜¾ç¤ºå®šä¹‰mainæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ‰©å±•Appç‰¹è´¨çš„å¯¹è±¡ å¯ä»¥é€šè¿‡æ‰©å±•Enumerationå¯¹è±¡æ¥å®ç°æšä¸¾ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:7:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"8. Package åŒ…ä¹Ÿå¯ä»¥åƒå†…éƒ¨ç±»é‚£æ ·åµŒå¥— åŒ…è·¯å¾„ä¸æ˜¯ç»å¯¹è·¯å¾„ åŒ…å£°æ˜é“¾x.y.zå¹¶ä¸è‡ªåŠ¨å°†ä¸­é—´åŒ…xå’Œx.yå˜æˆå¯è§ ä½äºæ–‡ä»¶é¡¶éƒ¨ä¸å¸¦èŠ±æ‹¬å·çš„åŒ…å£°æ˜åœ¨æ•´ä¸ªæ–‡ä»¶èŒƒå›´å†…æœ‰æ•ˆ åŒ…å¯¹è±¡å¯ä»¥æŒæœ‰å‡½æ•°å’Œå˜é‡ å¼•å…¥è¯­å¥å¯ä»¥å¼•å…¥åŒ…ã€ç±»å’Œå¯¹è±¡ å¼•å…¥è¯­å¥å¯ä»¥å‡ºç°åœ¨ä»»ä½•ä½ç½® å¼•å…¥è¯­å¥å¯ä»¥é‡å‘½åå’Œéšè—ç‰¹å®šæˆå‘˜ java.langã€scalaå’Œpredefæ€»æ˜¯è¢«å¼•å…¥ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:8:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"9. Extends extendsã€finalå…³é”®å­—å’ŒJavaä¸­ç›¸åŒ é‡å†™æ–¹æ³•æ—¶å¿…é¡»ç”¨override åªæœ‰ä¸»æ„é€ å™¨å¯ä»¥ç”¨è¶…ç±»çš„ä¸»æ„é€ å™¨ å¯ä»¥é‡å†™å­—æ®µ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:9:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"10. File\u0026Regex Source.fromFile(â€¦).getLines.toArrayå°†äº¤å‡ºæ–‡ä»¶çš„æ‰€æœ‰è¡Œ Source.fromFile(â€¦).mkStringå°†ä»¥å­—ç¬¦ä¸²å½¢å¼äº¤å‡ºæ–‡ä»¶å†…å®¹ å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼Œå¯ä»¥ç”¨toIntæˆ–toDoubleæ–¹æ³• ä½¿ç”¨Javaçš„PrintWriteræ¥å†™å…¥æ–‡æœ¬æ–‡ä»¶ â€œæ­£åˆ™â€.ræ˜¯ä¸€ä¸ªRegexå¯¹è±¡ å¦‚æœä½ çš„æ­£åˆ™è¡¨è¾¾å¼åŒ…å«åæ–œæ çš„è¯ï¼Œç”¨\"\"\"â€¦\"\"\" å¦‚æœæ­£åˆ™æ¨¡å¼åŒ…å«åˆ†ç»„ï¼Œä½ å¯ä»¥ç”¨å¦‚ä¸‹è¯­æ³•æ¥æå–å®ƒä»¬çš„å†…å®¹for(regex(å˜é‡1,â€¦,å˜é‡n) \u003c- å­—ç¬¦ä¸²) ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:10:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"11. Feature ç±»å¯ä»¥å®ç°ä»»æ„æ•°é‡çš„ç‰¹è´¨ ç‰¹è´¨å¯ä»¥è¦æ±‚å®ç°å®ƒä»¬çš„ç±»å…·å¤‡ç‰¹å®šçš„å­—æ®µã€æ–¹æ³•æˆ–è¶…ç±» å’ŒJavaæ¥å£ä¸åŒï¼ŒScalaç‰¹è´¨å¯ä»¥æä¾›æ–¹æ³•å’Œå­—æ®µçš„å®ç° å½“å°†å¤šä¸ªç‰¹è´¨å åŠ åœ¨ä¸€èµ·æ—¶ï¼Œé¡ºåºå¾ˆé‡è¦â€”â€”å…¶æ–¹æ³•å…ˆè¢«æ‰§è¡Œå•Šçš„ç‰¹è´¨æ’åœ¨æ›´åé¢ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:11:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"12. Advanced function å‡½æ•°å¯ä»¥ç›´æ¥èµ‹å€¼ç»™å˜é‡ï¼Œå°±å’Œæ•°å­—ä¸€æ · å¯ä»¥åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œé€šå¸¸è¿˜ä¼šæŠŠå®ƒä»¬äº¤ç»™å…¶ä»–å‡½æ•° å‡½æ•°å‚æ•°å¯ä»¥ç»™å‡ºéœ€è¦ç¨åæ‰§è¡Œçš„è¡Œä¸º è®¸å¤šé›†åˆæ–¹æ³•éƒ½æ¥å—å‡½æ•°å‚æ•°ï¼Œå°†å‡½æ•°åº”ç”¨åˆ°é›†åˆä¸­çš„å€¼ æœ‰å¾ˆå¤šè¯­æ³•ä¸Šçš„ç®€å†™è®©ä½ ä»¥ç®€çŸ­ä¸”æ˜“è¯»çš„æ–¹å¼è¡¨è¾¾å‡½æ•°å‚æ•° å¯ä»¥åˆ›å»ºæ“ä½œä»£ç å—çš„å‡½æ•°ï¼Œå®ƒä»¬çœ‹ä¸Šå»å°±åƒæ˜¯å†…å»ºçš„æ§åˆ¶è¯­å¥ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:12:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"13. Collection æ‰€æœ‰é›†åˆéƒ½æ‰©å±•è‡ªIterableç‰¹è´¨ é›†åˆæœ‰ä¸‰å¤§ç±»ï¼Œåˆ†åˆ«ä¸ºåºåˆ—ã€é›†åˆæ˜ å°„ å¯¹äºå‡ ä¹æ‰€æœ‰é›†åˆç±»ï¼ŒScalaéƒ½åŒæ—¶æä¾›äº†å¯å˜çš„å’Œä¸å¯å˜çš„ç‰ˆæœ¬ Scalaåˆ—è¡¨è¦ä¹ˆæ˜¯ç©ºçš„ï¼Œè¦ä¹ˆæ‹¥æœ‰ä¸€å¤´ä¸€å°¾ï¼Œå…¶ä¸­å°¾éƒ¨æœ¬èº«åˆæ˜¯ä¸€ä¸ªåˆ—è¡¨ é›†æ˜¯æ— å…ˆåæ¬¡åºçš„é›†åˆ ç”¨LinkedHashSetä¿ç•™æ’å…¥é¡ºåºï¼Œæˆ–è€…ç”¨SortedSetæŒ‰é¡ºåºè¿›è¡Œè¿­ä»£ +å°†å…ƒç´ æ·»åŠ åˆ°æ— å…ˆåæ¬¡åºçš„é›†åˆä¸­ï¼›+:å’Œ:+å‘å‰æˆ–å‘åè¿½åŠ åˆ°åºåˆ—ï¼›++å°†ä¸¤ä¸ªé›†åˆä¸²æ¥åœ¨ä¸€èµ·ï¼›-å’Œâ€“ç§»é™¤å…ƒç´  æ˜ å°„ã€æŠ˜å å’Œæ‹‰é“¾æ“ä½œæ˜¯å¾ˆæœ‰ç”¨çš„æŠ€å·§ï¼Œç”¨æ¥å°†å‡½æ•°æˆ–æ“ä½œåº”ç”¨åˆ°é›†åˆä¸­çš„å…ƒç´  ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:13:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"14. Pattern match matchè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæ›´å¥½çš„switchï¼Œä¸ä¼šæœ‰æ„å¤–æ‰å…¥ä¸‹ä¸€ä¸ªåˆ†æ”¯çš„é—®é¢˜ å¦‚æœæ²¡æœ‰æ¨¡å¼èƒ½å¤ŸåŒ¹é…ï¼Œä¼šæŠ›å‡ºMatchErrorã€‚å¯ä»¥ç”¨case _æ¨¡å¼æ¥é¿å… æ¨¡å¼å¯ä»¥åŒ…å«ä¸€ä¸ªéšæ„å®šä¹‰çš„æ¡ä»¶ï¼Œç§°ä½œå®ˆå«ï¼ˆguardï¼‰ å¯ä»¥å¯¹è¡¨è¾¾å¼çš„ç±»å‹è¿›è¡ŒåŒ¹é…ï¼›ä¼˜å…ˆé€‰æ‹©æ¨¡å¼åŒ¹é…è€Œä¸æ˜¯isInstanceOf/asInstanceOf å¯ä»¥åŒ¹é…æ•°ç»„ã€å…ƒç»„å’Œæ ·ä¾‹ç±»çš„æ¨¡å¼ï¼Œç„¶åå°†åŒ¹é…åˆ°çš„ä¸åŒéƒ¨åˆ†ç»‘å®šåˆ°å˜é‡ åœ¨forè¡¨è¾¾å¼ä¸­ï¼Œä¸èƒ½åŒ¹é…çš„æƒ…å†µä¼šè¢«å®‰é™åœ°è·³è¿‡ æ ·ä¾‹ç±»æ˜¯æ˜¯ç¼–è¯‘å™¨ä¼šä¸ºä¹‹è‡ªåŠ¨äº§å‡ºæ¨¡å¼åŒ¹é…æ‰€éœ€è¦çš„æ–¹æ³•çš„ç±» æ ·ä¾‹ç±»ç»§æ‰¿å±‚çº§ä¸­çš„å…¬å…±è¶…ç±»åº”è¯¥æ˜¯sealedçš„ ç”¨Optionæ¥å­˜æ”¾å¯¹äºå¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨çš„å€¼â€”â€”æ¯”nullæ›´å®‰å…¨ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:14:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"15. Annotation å¯ä»¥ä¸ºç±»ã€æ–¹æ³•ã€å­—æ®µã€å±€éƒ¨å˜é‡ã€å‚æ•°ã€è¡¨è¾¾å¼ã€ç±»å‹å‚æ•°ä»¥åŠå„ç§ç±»å‹å®šä¹‰æ·»åŠ æ³¨è§£ å¯¹äºè¡¨è¾¾å¼å’Œç±»å‹ï¼Œæ³¨è§£è·Ÿåœ¨è¢«æ³¨è§£çš„æ¡ç›®ä¹‹å æ³¨è§£çš„å½¢å¼æœ‰ @Annotationã€@Annotation(value)æˆ–@Annotation(name = value1, â€¦) @volatileã€@transientã€@strictfpå’Œ@nativeåˆ†åˆ«ç”Ÿæˆç­‰æ•ˆçš„Javaä¿®é¥°ç¬¦ ç”¨@throwsæ¥ç”Ÿæˆä¸Javaå…¼å®¹çš„throwsè§„æ ¼è¯´æ˜ @tailrecæ³¨è§£è®©ä½ æ ¡éªŒæŸä¸ªé€’å½’å‡½æ•°ä½¿ç”¨äº†å°¾é€’å½’ä¼˜åŒ– assertå‡½æ•°åˆ©ç”¨äº†@elidableæ³¨è§£ã€‚ä½ å¯ä»¥é€‰æ‹©ä»Scalaç¨‹åºä¸­ç§»é™¤æ‰€æœ‰æ–­è¨€ ç”¨@deprecatedæ³¨è§£æ¥æ ‡è®°å·²è¿‡æ—¶çš„ç‰¹æ€§ ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:15:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"16. XML XMLå­—é¢é‡thisçš„ç±»å‹ä¸ºNodeSeq å¯ä»¥åœ¨XMLé‡Œå­—é¢é‡ä¸­åµŒå¥—Scalaä»£ç  Nodeçš„childå±æ€§äº¤å‡ºçš„æ˜¯å­èŠ‚ç‚¹ Nodeçš„attributeså±æ€§äº¤å‡ºçš„æ˜¯åŒ…å«èŠ‚ç‚¹å±æ€§çš„MetaDataå¯¹è±¡ \\å’Œ\\æ“ä½œç¬¦æ‰§è¡Œç±»XPathåŒ¹é… ","date":"2020-02-08","objectID":"/20200208_scalaintroduction/:16:0","tags":["Scala","Java"],"title":"Scala Introduction","uri":"/20200208_scalaintroduction/"},{"categories":["Technology"],"content":"Article description.","date":"2020-01-22","objectID":"/20200122_java-static/","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"The static keyword can be used for variables, methods, code blocks, and inner classes to indicate that a particular member belongs only to a class itself, and not to an object of that class. ","date":"2020-01-22","objectID":"/20200122_java-static/:0:0","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"1. Static Variable é™æ€å˜é‡ä¹Ÿå«ç±»å˜é‡ï¼Œå®ƒå±äºä¸€ä¸ªç±»ï¼Œè€Œä¸æ˜¯è¿™ä¸ªç±»çš„å¯¹è±¡ã€‚ public class Writer { private String name; private int age; public static int countOfWriters; public Writer(String name, int age) { this.name = name; this.age = age; countOfWriters++; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } } å…¶ä¸­ï¼ŒcountOfWriters è¢«ç§°ä¸ºé™æ€å˜é‡ï¼Œå®ƒæœ‰åˆ«äº name å’Œ age è¿™ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œå› ä¸ºå®ƒå‰é¢å¤šäº†ä¸€ä¸ªä¿®é¥°ç¬¦ staticã€‚ è¿™æ„å‘³ç€æ— è®ºè¿™ä¸ªç±»è¢«åˆå§‹åŒ–å¤šå°‘æ¬¡ï¼Œé™æ€å˜é‡çš„å€¼éƒ½ä¼šåœ¨æ‰€æœ‰ç±»çš„å¯¹è±¡ä¸­å…±äº«ã€‚ Writer w1 = new Writer(\"æ²‰é»˜ç‹äºŒ\",18); Writer w2 = new Writer(\"æ²‰é»˜ç‹ä¸‰\",16); System.out.println(Writer.countOfWriters); æŒ‰ç…§ä¸Šé¢çš„é€»è¾‘ï¼Œä½ åº”è¯¥èƒ½æ¨ç†å¾—å‡ºï¼ŒcountOfWriters çš„å€¼æ­¤æ—¶åº”è¯¥ä¸º 2 è€Œä¸æ˜¯ 1ã€‚ä»å†…å­˜çš„è§’åº¦æ¥çœ‹ï¼Œé™æ€å˜é‡å°†ä¼šå­˜å‚¨åœ¨ Java è™šæ‹Ÿæœºä¸­ä¸€ä¸ªåå«â€œMetaspaceâ€ï¼ˆå…ƒç©ºé—´ï¼ŒJava 8 ä¹‹åï¼‰çš„ç‰¹å®šæ± ä¸­ã€‚ é™æ€å˜é‡å’Œæˆå‘˜å˜é‡æœ‰ç€å¾ˆå¤§çš„ä¸åŒï¼Œæˆå‘˜å˜é‡çš„å€¼å±äºæŸä¸ªå¯¹è±¡ï¼Œä¸åŒçš„å¯¹è±¡ä¹‹é—´ï¼Œå€¼æ˜¯ä¸å…±äº«çš„ï¼›ä½†é™æ€å˜é‡ä¸æ˜¯çš„ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç»Ÿè®¡å¯¹è±¡çš„æ•°é‡ï¼Œå› ä¸ºå®ƒæ˜¯å…±äº«çš„ã€‚å°±åƒä¸Šé¢ä¾‹å­ä¸­çš„ countOfWritersï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒçš„å€¼ä¸º 1ï¼Œåˆ›å»ºä¸¤ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒçš„å€¼å°±ä¸º 2ã€‚ Summary: ç”±äºé™æ€å˜é‡å±äºä¸€ä¸ªç±»ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡å¯¹è±¡å¼•ç”¨æ¥è®¿é—®ï¼Œè€Œåº”è¯¥ç›´æ¥é€šè¿‡ç±»åæ¥è®¿é—®ï¼› w1.countOfWriters #ä¸åº”è¯¥é€šè¿‡ç±»å®ä¾‹è®¿é—®é™æ€æˆå‘˜ ä¸éœ€è¦åˆå§‹åŒ–ç±»å°±å¯ä»¥è®¿é—®é™æ€å˜é‡ã€‚ public static void main(String[] args) { System.out.println(Writer.countOfWriters); // è¾“å‡º 0 } ","date":"2020-01-22","objectID":"/20200122_java-static/:1:0","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"2. Static Method é™æ€æ–¹æ³•ä¹Ÿå«ç±»æ–¹æ³•ï¼Œå®ƒå’Œé™æ€å˜é‡ç±»ä¼¼ï¼Œå±äºä¸€ä¸ªç±»ï¼Œè€Œä¸æ˜¯è¿™ä¸ªç±»çš„å¯¹è±¡ã€‚ public static void setCountOfWriters(int countOfWriters) { Writer.countOfWriters = countOfWriters; } setCountOfWriters() å°±æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒç”± static å…³é”®å­—ä¿®é¥°ã€‚ å¦‚æœä½ ç”¨è¿‡ java.lang.Math ç±»æˆ–è€… Apache çš„ä¸€äº›å·¥å…·ç±»ï¼ˆæ¯”å¦‚è¯´ StringUtilsï¼‰çš„è¯ï¼Œå¯¹é™æ€æ–¹æ³•ä¸€å®šä¸ä¼šæ„ŸåŠ¨é™Œç”Ÿã€‚ Math ç±»çš„å‡ ä¹æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è°ƒç”¨ï¼Œä¸éœ€è¦åˆ›å»ºç±»çš„å¯¹è±¡ã€‚ Math. random() abs(int a) sin(double a) cos(double a) ... Summary: Java ä¸­çš„é™æ€æ–¹æ³•åœ¨ç¼–è¯‘æ—¶è§£æï¼Œå› ä¸ºé™æ€æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼ˆæ–¹æ³•é‡å†™å‘ç”Ÿåœ¨è¿è¡Œæ—¶é˜¶æ®µï¼Œä¸ºäº†å¤šæ€ï¼‰ã€‚ æŠ½è±¡æ–¹æ³•ä¸èƒ½æ˜¯é™æ€çš„ã€‚ static abstract void paly(); #ä¿®é¥°ç¬¦abstract å’Œ staticçš„ç»„åˆéæ³• é™æ€æ–¹æ³•ä¸èƒ½ä½¿ç”¨ this å’Œ super å…³é”®å­—ã€‚ æˆå‘˜æ–¹æ³•å¯ä»¥ç›´æ¥è®¿é—®å…¶ä»–æˆå‘˜æ–¹æ³•å’Œæˆå‘˜å˜é‡ã€‚ æˆå‘˜æ–¹æ³•ä¹Ÿå¯ä»¥ç›´æ¥æ–¹æ³•é™æ€æ–¹æ³•å’Œé™æ€å˜é‡ã€‚ é™æ€æ–¹æ³•å¯ä»¥è®¿é—®æ‰€æœ‰å…¶ä»–é™æ€æ–¹æ³•å’Œé™æ€å˜é‡ã€‚ é™æ€æ–¹æ³•æ— æ³•ç›´æ¥è®¿é—®æˆå‘˜æ–¹æ³•å’Œæˆå‘˜å˜é‡ã€‚ ","date":"2020-01-22","objectID":"/20200122_java-static/:2:0","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"3. Static Code Block é™æ€ä»£ç å—å¯ä»¥ç”¨æ¥åˆå§‹åŒ–é™æ€å˜é‡ï¼Œå°½ç®¡é™æ€æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨å£°æ˜çš„æ—¶å€™ç›´æ¥åˆå§‹åŒ–ï¼Œä½†æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¤šè¡Œä»£ç æ¥å®Œæˆåˆå§‹åŒ–ã€‚ public class StaticBlockDemo { public static List\u003cString\u003e writes = new ArrayList\u003c\u003e(); static { writes.add(\"a\"); writes.add(\"b\"); writes.add(\"c\"); System.out.println(\"ç¬¬ä¸€å—\"); } static { writes.add(\"d\"); writes.add(\"e\"); System.out.println(\"ç¬¬äºŒå—\"); } } writes æ˜¯ä¸€ä¸ªé™æ€çš„ ArrayListï¼Œæ‰€ä»¥ä¸å¤ªå¯èƒ½åœ¨å£°æ˜çš„æ—¶å€™å®Œæˆåˆå§‹åŒ–ï¼Œå› æ­¤éœ€è¦åœ¨é™æ€ä»£ç å—ä¸­å®Œæˆåˆå§‹åŒ–ã€‚ Summary: ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªé™æ€ä»£ç å—ã€‚ é™æ€ä»£ç å—çš„è§£æå’Œæ‰§è¡Œé¡ºåºå’Œå®ƒåœ¨ç±»ä¸­çš„ä½ç½®ä¿æŒä¸€è‡´ã€‚ä¸ºäº†éªŒè¯è¿™ä¸ªç»“è®ºï¼Œå¯ä»¥åœ¨ StaticBlockDemo ç±»ä¸­åŠ å…¥ç©ºçš„ main æ–¹æ³•ï¼Œæ‰§è¡Œå®Œçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š ç¬¬ä¸€å— ç¬¬äºŒå— ","date":"2020-01-22","objectID":"/20200122_java-static/:3:0","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"4. Static Inner Class Java å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªç±»ä¸­å£°æ˜ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ƒæä¾›äº†ä¸€ç§ä»¤äººä¿¡æœçš„æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬åªåœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨ä¸€äº›å˜é‡ï¼Œä½¿ä»£ç æ›´å…·æœ‰æ¡ç†æ€§å’Œå¯è¯»æ€§ã€‚ å¸¸è§çš„å†…éƒ¨ç±»æœ‰å››ç§ï¼Œæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»ã€‚ é™æ€å†…éƒ¨ç±»ï¼š public class Singleton { private Singleton() {} private static class SingletonHolder { public static final Singleton instance = new Singleton(); } public static Singleton getInstance() { return SingletonHolder.instance; } } ä»¥ä¸Šè¿™æ®µä»£ç æ˜¯ä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰ï¼Œå¯¹ï¼Œè¿™å°±æ˜¯åˆ›å»ºå•ä¾‹çš„ä¸€ç§æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡åŠ è½½ Singleton ç±»æ—¶å¹¶ä¸ä¼šåˆå§‹åŒ– instanceï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨ getInstance() æ–¹æ³•æ—¶ Java è™šæ‹Ÿæœºæ‰å¼€å§‹åŠ è½½ SingletonHolder å¹¶åˆå§‹åŒ– instanceï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ä¹Ÿèƒ½ä¿è¯ Singleton ç±»çš„å”¯ä¸€æ€§ã€‚ä¸è¿‡ï¼Œåˆ›å»ºå•ä¾‹æ›´ä¼˜é›…çš„ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨æšä¸¾ã€‚ Summary: é™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬ç§æœ‰å˜é‡ã€‚ å¤–éƒ¨ç±»ä¸èƒ½å£°æ˜ä¸º staticã€‚ ","date":"2020-01-22","objectID":"/20200122_java-static/:4:0","tags":["Java"],"title":"Static Keyword in Java","uri":"/20200122_java-static/"},{"categories":["Technology"],"content":"Article description.","date":"2020-01-14","objectID":"/20200114_leetcode/","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Algorithms are used in every part of computer science. They form the fieldâ€™s backbone. In computer science, an algorithm gives the computer a specific set of instructions, which allows the computer to do everything, be it running a calculator or running a rocket. å¼‚æˆ–è¿ç®— ç‰¹ç‚¹ï¼š ä¸è‡ªå·±å¼‚æˆ–ç­‰äº0ï¼Œä¸0å¼‚æˆ–ç­‰äºè‡ªå·± éµå¾ªäº¤æ¢å¾‹å’Œç»“åˆå¾‹ ä¾‹ï¼š //1.ä¸¤æ•°äº¤æ¢ï¼š arr[i] = arr[i] ^ arr[j]; // a = a ^ b arr[j] = arr[i] ^ arr[j]; // b = (a ^ b) ^ b = a arr[i] = arr[i] ^ arr[j]; // a = (a ^ b) ^ a = b //2.æ•°ç»„ä¸­æœ‰ä¸€ä¸ªå‡ºç°å¥‡æ•°æ¬¡çš„æ•° int eor = 0; for(int cur : arr){ eor ^= cur; //[a,a,b,b,c,c,c] =\u003e a^a^b^b^c^c^c = c } System.out.println(eor); //3.æ•°ç»„ä¸­æœ‰ä¸¤ä¸ªå‡ºç°å¥‡æ•°æ¬¡çš„æ•° int eor = 0; for(int cur : arr){ eor ^= cur; //[a,a,b,b,b,c,c,c] =\u003e a^a^b^b^b^c^c^c = b^c } //eor = b ^ c //eor != 0 //eorå¿…ç„¶æœ‰ä¸ªä¸€ä½ç½®ä¸Šæ˜¯1, è¯´æ˜è¿™ä¸ªä½ç½®ä¸Šbå’Œcä¸åŒ int rightOne = eor \u0026 (~eor + 1); //ï¼ˆå–å + 1ï¼‰ \u0026 è‡ªå·± = æå–å‡ºåªä¿ç•™æœ€å³ä¾§çš„1 int result1 = 0; for(int cur : arr){ if((cur \u0026 rightOne) == 0){ //å·²çŸ¥åœ¨rightOneè¿™ä¸ªä½ç½®ä¸Šbå’Œcä¸åŒï¼Œé€šè¿‡(\u0026 rightOne)æŠŠbå’ŒcåŒºåˆ†å¼€,åˆ«çš„æ•°æ˜¯å¶æ•°ä¸ªï¼Œå¼‚æˆ–èµ·æ¥æ˜¯0ä¸åŒç®¡ result1 ^= cur; //è¿™æ ·result1æ˜¯bæˆ–è€…c } } int result2 = eor ^ result1; ","date":"2020-01-14","objectID":"/20200114_leetcode/:0:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ’åº å†’æ³¡æ’åº bubble_sort é€‰æ‹©æ’åº select_sort ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ’å…¥æ’åº insert-sort æ¦‚å¿µï¼š å°†åéƒ¨åˆ†çš„æ•°æ®(ä»ç¬¬äºŒå¼€å§‹)æŒ‰ç…§ä¸€å®šçš„é¡ºåºä¸€ä¸ªä¸€ä¸ªçš„æ’å…¥åˆ°å‰éƒ¨åˆ†æœ‰åºçš„è¡¨ä¸­ æ—¶é—´å¤æ‚åº¦ï¼šO(N^2) é¢å¤–ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ•°æ®çŠ¶å†µä¸åŒï¼Œæ—¶é—´å¤æ‚åº¦ä¸åŒ: æ—¶é—´å¤æ‚åº¦æ˜¯æŒ‰ç…§æœ€å·®æƒ…å†µè€ƒè™‘ public static void insertionSort(int[] arr) { if (arr == null || arr.length \u003c 2){ return; } for (int i = 1; i \u003c arr.length; i++){ for(int j = i - 1; j \u003e= 0 \u0026\u0026 arr[j] \u003e arr[j+1]; j--){ swap(arr, j, j+1); } } } public static void swap(int[] arr, int i, int j){ arr[i] = arr[i] ^ arr[j]; arr[j] = arr[i] ^ arr[j]; arr[i] = arr[i] ^ arr[j]; } é€’å½’ public static int getMax(int[] arr){ return process(arr, 0, arr.length - 1); } public static int process(int[] arr, int L, int R){ if(L == R){ return arr[L]; } int mid = L + ((R - L) \u003e\u003e 1); int leftMax = process(arr, L, mid); int rightMax = process(arr, mid + 1, R); return Math.max(leftMax, rightMax); } é€’å½’æ—¶é—´å¤æ‚åº¦ä¼°ç®— Masterå…¬å¼ï¼š T(N) = a * T (N / b) + 0 (N ^ d) log(b, a) \u003e d, åˆ™å¤æ‚åº¦ä¸ºO(N ^ log(b, a)) log(b, a) = d, åˆ™å¤æ‚åº¦ä¸ºO(N ^ d * logN) log(b, a) \u003c d, åˆ™å¤æ‚åº¦ä¸ºO(N ^ d) ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å½’å¹¶æ’åº merge-sort æ¦‚å¿µï¼šå°†nä¸ªå…ƒç´ åˆ†æˆä¸ªå«n/2ä¸ªå…ƒç´ çš„å­åºåˆ—ï¼Œç”¨åˆå¹¶æ’åºæ³•å¯¹ä¸¤ä¸ªå­åºåˆ—é€’å½’çš„æ’åºï¼Œåˆå¹¶ä¸¤ä¸ªå·²æ’åºçš„å­åºåˆ—å·²å¾—åˆ°æ’åºç»“æœã€‚ æ—¶é—´å¤æ‚åº¦ï¼šä½¿ç”¨Masterå…¬å¼ï¼š T(N) = NlogN ä»£ç å®ç°ï¼š public static void process(int[] arr, int L, int R){ if(L == R){ return; } int mid = L + ((R - L) \u003e\u003e 1); process(arr, L, mid); process(arr, mid + 1, R); merge(arr, L, mid, R); } public static void merge(int[] arr, int L, int M, int R){ int[] extra = new int[R - L + 1]; int i = 0; int p1 = L; int p2 = M + 1; while(p1 \u003c= M \u0026\u0026 p2 \u003c= R){ extra[i++] = arr[p1] \u003c= arr[p2] ? arr[p1++]: arr[p2++]; } while(p1 \u003c= M){ extra[i++] = arr[p1++]; } while(p2 \u003c= R){ extra[i++] = arr[p2++]; } for(i = 0; i \u003c extra.length; i++){ arr[L + i] = extra[i]; } } å°å’Œé—®é¢˜ã€é€†åºå¯¹é—®é¢˜ [1, 3, 4, 2, 5] çš„å°å’Œæ˜¯ 0 + 1 + 4 + 1 +10 = 16ï¼ˆ åœ¨ä¸€ä¸ªæ•°ç»„ä¸­,æ¯ä¸€ä¸ªæ•°å·¦è¾¹æ¯”å½“å‰æ•°å°çš„æ•°ç´¯åŠ èµ·æ¥,å«åšè¿™ä¸ªæ•°ç»„çš„å°å’Œã€‚ï¼‰ å½’å¹¶æ’åºæ€è·¯ï¼Œç›®çš„å°±æ˜¯å‡å°‘å¯¹æ¯”æ¬¡æ•°ã€‚å¢åŠ ä¸€ä¸ªå¤–éƒ¨ç©ºé—´ï¼Œè®°å½•åœ¨ä¸€æ¬¡mergeä¸­çš„å°å’Œã€‚ public static int process(int[] arr, int l, int r){ if (l == r){ return 0; } int mid = 1 + ((r - l) \u003e\u003e 1); return process(arr, 1 , mid) + process(arr, mid + 1 , r) + merge(arr, 1 , mid, r); } public static void merge(int[] arr, int L, int mid, int R){ int[] extr = new int[R - L + 1]; int i = 0; int p1 = L;1 int p2 = M + 1; int res = 0; while(p1 \u003c= M \u0026\u0026 p2 \u003c= R){ res += arr[p1] \u003c arr[p2] ? (r - p2 + 1) * arr[p1] : 0 extr[i++] = arr[p1] \u003c arr[p2] ? arr[p1++]: arr[p2++]; } while(p1 \u003c= M){ extr[i++] = arr[p1++]; } while(p2 \u003c= R){ extr[i++] = arr[p2++]; } for(i = 0; i \u003c extra.length; i++){ arr[L + i] = extra[i]; } return res; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å¿«é€Ÿæ’åº quick_sort æ—¶é—´å¤æ‚åº¦ï¼šO(NlogN)ï¼Œå› ä¸ºæœ‰éšæœºæ¦‚ç‡è¡Œä¸ºï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºæœŸæœ›å€¼ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logN) è·å…°å›½æ——é—®é¢˜ é—®é¢˜1ï¼šç»™ä¸€ä¸ª arr å’Œ numï¼Œè¦æ±‚æŠŠå°äºç­‰numçš„æ•°æ”¾å·¦ï¼Œå¤§äºnumæ”¾å³ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œç©ºé—´ä¸ºO(1) é—®é¢˜2ï¼šç»™ä¸€ä¸ª arr å’Œ numï¼Œè¦æ±‚æŠŠå°äºç­‰numçš„æ•°æ”¾å·¦ï¼Œç­‰äºæ”¾ä¸­é—´ï¼Œå¤§äºnumæ”¾å³ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œç©ºé—´ä¸ºO(1) public static void quickSort(int[] arr, int L, int R){ if(L \u003c R){ swap(arr, L + (int)(Math.random() * (R - L + 1)), R);//éšæœºé€‰ä¸€ä¸ªæ•°å’Œæœ€åä½ç½®äº¤æ¢ int[] p = partition(arr, L, R);//=åŒºåŸŸçš„å·¦å³è¾¹ç•Œ quickSort(arr, L, p[0] - 1); quickSort(arr, p[1] + 1, R); } } public static int[] partition(int[] arr, int L, int R){ int less = L - 1;// \u003cåŒºåŸŸçš„å³è¾¹ç•Œ int more = R; //\u003eåŒºçš„å·¦è¾¹ç•Œ while(L \u003c more){ // Lè¡¨ç¤ºå½“å‰æ•°çš„ä½ç½® if(arr[L] \u003c arr[R]){ swap(arr, ++less, L++); }else if(arr[L] \u003e arr[R]){ swap(arr, --more, L); }else{ L++; } } swap(arr, more, R); return new int[]{ less + 1, more }; } private static void swap(int[] arr, int i, int j) { if(i != j){ arr[i] = arr[i] ^ arr[j]; arr[j] = arr[i] ^ arr[j]; arr[i] = arr[i] ^ arr[j]; } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å †æ’åº heap_sort æ—¶é—´å¤æ‚åº¦ï¼šO(NlogN) å¤§æ ¹å †ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ï¼ˆæœ€åä¸€å±‚çš„ç»“ç‚¹éƒ½è¿ç»­é›†ä¸­åœ¨æœ€å·¦è¾¹ï¼Œå…¶ä½™å±‚æ»¡èŠ‚ç‚¹ï¼‰çš„å‰æä¸‹ï¼Œæ¯ä¸€æ£µå­æ ‘çš„æœ€å¤§å€¼æ˜¯å¤´ç»“ç‚¹çš„æ•°ã€‚ å°æ ¹å †ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ï¼ˆæœ€åä¸€å±‚çš„ç»“ç‚¹éƒ½è¿ç»­é›†ä¸­åœ¨æœ€å·¦è¾¹ï¼Œå…¶ä½™å±‚æ»¡èŠ‚ç‚¹ï¼‰çš„å‰æä¸‹ï¼Œæ¯ä¸€æ£µå­æ ‘çš„æœ€å°å€¼æ˜¯å¤´ç»“ç‚¹çš„æ•°ã€‚ ä¼˜å…ˆçº§é˜Ÿåˆ—ç»“æ„ï¼Œå°±æ˜¯å †ç»“æ„ //å¤„åœ¨indexä½ç½®ä¸Šçš„æ•°ï¼Œå¾€ä¸Šç»§ç»­ç§»åŠ¨ public static void heapInsert(int[] arr, int index){ while(arr[index] \u003e arr[(index - 1) / 2]) { swap(arr, index, (index - 1) / 2); index = (index - 1) / 2; } } è¿”å›æœ€å¤§å€¼ï¼ˆarr[0]ä¸Šçš„æ•°ï¼‰ï¼Œå¹¶åˆ é™¤æœ€å¤§å€¼ï¼š è¿”å›æ ¹èŠ‚ç‚¹ã€‚ æŠŠ arr[heapSize] çš„æ•°æ”¾åˆ°æ ¹èŠ‚ç‚¹ã€‚ heapSizeâ€“ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹å³ä¸å †æ–­è¿ã€‚ while å¾ªç¯ï¼Œä¸å­èŠ‚ç‚¹æ¯”è¾ƒï¼Œå°åˆ™æ›¿æ¢ï¼Œç›´åˆ°æ»¡è¶³å¤§æ ¹å †ã€‚ // å¤„åœ¨indexä½ç½®ä¸Šçš„æ•°ï¼Œå¾€ä¸‹ç»§ç»­ç§»åŠ¨ public static void heapify(int[] arr, int index, int heapSize){ int left = index * 2 + 1; //èŠ‚ç‚¹å·¦å­©å­ä¸‹æ ‡ while(left \u003c heapSize){ //åˆ¤æ–­ä¸‹æ–¹æ˜¯å¦æœ‰å­©å­ //ä¸¤ä¸ªå­©å­ä¸­ï¼Œè°çš„å€¼å¤§ï¼ŒæŠŠä¸‹æ ‡ç»™æœ€å¤§çš„ int largest = left + 1 \u003c heapSize \u0026\u0026 arr[left + 1] \u003e arr[left] ? left + 1 : left; //èŠ‚ç‚¹ä¸å­©å­æ¯”è¾ƒï¼Œè°çš„å€¼å¤§ï¼ŒæŠŠä¸‹æ ‡ç»™æœ€å¤§çš„ largest = arr[largest] \u003e arr[index] ? largest : index; if(largest == index){ break; } swap(arr, largest, index); index = largest; left = index * 2 + 1; } } HeapSort public static void heapSort(int[] arr){ if(arr == null || arr.length \u003c 2){ return; } for(int i = 0; i \u003c arr.length; i++){ heapInsert(arr, i);//æ•°ç»„æ•´ä½“èŒƒå›´å˜æˆå¤§æ ¹å † } int heapSize = arr.length; swap(arr, 0, --heapSize);//å¤§æ ¹å †çš„root(æœ€å¤§å€¼)æ”¾åˆ°arræœ€å while(heapSize \u003e 0){ heapify(arr, 0, heapSize); swap(arr, 0, --heapSize); } } ä¸€ä¸ªæ•°ç»„å¦‚æœæŠŠå®ƒæ’å¥½åºçš„è¯ï¼Œæ¯ä¸ªå…ƒç´ ç§»åŠ¨çš„è·ç¦»ä¸è¶…è¿‡kï¼Œkç›¸å¯¹äºæ•°ç»„é•¿åº¦æ¯”è¾ƒå°ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ’åºç®—æ³•æ’åº æ–¹æ³•ï¼š æœ€å°å †æ’æ–¹æ³•ï¼Œå…ˆå–å‡ºå‰kä¸ªæ•°å­—ç»„æˆæœ€å°å †ï¼Œæ ¹ä½ç½®ä¸º0ä½ç½®ä¸Šçš„æ•°ï¼›æ·»åŠ ä¸€ä¸ªæ•°ï¼Œå †åŒ–ï¼Œæ ¹ä½ç½®ä¸ºç¬¬äºŒä¸ªä½ç½®ä¸Šçš„æ•°ã€‚ä»¥æ­¤ç±»æ¨ PriorityQueue\u003cInteger\u003e heap = new PriorityQueue\u003c\u003e();//ä¼˜å…ˆçº§é˜Ÿåˆ—ç»“æ„ï¼Œå°±æ˜¯å †ç»“æ„ æ‰©å®¹æ–¹å¼ï¼šåŒå€æ‰©å®¹ public void sortedArrDistanceLessK(int[] arr, int k){ PriorityQueue\u003cInteger\u003e heap = new PriorityQueue\u003c\u003e();//é»˜è®¤å°æ ¹å † int index = 0; for(; index \u003c= Math.min(arr.length, k); index++){//ç”Ÿæˆå‰kä¸ªæ•°çš„æœ€å°å † heap.add(arr[index]); } int i = 0; for(;index \u003c arr.length; i++, index++){//å¼¹ä¸€ä¸ªï¼Œæ”¾å…¥ä¸€ä¸ª heap.add(arr[index]); arr[i] = heap.poll(); } while(!heap.isEmpty()){ arr[i++] = heap.poll(); } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ¡¶æ’åº è®¡æ•°æ’åºï¼š åŸºæ•°æ’åºï¼š radix_sort public static void radixSort(int[] arr, int L, int R, int digit){//digit: æœ€å¤§æ•°çš„ä½æ•° final int radix = 10; int i = 0, j = 0; int[] bucket = new int[R - L + 1];//æœ‰å¤šå°‘ä¸ªæ•°å‡†å¤‡å¤šå°‘ä¸ªè¾…åŠ©ç©ºé—´ for(int d = 1; d \u003c= digit; d++){//æœ€å¤§ä½æ•°æœ‰å¤šå°‘ä½å°±è¿›å‡ºæ¡¶å¤šå°‘æ¬¡ int[] count = new int[radix]; //count[0..9] //count[0] å½“å‰(d)ä½æ˜¯0çš„æ•°å­—æœ‰å¤šå°‘ä¸ª //count[1] å½“å‰(d)ä½å°äºç­‰äº1çš„æ•°å­—æœ‰å¤šå°‘ä¸ª //count[2] å½“å‰(d)ä½å°äºç­‰äº2çš„æ•°å­—æœ‰å¤šå°‘ä¸ª //count[i] å½“å‰(d)ä½å°äºç­‰äºiçš„æ•°å­—æœ‰å¤šå°‘ä¸ª for(i = L; i \u003c= R; i++){ count[getDigit(arr[i], d)]++;//å…ˆç»Ÿè®¡æ¯ä¸ªæ•°å­—(num)å‡ºç°äº†å‡ æ¬¡(times)ï¼Œå…ˆè®°å½•åœ¨count[num] = times } for(i = 1; i \u003c radix; i++){ count[i] = count[i] + count[i - 1];//å†ç»Ÿè®¡å°äºç­‰äºå‡ºç°çš„æ¬¡æ•° } for(i = R; i \u003e= L; i--){//ä»å³å‘å·¦ j = getDigit(arr[i], d); bucket[count[j] - 1] = arr[i]; } for(i = L, j = 0; i \u003c= R; i++, j++){ arr[i] = bucket[j];//å°†æ¡¶ä¸­æ•°æ®å€’å›æ•°ç»„ } } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ€»ç»“ æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ ç¨³å®šæ€§ é€‰æ‹© O(N2) O(1) x å†’æ³¡ O(N2) O(1) âˆš æ’å…¥ O(N2) O(1) âˆš å½’å¹¶ O(NlogN) O(N) âˆš å¿«æ’ O(NlogN) O(logN) x å †æ’ O(NlogN) O(1) x ä¸€èˆ¬ä¼˜å…ˆé€‰æ‹© å¿«é€Ÿæ’åºï¼Œå¿«æ’çš„å¤æ‚åº¦åœ¨å¸¸æ•°é¡¹æ˜¯æœ€ä½çš„ã€‚ å¯¹ç©ºé—´æœ‰è¦æ±‚é€‰æ‹© å †æ’åºã€‚ å¯¹ç¨³å®šæ€§æœ‰è¦æ±‚é€‰æ‹© å½’å¹¶æ’åºã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:1:6","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - æ’åº ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å¿«é€Ÿé€‰æ‹© ç”¨äºæ±‚è§£ Kth Element é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç¬¬ K ä¸ªå…ƒç´ çš„é—®é¢˜ã€‚ å¯ä»¥ä½¿ç”¨å¿«é€Ÿæ’åºçš„ partition() è¿›è¡Œå®ç°ã€‚éœ€è¦å…ˆæ‰“ä¹±æ•°ç»„ï¼Œå¦åˆ™æœ€åæƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¸º O(N2)ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å † ç”¨äºæ±‚è§£ TopK Elements é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ K ä¸ªæœ€å°å…ƒç´ çš„é—®é¢˜ã€‚ä½¿ç”¨æœ€å°å †æ¥å®ç° Top é—®é¢˜ï¼Œæœ€å°å †ä½¿ç”¨å¤§é¡¶å †æ¥å®ç°ï¼Œå¤§é¡¶å †çš„å †é¡¶å…ƒç´ ä¸ºå½“å‰çš„æœ€å¤§å…ƒç´ ã€‚ å®ç°è¿‡ç¨‹ï¼šä¸æ–­åœ°å¾€å¤§é¡¶å †ä¸­æ’å…¥æ–°å…ƒç´ ï¼Œå½“å †ä¸­å…ƒç´ çš„æ•°é‡å¤§äº k æ—¶ï¼Œç§»é™¤å †é¡¶å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å½“å‰å †ä¸­æœ€å¤§çš„å…ƒç´ ï¼Œå‰©ä¸‹çš„å…ƒç´ éƒ½ä¸ºå½“å‰æ·»åŠ è¿‡çš„å…ƒç´ ä¸­æœ€å°çš„Kä¸ªå…ƒç´ ã€‚æ’å…¥å’Œç§»é™¤å †é¡¶å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º log2N å¿«é€Ÿé€‰æ‹©ä¹Ÿå¯ä»¥æ±‚è§£ TopK Elements é—®é¢˜ï¼Œå› ä¸ºæ‰¾åˆ°äº† Kth Element ä¹‹åï¼Œæ‰€æœ‰å°äºç­‰äº Kth Element çš„å…ƒç´ éƒ½æ˜¯ TopK Elementsã€‚ å¿«é€Ÿé€‰æ‹©å’Œå †æ’åºéƒ½å¯ä»¥æ±‚è§£ Kth Element å’Œ TopK Elements é—®é¢˜ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸€ï¼šKth Element Kth Largest Element in an Array (Medium) Input: [3,2,1,5,6,4] and k = 2 Output: 5 é¢˜ç›®æè¿°ï¼šæ‰¾åˆ°å€’æ•°ç¬¬ k ä¸ªçš„å…ƒç´ ã€‚ è§£é¢˜ï¼š æ–¹æ³•ä¸€ï¼šæ’åºï¼šæ—¶é—´å¤æ‚åº¦ O(NlogN)ï¼Œç©ºé—´å¤æ‚åº¦ O(1) sort() æ–¹æ³•ï¼šå…ƒç´ å°‘äºNSERTION_SORT_THRESHOLDâ½¤æ’â¼Šæ’åºï¼Œå¤§äºNSERTION_SORT_THRESHOLDï¼Œä½¿ç”¨å¿«æ’ã€‚ public int findKthLargest(int[] nums, int k) { Arrays.sort(nums); return nums[nums.length - k]; } æ–¹æ³•äºŒï¼šå †ï¼šæ—¶é—´å¤æ‚åº¦ O(NlogK)ï¼Œç©ºé—´å¤æ‚åº¦ O(K)ã€‚ public int findKthLargest(int[] nums, int k) { PriorityQueue\u003cInteger\u003e pq = new PriorityQueue\u003c\u003e(); //å°é¡¹å † for(int val : nums){ pq.add(val); if(pq.size() \u003e k) pq.poll(); //ç»´æŠ¤å †çš„å¤§å°ä¸ºKï¼Œå¼¹å‡ºæœ€å°é¡¹ï¼Œç•™ä¸‹çš„ k é¡¹ä¸ºæ•°ç»„ä¸­æœ€å¤§çš„ã€‚ } return pq.peek(); } æ–¹æ³•ä¸‰ï¼šå¿«é€Ÿé€‰æ‹© ï¼šæ—¶é—´å¤æ‚åº¦ O(N)ï¼Œç©ºé—´å¤æ‚åº¦ O(1) public int findKthLargest(int[] nums, int k) { k = nums.length - k; int l = 0, h = nums.length - 1; while (l \u003c h) { int j = partition(nums, l, h); if (j == k) { break; } else if (j \u003c k) { l = j + 1; } else { h = j - 1; } } return nums[k]; } private int partition(int[] a, int l, int h) { int i = l, j = h + 1; while (true) { while (a[++i] \u003c a[l] \u0026\u0026 i \u003c h) ; while (a[--j] \u003e a[l] \u0026\u0026 j \u003e l) ; if (i \u003e= j) { break; } swap(a, i, j); } swap(a, l, j); return j; } private void swap(int[] a, int i, int j) { int t = a[i]; a[i] = a[j]; a[j] = t; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®äºŒï¼šå‡ºç°é¢‘ç‡æœ€å¤šçš„ k ä¸ªå…ƒç´  Top K Frequent Elements (Medium) Given [1,1,1,2,2,3] and k = 2, return [1,2]. è§£é¢˜ï¼šæ¡¶æ’åº è®¾ç½®è‹¥å¹²ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶å­˜å‚¨å‡ºç°é¢‘ç‡ç›¸åŒçš„æ•°ã€‚æ¡¶çš„ä¸‹æ ‡è¡¨ç¤ºæ•°å‡ºç°çš„é¢‘ç‡ï¼Œå³ç¬¬ i ä¸ªæ¡¶ä¸­å­˜å‚¨çš„æ•°å‡ºç°çš„é¢‘ç‡ä¸º iã€‚ æŠŠæ•°éƒ½æ”¾åˆ°æ¡¶ä¹‹åï¼Œä»åå‘å‰éå†æ¡¶ï¼Œæœ€å…ˆå¾—åˆ°çš„ k ä¸ªæ•°å°±æ˜¯å‡ºç°é¢‘ç‡æœ€å¤šçš„çš„ k ä¸ªæ•°ã€‚ public int[] topKFrequent(int[] nums, int k) { Map\u003cInteger, Integer\u003e frequencyForNum = new HashMap\u003c\u003e(); for(int num : nums){ frequencyForNum.put(num, frequencyForNum.getOrDefault(num, 0) + 1); } List\u003cInteger\u003e[] buckets = new ArrayList[nums.length + 1]; for(int key : frequencyForNum.keySet()){ int frequency = frequencyForNum.get(key); if (buckets[frequency] == null){ buckets[frequency] = new ArrayList\u003c\u003e(); } buckets[frequency].add(key); } List\u003cInteger\u003e topK = new ArrayList\u003c\u003e();//res for(int i = buckets.length - 1; i \u003e= 0 \u0026\u0026 topK.size() \u003c k; i--){ if(buckets[i] == null){ continue; } if(buckets[i].size() \u003c= (k - topK.size())){ topK.addAll(buckets[i]); }else{ topK.addAll(buckets[i].subList(0, k - topK.size())); } } int[] res = new int[k]; for (int i = 0; i \u003c k; i++) { res[i] = topK.get(i); } return res; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸‰ï¼šæŒ‰ç…§å­—ç¬¦å‡ºç°æ¬¡æ•°å¯¹å­—ç¬¦ä¸²æ’åº Sort Characters By Frequency (Medium) Input: \"tree\" Output: \"eert\" Explanation: 'e' appears twice while 'r' and 't' both appear once. So 'e' must appear before both 'r' and 't'. Therefore \"eetr\" is also a valid answer. è§£é¢˜ï¼š public String frequencySort(String s) { Map\u003cCharacter, Integer\u003e frequencyForNum = new HashMap\u003c\u003e(); for (char c : s.toCharArray()) frequencyForNum.put(c, frequencyForNum.getOrDefault(c, 0) + 1); List\u003cCharacter\u003e[] frequencyBucket = new ArrayList[s.length() + 1]; for (char c : frequencyForNum.keySet()) { int f = frequencyForNum.get(c); if (frequencyBucket[f] == null) { frequencyBucket[f] = new ArrayList\u003c\u003e(); } frequencyBucket[f].add(c); } StringBuilder str = new StringBuilder(); for (int i = frequencyBucket.length - 1; i \u003e= 0; i--) { if (frequencyBucket[i] == null) { continue; } for (char c : frequencyBucket[i]) { for (int j = 0; j \u003c i; j++) { str.append(c); } } } return str.toString(); } ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"è·å…°å›½æ——é—®é¢˜ï¼šå¿«æ’ partition Input: [2,0,2,1,1,0] Output: [0,0,1,1,2,2] è§£é¢˜ï¼š public void sortColors(int[] nums) { int zero = -1, one = 0, two = nums.length; while (one \u003c two) { if (nums[one] == 0) { swap(nums, ++zero, one++); } else if (nums[one] == 2) { swap(nums, --two, one); } else { ++one; } } } private void swap(int[] nums, int i, int j) { int t = nums[i]; nums[i] = nums[j]; nums[j] = t; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:2:6","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - äºŒåˆ†æŸ¥æ‰¾ æ—¶é—´å¤æ‚åº¦ï¼šO(logN) (logNé»˜è®¤æŒ‡logä»¥2ä¸ºåº•) ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ±‚ä¸­é—´æ•° mid = (L + R) / 2 // L + R å¯èƒ½ä¼šè¶Šç•Œ65535ï¼Œè¿™æ—¶midç®—å‡ºè´Ÿæ•° mid = L + (R - L) / 2 //ä¸ä¼šè¶Šç•Œ mid = L + (R - L) \u003e\u003e 1 //å³ç§»ä¸€ä½æ¯”é™¤2å¿« ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"binarySearch public int binarySearch(int[] nums, int key) { int l = 0, h = nums.length; while (l \u003c h) { //int m = l + (h - l) / 2; int m = l + (h - l) \u003e 2; if (nums[m] \u003e= key) { h = m; } else { l = m + 1; } } return l; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸€ï¼šæ±‚å¼€æ–¹ Sqrt(x) (Easy) Input: 4 Output: 2 Input: 8 Output: 2 Explanation: The square root of 8 is 2.82842..., and since we want to return an integer, the decimal part will be truncated. è§£é¢˜ï¼š ä¸€ä¸ªæ•° x çš„å¼€æ–¹ sqrt ä¸€å®šåœ¨ 0 ~ x ä¹‹é—´ï¼Œå¹¶ä¸”æ»¡è¶³ sqrt == x / sqrtã€‚å¯ä»¥åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾åœ¨ 0 ~ x ä¹‹é—´æŸ¥æ‰¾ sqrtã€‚ å¯¹äº x = 8ï¼Œå®ƒçš„å¼€æ–¹æ˜¯ 2.82842â€¦ï¼Œæœ€ååº”è¯¥è¿”å› 2 è€Œä¸æ˜¯ 3ã€‚åœ¨å¾ªç¯æ¡ä»¶ä¸º l \u003c= h å¹¶ä¸”å¾ªç¯é€€å‡ºæ—¶ï¼Œh æ€»æ˜¯æ¯” l å° 1ï¼Œä¹Ÿå°±æ˜¯è¯´ h = 2ï¼Œl = 3ï¼Œå› æ­¤æœ€åçš„è¿”å›å€¼åº”è¯¥ä¸º h è€Œä¸æ˜¯ lã€‚ public int mySqrt(int x){ if(x \u003c= 1){ return x; } int l = 1, h = x; while(l \u003c= h){ int mid = l + (h - l) \u003e\u003e 2; int sqrt = x / mid; if (sqrt == mid){ return mid; } else if (mid \u003e sqrt){ h = mid - 1; } else { l = mid + 1; } } return h; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®äºŒï¼šå¤§äºç»™å®šå…ƒç´ çš„æœ€å°å…ƒç´  Find Smallest Letter Greater Than Target (Easy) Input: letters = [\"c\", \"f\", \"j\"] target = \"d\" Output: \"f\" Input: letters = [\"c\", \"f\", \"j\"] target = \"k\" Output: \"c\" è§£é¢˜ï¼š public char nextGreatestLetter(char[] letters, char target) { int n = letters.length; int l = 0, h = n - 1; while (l \u003c= h) { int m = l + (h - l) / 2; if (letters[m] \u003c= target) { l = m + 1; } else { h = m - 1; } } return l \u003c n ? letters[l] : letters[0]; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸‰ï¼šæœ‰åºæ•°ç»„çš„ Single Element in a Sorted Array (Medium) Input: [1, 1, 2, 3, 3, 4, 4, 8, 8] Output: 2 é¢˜ç›®æè¿°ï¼šä¸€ä¸ªæœ‰åºæ•°ç»„åªæœ‰ä¸€ä¸ªæ•°ä¸å‡ºç°ä¸¤æ¬¡ï¼Œæ‰¾å‡ºè¿™ä¸ªæ•°ã€‚è¦æ±‚ä»¥ O(logN) æ—¶é—´å¤æ‚åº¦æ±‚è§£ï¼Œå› æ­¤ä¸èƒ½éå†æ•°ç»„å¹¶è¿›è¡Œå¼‚æˆ–æ“ä½œæ¥æ±‚è§£ï¼Œè¿™ä¹ˆåšçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N) è§£é¢˜ï¼š ä»¤ index ä¸º Single Element åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚åœ¨ index ä¹‹åï¼Œæ•°ç»„ä¸­åŸæ¥å­˜åœ¨çš„æˆå¯¹çŠ¶æ€è¢«æ”¹å˜ã€‚å¦‚æœ m ä¸ºå¶æ•°ï¼Œå¹¶ä¸” m + 1 \u003c indexï¼Œé‚£ä¹ˆ nums[m] == nums[m + 1]ï¼›m + 1 \u003e= indexï¼Œé‚£ä¹ˆ nums[m] != nums[m + 1]ã€‚ public int singleNonDuplicate(int[] nums) { int l = 0, h = nums.length - 1; while (l \u003c h) { int m = l + (h - l) / 2; if (m % 2 == 1) { m--; // ä¿è¯ l/h/m éƒ½åœ¨å¶æ•°ä½ï¼Œä½¿å¾—æŸ¥æ‰¾åŒºé—´å¤§å°ä¸€ç›´éƒ½æ˜¯å¥‡æ•° } if (nums[m] == nums[m + 1]) { l = m + 2; } else { h = m; } } return nums[l]; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ï¼šæ‰¾ä¸€ä¸ªå±€éƒ¨æœ€å°ï¼ˆi-1 \u003c i \u003c i+1ï¼‰çš„æ•°ï¼Œå¤æ‚åº¦å°äº O(N) ä¾‹é¢˜ï¼š åœ¨ä¸€ä¸ªæœ‰åºæ•°ç»„ä¸­ï¼Œæ‰¾æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨ åœ¨ä¸€ä¸ªæœ‰åºæ•°ç»„ä¸­ï¼Œæ‰¾ \u003e= æŸä¸ªæ•°æœ€å·¦ä¾§çš„ä½ç½®ï¼šäºŒåˆ†æŸ¥æ‰¾ç›´åˆ°å·¦ä¾§æ²¡æœ‰æ•° æ— åºï¼Œç›¸é‚»æ•°ä¸€å®šä¸ç›¸ç­‰ï¼Œæ‰¾ä¸€ä¸ªå±€éƒ¨æœ€å°(i-1 \u003c i \u003c i+1)çš„æ•°ï¼Œå¤æ‚åº¦èƒ½å¦å¥½äºO(N) å…ˆåˆ¤æ–­é¦–å°¾é¡¹æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œè‹¥é¦–å°¾é¡¹ä¸æ»¡è¶³è¦æ±‚ï¼Œä¸€å®šæ˜¯\\è¿›/å‡ºï¼Œä¸­é—´ä¸€å®šæœ‰ä½è°·æ‹ç‚¹ã€‚ ç„¶ååˆ¤æ–­ä¸­é—´ç‚¹æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œè‹¥ä¸æ»¡è¶³ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š 1. æ–œå¡ï¼Œåˆ™ä¸€æ–¹å¯ä¸èµ·ç‚¹æˆ–ç»ˆç‚¹ç»„æˆ\\è¿›/å‡ºã€‚ 2. é¡¶å³°ï¼Œåˆ™ä¸¤æ–¹å‘éƒ½æ»¡è¶³\\è¿›/å‡ºæ¡ä»¶ï¼Œä¸¤ä¸ªæ–¹å‘éƒ½å¯ç»§ç»­è¿›è¡ŒäºŒåˆ†æ³• ç›´åˆ°åˆ¤æ–­å‡ºæŸä¸ªäºŒåˆ†æ³•ä¸­ç‚¹æ»¡è¶³è¦æ±‚ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:3:6","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - å“ˆå¸Œè¡¨ - æœ‰åºè¡¨ å“ˆå¸Œè¡¨ä»‹ç» å“ˆå¸Œè¡¨ä½¿ç”¨å±‚é¢ä¸Šå¯ä»¥ç†è§£ä¸ºä¸€ç§é›†åˆç»“æ„ã€‚ æœ‰æ— ä¼´éšæ•°æ®ï¼Œæ˜¯HashMapå’ŒHashSetå”¯ä¸€çš„åŒºåˆ«ï¼Œåº•å±‚çš„æ•°æ®ç»“æ„ä¸€æ ·ã€‚ ä½¿ç”¨å“ˆå¸Œè¡¨ putï¼Œremoveï¼Œputï¼Œget çš„æ“ä½œï¼Œå¯ä»¥è®¤ä¸ºæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œä½†å¸¸æ•°æ—¶é—´æ¯”è¾ƒå¤§ã€‚ å“ˆå¸Œè¡¨ä½¿ç”¨ O(N) ç©ºé—´å¤æ‚åº¦å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”ä»¥ O(1) æ—¶é—´å¤æ‚åº¦æ±‚è§£é—®é¢˜ã€‚ Java ä¸­çš„ HashSet ç”¨äºå­˜å‚¨ä¸€ä¸ªé›†åˆï¼Œå¯ä»¥æŸ¥æ‰¾å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ã€‚å¦‚æœå…ƒç´ æœ‰ç©·ï¼Œå¹¶ä¸”èŒƒå›´ä¸å¤§ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ä¸€ä¸ªå¸ƒå°”æ•°ç»„æ¥å­˜å‚¨ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚å¯¹äºåªæœ‰å°å†™å­—ç¬¦çš„å…ƒç´ ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªé•¿åº¦ä¸º 26 çš„å¸ƒå°”æ•°ç»„æ¥å­˜å‚¨ä¸€ä¸ªå­—ç¬¦é›†åˆï¼Œä½¿å¾—ç©ºé—´å¤æ‚åº¦é™ä½ä¸º O(1)ã€‚ Java ä¸­çš„ HashMap ä¸»è¦ç”¨äºæ˜ å°„å…³ç³»ï¼Œä»è€ŒæŠŠä¸¤ä¸ªå…ƒç´ è”ç³»èµ·æ¥ã€‚HashMap ä¹Ÿå¯ä»¥ç”¨æ¥å¯¹å…ƒç´ è¿›è¡Œè®¡æ•°ç»Ÿè®¡ã€‚åœ¨å¯¹ä¸€ä¸ªå†…å®¹è¿›è¡Œå‹ç¼©æˆ–è€…å…¶ä»–è½¬æ¢æ—¶ï¼Œåˆ©ç”¨ HashMap å¯ä»¥æŠŠåŸå§‹å†…å®¹å’Œè½¬æ¢åçš„å†…å®¹è”ç³»èµ·æ¥ã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ªç®€åŒ– url çš„ç³»ç»Ÿä¸­ã€‚ åˆ©ç”¨ HashMap å°±å¯ä»¥å­˜å‚¨ç²¾ç®€åçš„ url åˆ°åŸå§‹ url çš„æ˜ å°„ï¼Œä½¿å¾—ä¸ä»…å¯ä»¥æ˜¾ç¤ºç®€åŒ–çš„ urlï¼Œä¹Ÿå¯ä»¥æ ¹æ®ç®€åŒ–çš„ url å¾—åˆ°åŸå§‹ url ä»è€Œå®šä½åˆ°æ­£ç¡®çš„èµ„æºã€‚ æœ‰åºè¡¨ä»‹ç» æœ‰åºè¡¨åœ¨ä½¿ç”¨å±‚é¢ä¸Šå¯ä»¥ç†è§£ä¸ºä¸€ç§é›†åˆç»“æ„ã€‚ æœ‰æ— ä¼´éšæ•°æ®ï¼Œæ˜¯TreeSetå’ŒTreeMapå”¯ä¸€çš„åŒºåˆ«ï¼Œåº•å±‚çš„æ•°æ®ç»“æ„ä¸€æ ·ã€‚ æœ‰åºè¡¨å’Œå“ˆå¸Œè¡¨çš„åŒºåˆ«æ˜¯ï¼Œæœ‰åºè¡¨æŠŠkeyæŒ‰ç…§é¡ºåºç»„ç»‡èµ·æ¥ï¼Œè€Œå“ˆå¸Œè¡¨å®Œå…¨ä¸ç»„ç»‡ã€‚ çº¢é»‘æ ‘ã€AVLæ ‘ã€size-balance-treeå’Œè·³è¡¨éƒ½å±äºæœ‰åºè¡¨ç»“æ„ï¼Œåªæ˜¯åº•å±‚å…·ä½“å®ç°ä¸åŒã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:4:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"1. æ•°ç»„ä¸­ä¸¤ä¸ªæ•°çš„å’Œä¸ºç»™å®šå€¼ Two Sum (Easy) è§£é¢˜ï¼š å¯ä»¥å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œç„¶åä½¿ç”¨åŒæŒ‡é’ˆæ–¹æ³•æˆ–è€…äºŒåˆ†æŸ¥æ‰¾æ–¹æ³•ã€‚è¿™æ ·åšçš„æ—¶é—´å¤æ‚åº¦ä¸º O(NlogN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ ç”¨ HashMap å­˜å‚¨æ•°ç»„å…ƒç´ å’Œç´¢å¼•çš„æ˜ å°„ï¼Œåœ¨è®¿é—®åˆ° nums[i] æ—¶ï¼Œåˆ¤æ–­ HashMap ä¸­æ˜¯å¦å­˜åœ¨ target - nums[i]ï¼Œå¦‚æœå­˜åœ¨è¯´æ˜ target - nums[i] æ‰€åœ¨çš„ç´¢å¼•å’Œ i å°±æ˜¯è¦æ‰¾çš„ä¸¤ä¸ªæ•°ã€‚è¯¥æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(N)ï¼Œä½¿ç”¨ç©ºé—´æ¥æ¢å–æ—¶é—´ã€‚ public int[] twoSum(int[] nums, int target){ HashMap\u003cIntger, Intger\u003e indexForNum = new HashMap\u003c\u003e(); for(int i = 0; i \u003c nums.length; i++){ if(indexForNum.containsKey(target - nums[i])){ return new int[]{indexForNum.get(target - nums[i]), i}; } else { indexForNum.put(nums[i], i); } } return null; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:4:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"2. åˆ¤æ–­æ•°ç»„æ˜¯å¦å«æœ‰é‡å¤å…ƒç´  Contains Duplicate (Easy) public boolean containsDuplicate(int[] nums){ Set\u003cInteger\u003e set = new HashSet\u003c\u003e(); for (int num : nums){ set.add(num); } return set.size() \u003c nums.length; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:4:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"3. æœ€é•¿å’Œè°åºåˆ— Longest Harmonious Subsequence (Easy) å’Œè°åºåˆ—ä¸­æœ€å¤§æ•°å’Œæœ€å°æ•°ä¹‹å·®æ­£å¥½ä¸º 1ï¼Œåº”è¯¥æ³¨æ„çš„æ˜¯åºåˆ—çš„å…ƒç´ ä¸ä¸€å®šæ˜¯æ•°ç»„çš„è¿ç»­å…ƒç´ ã€‚ Input: [1,3,2,2,5,2,3,7] Output: 5 Explanation: The longest harmonious subsequence is [3,2,2,2,3]. public int findLHS(int[] nums){ Map\u003cInteger, Integer\u003e countForNum = new HashMap\u003c\u003e(); for(int num : nums){ countForNum.put(num, countForNum.getOrDefault(nums, 0) + 1); } int longest = 0; for(int num : countForNum.keySet()){ if(countForNum.containsKey(num + 1)){ longest = Math.max(longest, countForNum.get(num + 1) + countForNum.get(num)); } } return longest; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:4:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"4. æœ€é•¿è¿ç»­åºåˆ— Longest Consecutive Sequence (Hard) ","date":"2020-01-14","objectID":"/20200114_leetcode/:4:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é“¾è¡¨ ç¬”è¯• é¢è¯•åŒºåˆ†ï¼Œé¢è¯•æ—¶éœ€è€ƒè™‘ç©ºé—´å¤æ‚åº¦ã€‚ é¢˜ç›®ä¸€ï¼šåˆ¤æ–­ä¸€ä¸ªé“¾è¡¨æ˜¯å¦å›æ–‡ æ–¹æ³•ä¸€ï¼šç¬”è¯•ç”¨ï¼šè¿›æ ˆå‡ºæ ˆ(å…ˆè¿›åå‡º) public static boolean isPalindrome1(Node head) { Stack\u003cNode\u003e stack = new Stack\u003cNode\u003e(); Node cur = head; while (cur != null) { stack.push(cur); cur = cur.next; } while (head != null) { if (head.value != stack.pop().value) { return false; } head = head.next; } return true; } æ–¹æ³•2ï¼šå¿«æ…¢æŒ‡é’ˆï¼šç©ºé—´å¤æ‚åº¦O(1)ï¼Œä½¿ç”¨äº†æœ‰é™å‡ ä¸ªå˜é‡ public static boolean isPalindrome3(Node head) { if (head == null || head.next == null) { return true; } Node n1 = head; Node n2 = head; while (n2.next != null \u0026\u0026 n2.next.next != null) { n1 = n1.next; //n1 -\u003e mid n2 = n1.next.next; //n2 -\u003e end } n2 = n1.next; //n2 -\u003e right part first node Node n3 = null; while (n2 != null) { //right part convert n3 = n2.next; // save next node n2.next = n1; // right direct to left direct n1 = n2; n2 = n3; } n3 = n1; // last node n2 = head; // fist node boolean res = true; while (n1 != null \u0026\u0026 n2 != null) { if (n1.value != n2.value) { res = false; break; } n1 = n1.next; n2 = n2.next; } n1 = n3.next; // recover list n3.next = null; while (n1 != null) { n2 = n1.next; n1.next = n3; n3 = n1; n1 = n2; } return res; } é¢˜ç›®äºŒï¼šå•é“¾è¡¨æŒ‰æŸå€¼åˆ’åˆ†æˆå·¦è¾¹å°ï¼Œä¸­é—´ç›¸ç­‰ï¼Œå³è¾¹å¤§ æ–¹æ³•ä¸€ï¼šï¼ˆç¬”è¯•ï¼‰æ”¾åˆ°æ•°ç»„é‡Œï¼Œåœ¨æ•°ç»„é‡Œpartition æ–¹æ³•äºŒï¼šï¼ˆé¢è¯•ï¼‰åˆ›å»º6ä¸ªç©ºèŠ‚ç‚¹ï¼Œæ¯ä¸¤ä¸ªä¸€ç»„ï¼Œä½œä¸ºä¸‰ä¸ªåŒºåŸŸçš„é¦–å°¾èŠ‚ç‚¹ã€‚éå†åŸé“¾è¡¨ï¼Œæ”¾åˆ°ä¸åŒçš„åŒºåŸŸå¹¶è°ƒæ•´å„ç»„é¦–å°¾èŠ‚ç‚¹ï¼Œæœ€åä¸‰ä¸ªæ‹¼è£…ã€‚ é¢˜ç›®ä¸‰ï¼šå¤åˆ¶å«æœ‰éšæœºæŒ‡é’ˆèŠ‚ç‚¹çš„é“¾è¡¨ class Node { int value; Node next; Node rand; Node(int val) { value = val; } } æ–¹æ³•ä¸€ï¼šhashmap public static Node copyListWithRand1(Node head) { HashMap\u003cNode, Node\u003e map = new HashMap\u003cNode, Node\u003e(); Node cur = head; while (cur != null) { map.put(cur, new Node(cur.value)); cur = cur.next; } cur = head; while (cur != null) { map.get(cur).next = map.get(cur.next); map.get(cur).rand = map.get(cur.rand); cur = cur.next; } return map.get(head); } æ–¹æ³•äºŒï¼šåˆ©ç”¨ä½ç½®å…³ç³»çœå»å“ˆå¸Œè¡¨ã€‚ å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå°±æ”¾å…‹éš†èŠ‚ç‚¹ã€‚ curCopy = cur.next; curCopy.rand = cur.rand != null ? cur.rand.next:null; è·³è¿‡æ—§é“¾è¡¨ã€‚ é¢˜ç›®å››ï¼šä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„ä¸€ç³»åˆ—é—®é¢˜ å…ˆåˆ¤æ–­æœ‰æ— ç¯ï¼š æ–¹æ³•ä¸€ï¼šHashsetã€‚getä¸€ä¸ªï¼Œçœ‹ä¹‹å‰æ˜¯å¦åŠ å…¥è¿‡ï¼Œå¦åˆ™putè¿›setã€‚ æ–¹æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆã€‚ä¸ä¼šèµ°åˆ°ç©ºèŠ‚ç‚¹ï¼Œå¿«æ…¢æŒ‡é’ˆä¸€å®šä¼šç›¸é‡ï¼Œè€Œä¸”å¿«æŒ‡é’ˆåœ¨ç¯ä¸­ä¸ä¼šè¶…è¿‡ä¸¤åœˆã€‚ç›¸é‡åå¿«æŒ‡é’ˆå›åˆ°å¼€å¤´ï¼Œç„¶åä¸¤ä¸ªæŒ‡é’ˆéƒ½èµ°ä¸€æ­¥ï¼Œä¸€å®šä¼šåœ¨å…¥ç¯èŠ‚ç‚¹ç›¸é‡ã€‚ æƒ…å†µä¸€ï¼šä¸¤é“¾è¡¨éƒ½æ— ç¯ åˆ¤æ–­é“¾è¡¨é•¿åº¦ åˆ¤æ–­endèŠ‚ç‚¹æ˜¯å¦æ˜¯ä¸€ä¸ªï¼Œä¸åŒåˆ™ä¸ç›¸äº¤ã€‚ é•¿é“¾è¡¨å…ˆèµ°å·®å€¼æ­¥ï¼Œç„¶åä¸¤é“¾è¡¨ä¸€èµ·èµ°ï¼Œä¸€å®šä¼šä¸€èµ·èµ°åˆ°ç¬¬ä¸€ä¸ªç›¸äº¤ç‚¹ã€‚ æƒ…å†µäºŒï¼šä¸¤é“¾è¡¨éƒ½æœ‰ç¯ æƒ…å†µäºŒä¹‹ä¸€ï¼šé“¾è¡¨æ— äº¤é›† æƒ…å†µäºŒä¹‹äºŒï¼šå…¥ç¯èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ã€‚ æƒ…å†µäºŒä¹‹ä¸‰ï¼šå…¥ç¯èŠ‚ç‚¹ä¸åŒã€‚ public static Node bothLoop(Node head1, Node head2, Node loop1, Node loop2) {//ä¸¤é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå…¥ç¯èŠ‚ç‚¹ Node cur1 = null; Node cur2 = null; if (loop1 == loop2) { //æƒ…å†µäºŒä¹‹äºŒï¼šå…¥ç¯èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ã€‚ cur1 = head1; cur2 = head2; int n = 0; while (cur1 != loop1) { //åˆ¤æ–­åˆ°è¾¾å…¥ç¯èŠ‚ç‚¹çš„é•¿åº¦ n++; cur1 = cur1.next; } while (cur2 != loop2) { //åˆ¤æ–­æ˜¯1é“¾è¡¨å¤´ç»“ç‚¹åˆ°å…¥ç¯èŠ‚ç‚¹é•¿åº¦å’Œ2é“¾è¡¨åˆ°å…¥ç¯èŠ‚ç‚¹é•¿åº¦çš„å·®å€¼ n--; cur2 = cur2.next; } cur1 = n \u003e 0 ? head1 : head2; cur2 = cur1 == head1 ? head2 : head1; n = Math.abs(n); while (n != 0) {// ä½¿ä¸¤ä¸ªé“¾è¡¨åˆ°å…¥ç¯ç‚¹é•¿åº¦ä¸€æ · n--; cur1 = cur1.next; } while (cur1 != cur2) { cur1 = cur1.next; cur2 = cur2.next; } return cur1; } else { // æƒ…å†µäºŒä¹‹ä¸‰ï¼šå…¥ç¯èŠ‚ç‚¹ä¸åŒ æˆ– æƒ…å†µäºŒä¹‹ä¸€ï¼šé“¾è¡¨æ— äº¤é›† cur1 = loop1.next; while (cur1 != loop1) { // é™å®šåªè½¬ä¸€åœˆï¼Œç¢°ä¸åˆ°loop2å°±æ˜¯æ— äº¤é›† if (cur1 == loop2) { return loop1; } cur1 = cur1.next; } return null; } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:5:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ åŒæŒ‡é’ˆ ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸€ï¼šæœ‰åºæ•°ç»„çš„ Two Sum Two Sum II - Input array is sorted (Easy) Input: numbers={2, 7, 11, 15}, target=9 Output: index1=1, index2=2 é¢˜ç›®æè¿°ï¼šåœ¨æœ‰åºæ•°ç»„ä¸­æ‰¾å‡ºä¸¤ä¸ªæ•°ï¼Œä½¿å®ƒä»¬çš„å’Œä¸º targetã€‚ è§£é¢˜ï¼š ä½¿ç”¨åŒæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æœ€å°çš„å…ƒç´ ï¼Œä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æœ€å¤§çš„å…ƒç´ ï¼Œä¸¤æŒ‡é’ˆå‘ä¸­é—´éå† å¦‚æœä¸¤æŒ‡é’ˆçš„å’Œ sum == gargetï¼Œreturn ç»“æœï¼› å¦‚æœ sum \u003e targetï¼Œç§»åŠ¨è¾ƒå¤§çš„å…ƒç´ ï¼Œä½¿ sum å˜å°ä¸€äº›ï¼› å¦‚æœ sum \u003c targetï¼Œç§»åŠ¨è¾ƒå°çš„å…ƒç´ ï¼Œä½¿ sum å˜å°ä¸€äº›ã€‚ æœ€å¤šéå†ä¸€éï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(N)ã€‚åªæ˜¯ç”¨ä¸¤ä¸ªé¢å¤–çš„å˜é‡ï¼Œç©ºé—´æŒ‰å¤æ‚åº¦ä¸º O(1) public int[] twoSum(int[] numbers, int target){ if (numbers == null) return null; int i = 0,j = numbers.length - 1; while(i \u003c j){ int sum = numbers[i] + numbers[j]; if (sum == target) { return new int[]{i + 1, j + 1}; } else if (sum \u003c target) { i++; } else { j--; } } return null; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®äºŒï¼šä¸¤æ•°å¹³æ–¹å’Œ Sum of Square Numbers (Easy) é¢˜ç›®æè¿°ï¼šåˆ¤æ–­ä¸€ä¸ªéè´Ÿæ•´æ•°æ˜¯å¦ä¸ºä¸¤ä¸ªæ•´æ•°çš„å¹³æ–¹å’Œã€‚ è§£é¢˜ï¼š å¯ä»¥çœ‹æˆæ˜¯åœ¨å…ƒç´ ä¸º 0 ~ target çš„æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ä¸¤ä¸ªæ•°ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªæ•°çš„å¹³æ–¹å’Œä¸º targetã€‚ ä¸ é¢˜ä¸€ é€»è¾‘ä¸€è‡´ï¼Œä¸åŒçš„æ˜¯ï¼šå·¦æŒ‡é’ˆä» 0ä½ç½®ä¸Šçš„0å¼€å§‹ï¼Œå³æŒ‡é’ˆä» sqrt(target) ä½ç½®å¼€å§‹ï¼› æ—¶é—´å¤æ‚åº¦ O(sqrt(target))ï¼Œæ—¶é—´å¤æ‚åº¦ O(1) ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸‰ï¼šåè½¬å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­—ç¬¦ Reverse Vowels of a String (Easy) Given s = \"leetcode\", return \"leotcede\". è§£é¢˜ï¼š ä½¿ç”¨åŒæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡é’ˆä»å¤´éå†ï¼Œä¸€ä¸ªæŒ‡é’ˆä»å°¾éå†ï¼Œå½“ä¸¤ä¸ªæŒ‡é’ˆéƒ½é‡åˆ°å…ƒéŸ³æ—¶ï¼Œäº¤æ¢è¿™ä¸¤ä¸ªå…ƒéŸ³å­—ç¬¦ã€‚ ä¸ºäº†å¿«é€Ÿåˆ¤æ–­å­—ç¬¦æ˜¯ä¸æ˜¯å…ƒéŸ³å­—ç¬¦ï¼Œå°†å…ƒéŸ³å­—ç¬¦æ·»åŠ åˆ°é›†åˆ HashSet ä¸­ï¼Œä»è€Œä»¥ O(1) çš„æ—¶é—´å¤æ‚åº¦è¿›è¡Œè¯¥æ“ä½œ private final static HashSet\u003cCharacter\u003e vowels = new HashSet\u003c\u003e( Arrays.asList('a', 'e', 'i', 'o', 'u', 'A', 'E', 'I', 'O', 'U')); æ—¶é—´å¤æ‚åº¦ O(N)ï¼Œç©ºé—´å¤æ‚åº¦ O(1) ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®å››ï¼šå›æ–‡å­—ç¬¦ä¸² Valid Palindrome II (Easy) Input: \"abca\" Output: True Explanation: You could delete the character 'c'. é¢˜ç›®æè¿°ï¼šå¯ä»¥åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½æ„æˆå›æ–‡å­—ç¬¦ä¸²ã€‚ ä½¿ç”¨ åŒæŒ‡é’ˆï¼ˆstackè¿›æ ˆå‡ºæ ˆã€å¿«æ…¢æŒ‡é’ˆï¼ˆç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼‰ï¼‰å®¹æ˜“åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡å­—ç¬¦ä¸²ã€‚ æœ¬é¢˜çš„å…³é”®æ˜¯å¤„ç†åˆ é™¤ä¸€ä¸ªå­—ç¬¦ã€‚åœ¨ä½¿ç”¨åŒæŒ‡é’ˆéå†å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå‡ºç°ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸ç›¸ç­‰çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±è¯•ç€åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œå†åˆ¤æ–­åˆ é™¤å®Œä¹‹åçš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡å­—ç¬¦ä¸²ã€‚ åœ¨åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡å­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ¤æ–­æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºå·¦æŒ‡é’ˆå·¦è¾¹å’Œå³æŒ‡é’ˆå³è¾¹çš„å­—ç¬¦ä¹‹å‰å·²ç»åˆ¤æ–­è¿‡å…·æœ‰å¯¹ç§°æ€§è´¨ï¼Œæ‰€ä»¥åªéœ€è¦åˆ¤æ–­ä¸­é—´çš„å­å­—ç¬¦ä¸²å³å¯ã€‚ åœ¨è¯•ç€åˆ é™¤å­—ç¬¦æ—¶ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥åˆ é™¤å·¦æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥åˆ é™¤å³æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ã€‚ public boolean validPalindrome(String s){ for(int i = 0, j = s.length() - 1; i \u003c j; i++,j--){ if(s.charAt(i) != s.charAt(j)){ return isPalindrome(s, i, j - 1) || isPalindrome(s, i + 1, j); } } return true; } private bool isPalindrome(String s, int i, int j) { while (i \u003c j){ if(s.charAt(i++) != s.charAt(j--)){ return false; } } return ture; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®äº”ï¼šå½’å¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„ Merge Sorted Array (Easy) é¢˜ç›®æè¿°ï¼šæŠŠå½’å¹¶ç»“æœå­˜åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„ä¸Šã€‚ Input: nums1 = [1,2,3,0,0,0], m = 3 nums2 = [2,5,6], n = 3 Output: [1,2,2,3,5,6] è§£é¢˜ï¼š ç±»ä¼¼å½’å¹¶æ’åºåˆå¹¶å­—ç¬¦ä¸²ã€‚ public void merge(int[] nums1, int m, int[] nums2, int n) { int index1 = m - 1, index2 = n - 1; int indexMerge = m + n - 1; while (index2 \u003e= 0) { if (index1 \u003c 0) { nums1[indexMerge--] = nums2[index2--]; } else if (index2 \u003c 0) { nums1[indexMerge--] = nums1[index1--]; } else if (nums1[index1] \u003e nums2[index2]) { nums1[indexMerge--] = nums1[index1--]; } else { nums1[indexMerge--] = nums2[index2--]; } } } //å½’å¹¶æ’åºmergeæ–¹æ³• public static void merge(int[] arr, int L, int M, int R){ int[] extra = new int[R - L + 1]; int i = 0; int p1 = L; int p2 = M + 1; while(p1 \u003c= M \u0026\u0026 p2 \u003c= R){ extra[i++] = arr[p1] \u003c= arr[p2] ? arr[p1++]: arr[p2++]; } while(p1 \u003c= M){ extra[i++] = arr[p1++]; } while(p2 \u003c= R){ extra[i++] = arr[p2++]; } for(i = 0; i \u003c extra.length; i++){ arr[L + i] = extra[i]; } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®å…­ï¼šåˆ¤æ–­é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ Linked List Cycle (Easy) è§£é¢˜ï¼š ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆã€‚å¦‚æœå­˜åœ¨ç¯ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆä¸€å®šä¼šç›¸é‡ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:6","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸ƒï¼šæœ€é•¿å­åºåˆ— Longest Word in Dictionary through Deleting (Medium) Input: s = \"abpcplea\", d = [\"ale\",\"apple\",\"monkey\",\"plea\"] Output: \"apple\" é¢˜ç›®æè¿°ï¼šåˆ é™¤ s ä¸­çš„ä¸€äº›å­—ç¬¦ï¼Œä½¿å¾—å®ƒæ„æˆå­—ç¬¦ä¸²åˆ—è¡¨ d ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºèƒ½æ„æˆçš„æœ€é•¿å­—ç¬¦ä¸²ã€‚å¦‚æœæœ‰å¤šä¸ªç›¸åŒé•¿åº¦çš„ç»“æœï¼Œè¿”å›å­—å…¸åºçš„æœ€å°å­—ç¬¦ä¸²ã€‚ è§£é¢˜ï¼š é€šè¿‡åˆ é™¤å­—ç¬¦ä¸² s ä¸­çš„ä¸€ä¸ªå­—ç¬¦èƒ½å¾—åˆ°å­—ç¬¦ä¸² tï¼Œå¯ä»¥è®¤ä¸º t æ˜¯ s çš„å­åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆæ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­åºåˆ—ã€‚ public String findLongestWord(String s, List\u003cString\u003e d) { String longestWord = \"\"; for(String target: d){ int l1 = longestWord.length(), l2 = target.length(); if(l1 \u003e l2 || (l1 == l2 \u0026\u0026 longestWord.compareTo(target) \u003c 0)){ continue; } if(isSubstr(s,target)){ } } return longestWord; } private boolean isSubstr(String s,String target){ int i = 0,j = 0; while(i \u003c s.length() \u0026\u0026 j \u003c target.length()){ if(s.charAt(i) == target.charAt(j)){ j++; } i++; } return j == target.length(); } ","date":"2020-01-14","objectID":"/20200114_leetcode/:6:7","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - æ ‘ é€’å½’éå†ï¼š public static void orderRecur(Node head){ if(head == null){ return; } //operation(...) //å…ˆåºéå† orderRecur(head.left); //operation(...) //ä¸­åºéå† orderRecur(head.right); //operation(...) //ååºéå† } æ·±åº¦ä¼˜å…ˆéå†ï¼šä¸­åºéå† å®½åº¦ä¼˜å…ˆéå†å¹¶æ±‚æœ€å¤§å®½åº¦ï¼šé˜Ÿåˆ— LinkedList public static void weight(Node head) { if (head == null) { return; } Queue\u003cNode\u003e queue = new LinkedList\u003c\u003e(); queue.add(head); HashMap\u003cNode, Integer\u003e levelMap = new HashMap\u003c\u003e();//è®°å½•è¡Œæ•° levelMap.put(head, 1); int curLevel = 1; int curLevelNodes = 0; int max = Integer.MIN_VALUE; while (!queue.isEmpty()) { Node cur = queue.poll(); int curNodeLevel = levelMap.get(cur); if (curNodeLevel == curLevel) { curLevelNodes++; } else { max = Math.max(max, curLevelNodes); curLevel++; curLevelNodes = 0; } System.out.println(cur.value); if (cur.left != null) { levelMap.put(cur.left, curNodeLevel + 1); queue.add(cur.left); } if (cur.right != null) { levelMap.put(cur.right, curNodeLevel + 1); queue.add(cur.right); } } } åˆ¤æ–­æ˜¯å¦æ˜¯æœç´¢äºŒå‰æ ‘ï¼šå·¦å­©å­å°äºçˆ¶èŠ‚ç‚¹ï¼Œå³å­©å­å¤§äºçˆ¶èŠ‚ç‚¹ã€‚ ä¸­åºéå†ï¼šä¸­é—´æ‰“å°èŠ‚ç‚¹å€¼çš„åœ°æ–¹æ”¹æˆå’Œå‰èŠ‚ç‚¹å€¼æ¯”è¾ƒã€‚ åˆ¤æ–­æ˜¯å¦æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼šæ¯ä¸€å±‚æ˜¯æ»¡çš„ï¼Œæˆ–è€…æœ€åä¸€å±‚èŠ‚ç‚¹éƒ½åœ¨å·¦è¾¹ã€‚ éé€’å½’æ–¹æ³•ï¼š åŒæ—¶æ»¡è¶³ ä»»ä¸€èŠ‚ç‚¹æœ‰å³æ— å·¦ â€“\u003e false é‡åˆ°ä¸€ä¸ªå·¦å³å­æ ‘ä¸å…¨çš„èŠ‚ç‚¹ï¼Œåç»­çš†æ˜¯å¶èŠ‚ç‚¹ã€‚ public static boolean isCBT(Node head){ if(head == null){ return true; } LinkedList\u003cNode\u003e queue = new LinkedList\u003c\u003e(); //æ˜¯å¦é‡åˆ°è¿‡å·¦å³ä¸¤ä¸ªå­©å­ä¸åŒå…¨çš„èŠ‚ç‚¹ boolean leaf = false; Node l = null; node r = null; queue.add(head); while(!queue.isEmpty()){ head = queue.poll(); l = head.left; r = head.right; if( //èŠ‚ç‚¹ä¸åŒå…¨ï¼Œåˆå‘ç°æœ‰å­©å­ (leaf \u0026\u0026 (l ï¼= null || r ï¼= null)) || (l == null \u0026\u0026 r != null) ){ return false; } if (l != null){ queue.add(l); } if (r != null){ queue.add(r); } if (l == null || r == null){ leaf = true; } return true; } } åˆ¤æ–­æ»¡äºŒå‰æ ‘ï¼š äºŒå‰æ ‘DPé¢˜ç›®å›ºå®šå¥—è·¯ï¼šé€’å½’ äºŒå‰æ ‘DPé¢˜ç›®: å¯ä»¥é€šè¿‡ä»å·¦å³æ ‘è¦ä¿¡æ¯è§£å†³é—®é¢˜å¯ä»¥ä½¿ç”¨è¿™ä¸ªå›ºå®šæ–¹æ³•ã€‚ public static class Info { public int height; public int nodes; public Info(int h, int n) { height = h; nodes = n; } } public static Info f(Node x) { if (x == null) { return new Info(0, 0); } Info leftData = f(x.left); Info rightData = f(x.right); int height = Math.max(leftData.height, rightData.height) + 1; int nodes = leftData.nodes + rightData.nodes + 1; return new Info(height, nodes); } åˆ¤æ–­å¹³è¡¡äºŒå‰æ ‘ï¼šå·¦æ ‘é«˜åº¦å’Œå³æ ‘é«˜åº¦çš„å·®éƒ½ä¸è¶…è¿‡1 åŒæ—¶æ»¡è¶³ï¼š å·¦å­æ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘ å³å­æ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘ å·¦æ ‘é«˜åº¦å’Œå³æ ‘é«˜åº¦çš„å·®ä¸è¶…è¿‡1 public static class ReturnType{ public boolean isBalanced; public int height; public ReturnType(boolean isB, int hei){ isBalanced = isB; height = hei; } } public static ReturnType Process(Node x){ if(x = null){ return new ReturnType(true, 0); } ReturnType leftData = process(x.left); ReturnType rightData = process(x.right); int height = Math.max(leftData.height, rightData.height) + 1; boolean isBalanced = leftData.isBalanced \u0026\u0026 rightData.isBalanced \u0026\u0026 Math.abs(leftData.height - rightData.height) \u003c 2; return new ReturnType(isBalanced, height); } ","date":"2020-01-14","objectID":"/20200114_leetcode/:7:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é€’å½’ 1. æ ‘çš„é«˜åº¦ Maximum Depth of Binary Tree (Easy) public int maxDepth(TreeNode root){ if(root == null) return 0; return Math.max(maxDepth(root.left), maxDepth(root.right)) + 1; } 2. å¹³è¡¡æ ‘ Balanced Binary Tree (Easy) å¹³è¡¡æ ‘å·¦å³å­æ ‘é«˜åº¦å·®éƒ½å°äºç­‰äº 1 private boolean result = true; public boolean isBalanced(TreeNode root){ maxDepth(root); return result; } public int maxDepth(TreeNode root){ if(root == null) return 0; int l = maxDepth(root.left); int r = maxDepth(root.right); if(Math.abs(l - r) \u003e 1) result = false; return Math.max(l, r) + 1; } 3. ä¸¤èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ Diameter of Binary Tree (Easy) Input: 1 / \\ 2 3 / \\ 4 5 Return 3, which is the length of the path [4,2,1,3] or [5,2,1,3]. private int max = 0; public int diameterOfBinaryTree(TreeNode root){ depth(root); return max; } private int depth(TreeNode root){ if(root == null) return 0; int l = depth(root.left); int r = depth(root.right); max = Math.max(max, l + r); return Math.max(l, r) + 1; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:7:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"BFSå±‚æ¬¡éå† ä½¿ç”¨ BFS æ—¶ï¼Œä¸éœ€è¦ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—æ¥åˆ†åˆ«å­˜å‚¨å½“å‰å±‚çš„èŠ‚ç‚¹å’Œä¸‹ä¸€å±‚çš„èŠ‚ç‚¹ï¼Œå› ä¸ºåœ¨å¼€å§‹éå†ä¸€å±‚çš„èŠ‚ç‚¹æ—¶ï¼Œå½“å‰é˜Ÿåˆ—çš„èŠ‚ç‚¹æ•°å°±æ˜¯å½“å‰å±‚çš„èŠ‚ç‚¹æ•°ï¼Œåªè¦æ§åˆ¶éå†è¿™ä¹ˆå¤šèŠ‚ç‚¹æ•°ï¼Œå°±èƒ½ä¿è¯è¿™æ¬¡éå†çš„éƒ½æ˜¯å½“å‰å±‚çš„èŠ‚ç‚¹ã€‚ 1. ä¸€æ£µæ ‘æ¯å±‚èŠ‚ç‚¹çš„å¹³å‡æ•° Average of Levels in Binary Tree (Easy) public List\u003cDouble\u003e averageOfLevels (TreeNode root){ List\u003cDouble\u003e ret = new ArrayList\u003c\u003e(); if (root == null) return ret; Queue\u003cTreeNode\u003e queue = new LinkedList\u003c\u003e(); queue.add(root); while (!queue.isEmpty()){ int cnt = queue.size(); double sum = 0; for(int i = 0; i \u003c cnt; i++){ TreeNode node = queue.poll(); sum += node.val; if (node.left != null) queue.add(node.left); if (node.right != null) queue.add(node.right); } ret.add(sum / cnt); } return ret; } 2. å¾—åˆ°å·¦ä¸‹è§’çš„èŠ‚ç‚¹ Find Bottom Left Tree Value (Easy) Input: 1 / \\ 2 3 / / \\ 4 5 6 / 7 Output: 7 è§£é¢˜ï¼š å®½åº¦ä¼˜å…ˆéå† BFSï¼Œæ¯ä¸€è¡Œä»å·¦è‡³å³æ”¹æˆä»å³è‡³å·¦ï¼Œç„¶åæœ€åä¸€ä¸ªæ•° public int findBottomLeftValue(TreeNode root) { Queue\u003cTreeNode\u003e queue = new LinkedList\u003c\u003e(); queue.add(root); while(!queue.isEmpty()){ root = queue.poll(); if (root.right != null) queue.add(root.right); if (root.left != null) queue.add(root.left); } return root.val; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:7:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å‰ä¸­ååºéå† éé€’å½’å®ç°å‰ä¸­ååºéå† å‰åºéå†ã€åç»­éå† public List\u003cInteger\u003e preOrderTraversal(TreeNode root){ List\u003cInteger\u003e ret = new ArrayList\u003c\u003e(); Stack\u003cTreeNode\u003e stack = new Stack\u003c\u003e(); stack.push(root); while(!stack.isEmpty()){ TreeNode node = stack.pop(); if (node == null) continue; ret.add(node.val); stack.push(node.right); //å…ˆå³åå·¦ï¼Œä¿è¯å·¦å­æ ‘å…ˆéå†ã€‚å…ˆå·¦åå³å³ä¸ºåç»­éå†ã€‚ stack.push(node.left); } return ret; } ä¸­åºéå† public List\u003cInteger\u003e inorderTraversal(TreeNode root) { List\u003cInteger\u003e ret = new ArrayList\u003c\u003e(); if (root == null) return ret; Stack\u003cTreeNode\u003e stack = new Stack\u003c\u003e(); TreeNode cur = root; while(cur != null || !stack.isEmpty()){ while(cur != null){ stack.push(cur); cur = cur.left; } TreeNode node = stack.pop(); ret.add(node.val); cur = node.right; } return ret; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:7:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"BSTäºŒå‰æŸ¥æ‰¾æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBSTï¼‰ï¼šæ ¹èŠ‚ç‚¹å¤§äºç­‰äºå·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹ï¼Œå°äºç­‰äºå³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘ä¸­åºéå†æœ‰åºã€‚ 1. ä¿®å‰ªäºŒå‰æŸ¥æ‰¾æ ‘ Trim a Binary Search Tree Input: 3 / \\ 0 4 \\ 2 / 1 L = 1 R = 3 Output: 3 / 2 / 1 é¢˜ç›®æè¿°ï¼šåªä¿ç•™å€¼åœ¨ L ~ R ä¹‹é—´çš„èŠ‚ç‚¹ è§£é¢˜ï¼š public TreeNode trimBST(TreeNode root, int L, int R){ if(root == null) return null; if(root.val \u003e R) return trimBST(root.left, L, R); if(root.val \u003c L) return trimBST(root.right, L, R); root.left = trimBST(root.left, L, R); root.right = trimBST(root.right, L, R); return root; } 2.å¯»æ‰¾äºŒå‰æŸ¥æ‰¾æ ‘ç¬¬Kä¸ªå…ƒç´  Kth Smallest Element in a BST (Medium) ä¸­åºéå†è§£æ³•ï¼š private int cnt = 0; private int val; public int kthSmallest(TreeNode root, int k){ if(node == null) return; inOrder(node.left, k); //ä¸­åºéå†æŸ¥æ‰¾æ ‘æœ‰åºï¼Œå·¦å­æ ‘èµ°åˆ°åº•ä¸ºæœ€å°æ•° cnt++; if(cnt == k){ val = node.val; return; } inOrder(node.right, k); //ä¸­åºéå†å‘å³å­æ ‘ } 3. æŠŠäºŒå‰æŸ¥æ‰¾æ ‘æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½åŠ ä¸Šæ¯”å®ƒå¤§çš„èŠ‚ç‚¹çš„å€¼ Convert BST to Greater Tree (Easy) Input: The root of a Binary Search Tree like this: 5 / \\ 2 13 Output: The root of a Greater Tree like this: 18 / \\ 20 13 è§£é¢˜ï¼š å…ˆéå†å³å­æ ‘ã€‚åå‘ä¸­åºéå†å³ä»å¤§åˆ°å°. private int sum = 0; public TreeNode convertBST(TreeNode root){ traver(root); return root; } private void traver(TreeNode node){ if(node == null) return; traver(node.right); //åˆ°æœ€å¤§çš„èŠ‚ç‚¹ sum += node.val; node.val = sum; traver(node.left); } 4. äºŒå‰æŸ¥æ‰¾æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Lowest Common Ancestor of a Binary Search Tree (Easy) _______6______ / \\ ___2__ ___8__ / \\ / \\ 0 4 7 9 / \\ 3 5 For example, the lowest common ancestor (LCA) of nodes 2 and 8 is 6. Another example is LCA of nodes 2 and 4 is 2, since a node can be a descendant of itself according to the LCA definition. è§£é¢˜ï¼š å‰åºéå†ï¼Œç¬¬ä¸€ä¸ªæ»¡è¶³åŒºé—´ä¸­çš„æ•°å³ä¸ºæœ€è¿‘æ ¹ã€‚ public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q){ if(root.val \u003e p.val \u0026\u0026 root.val \u003e q.val) return lowestCommonAncestor(root.left, p, q); if(root.val \u003c p.val \u0026\u0026 root.val \u003c q.val) return lowestCommonAncestor(root.right, p, q); } 6. ä»æœ‰åºæ•°ç»„ä¸­æ„é€ äºŒå‰æŸ¥æ‰¾æ ‘ Convert Sorted Array to Binary Search Tree (Easy) public TreeNode sortedArrayToBST(int[] nums){ return toBST(nums, 0, nums.length - 1); } private TreeNode toBST(int[] nums, int sIdx, int eIdx){ if(sIdx \u003e eIdx) return null; int mIdx = (sIdx + eIdx) / 2; TreeNode root = new TreeNode(nums[mIdex]); root.left = toBST(nums, sIdx, mIdx - 1); root.right = toBST(nums, mIdx + 1, eIdx); return root; } 7. æ ¹æ®æœ‰åºé“¾è¡¨æ„é€ å¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ Convert Sorted List to Binary Search Tree (Medium) 8. åœ¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸­å¯»æ‰¾ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä½¿å®ƒä»¬çš„å’Œä¸ºä¸€ä¸ªç»™å®šå€¼ Two Sum IV - Input is a BST (Easy) Input: 5 / \\ 3 6 / \\ \\ 2 4 7 Target = 9 Output: True è§£é¢˜ï¼š ä½¿ç”¨ä¸­åºéå†å¾—åˆ°æœ‰åºæ•°ç»„ä¹‹åï¼Œå†åˆ©ç”¨åŒæŒ‡é’ˆå¯¹æ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ã€‚ åº”è¯¥æ³¨æ„åˆ°ï¼Œè¿™ä¸€é¢˜ä¸èƒ½ç”¨åˆ†åˆ«åœ¨å·¦å³å­æ ‘ä¸¤éƒ¨åˆ†æ¥å¤„ç†è¿™ç§æ€æƒ³ï¼Œå› ä¸ºä¸¤ä¸ªå¾…æ±‚çš„èŠ‚ç‚¹å¯èƒ½åˆ†åˆ«åœ¨å·¦å³å­æ ‘ä¸­ã€‚ public boolean findTarget(TreeNode root, int k) { List\u003cInteger\u003e nums = new ArrayList\u003c\u003e(); inOrder(root, nums); int i = 0, j = nums.size() - 1; while (i \u003c j) { int sum = nums.get(i) + nums.get(j); if (sum == k) return true; if (sum \u003c k) i++; else j--; } return false; } private void inOrder(TreeNode root, List\u003cInteger\u003e nums) { if (root == null) return; inOrder(root.left, nums); nums.add(root.val); inOrder(root.right, nums); } 9. åœ¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æŸ¥æ‰¾ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹å·®çš„æœ€å°ç»å¯¹å€¼ Minimum Absolute Difference in BST (Easy) Input: 1 \\ 3 / 2 Output: 1 è§£é¢˜ï¼š åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸­åºéå†æœ‰åºçš„æ€§è´¨ï¼Œè®¡ç®—ä¸­åºéå†ä¸­ä¸´è¿‘çš„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹å·®çš„ç»å¯¹å€¼ï¼Œå–æœ€å°å€¼ã€‚ private int minDiff = Integer.MAX_VALUE; private TreeNode preNode = null; public int getMinimumDifference(TreeNode root){ inOrder(root); return minDiff; } private void inOrder(TreeNode node){ if (node == null) return; inOrder(node.left); if (preNode != null) minDiff = Math.min(minDiff, node.val - preNode.val); preNode = node; inOrder(node.right); } 10. å¯»æ‰¾äºŒå‰æŸ¥æ‰¾æ ‘ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å€¼ Find Mode in Binary Search Tree (Easy) private int curCnt = 1; private int maxCnt = 1; private TreeNode preNode = null; public int[] findMode(TreeNode root){ List\u003cInteger\u003e maxCntNums = new ArrayList\u003c\u003e(); inOrder(root, maxCntNums); int[] ret = new int[maxCntNums.size()]; int idx = 0; for(int num : maxCntNums){ ret[idx++] = num; } return ret; } private void inOrder(TreeNode node, List\u003cInteger\u003e nums){ if(node == null) return; inOrder(node.left, nums); if(preNode != null){ if (preNode.val == node.val) curCnt++; else curCnt = 1; } if(curCnt \u003e maxCnt){ maxCnt = curCnt; nu","date":"2020-01-14","objectID":"/20200114_leetcode/:7:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Trie å‰ç¼€æ ‘ Trie æ¦‚å¿µï¼šå•è¯é›†åˆç”Ÿæˆç”±å­—æ¯ç»„æˆçš„æ ‘ã€‚åˆç§°å‰ç¼€æ ‘æˆ–å­—å…¸æ ‘ï¼Œç”¨äºåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨æˆ–è€…æ˜¯å¦å…·æœ‰æŸç§å­—ç¬¦ä¸²å‰ç¼€ã€‚ trie 1.å®ç°ä¸€ä¸ª Trie Implement Trie (Prefix Tree) (Medium) class Trie{ private class Node{ Node[] childs = new Node[26]; boolean isLeaf; } private Node root = new Node(); public Trie(){ } public void insert(String word, Node node){ insert(word, root); } private void insert(String word, Node node){ if(node == null) return; if(word.length() == 0){ node.isLeaf = true; return; } int index = indexForChar(word.charAt(0)); if(node.childs[index] == null){ node.childs[index] = new Node(); } insert(word.substring(1), node.childs[index]); } public boolean search(String word){ return search(word, root); } private boolean search(String word, Node node){ if(node == null) return false; if(word.length() == 0) node.isLeaf; int index = indexForChar(word.charAt(0)); return search(word.substring(1), node.childs[index]); } public boolean startsWith(String prefix){ return startWith(prefix, root); } private boolean startWith(String prefix, Node node){ if(node == null) return false; if(prefix.length() == 0) return true; int index = indexForChar(prefix.charAt(0)); return startWith(prefix.substring(1), node.childs[index]); } private int indexForChar(char c) { return c - 'a'; } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:7:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - æ ˆå’Œé˜Ÿåˆ— ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"1. ç”¨æ ˆå®ç°é˜Ÿåˆ— Implement Queue using Stacks (Easy) è§£é¢˜ï¼š æ ˆçš„é¡ºåºä¸ºåè¿›å…ˆå‡ºï¼Œè€Œé˜Ÿåˆ—çš„é¡ºåºä¸ºå…ˆè¿›å…ˆå‡ºã€‚ä½¿ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—ï¼Œä¸€ä¸ªå…ƒç´ éœ€è¦ç»è¿‡ä¸¤ä¸ªæ ˆæ‰èƒ½å‡ºé˜Ÿåˆ—ï¼Œåœ¨ç»è¿‡ç¬¬ä¸€ä¸ªæ ˆæ—¶å…ƒç´ é¡ºåºè¢«åè½¬ï¼Œç»è¿‡ç¬¬äºŒä¸ªæ ˆæ—¶å†æ¬¡è¢«åè½¬ã€‚ class MyQueue{ private Stack\u003cInteger\u003e in = new Stack\u003c\u003e(); private Stack\u003cInteger\u003e out = new Stack\u003c\u003e(); public void push(int x){ in.push(x); } public int pop(){ in2out(); return out.pop(); } public int peek(){ in2out(); return out.peek(); } private void in2out(){ if(out.isEmpty()){ while(!in.isEmpty()){ out.push(in.pop()); } } } public boolean empty(){ return in.isEmpty() \u0026\u0026 out.isEmpty(); } } ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"2. ç”¨é˜Ÿåˆ—å®ç°æ ˆ Stack using Queues (Easy) è§£é¢˜ï¼š åœ¨å°†ä¸€ä¸ªå…ƒç´ xæ’å…¥é˜Ÿåˆ—æ—¶ï¼Œä¸ºäº†ç»´æŠ¤åŸæ¥çš„åè¿›å…ˆå‡ºé¡ºåºï¼Œéœ€è¦è®©xæ’å…¥é˜Ÿåˆ—é¦–éƒ¨ã€‚è€Œé˜Ÿåˆ—é»˜è®¤æ’å…¥é¡ºåºæ˜¯é˜Ÿåˆ—å°¾éƒ¨ï¼Œå› æ­¤åœ¨å°†xæ’å…¥é˜Ÿåˆ—å°¾éƒ¨ä¹‹åï¼Œéœ€è¦è®©é™¤äº†xä¹‹å¤–çš„æ‰€æœ‰å…ƒç´ å‡ºé˜Ÿåˆ—ï¼Œå†å…¥é˜Ÿåˆ—ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"3. æœ€å°å€¼æ ˆ Min Stack (Easy) class MinStack { private Stack\u003cInteger\u003e dataStack; private Stack\u003cInteger\u003e minStack; private int min; public MinStack() { dataStack = new Stack\u003c\u003e(); minStack = new Stack\u003c\u003e(); min = Integer.MAX_VALUE; } public void push(int x) { dataStack.add(x); min = Math.min(min, x); minStack.add(min); } public void pop() { dataStack.pop(); minStack.pop(); min = minStack.isEmpty() ? Integer.MAX_VALUE : minStack.peek(); } public int top() { return dataStack.peek(); } public int getMin() { return minStack.peek(); } } å¯¹äºå®ç°æœ€å°å€¼é˜Ÿåˆ—é—®é¢˜ï¼Œå¯ä»¥å…ˆå°†é˜Ÿåˆ—ä½¿ç”¨æ ˆæ¥å®ç°ï¼Œç„¶åå°±å°†é—®é¢˜è½¬æ¢ä¸ºæœ€å°å€¼æ ˆã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:3","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"4. ç”¨æ ˆå®ç°æ‹¬å·åŒ¹é… Valid Parentheses (Easy) \"()[]{}\" Output : true public boolean isValid(String s){ Stack\u003cCharacter\u003e stack = new Stack\u003c\u003e(); for(char c : s.toCharArray()){ if(c == '(' || c == '{' || c == '['){ stack.push(c); } else { if(stack.isEmpty()){ return false; } char cStack = stack.pop(); boolean b1 = c == ')' \u0026\u0026 cStack != '('; boolean b2 = c == ']' \u0026\u0026 cStack != '['; boolean b3 = c == '}' \u0026\u0026 cStack != '{'; if(b1 || b2 || b3){ return false; } } } return stack.isEmpty(); } ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:4","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"5. æ•°ç»„ä¸­å…ƒç´ ä¸ä¸‹ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ä¹‹é—´çš„è·ç¦» Daily Temperatures (Medium) Input: [73, 74, 75, 71, 69, 72, 76, 73] Output: [1, 1, 4, 2, 1, 1, 0, 0] è§£é¢˜ï¼š åœ¨éå†æ•°ç»„æ—¶ç”¨æ ˆæŠŠæ•°ç»„ä¸­çš„æ•°å­˜èµ·æ¥ï¼Œå¦‚æœå½“å‰éå†çš„æ•°æ¯”æ ˆé¡¶å…ƒç´ æ¥çš„å¤§ï¼Œè¯´æ˜æ ˆé¡¶å…ƒç´ çš„ä¸‹ä¸€ä¸ªæ¯”å®ƒå¤§çš„æ•°å°±æ˜¯å½“å‰å…ƒç´ ã€‚ public int[] dailyTemperatures(int[] temperatures){ int n = temperatures.length; int[] dist = new int[n]; Stack\u003cInteger\u003e indexs = new Stack\u003c\u003e(); for(int curIndex = 0; curIndex \u003c n; curIndex ++){ while(!indexs.isEmpty() \u0026\u0026 temperatures[curIndex] \u003e temperatures[indexs.peek()]){ int preIndex = indexs.pop(); dist[preIndex] = curIndex - preIndex; } indexs.add(curIndex); } return dist; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:5","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"6. å¾ªç¯æ•°ç»„ä¸­æ¯”å½“å‰å…ƒç´ å¤§çš„ä¸‹ä¸€ä¸ªå…ƒç´  Next Greater Element II (Medium) Input: [1,2,1] Output: [2,-1,2] Explanation: The first 1's next greater number is 2; The number 2 can't find next greater number; The second 1's next greater number needs to search circularly, which is also 2. è§£é¢˜ï¼š ä¸ Daily Temperatures (Medium) ä¸åŒçš„æ˜¯ï¼Œæ•°ç»„æ˜¯å¾ªç¯æ•°ç»„ï¼Œå¹¶ä¸”æœ€åè¦æ±‚çš„ä¸æ˜¯è·ç¦»è€Œæ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ public int[] nextGreaterElements(int[] nums){ int n = nums.length; int[] next = new int[n]; Stack\u003cInteger\u003e pre = new Stack\u003c\u003e(); for(int i = 0; i \u003c n * 2; i++){ int num = nums[i % n]; while(!pre.isEmpty() \u0026\u0026 nums[pre.peek()] \u003c num){ next[pre.pop()] = num; } if(i \u003c n){ pre.push(i); } } return next; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:8:6","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - åˆ†æ²» ","date":"2020-01-14","objectID":"/20200114_leetcode/:9:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®ä¸€ï¼šç»™è¡¨è¾¾å¼åŠ æ‹¬å· Different Ways to Add Parentheses (Medium) Input: \"2-1-1\". ((2-1)-1) = 0 (2-(1-1)) = 2 Output : [0, 2] è§£é¢˜ï¼š åˆ©ç”¨åˆ†æ²»ç®—æ³•ï¼Œåœ¨é¡ºåºæ‰«æè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå½“é‡åˆ°ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œè¯¥è¿ç®—ç¬¦å°†æ•´ä¸ªè¡¨è¾¾å¼åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè¡¨è¾¾å¼å·¦å³å‡æ˜¯å®Œæ•´çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥å¯¹ä¸¤è¾¹çš„è¡¨è¾¾å¼åˆ†å¼€å¤„ç†ï¼Œåˆ†åˆ«å¾—åˆ°ä¸¤ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ•°ç»„ï¼Œç„¶åæ ¹æ®è¯¥è¿ç®—ç¬¦å¯¹ä¸¤è¾¹çš„ç»“æœæ•°ç»„åšç›¸åº”çš„å¤„ç†ï¼Œå†å¯¹æ•´ä½“è¡¨è¾¾å¼çš„ä¸‹ä¸€ä¸ªè¿ç®—ç¬¦åšä¸Šè¿°å¤„ç†ï¼Œç›´åˆ°æ‰€æœ‰è¿ç®—ç¬¦ã€‚ public List\u003cInteger\u003e diffWaysToCompute(String input) { List\u003cInteger\u003e ways = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c input.length(); i++) { char c = input.charAt(i); if (c == '+' || c == '-' || c == '*') { List\u003cInteger\u003e left = diffWaysToCompute(input.substring(0, i)); List\u003cInteger\u003e right = diffWaysToCompute(input.substring(i + 1)); for (int l : left) { for (int r : right) { switch (c) { case '+': ways.add(l + r); break; case '-': ways.add(l - r); break; case '*': ways.add(l * r); break; } } } } } if (ways.size() == 0) { ways.add(Integer.valueOf(input)); } return ways; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:9:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"é¢˜ç›®äºŒï¼šä¸åŒçš„äºŒå‰æœç´¢æ ‘ Unique Binary Search Trees II (Medium) ç»™å®šä¸€ä¸ªæ•°å­— nï¼Œè¦æ±‚ç”Ÿæˆæ‰€æœ‰å€¼ä¸º 1â€¦n çš„äºŒå‰æœç´¢æ ‘ã€‚ äºŒå‰æœç´¢æ ‘ï¼šå¯¹äºæ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹ï¼š è‹¥å…¶å·¦å­æ ‘å­˜åœ¨ï¼Œåˆ™å…¶å·¦å­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½ä¸å¤§äºè¯¥èŠ‚ç‚¹å€¼ï¼› è‹¥å…¶å³å­æ ‘å­˜åœ¨ï¼Œåˆ™å…¶å³å­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½ä¸å°äºè¯¥èŠ‚ç‚¹å€¼ã€‚ Input: 3 Output: [ [1,null,3,2], [3,2,null,1], [3,1,null,null,2], [2,1,3], [1,null,2,null,3] ] Explanation: The above output corresponds to the 5 unique BST's shown below: 1 3 3 2 1 \\ / / / \\ \\ 3 2 1 1 3 2 / / \\ \\ 2 1 2 3 è§£é¢˜ï¼š public List\u003cTreeNode\u003e generateTrees(int n) { if (n \u003c 1) { return new LinkedList\u003cTreeNode\u003e(); } return generateSubtrees(1, n); } private List\u003cTreeNode\u003e generateSubtrees(int s, int e) { List\u003cTreeNode\u003e res = new LinkedList\u003cTreeNode\u003e(); if (s \u003e e) { res.add(null); return res; } for (int i = s; i \u003c= e; ++i) { List\u003cTreeNode\u003e leftSubtrees = generateSubtrees(s, i - 1); List\u003cTreeNode\u003e rightSubtrees = generateSubtrees(i + 1, e); for (TreeNode left : leftSubtrees) { for (TreeNode right : rightSubtrees) { TreeNode root = new TreeNode(i); root.left = left; root.right = right; res.add(root); } } } return res; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:9:2","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - åŠ¨æ€è§„åˆ’ é€’å½’å’ŒåŠ¨æ€è§„åˆ’çš„åŒºåˆ« éƒ½æ˜¯å°†åŸé—®é¢˜æ‹†æˆå¤šä¸ªå­é—®é¢˜ç„¶åæ±‚è§£ï¼Œä»–ä»¬ä¹‹é—´æœ€æœ¬è´¨çš„åŒºåˆ«æ˜¯ï¼ŒåŠ¨æ€è§„åˆ’ä¿å­˜äº†å­é—®é¢˜çš„è§£ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:10:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"æ–æ³¢é‚£å¥‘æ•°åˆ— é¢˜ç›®ä¸€ï¼šçˆ¬æ¥¼æ¢¯ Climbing Stairs (Easy) é¢˜ç›®æè¿°ï¼šæœ‰ N é˜¶æ¥¼æ¢¯ï¼Œæ¯æ¬¡å¯ä»¥ä¸Šä¸€é˜¶æˆ–è€…ä¸¤é˜¶ï¼Œæ±‚æœ‰å¤šå°‘ç§ä¸Šæ¥¼æ¢¯çš„æ–¹æ³•ã€‚ è§£é¢˜ï¼š å®šä¹‰ä¸€ä¸ªæ•°ç»„ dp å­˜å‚¨ä¸Šæ¥¼æ¢¯çš„æ–¹æ³•æ•°ï¼ˆä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œæ•°ç»„ä¸‹æ ‡ä» 1 å¼€å§‹ï¼‰ï¼Œdp[i] è¡¨ç¤ºèµ°åˆ°ç¬¬ i ä¸ªæ¥¼æ¢¯çš„æ–¹æ³•æ•°ç›®ã€‚ ç¬¬ i ä¸ªæ¥¼æ¢¯å¯ä»¥ä»ç¬¬ i-1 å’Œ i-2 ä¸ªæ¥¼æ¢¯å†èµ°ä¸€æ­¥åˆ°è¾¾ï¼Œèµ°åˆ°ç¬¬ i ä¸ªæ¥¼æ¢¯çš„æ–¹æ³•æ•°ä¸ºèµ°åˆ°ç¬¬ i-1 å’Œç¬¬ i-2 ä¸ªæ¥¼æ¢¯çš„æ–¹æ³•æ•°ä¹‹å’Œã€‚ dp[i] = dp[i - 1] + dp[i - 2] è€ƒè™‘åˆ° dp[i] åªä¸ dp[i - 1] å’Œ dp[i - 2] æœ‰å…³ï¼Œå› æ­¤å¯ä»¥åªç”¨ä¸¤ä¸ªå˜é‡æ¥å­˜å‚¨ dp[i - 1] å’Œ dp[i - 2]ï¼Œä½¿å¾—åŸæ¥çš„ O(N) ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–ä¸º O(1) å¤æ‚åº¦ã€‚ public int climbStairs(int n){ if(n \u003c= 2){ return n; } int pre2 = 1, pre1 = 2; for(int i = 2;i \u003c n;i++){ int cur = pre1 + pre2; pre2 = pre1; pre1 = cur; } return pre1; } é¢˜ç›®äºŒï¼šå¼ºç›—æŠ¢åŠ« House Robber (Easy) é¢˜ç›®æè¿°ï¼šæŠ¢åŠ«ä¸€æ’ä½æˆ·ï¼Œä½†æ˜¯ä¸èƒ½æŠ¢é‚»è¿‘çš„ä½æˆ·ï¼Œæ±‚æœ€å¤§æŠ¢åŠ«é‡ã€‚ è§£é¢˜ï¼š ","date":"2020-01-14","objectID":"/20200114_leetcode/:10:1","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å›¾ å›¾çš„æè¿°æ–¹å¼: public class Node { public int value; //ç‚¹çš„ç¼–å· public int in; //å…¥åº¦çš„ä¸ªæ•° public int out; //å‡ºåº¦çš„ä¸ªæ•° public ArrayList\u003cNode\u003e nexts; //é‚»å±…ç‚¹ public ArrayList\u003cEdge\u003e edges; //é‚»å±…è¾¹ public Node(int =value) { this.value = value; in = 0; out = 0; nexts = new ArrayList\u003c\u003e(); edges = new ArrayList\u003c\u003e(); } } public class Edge { public int weight; public Node from; public Node to; public Edge(int weight, Node from, Node to) { this.weight = weight; this.from = from; this.to = to; } } public class Graph { public HashMap\u003cInteger, Node\u003e nodes; //ç‚¹é›† public HashSet\u003cEdge\u003e edges; //è¾¹é›† public Graph() { nodes = new HashMap\u003c\u003e(); edges = new HashSet\u003c\u003e(); } } å›¾çš„å®½åº¦ä¼˜å…ˆéå†ï¼š åˆ©ç”¨é˜Ÿåˆ—å®ç° ä»æºèŠ‚ç‚¹å¼€å§‹ä¾æ¬¡æŒ‰ç…§å®½åº¦è¿›é˜Ÿåˆ—ï¼Œç„¶åå¼¹å‡º æ¯å¼¹å‡ºä¸€ä¸ªç‚¹ï¼ŒæŠŠè¯¥èŠ‚ç‚¹æ‰€æœ‰æ²¡æœ‰è¿›è¿‡é˜Ÿåˆ—çš„é‚»æ¥ç‚¹æ”¾å…¥é˜Ÿåˆ— ç›´åˆ°é˜Ÿåˆ—å˜ç©º public static void bfs(Node node){ if (node == null){ return; } Queue\u003cNode\u003e queue = new LinkedList\u003c\u003e(); HashSet\u003cNode\u003e set = new HashSet\u003c\u003e(); //æ”¾å…¥å·²å¤„ç†çš„èŠ‚ç‚¹ï¼Œæ£€æŸ¥ç‚¹æ˜¯å¦é‡å¤ã€‚ queue.add(node); set.add(node); while(!queue.isEmpty()){ Node cur = queue.poll(); System.out.println(cur.value); for(Node next : cur.nexts){ if(!set.contains(nexts)){ set.add(next); queue.add(next); } } } } å›¾çš„å¹¿åº¦ä¼˜å…ˆéå†ï¼š åˆ©ç”¨æ ˆå®ç° ä»æºèŠ‚ç‚¹å¼€å§‹ä¾æ¬¡æŒ‰ç…§æ·±åº¦è¿›é˜Ÿåˆ—ï¼Œç„¶åå¼¹å‡º æ¯å¼¹å‡ºä¸€ä¸ªç‚¹ï¼ŒæŠŠè¯¥èŠ‚ç‚¹æ‰€æœ‰æ²¡æœ‰è¿›è¿‡é˜Ÿåˆ—çš„é‚»æ¥ç‚¹æ”¾å…¥é˜Ÿåˆ— ç›´åˆ°é˜Ÿåˆ—å˜ç©º public static void dfs(Node node){ if (node == null){ return; } Stack\u003cNode\u003e stack = new Stack\u003c\u003e(); HashSet\u003cNode\u003e set = new HashSet\u003c\u003e(); stack.add(node); set.add(node); System.out.println(node.value); while(!stack.isEmpty()){ Node cur = stack.pop(); for(Node next : cur.nexts){ if(!set.contains(next)){ stack.push(cur); stack.push(next); set.add(next); System.out.println(next.value); break; } } } } æ‹“æ‰‘æ’åºé—®é¢˜ï¼š å®é™…é—®é¢˜ï¼šç¼–è¯‘ä¾èµ–æ˜¯ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚å¦‚ä½•å†³å®šç¼–è¯‘é¡ºåºã€‚ æ–¹æ³•ï¼šæ‰¾åˆ°å…¥åº¦ä¸º0çš„ç‚¹è¾“å‡ºï¼Œç„¶åæ“¦æ‰è¯¥èŠ‚ç‚¹å’Œè¯¥èŠ‚ç‚¹è¾¹ï¼Œå†æ‰¾åˆ°å…¥åº¦ä¸º0ç‚¹è¾“å‡ºã€‚ä»¥æ­¤å¾€å¤ã€‚ public static List\u003cNode\u003e sortedTopoloty(Graph graph){ HashMap\u003cNode, Integer\u003e inMap = new HashMap\u003c\u003e(); // key: æŸä¸€ä¸ªNodeï¼› valueï¼šå‰©ä½™çš„å…¥åº¦ Queue\u003cNode\u003e zeroInQueue = new LinkedList\u003c\u003e(); // å…¥åº¦ä¸º0æ”¾å…¥è¿™ä¸ªé˜Ÿåˆ—ã€‚ for(Node node: graph.nodes.values()){ inMap.put(node, node.in); if(node.in == 0){ zeroInQueue.add(node); } } // æ‹“æ‰‘æ’åºç»“æœï¼Œä¾æ¬¡åŠ å…¥result List\u003cNode\u003e result = new ArrayList\u003c\u003e(); while(!zeroInQueue.isEmpty()){ Node cur = zeroInQueue.poll(); result.add(cur); for(Node next : cur.nexts){ inMap.put(next, inMap.get(next) - 1); if(inMap.get(next) == 0){ zeroInQueue.add(next); } } } return result; } kruskalç®—æ³•ï¼šé€‚ç”¨èŒƒå›´è¦æ±‚æ— å‘å›¾ primç®—æ³•ï¼šé€‚ç”¨èŒƒå›´è¦æ±‚æ— å‘å›¾ Dijkstraç®—æ³•ï¼šé€‚ç”¨èŒƒå›´æ²¡æœ‰æƒå€¼ä¸ºè´Ÿæ•°çš„è¾¹ ","date":"2020-01-14","objectID":"/20200114_leetcode/:11:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å“ˆå¸Œå‡½æ•° é—®é¢˜ï¼š2çš„32æ¬¡æ–¹ä¸ªç”± 0 - 2 çš„32æ¬¡æ–¹ç»„æˆçš„éšæœºæ•°ï¼Œç”¨1Gå†…å­˜ï¼Œè¿”å›å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•° å¦‚æœç›´æ¥ä½¿ç”¨å“ˆå¸Œè¡¨ {key ï¼šæ¬¡æ•°}ï¼Œä¼šå ç”¨8 * 2 32 ä¸ªå­—èŠ‚ï¼ˆ32Gï¼‰ã€‚ å¯ä»¥å°†æ¯ä¸ªæ•°ç®—å‡ºå“ˆå¸Œå€¼å%100 åå­˜å…¥å“ˆå¸Œè¡¨ï¼Œè¿™æ · 2 32 ä¸ª keyï¼švalue å˜æˆäº†ä¸€ç™¾ä¸ªkeyï¼švalueã€‚ å†å°†æ¬¡æ•°æœ€å¤šçš„ key è¿›è¡Œç»Ÿè®¡ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:12:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"å¸ƒéš†è¿‡æ»¤å™¨ è§£å†³é—®é¢˜ï¼š é»‘åå•ç³»ç»Ÿï¼ˆ100äº¿ URL ç»„æˆçš„é»‘åå•ï¼Œæ¯æ¬¡è®¿é—®è¦åˆ¤æ–­æ˜¯å¦åœ¨é»‘åå•ä¸­ï¼Œç”¨ HashSet åˆ™å ç”¨ 640G å†…å­˜ï¼‰ çˆ¬è™«å»é‡é—®é¢˜ç­‰ ï¼ˆä½¿ç”¨1000ä¸ªçº¿ç¨‹çˆ¬è™«ï¼Œä¸å¸Œæœ›çˆ¬å·²ç»çˆ¬è¿‡çš„ç½‘ç«™ï¼Œéœ€è¦æŠŠå·²ç»çˆ¬è¿‡çš„ç½‘ç«™åšæˆé›†åˆï¼‰ åŠŸèƒ½ï¼š åªæœ‰æ·»åŠ å’Œæœç´¢åŠŸèƒ½ï¼Œæ²¡æœ‰åˆ é™¤åŠŸèƒ½ ä½¿ç”¨å¾ˆå°‘çš„å†…å­˜ï¼Œå…è®¸æœ‰ä¸€å®šçš„å¤±è¯¯ ä½å›¾ä»£ç ï¼š int [] arr = new int[10]; //æ¯ä¸ª int 4ä¸ªå­—èŠ‚32ä½ï¼Œ10ä¸ªintæ•°ç»„å¯ä»¥è¡¨ç¤º 32bit * 10 -\u003e 320bit //ä¾‹ï¼šæƒ³æ‹¿åˆ°ç¬¬178ä½çš„çŠ¶æ€ int numIndex = 178 / 32; int bitIndex = 178 % 32; //æ‹¿åˆ°178ä½çš„çŠ¶æ€ int s = ((arr[numIndex] \u003e\u003e (bitIndex)) \u0026 1); //æŠŠ178ä½çš„çŠ¶æ€æ”¹æˆ1 arr[numIndex] = arr[numIndex] | (1 \u003c\u003c (bitIndex)); //æŠŠ178ä½çš„çŠ¶æ€æ”¹æˆ0 arr[numIndex] = arr[numIndex] \u0026 (~ (1 \u003c\u003c (bitIndex))); å¸ƒéš†è¿‡æ»¤å™¨é€»è¾‘ï¼š ç”Ÿæˆå¸ƒéš†è¿‡æ»¤å™¨ï¼š //1. ç”Ÿæˆ m é•¿åº¦çš„ä½å›¾ //2. åŠ å…¥é»‘åå•ï¼šURL1 é€šè¿‡kä¸ª hash å‡½æ•°ç®—å‡ºkä¸ª hash å€¼ %m ï¼Œç¡®ç«‹kä¸ªä½æ•°å€¼ä½ 1 ã€‚æ›´æ–°åˆ°ä½å›¾ä¸Š //3. æ­¤æ—¶ä½å›¾å·²è®°å½• URL1 ã€‚ä»¥æ­¤é‡å¤, å·²ç»ä¸º1ç»§ç»­ä¸º1ï¼Œç›´åˆ°å†™å…¥ 100äº¿ URL æŸ¥è¯¢ï¼š // URL é€šè¿‡kä¸ª hash å‡½æ•°ç®—å‡ºkä¸ª hash å€¼ %mï¼Œåœ¨ä½å›¾ä¸ŠéªŒè¯ï¼Œéƒ½ä¸º 1 åˆ™æ»¡è¶³ må’Œkå€¼å¦‚ä½•ç¡®å®šï¼š // m è¶Šå¤§è¶Šå¥½ï¼Œk è¿‡å¤§è¿‡å°éƒ½ä¸å¥½ã€‚æœ‰è®¡ç®—å…¬å¼ ","date":"2020-01-14","objectID":"/20200114_leetcode/:13:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"ä¸€è‡´æ€§å“ˆå¸Œ è§£å†³é—®é¢˜ï¼š æ•°æ®æœåŠ¡å™¨å¦‚ä½•ç»„ç»‡ï¼Œè§£å†³åˆ†å¸ƒå¼æ•°æ®åº“è´Ÿè½½å‡è¡¡ï¼Œé«˜ä½é¢‘æŸ¥è¯¢ã€‚ ä¼ ç»Ÿåˆ†å¸ƒå¼å­˜å‚¨ï¼š æµ·é‡æ•°æ®åˆ†å¸ƒå¼å­˜å‚¨ï¼šæ•°æ®é€šè¿‡keyå€¼ç®—å‡ºå“ˆå¸Œå€¼ % æœºå™¨æ•°é‡ å†³å®šæ•°æ®å­˜æ”¾æœåŠ¡å™¨èŠ‚ç‚¹ã€‚ å½“æœåŠ¡å™¨ç¡¬ç›˜å¤§å°ä¸å¤Ÿï¼Œéœ€è¦å¢åŠ æœåŠ¡å™¨ã€‚è¿™æ—¶éœ€è¦æ•°æ®å…¨é‡è¿ç§»ï¼Œè€Œä¸”é‡æ–°å°†hashå€¼ % æ–°çš„æœåŠ¡å™¨æ•°é‡ é€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œå­˜å‚¨ä¿è¯ä¸ % ï¼Œå¹¶å‡å°‘è¿ç§»ä»£ä»·ï¼š å¦‚æœ‰ 3 å°æœºå™¨åˆ†å¸ƒå¼å­˜å‚¨æ•°æ®ã€‚é€šè¿‡ MD5 ä½œå“ˆå¸Œå€¼ã€‚ å°†1 ~ 264-1 æƒ³è±¡æˆä¸€ä¸ªç¯ï¼Œå°† [0 , 264 / 3] åˆ†ç»™èŠ‚ç‚¹1ï¼Œ[264 / 3 , 264 / 3 * 2] åˆ†ç»™èŠ‚ç‚¹2ï¼Œ[264 / 3 * 2 , 264] åˆ†ç»™èŠ‚ç‚¹3ã€‚ å½“å¢åŠ èŠ‚ç‚¹æ—¶ï¼Œæ¯”å¦‚èŠ‚ç‚¹æ”¾åœ¨èŠ‚ç‚¹2å’ŒèŠ‚ç‚¹3æ­£ä¸­é—´ã€‚åªç”¨ä»èŠ‚ç‚¹2ä¸Šç§»åŠ¨ 264 / 3 / 2 ä¸ªæ•°æ®åˆ°æ–°èŠ‚ç‚¹ä¸Šã€‚ é—®é¢˜1ï¼šå¼€å§‹å¦‚ä½•å‡åˆ†æ•°æ® é—®é¢˜2ï¼šå¢åŠ å‡å°‘èŠ‚ç‚¹å¯¼è‡´è´Ÿè½½ä¸å‡è¡¡ è™šæ‹ŸèŠ‚ç‚¹æŠ€æœ¯ ï¼šæŒ‰æ¯”ä¾‹å»æŠ¢ç¯ï¼Œå¢åŠ èŠ‚ç‚¹æ—¶ï¼ŒæŒ‰æ¯”ä¾‹ä»æ¯ä¸ªèŠ‚ç‚¹æ‹¿æ•°æ®æ”¾åˆ°æ–°èŠ‚ç‚¹ã€‚åˆ é™¤èŠ‚ç‚¹ä¹ŸæŒ‰æ¯”ä¾‹åˆ†é…åˆ°åˆ«çš„èŠ‚ç‚¹ã€‚ ä¸€è‡´æ€§å“ˆå¸ŒæŒ‰æ¯”ä¾‹åŒæ—¶å¯ä»¥è§£å†³ï¼šæ€§èƒ½å¼ºçš„æœºå™¨æ•°æ®é‡å¤§ï¼Œæ€§èƒ½å¼±çš„æœºå™¨æ•°æ®å°‘ã€‚ ã€é¢˜ç›®ã€‘: å²›é—®é¢˜ ã€é¢˜ç›®ã€‘çŸ©é˜µä¸­åªæœ‰0å’Œ1ä¸¤ç§å€¼ï¼Œæ¯ä¸ªä½ç½®éƒ½å¯ä»¥å’Œè‡ªå·±çš„ä¸Šä¸‹å·¦å³å››ä¸ªä½ç½®ç›¸è¿ï¼Œç›¸é‚»çš„ä¸€ç‰‡1å«åšä¸€ä¸ªå²›ï¼Œæ±‚ä¸€ä¸ªçŸ©é˜µä¸­æœ‰å¤šå°‘ä¸ªå²›ï¼Ÿ 001010 111010 100100 000000 \u003e è¿™ä¸ªçŸ©é˜µä¸­æœ‰ä¸‰ä¸ªå²› ã€è§£é¢˜ã€‘é¡ºåºéå†èŠ‚ç‚¹ï¼Œé‡åˆ°1åˆ™è¿›å…¥æ„ŸæŸ“å‡½æ•°ï¼Œå°†ä¸è¯¥1ä¸€èµ·çš„å²›æ”¹æˆ2ï¼Œå²›æ•°++ã€‚ æ„ŸæŸ“å‡½æ•°ï¼š public static void infect (int[][]m, int i, int j, int N, int M){ //(i,j)ä½ç½® N,MçŸ©å½¢é•¿å®½ if(i \u003c 0 || i \u003e= N || j \u003c 0 || j \u003e= M || m[i][j] != 1){ //i,jæ²¡è¶Šç•Œï¼Œå¹¶ä¸”å½“å‰ä½ç½®æ˜¯1 return; } m[i][j] = 2; infect(m, i + 1, j, N, M); infect(m, i - 1, j, N, M); infect(m, i, j + 1, N, M); infect(m, i, j - 1, N, M); } æ—¶é—´å¤æ‚åº¦ï¼šO(N * M) ã€è¿›é˜¶ã€‘å¦‚ä½•è®¾è®¡ä¸€ä¸ªå¹¶è¡Œç®—æ³•è§£å†³è¿™ä¸ªé—®é¢˜ å¹¶æŸ¥é›†ï¼š è§£å†³ä¸¤ä¸ªé›†åˆæŸ¥é‡ä¸åˆå¹¶ã€‚ä½¿ç”¨ é“¾è¡¨ å’Œ hashSet æ•ˆç‡éƒ½ä¸é«˜ã€‚é“¾è¡¨ åˆå¹¶çš„å¤æ‚åº¦æ˜¯ O(1)ï¼ŒæŸ¥é‡æ˜¯ O(n2)ã€‚ä½¿ç”¨ hashSet æŸ¥é‡ å¤æ‚åº¦æ˜¯ O(n)ï¼Œåˆå¹¶ å¤æ‚åº¦æ˜¯ O(n)ã€‚ //æ‰¾åˆ°å¤´ç»“ç‚¹å‡½æ•°ï¼šåˆ¤æ–­é›†åˆæ˜¯å¦æ˜¯ä¸€ä¸ªé›†åˆåªç”¨åˆ¤æ–­å¤´ç»“ç‚¹æ˜¯å¦ç›¸åŒã€‚ //æ‰¾å¤´ç»“ç‚¹æ—¶åŒæ—¶ä¼˜åŒ–ï¼šå°†è¯¥èŠ‚ç‚¹åˆ°å¤´èŠ‚ç‚¹è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ‹å¹³ï¼Œç›´æ¥æ’åˆ°å¤´ç»“ç‚¹ä¸Šã€‚å½“è°ƒç”¨ findHead å‡½æ•°æ¬¡æ•°è¶Šå¤šï¼Œæ—¶é—´å¤æ‚åº¦è¶Šæ¥è¿‘ O(1) private Element\u003cV\u003e findHead(Element\u003cV\u003e element){ Stack\u003cElement\u003cV\u003e\u003e path = new Stack\u003c\u003e(); while (element != fatherMap.get(element)){ path.push(element); element = fatherMap.get(element); } while (!path.isEmpty()){ fatherMap.put(path.pop(), element); } return element; } //åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€é›†åˆå‡½æ•° public boolean isSameSet(V a, V b){ if (elementMap.containsKey(a) \u0026\u0026 elementMap.containsKey(b)){ return findHead(elementMap.get(a)) == findHead(elementMap.get(b)); } return false; } //åˆå¹¶é›†åˆå‡½æ•°, å°é›†åˆæ’åˆ°å¤§é›†åˆå°¾éƒ¨ public void union(V a, V b){ if (elementMap.containsKey(a) \u0026\u0026 elementMap.containsKey(b)){ ... } } å¹¶è¡Œè§£å†³æ–¹æ¡ˆï¼š å¦‚æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå°†å²›å›¾åˆ‡åˆ†æˆ 2 å—ï¼Œåˆ†åˆ«è¿›è¡Œé¡ºåºéå†æ„ŸæŸ“ã€‚è¿™æ ·ç»Ÿè®¡å‡ºåˆ†æ•£çš„å²›è§†ä¸ºä¸åŒçš„é›†åˆï¼Œå°†è¿™äº›é›†åˆè¿›è¡Œå¹¶æŸ¥é›†åˆå¹¶æ“ä½œï¼Œç®—å‡ºåˆå¹¶åçš„å²›æ•°ã€‚ ","date":"2020-01-14","objectID":"/20200114_leetcode/:14:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Leetcode é¢˜è§£ - è´ªå¿ƒæ€æƒ³ ç¬”è¯•é¢è¯•éƒ½å¾ˆå°‘å‡ºç° æ¦‚å¿µï¼šä¿è¯æ¯æ¬¡æ“ä½œéƒ½æ˜¯å±€éƒ¨æœ€ä¼˜çš„ï¼Œå¹¶ä¸”æœ€åå¾—åˆ°çš„ç»“æœæ˜¯å…¨å±€æœ€ä¼˜çš„ã€‚ å› ä¸ºå˜åŒ–å¤ªå¤šï¼Œç¬”è¯•é¢è¯•éƒ½å¾ˆå°‘å‡ºç°ã€‚ é¢˜ç›®ä¸€ï¼šåˆ†é…é¥¼å¹² Assign Cookies (Easy) Input: grid[1,3], size[1,2,4] Output: 2 é¢˜ç›®æè¿°ï¼šæ¯ä¸ªå­©å­éƒ½æœ‰ä¸€ä¸ªæ»¡è¶³åº¦ gridï¼Œæ¯ä¸ªé¥¼å¹²éƒ½æœ‰ä¸€ä¸ªå¤§å° sizeï¼Œåªæœ‰é¥¼å¹²çš„å¤§å°å¤§äºç­‰äºä¸€ä¸ªå­©å­çš„æ»¡è¶³åº¦ï¼Œè¯¥å­©å­æ‰ä¼šè·å¾—æ»¡è¶³ã€‚æ±‚è§£æœ€å¤šå¯ä»¥è·å¾—æ»¡è¶³çš„å­©å­æ•°é‡ã€‚ è§£é¢˜ï¼š public int findContentChildren(int[] grid, int[] size) { if (grid == null || size == null) return 0; Arrays.sort(grid); Arrays.sort(size); int gi = 0, si = 0; while (gi \u003c grid.length \u0026\u0026 si \u003c size.length) { if (grid[gi] \u003c= size[si]) { gi++; } si++; } return gi; } ","date":"2020-01-14","objectID":"/20200114_leetcode/:15:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"SQL é¢˜ç›®ä¸€ï¼šç™»å½•æ—¥å¿—ï¼Œè®¡ç®—æ¯ä¸ªäººè¿ç»­ç™»å½•çš„æœ€å¤§å¤©æ•°(æ–­ä¸€å¤©ä¹Ÿç®—è¿ç»­) val tx_sql = spark.createDataFrame(Seq( (\"1002\",\"2021-08-01\"), (\"1002\",\"2021-08-02\"), (\"1002\",\"2021-08-04\"), (\"1002\",\"2021-08-05\"), (\"1002\",\"2021-08-06\"), (\"1003\",\"2021-08-01\"), (\"1003\",\"2021-08-04\"), (\"1003\",\"2021-08-05\") )).toDF(\"id\",\"time\") tx_sql.createOrReplaceTempView(\"tx_sql\") æ€è·¯ä¸€ï¼šç­‰å·®æ•°åˆ— å¼€çª—å‡½æ•°ï¼ŒæŒ‰ç…§idåˆ†ç»„åŒæ—¶æŒ‰ç…§æ—¶é—´æ’åºï¼Œæ±‚rank select id,time,rank() over(partition by id order by time) rk from tx_sql å°†æ¯è¡Œæ—¥æœŸå‡å»rkå€¼ï¼Œå¦‚æœä¹‹å‰æ˜¯è¿ç»­çš„æ—¥æœŸï¼Œåˆ™ç›¸å‡ä¹‹åä¸ºç›¸åŒæ—¥æœŸ select if,time,data_sub(time, rk) flag from (select id,time,rank() over(partition by id order by time) rk from tx_sql) t1 è®¡ç®—ç»å¯¹è¿ç»­çš„å¤©æ•°ï¼Œç›¸åŒçš„æ—¥æœŸä¸ªæ•°å³ä¸ºè¿ç»­å¤©æ•° select id,flag,count(*) days from (select id,time,date_sub(time, rk) flag from (select id,time,rank() over(partition by id order by time) rk from tx_sql)t1)t2 group by id,flag å†è®¡ç®—è¿ç»­é—®é¢˜ï¼Œä½¿ç”¨ç›¸åŒæ–¹æ³•å†è®¡ç®—ä¸€æ¬¡ select id,flag,days,rank() over(partition by id order by flag) newFlag from ()t3 æ—¥æœŸå·®1åˆ™å¯ä»¥ç›¸åŠ  select id,flag,sum(days)+count(*)-1 days from t5 group by id,flag å–æœ€å¤§å€¼ æ€è·¯äºŒï¼šæ•°æ® lag ä¸‹ç§»åšå·®å€¼ å°†æ¯è¡Œæ•°æ®ä¸‹ç§» select id,time,lag(1,time,'1970-01-01') over(partition by id order by time) lagDt from tx åšå·®å€¼ select id,time,datediff(time,lagDt) dtDiff from t1 å·®å€¼ä¸º 1æˆ–2 éƒ½è§†ä¸ºè¿ç»­ï¼Œå¤§äº2åˆ™ä¸ºæ–­å¼€ï¼Œåˆ†åˆ°å¦ä¸€ç»„ select id,time,sum(if(dtDiff \u003e 2, 1, 0)) over(partition by id order by time) flag from t2 è®¡ç®—æ¯ä¸€ç»„çš„æœ€å¤§æœ€å°å€¼å·®åŠ ä¸€ select id,flag,datediff(max(dt),min(dt)) + 1 from t3 group by id,flag æ±‚è¿ç»­å¤©æ•°çš„æœ€å¤§å€¼ TIPS HiveOnSpark bug: Datediff over å­æŸ¥è¯¢ =\u003e Nullpoint è§£å†³æ–¹æ¡ˆï¼š æ¢ MR å¼•æ“ å°†æ—¶é—´å­—æ®µç”± String ç±»å‹æ”¹ä¸º Date ç±»å‹ ","date":"2020-01-14","objectID":"/20200114_leetcode/:16:0","tags":["Interview","leetcode","Algorithm"],"title":"Leetcode","uri":"/20200114_leetcode/"},{"categories":["Technology"],"content":"Article description.","date":"2020-01-01","objectID":"/20200101_java-interview/","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"JVM, Garbage Collection, Multi - thread, Redis ","date":"2020-01-01","objectID":"/20200101_java-interview/:0:0","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"JVM Javaä»ç¼–ç åˆ°æ‰§è¡Œ javac å°† x.java(ä»»ä½•è¯­è¨€) æ–‡ä»¶ç¼–ç æˆ x.class æ–‡ä»¶ JVM ä¸­çš„ ClassLoader å°† x.class æ–‡ä»¶è£…è½½åˆ°å†…å­˜é‡Œï¼Œé€šå¸¸ä¹Ÿä¼šæŠŠ javaç±»åº“ä¹Ÿè£…è½½åˆ°å†…å­˜é‡Œ JVM è°ƒç”¨ å­—èŠ‚ç è§£é‡Šå™¨ æˆ– JITå³æ—¶ç¼–è¯‘å™¨(å¸¸ç”¨çš„ä»£ç ä½¿ç”¨å³æ—¶ç¼–è¯‘ï¼Œç¬¬äºŒæ¬¡ç¼–è¯‘çš„æ—¶å€™ç›´æ¥è°ƒç”¨) æ¥è¿›è¡Œè§£é‡Šæˆ–ç¼–è¯‘ *jvmæ˜¯è§£é‡Šæ‰§è¡Œä¹Ÿæ˜¯ç¼–è¯‘æ‰§è¡Œçš„ï¼Œä¹Ÿå¯ä»¥æ··åˆæ‰§è¡Œ JVM æ‰§è¡Œå¼•æ“å¼€å§‹æ‰§è¡Œ JVM jvm æ˜¯ä¸€ç§è§„èŒƒ å®ƒæ˜¯è™šæ„å‡ºæ¥çš„ä¸€å°è®¡ç®—æœº ClassFileFormat äºŒè¿›åˆ¶å­—èŠ‚æµ CLASSæ–‡ä»¶ç»“æ„ å‰4ä¸ªå­—èŠ‚ï¼šmagic ä¸¤ä¸ªå­—èŠ‚ï¼šminor version ä¸¤ä¸ªå­—èŠ‚ï¼šmajor version ä¸¤ä¸ªå­—èŠ‚ï¼šconstant pool count å¸¸é‡æ± ä¸ªæ•° ï¼Œ2ä¸ªå­—èŠ‚ï¼Œæœ€å¤š65535ä¸ª å¸¸é‡æ± ç»“æ„ï¼š constant_utf8_info: tag:1,å ç”¨ç©ºé—´ä¸€ä¸ªå­—èŠ‚ã€‚length: utf-8å­—ç¬¦ä¸²å ç”¨çš„å­—èŠ‚æ•°ã€‚bytes: é•¿åº¦ä½lengthçš„å­—ç¬¦ä¸² constant_integer_info: tag:3,å ç”¨ç©ºé—´ä¸€ä¸ªå­—èŠ‚ã€‚bytes: 4ä¸ªå­—èŠ‚ï¼Œbig-endianï¼ˆé«˜ä½åœ¨å‰ï¼‰å­˜å‚¨çš„intå€¼ constant_methodref_info: tag:10 index:2å­—èŠ‚ï¼ŒæŒ‡å‘å£°æ˜æ–¹æ³•çš„ç±»æˆ–è€…æ¥å£æè¿°ç¬¦constant_class_infoçš„ç´¢å¼•é¡¹ index: 2å­—èŠ‚ï¼ŒæŒ‡å‘å­—æ®µæè¿°ç¬¦constant_nameAndTypeçš„ç´¢å¼•é¡¹ class/this_class/super_class interfaces fields methods Class Loading Linking Initializing classæ–‡ä»¶loadåˆ°å†…å­˜çš„è¿‡ç¨‹ loading: classæ–‡ä»¶æ”¾åˆ°å†…å­˜ åŒäº²å§”æ´¾ï¼Œå®‰å…¨ lazyLoading äº”ä¸­æƒ…å†µ classLoaderï¼šfindInCache -\u003e parent.loadClass -\u003e findClass() è‡ªå®šä¹‰ç±»åŠ è½½å™¨ extends ClassLoader overwrite findClass() -\u003e defineClass(byte[] -\u003e Class clazz) æ··åˆæ‰§è¡Œ linking verificationï¼šæ–‡ä»¶ç¬¦åˆjvmè§„å®šï¼š0xCAFEBABEâ€¦ preparationï¼šé™æ€æˆå‘˜å˜é‡èµ‹é»˜è®¤å€¼ï¼Œint = 0â€¦ resolutionï¼šç±»ã€æ–¹æ³•ã€å±æ€§ç¬¦å·åº”ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨ï¼Œå¸¸é‡æ± ä¸­çš„å„ä¸ªç¬¦å·å¼•ç”¨è§£æä¸ºæŒ‡é’ˆã€åç§»é‡ç­‰å†…å­˜åœ°å€çš„ç›´æ¥å¼•ç”¨ initializingï¼šé™æ€å˜é‡è¿™æ—¶æ‰èµ‹ä¸ºåˆå§‹å€¼ load é™æ€æˆå‘˜å˜é‡ -\u003e é»˜è®¤å€¼ -\u003e åˆå§‹å€¼ new Object -\u003e ç”³è¯·å†…å­˜ -\u003e é»˜è®¤å€¼ -\u003e åˆå§‹å€¼ï¼šå•ä¾‹æ¨¡å¼ä¸­ï¼Œvolatile ç¡®ä¿æŒ‡ä»¤æ‰§è¡Œé¡ºåºï¼Œå…ˆåˆå§‹åŒ–åå†æŠŠå†…å­˜ç»™ t ï¼Œå¦åˆ™æœ‰å¯èƒ½å…ˆæŒ‡å‘å†…å­˜å†åˆå§‹åŒ– ç±»åŠ è½½å™¨ JVM æ˜¯æŒ‰éœ€åŠ¨æ€åŠ è½½ï¼Œé‡‡ç”¨åŒäº²å§”æ´¾æœºåˆ¶ ï¼ˆè‡ªé¡¶å‘ä¸‹ï¼Œè¿›è¡Œå®é™…æŸ¥æ‰¾å’ŒåŠ è½½childæ–¹å‘ï¼‰ Bootstrap -----\u003e åŠ è½½lib/rt.jar charset.jar ç­‰æ ¸å¿ƒç±»ï¼ŒC++å®ç° | Extension -----\u003e åŠ è½½æ‰©å±•jaråŒ…(jre/lib/ext/*.jar)ï¼Œæˆ–ç”± Djava.ext.dirsæŒ‡å®š | Application -----\u003e åŠ è½½classpathæŒ‡å®šå†…å®¹ | Custom ClassLoader -----\u003e è‡ªå®šä¹‰ classLoader ï¼ˆè‡ªåº•å‘ä¸Šæ£€æŸ¥è¯¥ç±»æ˜¯å¦å·²ç»åŠ è½½parentæ–¹å‘ï¼‰ åŒäº²å§”æ´¾ çˆ¶åŠ è½½å™¨ -çˆ¶åŠ è½½å™¨ä¸æ˜¯\"ç±»åŠ è½½å™¨çš„åŠ è½½å™¨\"ï¼Œï¼ï¼ä¹Ÿä¸æ˜¯\"ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨\" åŒäº²å§”æ´¾æ˜¯ä¸€ä¸ªå­©å­å‘çˆ¶äº²æ–¹å‘ï¼Œç„¶åçˆ¶äº²å‘å­©å­æ–¹å‘çš„åŒäº²å§”æ´¾è¿‡ç¨‹ classLoadProcess ä¸ºä»€ä¹ˆè¦åšåŒäº²å§”æ´¾ å®‰å…¨ åŒäº²å§”æ´¾æœºåˆ¶èƒ½å¤Ÿä¿è¯ç±»åŠ è½½å™¨åŠ è½½æŸä¸ªç±»æ—¶ï¼Œæœ€ç»ˆéƒ½æ˜¯ç”±ä¸€ä¸ªåŠ è½½å™¨åŠ è½½ï¼Œç¡®ä¿æœ€ç»ˆåŠ è½½ç»“æœç›¸åŒ æ¯”å¦‚ java.long.object, ä» custom classLoader ä»ä¸‹å‘ä¸Šå¼€å§‹ï¼Œåˆ°Bootstrap å‘ç°å·²ç»åŠ è½½è¿‡äº†ï¼Œå°±ä¸å†åŠ è½½äº† è¡¥å…… class loadåˆ°å†…å­˜ä¸­æœ‰ä¸¤å—ä¸œè¥¿ï¼Œä¸€æ˜¯classäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒäºŒæ˜¯classå¯¹è±¡ã€‚å…¶ä»–è‡ªå·±å†™çš„å¯¹è±¡è®¿é—®å†…å­˜ä¸­çš„classå¯¹è±¡ï¼Œé€šè¿‡classå¯¹è±¡è®¿é—®å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶ method Area ï¼š classå¯¹è±¡æ˜¯å­˜å‚¨åœ¨ method Area ä¸­ï¼Œmethod Area åœ¨å†…å­˜æ˜¯å­˜å‚¨åœ¨ metaspaceä¸­ï¼Œä¹Ÿå°±æ˜¯ permanent generationã€‚1.8ä¹‹å‰å« permanent generationï¼Œ 1.8ä¹‹åå« metaspace ä»€ä¹ˆæ—¶å€™éœ€è¦è°ƒç”¨loadclasså‡½æ•°ï¼Ÿ spring é‡Œæœ‰åŠ¨æ€ä»£ç†ï¼Œspring å°±è°ƒç”¨ loadclass æŠŠ class åŠ è½½åˆ°ç¼“å­˜é‡Œ tomcatï¼Œloadè‡ªå®šä¹‰çš„class çƒ­éƒ¨ç½²ï¼Œçƒ­å¯åŠ¨ ç±»ç¼–è¯‘ è§£é‡Šå™¨ -bytecode intepreter JIT -Just In Time compiler æ··åˆæ¨¡å¼ï¼š -æ··åˆä½¿ç”¨è§£é‡Šå™¨ + çƒ­ç‚¹ä»£ç ç¼–è¯‘ -èµ·å§‹é˜¶æ®µé‡‡ç”¨è§£é‡Šæ‰§è¡Œ -çƒ­ç‚¹ä»£ç æ£€æµ‹ å¤šæ¬¡è¢«è°ƒç”¨çš„æ–¹æ³•ï¼ˆæ–¹æ³•è®¡æ•°å™¨ï¼šç›‘æµ‹æ–¹æ³•æ‰§è¡Œé¢‘ç‡ï¼‰ å¤šæ¬¡è¢«è°ƒç”¨çš„æ–¹æ³•ï¼ˆå¾ªç¯è®¡æ•°å™¨ï¼šæ£€æµ‹å¾ªç¯æ‰§è¡Œé¢‘ç‡ï¼‰ è¿›è¡Œç¼–è¯‘ Xmixed: é»˜è®¤ä¸ºæ··åˆæ¨¡å¼ï¼Œå¼€å§‹è§£é‡Šæ‰§è¡Œï¼Œå¯åŠ¨é€Ÿåº¦è¾ƒå¿«ï¼Œå¯¹çƒ­ç‚¹ä»£ç å®è¡Œæ£€æµ‹å’Œç¼–è¯‘ Xint: è§£é‡Šæ¨¡å¼ï¼Œå¯åŠ¨å¾ˆå¿«æ‰§è¡Œç¨æ…¢ Xcomp: çº¯ç¼–è¯‘æ¨¡å¼ï¼Œæ‰§è¡Œå¾ˆå¿«ï¼Œå¯åŠ¨å¾ˆæ…¢ æ‡’åŠ è½½ new/ get static / put static / invoke static æŒ‡ä»¤ï¼Œè®¿é—® final å˜é‡é™¤å¤– java.lang.reflect å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶ åˆå§‹åŒ–å­ç±»çš„æ—¶å€™ï¼Œçˆ¶ç±»é¦–å…ˆåˆå§‹åŒ– jvmå¯åŠ¨æ—¶ï¼Œè¢«æ‰§è¡Œçš„ä¸»ç±»å¿…é¡»åˆå§‹åŒ– åŠ¨æ€è¯­è¨€æ”¯æŒREF_putstatic/REF_getstatic/REF_invokestaticçš„æ–¹æ³•å¥æŸ„æ—¶ï¼Œè¯¥ç±»å¿…é¡»åˆå§‹åŒ– Initializing //ä¾‹ï¼šæ±‚ T.count main(){ System.out.println(T.count); } class T { public static T t = new T(); public static int count = 2; private T(){ count ++; } } //T.class loadï¼Œç„¶ålinkingï¼Œ //åˆ°preparationï¼Œé™æ€æˆå‘˜å˜é‡èµ‹å€¼é»˜è®¤å€¼ã€‚tä¸ºnullï¼Œcountä¸º0 //ç„¶ååˆ°initializingï¼Œtå…ˆæ‰§è¡Œæ„é€ æ–¹æ³•ï¼Œcountèµ‹å€¼ä¸º2, countä¸º2 class T { public static int count = 2; public static T t = new T(); private T(){ count ++; } } //initializingï¼Œcountèµ‹å€¼ä¸º2ï¼Œtå†æ‰§è¡Œæ„é€ æ–¹æ³• count = 2++ = 3 ","date":"2020-01-01","objectID":"/20200101_java-interview/:1:0","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"GC ç†Ÿæ‚‰GCå¸¸ç”¨ç®—æ³•ï¼Œç†Ÿæ‚‰å¸¸è§åƒåœ¾æ”¶é›†å™¨ï¼Œå…·æœ‰å®é™…JVMè°ƒä¼˜å®æˆ˜ç»éªŒ gc1 ç¨‹åºçš„æ ˆå’Œå † æ ˆï¼š æ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ˆï¼Œæ ˆä¸­ç…§å…ˆè¿›å…ˆå‡ºï¼Œå­˜æ”¾æ–¹æ³• å †ï¼š åŠ¨æ€å†…å­˜å—ï¼Œæ¯”å¦‚ new å¯¹è±¡ ä»€ä¹ˆæ˜¯åƒåœ¾ æ²¡æœ‰å¼•ç”¨æŒ‡å‘ä»–äº†å°±æ˜¯åƒåœ¾ å›æ”¶åƒåœ¾çš„æ–¹æ³• å¼•ç”¨è®¡æ•°æ³•ï¼ˆreference countï¼‰ å½“å¼•ç”¨æŒ‡å‘ä¸º0ï¼Œå›æ”¶ ç¼ºç‚¹ï¼šå½“ä¸‰ä¸ªå†…å­˜åƒåœ¾äº’ç›¸æŒ‡å‘ï¼Œæ— æ³•å›æ”¶ Python æ ¹å¯è¾¾ç®—æ³•ï¼ˆroot searchingï¼‰ GC roots: çº¿ç¨‹æ ˆå˜é‡ï¼Œé™æ€å˜é‡ï¼Œå¸¸é‡æ± ï¼ŒJNIæŒ‡é’ˆ GC çš„æ¼”åŒ– éšç€å†…å­˜å¤§å°çš„ä¸æ–­å¢é•¿è€Œæ¼”è¿› å †å†…å­˜é€»è¾‘åˆ†åŒº åˆ†ä»£æ¨¡å‹ï¼š åˆšåˆšè¯ç”Ÿçš„å¯¹è±¡ä¼˜å…ˆæ”¾åœ¨æ–°ç”Ÿä»£å†…å­˜åŒºï¼Œ éšç€GCå™¨çš„æ‰«ææ–°ç”Ÿä»£ï¼Œæ–°ç”Ÿä»£å†…å­˜è‹¥å¤šæ¬¡æ²¡è¢«å›æ”¶(åœ¨Surviverä¸¤ä¸ªåŒºåå¤æ¨ªè·³å¤šæ¬¡)ä¼šå˜æˆè€å¹´ä»£(gcæ­£å¸¸ä¸ç®¡è¿™ç‰‡åŒºåŸŸ) GC ç®—æ³• Mark - Sweep (æ ‡è®°æ¸…é™¤) æ ‡è®°åˆ†ä¸ºï¼šå­˜è´§å¯¹è±¡ï¼Œæœªä½¿ç”¨å†…å­˜åŒºï¼Œå¯å›æ”¶å†…å­˜åŒº ç¼ºç‚¹ï¼šç¢ç‰‡åŒ–ä¸¥é‡ï¼Œåˆ†å¤§å—å†…å­˜æ—¶ä¸ä¾¿ Copying åŸºäºæ ‡è®°ï¼Œæ•´é½æ‹·è´åˆ°æ–°åŒºåŸŸï¼ŒåŸå†…å­˜æ•´ä½“æ€§å›æ”¶ ç¼ºç‚¹ï¼šæµªè´¹å†…å­˜ Mark - Compact (æ ‡è®°å‹ç¼©) åŸºäºcopyingï¼Œå›æ”¶æ—¶ç›´æ¥æ•´ç†å†…å­˜ ç¼ºç‚¹ï¼šæ•ˆç‡æœ€ä½ GC å™¨ Serial GC: ä¼˜ç‚¹ï¼šå•çº¿ç¨‹ç²¾ç®€çš„GCå®ç°ï¼Œæ— éœ€ç»´æŠ¤å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåˆå§‹åŒ–ç®€å•ï¼Œæ˜¯clientæ¨¡å¼ä¸‹JVMé»˜è®¤é€‰é¡¹ã€‚æœ€å¤è€çš„GCã€‚ ç¼ºç‚¹ï¼šä¼šè¿›å…¥\"Stop-The World\"çŠ¶æ€ã€‚ ParNew GCï¼š æ–°ç”Ÿä»£GCå®ç°ï¼Œæ˜¯SerialGCçš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œæœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯é…åˆè€å¹´ä»£çš„CMS GC å·¥ä½œ CMSï¼ˆConcurrent Mark Sweepï¼‰GC : åˆå§‹æ ‡è®° (STW) -\u003e å¹¶å‘æ ‡è®° -\u003e é‡æ–°æ ‡è®° (STW) (ä¸‰è‰²æ ‡è®°)-\u003e å¹¶å‘æ¸…ç† ä¸‰è‰²æ ‡è®°ç®—æ³•ï¼š é»‘è‰²ï¼šè‡ªå·±å·²ç»æ ‡è®°ï¼Œå­èŠ‚ç‚¹éƒ½æ ‡è®°å®Œæˆã€‚ä¸‹æ¬¡æ‰«æä¸æ‰«æ ç°è‰²ï¼šè‡ªå·±å·²ç»æ ‡è®°ï¼Œå­èŠ‚ç‚¹è¿˜æ²¡æ ‡è®°ã€‚ä¸‹æ¬¡æ‰«æåªæ‰«æå­èŠ‚ç‚¹ ç™½è‰²ï¼šæ²¡æœ‰éå†åˆ°çš„èŠ‚ç‚¹ã€‚ Incremental update ä¼˜ç‚¹ï¼š åŸºäºæ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•ï¼Œå°½é‡å‡å°‘åœé¡¿æ—¶é—´ã€‚ ç¼ºç‚¹ï¼š Incremental updateå¤©ç„¶bugï¼Œä¼šæœ‰æ¼æ ‡çš„é—®é¢˜ï¼Œæ‰€ä»¥CMSçš„remarké˜¶æ®µï¼Œå¿…é¡»é‡å¤´æ‰«æä¸€éï¼ŒSTWæ˜¯æ‰€æœ‰æ—¶é—´æœ€é•¿çš„ã€‚å­˜åœ¨ç¢ç‰‡åŒ–é—®é¢˜ï¼Œåœ¨é•¿æ—¶é—´è¿è¡Œçš„æƒ…å†µä¸‹ä¼šå‘ç”Ÿfull GCï¼Œå¯¼è‡´æ¶åŠ£åœé¡¿ã€‚ä¼šå ç”¨æ›´å¤šçš„CPUèµ„æºï¼Œå’Œç”¨æˆ·äº‰æŠ¢çº¿ç¨‹ã€‚åœ¨JDK 9ä¸­è¢«æ ‡è®°ä¸ºåºŸå¼ƒã€‚ Parrallel GCï¼ˆparallel Scavenge + parallel oldï¼‰ï¼š åœ¨JDK8ç­‰ç‰ˆæœ¬ä¸­ï¼Œæ˜¯serveræ¨¡å¼JVMçš„é»˜è®¤GCé€‰æ‹©ï¼Œä¹Ÿè¢«ç§°ä¸ºååé‡ä¼˜å…ˆçš„GCï¼Œç®—æ³•å’ŒSerial GCç›¸ä¼¼ï¼Œç‰¹ç‚¹æ˜¯è€ç”Ÿä»£å’Œæ–°ç”Ÿä»£GCå¹¶è¡Œè¿›è¡Œï¼Œæ›´åŠ é«˜æ•ˆã€‚ G1 GCï¼š å…¼é¡¾äº†ååé‡å’Œåœé¡¿æ—¶é—´çš„GCå®ç°ï¼Œæ˜¯Oracle JDK 9åé»˜è®¤çš„GC å¯ä»¥ç›´è§‚çš„è®¾å€¼åœé¡¿æ—¶é—´ï¼Œç›¸å¯¹äºCMS GC ï¼ŒG1æœªå¿…èƒ½åšåˆ°CMSæœ€å¥½æƒ…å†µä¸‹çš„å»¶æ—¶åœé¡¿ï¼Œä½†æ¯”æœ€å·®æƒ…å†µè¦å¥½å¾—å¤š G1 ä»å­˜åœ¨å¹´ä»£çš„æ¦‚å¿µï¼ŒG1ç‰©ç†ä¸Šä¸åˆ†ä»£ï¼Œé€»è¾‘åˆ†ä»£ï¼Œä½¿ç”¨äº†Regionæ£‹ç›˜ç®—æ³•ï¼Œå®é™…ä¸Šæ˜¯æ ‡è®°-æ•´ç†ï¼ˆMark-Compactï¼‰ç®—æ³•ï¼Œå¯ä»¥é¿å…å†…å­˜ç¢ç‰‡ï¼Œå°¤å…¶æ˜¯å †éå¸¸å¤§çš„æ—¶å€™ï¼ŒG1ä¼˜åŠ¿æ›´æ˜æ˜¾ã€‚ G1 ååé‡å’Œåœé¡¿è¡¨ç°éƒ½éå¸¸ä¸é”™ã€‚ ZGCï¼š colored Pointer + Load Barrier ä¸å†åˆ†ä»£ shenandoahï¼š å’Œ ZGC ç±»ä¼¼ GC è°ƒä¼˜ java -Xms200M -Xmx200m -XX:+PrintGC com.jvm -Xms200M -Xmx200m : é˜²æ­¢å†…å­˜æŠ–åŠ¨ï¼Œæ¶ˆè€—èµ„æº cpu å ç”¨ç‡å±…é«˜ä¸ä¸‹å¦‚ä½•è°ƒè¯• jvm é¡¹ç›®ä¸­ï¼Œäº§ç”Ÿå†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œ é¢‘ç¹GCä½†æ˜¯å›æ”¶ä¸åˆ°å†…å­˜ï¼Œé€šè¿‡å®šä½å‘ç°æ³„éœ²æ˜¯å› ä¸ºä¸€ä¸ªç±»åˆ›å»ºäº†æµ·é‡çš„å¯¹è±¡ top #æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹å CPUæ¯”è¾ƒé«˜ top -Hp PID #æŸ¥çœ‹è¿›ç¨‹é‡Œå“ªä¸ªçº¿ç¨‹å CPU jstack/PrintGC #æ‰¾åˆ°è¿›ç¨‹ï¼Œçœ‹æ˜¯ VM GC è¿›ç¨‹è¿˜æ˜¯ä¸šåŠ¡è¿›ç¨‹ #è‹¥æ˜¯ GC åˆ™ä¸€å®šæ˜¯é¢‘ç¹çš„ full GCï¼Œä½¿ç”¨ PrintGC æŸ¥çœ‹GCæ¯æ¬¡å›æ”¶æ˜¯å¦æ­£å¸¸ #java -printgc -heapDumpOnOutOfMemoryError, OOMä¼šä¸‹è½½dumpæ–‡ä»¶ jmap #æŸ¥çœ‹å †ä¸­å¯¹è±¡å ç”¨å†…å­˜çš„æƒ…å†µï¼›æŸ¥çœ‹å †è½¬å‚¨æ–‡ä»¶ MAT/jhat/jvisualbm #è¿›è¡Œdumpæ–‡ä»¶åˆ†æ jmap ä¸ºäº†æŠŠé‡Œé¢çš„å¯¹è±¡å…¨è¾“å‡ºå‡ºæ¥ï¼Œä¼š STWï¼Œè®©æ•´ä¸ªJVMå¡æ­» jmap å‘½ä»¤åœ¨å‹æµ‹ç¯å¢ƒä¸Šè§‚å¯Ÿçš„ æœºå™¨åšäº†è´Ÿè½½å‡è¡¡ï¼Œå‘ç°é—®é¢˜åæŠŠæœ‰é—®é¢˜çš„æœºå™¨ä»è´Ÿè½½ç¯å¢ƒæ‘˜å‡ºæ¥ï¼Œå†æŠŠå †è½¬å‚¨æ–‡ä»¶å¯¼å‡ºæ¥ ä½¿ç”¨tcpcopyå¤åˆ¶ä¸¤ä»½ï¼Œä¸€ä»½åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä¸€ä»½åˆ°æµ‹è¯•ç¯å¢ƒ arthasï¼š java -jar arthas-boot.jar # è¿è¡Œåä¼šè‡ªåŠ¨æ‰¾æœºå™¨ä¸­javaçš„è¿›ç¨‹ # æ€§èƒ½ä¸Šæœ‰æ‰€é™ä½ï¼Œä½†ä¸ä¼šstw dashboard # å±•ç¤ºçº¿ç¨‹å ç”¨ã€å¹´ä»£å †æ ˆå†…å­˜ heapdump # æ›¿ä»£jmapå‘½ä»¤ thread -b # æŸ¥æ‰¾çº¿ç¨‹ä¸­æ­»é”ï¼Œä»£æ›¿ jstack jvm jad # åœ¨çº¿åç¼–è¯‘ï¼Œåœ¨çº¿å®šä½ä¸€äº›é—®é¢˜ redefine # åœ¨çº¿ä¿®æ”¹classï¼Œä¸´æ—¶è§£å†³ç‰ˆæœ¬bugã€‚å¤šå°æœåŠ¡å™¨å†™ä¸ªè„šæœ¬æ‰¹é‡ä¿®æ”¹ trace # æŸ¥çœ‹æ–¹æ³•æ‰€ç”¨æ—¶é—´ ","date":"2020-01-01","objectID":"/20200101_java-interview/:2:0","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"Multi Thread å¯åŠ¨çº¿ç¨‹çš„ä¸‰ç§æ–¹å¼: extends Thread implements Runnable Executors.newCachedThread çº¿ç¨‹çš„çŠ¶æ€ï¼š classLoadProcess JVMå†…å­˜æ¨¡å‹ å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„ l0:å¯„å­˜å™¨ l1:é«˜é€Ÿç¼“å­˜ l2:é«˜é€Ÿç¼“å­˜--------------cpuå†…éƒ¨ -------------------------------- l3:é«˜é€Ÿç¼“å­˜ l4:ä¸»å­˜ l5:ç¡¬ç›˜ l6:è¿œç¨‹æ–‡ä»¶å­˜å‚¨-----------cpuå…±äº« -------------------------------- cache line çš„æ¦‚å¿µ / ç¼“å­˜è¡Œå¯¹å…¶ / ä¼ªå…±äº« ç¼“å­˜è¡Œï¼š ç¼“å­˜è¡Œè¶Šå¤§ï¼Œå±€éƒ¨æ€§ç©ºé—´æ•ˆç‡è¶Šé«˜ï¼Œä½†è¯»å–æ—¶é—´æ…¢ ç¼“å­˜è¡Œè¶Šå°ï¼Œå±€éƒ¨æ€§ç©ºé—´æ•ˆç‡è¶Šä½ï¼Œä½†è¯»å–æ—¶é—´å¿« ç›®å‰ç”¨ï¼š64å­—èŠ‚ ç¼“å­˜å¯¹å…¶ï¼Œåœ¨cpuå†…éƒ¨çš„L2é«˜é€Ÿç¼“å­˜å¤„ç†æ—¶å¤šçº¿ç¨‹ï¼Œå±äºç¡¬ä»¶é—®é¢˜ï¼š [x y main memory] [x y L3 cache] [x y L2][x y L2] [x y L1][x y L1] [è®¡ç®—å•å…ƒä¸å¯„å­˜å™¨][è®¡å¯„å­˜å™¨] é«˜é€Ÿç¼“å­˜æ•°æ®ä¸€è‡´æ€§è§£å†³æ–¹æ³• è€çš„CPUï¼šæ€»çº¿é” å¤§å¤§é™ä½äº†æ€§èƒ½ æ–°çš„CPUï¼šMESI Cache æ•°æ®ä¸€è‡´æ€§åè®®ç­‰(intel ç”¨ MESI) + æ€»çº¿é” Modified Exclusive Shared Invalid æœ‰äº›æ— æ³•è¢«ç¼“å­˜çš„æ•°æ®ï¼Œæˆ–è€…è·¨è¶Šå¤šä¸ªç¼“å­˜è¡Œçš„æ•°æ®ï¼Œä¾ç„¶å¿…é¡»ä½¿ç”¨æ€»çº¿é” ç¼“å­˜è¡Œå¯¹å…¶ / ä¼ªå…±äº« ä½äºåŒä¸€ç¼“å­˜è¡Œçš„ä¸¤ä¸ªä¸åŒæ•°æ®ï¼Œè¢«ä¸¤ä¸ªä¸åŒCPUé”å®šï¼Œäº§ç”Ÿäº’ç›¸å½±å“çš„ä¼ªå…±äº«é—®é¢˜ è§£å†³æ–¹æ³•ï¼š ç¼“å­˜è¡Œå¯¹å…¶ï¼šæ‰©å¤§å­—èŠ‚æ•°ï¼Œä½¿å…¶ä¸åœ¨ç»Ÿä¸€ç¼“å­˜è¡Œ private static class Padding { public long p1, p2, p3, p4, p5, p6, p7; //cache line padding private volatile long cursor = INITIAL_CURSOR_VALUE; public long p8, p9, p10, p11, p12, p13, p14; //cache line padding } ä¹±åºé—®é¢˜ cpuä¸ºäº†æé«˜æŒ‡ä»¤æ‰§è¡Œæ•ˆç‡ï¼Œå»åŒæ—¶æ‰§è¡Œå¦ä¸€æ¡æŒ‡ä»¤ï¼ˆå‰æä¸¤æ¡æŒ‡ä»¤æ²¡æœ‰ä¾èµ–å…³ç³»:int a = 0; a++;ï¼‰è¿™æ ·çš„cpuçš„æ‰§è¡Œå°±æ˜¯ä¹±åºçš„ã€‚ è€Œä¸” å¿…é¡»ä½¿ç”¨Memory Barrieræ¥åšå¥½æŒ‡ä»¤æ’åº volatileçš„åº•å±‚å°±æ˜¯è¿™ä¹ˆå®ç°çš„(windows æ˜¯ lock æŒ‡ä»¤) å¦‚ä½•ä¿è¯ç‰¹å®šæƒ…å†µä¸‹ä¸ä¹±åº volatile æœ‰åºï¼š ä½¿ç”¨ CPU å†…å­˜å±éšœï¼Œ åŸç†ï¼š sfenceæŒ‡ä»¤å‰çš„å†™æ“ä½œå¿…é¡»åœ¨sfenceæŒ‡ä»¤åçš„å†™æ“ä½œå‰å®Œæˆ IfenceæŒ‡ä»¤å‰çš„è¯»æ“ä½œå¿…é¡»åœ¨IfenceæŒ‡ä»¤åçš„è¯»æ“ä½œå‰å®Œæˆ mfenceæŒ‡ä»¤å‰çš„è¯»å†™æ“ä½œå¿…é¡»åœ¨mfenceæŒ‡ä»¤åçš„è¯»å†™æ“ä½œå‰å®Œæˆ å®é™…ä½¿ç”¨çš„æ˜¯ Intel lock æ±‡ç¼–æŒ‡ä»¤ volatile ä½œç”¨ï¼š ä¿æŒçº¿ç¨‹é—´çš„å¯è§æ€§ ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼ˆé€šè¿‡å†…å­˜å±éšœï¼‰ å…³äº Object o = new Object() è§£é‡Šå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ˆåŠåˆå§‹åŒ–ï¼‰ T t = new T() jvm ç¼–è¯‘æˆ class æ±‡ç¼–ç 5æ¡æŒ‡ä»¤: new #2 \u003cT\u003e //ç”³è¯·å†…å­˜ç©ºé—´, æˆå‘˜å˜é‡æ˜¯é»˜è®¤å€¼ dup invokespecial #3 \u003cT.\u003cinit\u003e\u003e //è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼Œæˆå‘˜å˜é‡åˆå§‹åŒ– astore //t å’Œ new å‡ºçš„å¯¹è±¡è¿›è¡Œå…³è” return ç”±äºæŒ‡ä»¤é‡æ’çš„å­˜åœ¨ invokespecial #3 \u003cT.\u003cinit\u003e\u003e astore //æœ‰å¯èƒ½ä¹±åºæ‰§è¡Œ,å…ˆæŒ‡å‘å†…å­˜å†åˆå§‹åŒ–å˜é‡ DCLä¸volatileé—®é¢˜ï¼ˆæŒ‡ä»¤é‡æ’ï¼‰ 1.Double Check Lock public static volatile T INSTANCE; public static T getInstance(){ if (INSTANCE == null){ synchronized(T.class){ if(INSTANCE == null){ try{ Thread.sleep(1); }catch(InterruptedException e) { e.printStackTrace(); } INSTANCE = new T(); } } } } 2.DCLå•ä¾‹å¿…é¡»è¦åŠ volatile æŒ‡ä»¤é‡æ’ï¼Œå¯¹è±¡åˆå§‹åŒ–æ—¶å…ˆæŒ‡å‘å†…å­˜ï¼Œå†åˆå§‹åŒ–èµ‹å€¼ è‹¥æ­¤æ—¶çº¿ç¨‹2è¿›å…¥ï¼Œåˆ™ç›´æ¥æ‹¿åˆ°æœªåˆå§‹åŒ–èµ‹å€¼çš„å¯¹è±¡ å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¸ƒå±€ï¼ˆå¯¹è±¡ä¸æ•°ç»„çš„å­˜å‚¨ä¸åŒï¼‰ å¯¹è±¡å¤´å…·ä½“åŒ…æ‹¬ä»€ä¹ˆï¼ˆmarkword klasspointerï¼‰ synchronizedé”ä¿¡æ¯ å¯¹è±¡æ€ä¹ˆå®šä½ï¼ˆç›´æ¥ é—´æ¥ï¼‰ å¯¹è±¡æ€ä¹ˆåˆ†é…ï¼ˆæ ˆä¸Š çº¿ç¨‹æœ¬åœ° Eden Oldï¼‰ Object o = new Object()åœ¨å†…å­˜ä¸­å ç”¨å¤šå°‘å­—èŠ‚ ","date":"2020-01-01","objectID":"/20200101_java-interview/:3:0","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"Redis é¡¹ç›®ä¸­Redisçš„åº”ç”¨åœºæ™¯ äº”å¤§valueç±»å‹ åŸºæœ¬ä¸Šå°±æ˜¯ç¼“å­˜ ä¸ºçš„æ˜¯æœåŠ¡æ— çŠ¶æ€ï¼Œï¼ˆå»¶ä¼¸ï¼šçœ‹é¡¹ç›®ä¸­æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Œå¦‚åˆ†å¸ƒå¼é”ï¼ŒæŠ½å‡ºæ¥æ”¾åˆ°Redisï¼‰ æ— é”åŒ– Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ æ— è®ºå“ªä¸ªç‰ˆæœ¬ï¼Œå·¥ä½œçº¿ç¨‹å°±æ˜¯ä¸€ä¸ª 6.x é«˜ç‰ˆæœ¬å‡ºç°äº†IOå¤šçº¿ç¨‹ å…³äºå„ç§æ¡†æ¶ä¼˜åŒ–çš„å›ç­” é—®æ³•ï¼šåšè¿‡ä»€ä¹ˆä¼˜åŒ–ï¼Ÿ è§£å†³è¿‡ä»€ä¹ˆé—®é¢˜ï¼Ÿé‡åˆ°å“ªäº›é—®é¢˜ï¼Ÿ è¯´æ˜ä¸šåŠ¡åœºæ™¯ï¼› é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ â€“\u003e å¾€å¾€é€šè¿‡ç›‘æ§å·¥å…·ç»“åˆæŠ¥è­¦ç³»ç»Ÿï¼› æ’æŸ¥é—®é¢˜ï¼› è§£å†³æ‰‹æ®µï¼› é—®é¢˜è¢«è§£å†³ã€‚ ","date":"2020-01-01","objectID":"/20200101_java-interview/:4:0","tags":["Interview"],"title":"Java Basic","uri":"/20200101_java-interview/"},{"categories":["Technology"],"content":"Article description.","date":"2019-12-29","objectID":"/20191229_copy-in-java/","tags":["Java"],"title":"Shallow Copy and Deep Copy in JAVA","uri":"/20191229_copy-in-java/"},{"categories":["Technology"],"content":"Cloning is a process of creating an exact copy of an existing object in the memory. In java, clone() method of java.lang.Object class is used for cloning process. This method creates an exact copy of an object on which it is called through field-by-field assignment and returns the reference of that object. Not all the objects in java are eligible for cloning process. The objects which implement Cloneable interface are only eligible for cloning process. Cloneable interface is a marker interface which is used to provide the marker to cloning process. Click here to see more info on clone() method in java. ","date":"2019-12-29","objectID":"/20191229_copy-in-java/:0:0","tags":["Java"],"title":"Shallow Copy and Deep Copy in JAVA","uri":"/20191229_copy-in-java/"},{"categories":["Technology"],"content":"Preface Object ç±»ä¸­æœ‰æ–¹æ³•clion()ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š protected native Object clone() throws CloneNotSupportedException; è¯¥æ–¹æ³•ç”± protected ä¿®é¥°ï¼Œjavaä¸­æ‰€æœ‰ç±»é»˜è®¤æ˜¯ç»§æ‰¿Objectç±»çš„ï¼Œé‡è½½åçš„clone()æ–¹æ³•ä¸ºäº†ä¿è¯å…¶ä»–ç±»éƒ½å¯ä»¥æ­£å¸¸è°ƒç”¨ï¼Œä¿®é¥°ç¬¦éœ€è¦æ”¹æˆpublicã€‚ è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼Œè¢«nativeä¿®é¥°çš„æ–¹æ³•å®é™…ä¸Šæ˜¯ç”±éJavaä»£ç å®ç°çš„ï¼Œæ•ˆç‡è¦é«˜äºæ™®é€šçš„javaæ–¹æ³•ã€‚ è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯Objectå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¼ºè½¬æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚ è¯¥æ–¹æ³•æŠ›å‡ºäº†ä¸€ä¸ªCloneNotSupportedExceptionå¼‚å¸¸ï¼Œæ„æ€å°±æ˜¯ä¸æ”¯æŒæ‹·è´ï¼Œéœ€è¦æˆ‘ä»¬å®ç°Cloneableæ¥å£æ¥æ ‡è®°ï¼Œè¿™ä¸ªç±»æ”¯æŒæ‹·è´ã€‚ ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬æ–°å»ºä¸¤ä¸ªå®ä½“ç±»Dept å’Œ Userï¼Œå…¶ä¸­Userä¾èµ–äº†Deptï¼Œå®ä½“ç±»ä»£ç å¦‚ä¸‹ï¼š Dept ç±»ï¼š @Data @AllArgsConstructor @NoArgsConstructor public class Dept { private int deptNo; private String name; } User ç±»ï¼š @Data @AllArgsConstructor @NoArgsConstructor public class User { private int age; private String name; private Dept dept; } ","date":"2019-12-29","objectID":"/20191229_copy-in-java/:1:0","tags":["Java"],"title":"Shallow Copy and Deep Copy in JAVA","uri":"/20191229_copy-in-java/"},{"categories":["Technology"],"content":"Shallow Copy å¯¹äºåŸºæœ¬ç±»å‹çš„çš„å±æ€§ï¼Œæµ…æ‹·è´ä¼šå°†å±æ€§å€¼å¤åˆ¶ç»™æ–°çš„å¯¹è±¡ï¼Œè€Œå¯¹äºå¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œæµ…æ‹·è´ä¼šå°†å¼•ç”¨å¤åˆ¶ç»™æ–°çš„å¯¹è±¡ã€‚è€ŒåƒStringï¼ŒIntegerè¿™äº›å¼•ç”¨ç±»å‹ï¼Œéƒ½æ˜¯ä¸å¯å˜çš„ï¼Œæ‹·è´çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä»½æ–°çš„å†…å­˜ç©ºé—´æ¥å­˜æ”¾å€¼ï¼Œå¹¶ä¸”å°†æ–°çš„å¼•ç”¨æŒ‡å‘æ–°çš„å†…å­˜ç©ºé—´ã€‚ä¸å¯å˜ç±»å‹æ˜¯ç‰¹æ®Šçš„å¼•ç”¨ç±»å‹ï¼Œæˆ‘ä»¬å§‘ä¸”è®¤ä¸ºè¿™äº›è¢«finalæ ‡è®°çš„å¼•ç”¨ç±»å‹ä¹Ÿæ˜¯å¤åˆ¶å€¼ã€‚ shallowCopy æµ…æ‹·è´åŠŸèƒ½å®ç° @Data @AllArgsConstructor @NoArgsConstructor public class User implements Cloneable{ private int age; private String name; private Dept dept; @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } } å¦‚ä½•éªŒè¯æˆ‘ä»¬çš„ç»“è®ºå‘¢ï¼Ÿé¦–å…ˆå¯¹æ¯”è¢«æ‹·è´å‡ºçš„å¯¹è±¡å’ŒåŸå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç­‰åˆ™è¯´æ˜æ˜¯æ–°æ‹·è´å‡ºçš„ä¸€ä¸ªå¯¹è±¡ã€‚å…¶æ¬¡ä¿®æ”¹æ‹·è´å‡ºå¯¹è±¡çš„åŸºæœ¬ç±»å‹å±æ€§ï¼Œå¦‚æœåŸå¯¹è±¡çš„æ­¤å±æ€§å‘ç”Ÿäº†ä¿®æ”¹ï¼Œåˆ™è¯´æ˜åŸºæœ¬ç±»å‹çš„å±æ€§æ˜¯åŒä¸€ä¸ªï¼Œæœ€åä¿®æ”¹æ‹·è´å‡ºå¯¹è±¡çš„å¼•ç”¨ç±»å‹å¯¹è±¡å³Deptå±æ€§ï¼Œå¦‚æœåŸå¯¹è±¡çš„æ­¤å±æ€§å‘ç”Ÿäº†æ”¹å˜ï¼Œåˆ™è¯´æ˜å¼•ç”¨ç±»å‹çš„å±æ€§æ˜¯åŒä¸€ä¸ªã€‚æ¸…æ¥šæµ‹è¯•åŸç†åï¼Œæˆ‘ä»¬å†™ä¸€æ®µæµ‹è¯•ä»£ç æ¥éªŒè¯æˆ‘ä»¬çš„ç»“è®ºã€‚ public static void main(Strign[] args) thows Exception{ Dept dept = new Dept(12,\"å¸‚åœºéƒ¨\"); User user = new User(18,\"Java\", dept); User user1 = (User)user.clone(); System.out.println(user == user1); user1.setAge(20); System.out.println(user); System.out.println(user1); dept.setName(\"ç ”å‘éƒ¨\"); System.out.println(user); System.out.println(user1); } è¿è¡Œç»“æœå¦‚ä¸‹ï¼š false User{age=18, name='Java', dept=Dept{deptNo=12, name='å¸‚åœºéƒ¨'}} User{age=20, name='Java', dept=Dept{deptNo=12, name='å¸‚åœºéƒ¨'}} User{age=18, name='Java', dept=Dept{deptNo=12, name='ç ”å‘éƒ¨'}} User{age=20, name='Java', dept=Dept{deptNo=12, name='ç ”å‘éƒ¨'}} ","date":"2019-12-29","objectID":"/20191229_copy-in-java/:2:0","tags":["Java"],"title":"Shallow Copy and Deep Copy in JAVA","uri":"/20191229_copy-in-java/"},{"categories":["Technology"],"content":"Deep Copy ç›¸è¾ƒäºæµ…æ‹·è´è€Œè¨€ï¼Œæ·±æ‹·è´é™¤äº†ä¼šå°†åŸºæœ¬ç±»å‹çš„å±æ€§å¤åˆ¶å¤–ï¼Œè¿˜ä¼šå°†å¼•ç”¨ç±»å‹çš„å±æ€§ä¹Ÿä¼šå¤åˆ¶ã€‚ DeepCopy æ·±æ‹·è´åŠŸèƒ½å®ç° åœ¨æ‹·è´userçš„æ—¶å€™ï¼ŒåŒäº‹å°†userä¸­çš„deptå±æ€§è¿›è¡Œæ‹·è´ã€‚ dept ç±»ï¼š @Data @AllArgsConstructor @NoArgsXonstructor public class Dept implements Cloneable{ private int deptNo; private String name; @Override public Object clone() throws CloneNotSupportedException{ return super.clone(); } } user ç±»ï¼š @Data @AllArgsConstructor @NoArgsConstructor public class User implements Cloneable{ private int age; private String name; private Dept dept; @Override protected Object clone() throws CloneNotSupportedException { User user = (User) super.clone(); user.dept = (Dept) dept.clone(); return user; } } ä½¿ç”¨æµ…æ‹·è´çš„æµ‹è¯•ä»£ç ç»§ç»­æµ‹è¯•ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼š false User{age=18, name='Javaæ—…é€”', dept=Dept{deptNo=12, name='å¸‚åœºéƒ¨'}} User{age=20, name='Javaæ—…é€”', dept=Dept{deptNo=12, name='å¸‚åœºéƒ¨'}} User{age=18, name='Javaæ—…é€”', dept=Dept{deptNo=12, name='ç ”å‘éƒ¨'}} User{age=20, name='Javaæ—…é€”', dept=Dept{deptNo=12, name='å¸‚åœºéƒ¨'}} é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–å®ç°æ·±æ‹·è´ï¼Œå…ˆå°†å¯¹è±¡åºåˆ—åŒ–æˆå­—èŠ‚æµï¼Œç„¶åå†å°†å­—èŠ‚æµåºåˆ—åŒ–æˆå¯¹è±¡ï¼Œè¿™æ ·å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ ","date":"2019-12-29","objectID":"/20191229_copy-in-java/:3:0","tags":["Java"],"title":"Shallow Copy and Deep Copy in JAVA","uri":"/20191229_copy-in-java/"},{"categories":["Life"],"content":"Article description.","date":"2019-12-18","objectID":"/20191218_2019-summary-video/","tags":["Life","Video","USA","Graduation"],"title":"Memories of 2019","uri":"/20191218_2019-summary-video/"},{"categories":["Life"],"content":"Photos and videos recorded in 2019. ","date":"2019-12-18","objectID":"/20191218_2019-summary-video/:0:0","tags":["Life","Video","USA","Graduation"],"title":"Memories of 2019","uri":"/20191218_2019-summary-video/"},{"categories":["Technology"],"content":"Article description.","date":"2019-11-26","objectID":"/20191126_git-contribution/","tags":["Git"],"title":"Git Contribution","uri":"/20191126_git-contribution/"},{"categories":["Technology"],"content":"Contribution graph shows activity from public repositories. You can choose to show activity from both public and private repositories, with specific details of your activity in private repositories anonymized. ","date":"2019-11-26","objectID":"/20191126_git-contribution/:0:0","tags":["Git"],"title":"Git Contribution","uri":"/20191126_git-contribution/"},{"categories":["Technology"],"content":"Update local git config git config --global user.name â€œgithubâ€™s Nameâ€ git config --global user.email \"github@*.com\" ","date":"2019-11-26","objectID":"/20191126_git-contribution/:1:0","tags":["Git"],"title":"Git Contribution","uri":"/20191126_git-contribution/"},{"categories":["Technology"],"content":"Update commit history If you do not want to waste your commit history. we can use â€˜git logâ€™ to see the git record git log we need to edit all of the history of commit and push. git filter-branch -f --env-filter ' if [ \"$GIT_AUTHOR_NAME\" = \"oldName\" ] then export GIT_AUTHOR_NAME=\"newName\" export GIT_AUTHOR_EMAIL=\"newEmail\" fi ' HEAD git filter-branch -f --env-filter ' if [ \"$GIT_COMMITTER_NAME\" = \"oldName\" ] then export GIT_COMMITTER_NAME=\"newName\" export GIT_COMMITTER_EMAIL=\"newEmail\" fi ' HEAD å¦‚æœæ— å·®åˆ«æŠŠæ‰€æœ‰éƒ½æ”¹çš„è¯å»æ‰if..fi git filter-branch -f --env-filter \" GIT_AUTHOR_NAME='newName'; GIT_AUTHOR_EMAIL='newEmail'; GIT_COMMITTER_NAME='newName'; GIT_COMMITTER_EMAIL='newEmail' \" HEAD ","date":"2019-11-26","objectID":"/20191126_git-contribution/:2:0","tags":["Git"],"title":"Git Contribution","uri":"/20191126_git-contribution/"},{"categories":["Technology"],"content":"Update Git push ä½ è¿™é‡Œå°†ä½ æœ¬åœ°gitçš„è´¦æˆ·å’Œé‚®ç®±é‡æ–°è®¾ç½®äº†,ä½†æ˜¯githubå¹¶æ²¡æœ‰é‚£ä¹ˆæ™ºèƒ½å°±èƒ½åˆ¤æ–­ä½ æ˜¯åŸæ¥ä½ ç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·. ä¹Ÿå°±æ˜¯è¯´ä½ æ–°é…ç½®çš„ç”¨æˆ·å’Œä½ é»˜è®¤çš„è¢«githubè¯†åˆ«æˆä¸¤ä¸ªç”¨æˆ·. è¿™æ ·ä½ ä»¥åæ“ä½œçš„æ—¶å€™commit æˆ–è€… pushçš„æ—¶å€™æœ‰å¯èƒ½äº§ç”Ÿå†²çª. Solution: ä½¿ç”¨å¼ºåˆ¶pushçš„æ–¹æ³•: git push -u origin master -f è¿™æ ·ä¼šä½¿è¿œç¨‹ä¿®æ”¹ä¸¢å¤±ï¼Œä¸€èˆ¬æ˜¯ä¸å¯å–çš„ï¼Œå°¤å…¶æ˜¯å¤šäººåä½œå¼€å‘çš„æ—¶å€™ã€‚ pushå‰å…ˆå°†è¿œç¨‹repositoryä¿®æ”¹pullä¸‹æ¥ git pull origin master git push -u origin master è‹¥ä¸æƒ³mergeè¿œç¨‹å’Œæœ¬åœ°ä¿®æ”¹ï¼Œå¯ä»¥å…ˆåˆ›å»ºæ–°çš„åˆ†æ”¯ï¼š git branch [name] #ç„¶åpush git push -u origin [name] ","date":"2019-11-26","objectID":"/20191126_git-contribution/:3:0","tags":["Git"],"title":"Git Contribution","uri":"/20191126_git-contribution/"},{"categories":["Technology"],"content":"Article description.","date":"2019-10-07","objectID":"/20191007_u32/","tags":["C"],"title":"Various data types in C","uri":"/20191007_u32/"},{"categories":["Technology"],"content":"C/C++ provides various data types that can be used in your programs.In general, youâ€™d commonly use: int for most variables and â€œcountableâ€ things (for loop counts, variables, events). char for characters and strings. float for general measurable things (seconds, distance, temperature). uint32 for bit manipulations, especially on 32-bit registers. int for most variables and â€œcountableâ€ things (for loop counts, variables, events) char for characters and strings float for general measurable things (seconds, distance, temperature) uint32_t for bit manipulations, especially on 32-bit registers ","date":"2019-10-07","objectID":"/20191007_u32/:0:0","tags":["C"],"title":"Various data types in C","uri":"/20191007_u32/"},{"categories":["Technology"],"content":"Integer Data Types C type alias Bits Sign Range char int8 8 Signed -128 .. 127 unsigned char uint8 8 Unsigned 0 .. 255 short int16 16 Signed -32,768 .. 32,767 unsigned short uint16 16 Unsigned 0 .. 65,535 int int32 32 Signed -2,147,483,648 .. 2,147,483,647 unsigned int uint32 32 Unsigned 0 .. 4,294,967,295 long long int64 64 Signed -9,223,372,036,854,775,808 .. 9,223,372,036,854,775,807 unsigned long long uint64 64 Unsigned 0 .. 18,446,744,073,709,551,615 ","date":"2019-10-07","objectID":"/20191007_u32/:0:1","tags":["C"],"title":"Various data types in C","uri":"/20191007_u32/"},{"categories":["Technology"],"content":"Floating Point Data Types C type IEE754 Name Bits Range float Single Precision 32 -3.4E38 .. 3.4E38 double Double Precision 64 -1.7E308 .. 1.7E308 ","date":"2019-10-07","objectID":"/20191007_u32/:0:2","tags":["C"],"title":"Various data types in C","uri":"/20191007_u32/"},{"categories":["Technology"],"content":"Print format %[flags][width][.prec][length]type %[æ ‡å¿—][æœ€å°å®½åº¦][.ç²¾åº¦][ç±»å‹é•¿åº¦]ç±»å‹ã€‚ 1. Type å­—ç¬¦ å¯¹åº”æ•°æ®ç±»å‹ å«ä¹‰ ç¤ºä¾‹ d/i int è¾“å‡ºåè¿›åˆ¶æœ‰ç¬¦å·32bitsæ•´æ•°ï¼Œiæ˜¯è€å¼å†™æ³• printf(\"%i\",123);è¾“å‡º123 o unsigned int æ— ç¬¦å·8è¿›åˆ¶(octal)æ•´æ•°(ä¸è¾“å‡ºå‰ç¼€0) printf(\"0%o\",123);è¾“å‡º0173 u unsigned int æ— ç¬¦å·10è¿›åˆ¶æ•´æ•° printf(\"%u\",123);è¾“å‡º123 x/X unsigned int æ— ç¬¦å·16è¿›åˆ¶æ•´æ•°ï¼Œxå¯¹åº”çš„æ˜¯abcdefï¼ŒXå¯¹åº”çš„æ˜¯ABCDEFï¼ˆä¸è¾“å‡ºå‰ç¼€0x) printf(\"0x%x 0x%X\",123,123);è¾“å‡º0x7b 0x7B f/lf float(double) å•ç²¾åº¦æµ®ç‚¹æ•°ç”¨f,åŒç²¾åº¦æµ®ç‚¹æ•°ç”¨lf(printfå¯æ··ç”¨ï¼Œä½†scanfä¸èƒ½æ··ç”¨) printf(\"%.9f %.9lf\",0.000000123,0.000000123);è¾“å‡º0.000000123 0.000000123ã€‚æ³¨æ„æŒ‡å®šç²¾åº¦ï¼Œå¦åˆ™printfé»˜è®¤ç²¾ç¡®åˆ°å°æ•°ç‚¹åå…­ä½ F float(double) ä¸fæ ¼å¼ç›¸åŒï¼Œåªä¸è¿‡ infinity å’Œ nan è¾“å‡ºä¸ºå¤§å†™å½¢å¼ã€‚ ä¾‹å¦‚printf(\"%f %F %f %F\\n\",INFINITY,INFINITY,NAN,NAN);è¾“å‡ºç»“æœä¸ºinf INF nan NAN e/E float(double) ç§‘å­¦è®¡æ•°æ³•ï¼Œä½¿ç”¨æŒ‡æ•°(Exponent)è¡¨ç¤ºæµ®ç‚¹æ•°ï¼Œæ­¤å¤„â€eâ€çš„å¤§å°å†™ä»£è¡¨åœ¨è¾“å‡ºæ—¶â€œeâ€çš„å¤§å°å†™ printf(\"%e %E\",0.000000123,0.000000123);è¾“å‡º1.230000e-07 1.230000E-07 g float(double) æ ¹æ®æ•°å€¼çš„é•¿åº¦ï¼Œé€‰æ‹©ä»¥æœ€çŸ­çš„æ–¹å¼è¾“å‡ºï¼Œ%fæˆ–%e printf(\"%g %g\",0.000000123,0.123);è¾“å‡º1.23e-07 0.123 G float(double) æ ¹æ®æ•°å€¼çš„é•¿åº¦ï¼Œé€‰æ‹©ä»¥æœ€çŸ­çš„æ–¹å¼è¾“å‡ºï¼Œ%fæˆ–%E printf(\"%G %G\",0.000000123,0.123);è¾“å‡º1.23E-07 0.123 c char å­—ç¬¦å‹ã€‚å¯ä»¥æŠŠè¾“å…¥çš„æ•°å­—æŒ‰ç…§ASCIIç ç›¸åº”è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ printf(\"%c\\n\",64)è¾“å‡ºA s char* å­—ç¬¦ä¸²ã€‚è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ç›´è‡³å­—ç¬¦ä¸²ä¸­çš„ç©ºå­—ç¬¦ï¼ˆå­—ç¬¦ä¸²ä»¥ç©ºå­—ç¬¦â€™\\0â€˜ç»“å°¾ï¼‰ printf(\"%s\",\"æµ‹è¯•test\");è¾“å‡ºï¼šæµ‹è¯•test S wchar_t* å®½å­—ç¬¦ä¸²ã€‚è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ç›´è‡³å­—ç¬¦ä¸²ä¸­çš„ç©ºå­—ç¬¦ï¼ˆå®½å­—ç¬¦ä¸²ä»¥ä¸¤ä¸ªç©ºå­—ç¬¦â€™\\0â€˜ç»“å°¾ï¼‰ setlocale(LC_ALL,\"zh_CN.UTF-8\"); wchar_t wtest[]=L\"æµ‹è¯•Test\"; printf(\"%S\\n\",wtest); è¾“å‡ºï¼šæµ‹è¯•test p void* ä»¥16è¿›åˆ¶å½¢å¼è¾“å‡ºæŒ‡é’ˆ printf(\"%010p\",\"lvlv\");è¾“å‡ºï¼š0x004007e6 n int* ä»€ä¹ˆä¹Ÿä¸è¾“å‡ºã€‚%nå¯¹åº”çš„å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘signed intçš„æŒ‡é’ˆï¼Œåœ¨æ­¤ä¹‹å‰è¾“å‡ºçš„å­—ç¬¦æ•°å°†å­˜å‚¨åˆ°æŒ‡é’ˆæ‰€æŒ‡çš„ä½ç½® int num=0; printf(\"lvlv%n\",\u0026num); printf(\"num:%d\",num); è¾“å‡º:lvlvnum:4 m æ—  æ‰“å°errnoå€¼å¯¹åº”çš„å‡ºé”™å†…å®¹ printf(\"%m\\n\"); a/A float(double) åå…­è¿›åˆ¶pè®¡æ•°æ³•è¾“å‡ºæµ®ç‚¹æ•°ï¼Œaä¸ºå°å†™ï¼ŒAä¸ºå¤§å†™ printf(\"%a %A\",15.15,15.15);è¾“å‡ºï¼š0x1.e4ccccccccccdp+3 0X1.E4CCCCCCCCCCDP+3 2. Flags å­—ç¬¦ åç§° è¯´æ˜ - å‡å· ç»“æœå·¦å¯¹é½ï¼Œå³è¾¹å¡«ç©ºæ ¼ã€‚é»˜è®¤æ˜¯å³å¯¹é½ï¼Œå·¦è¾¹å¡«ç©ºæ ¼ã€‚ + åŠ å· è¾“å‡ºç¬¦å·(æ­£å·æˆ–è´Ÿå·) space ç©ºæ ¼ è¾“å‡ºå€¼ä¸ºæ­£æ—¶åŠ ä¸Šç©ºæ ¼ï¼Œä¸ºè´Ÿæ—¶åŠ ä¸Šè´Ÿå· # äº•å· typeæ˜¯oã€xã€Xæ—¶ï¼Œå¢åŠ å‰ç¼€0ã€0xã€0Xã€‚ typeæ˜¯aã€Aã€eã€Eã€fã€gã€Gæ—¶ï¼Œä¸€å®šä½¿ç”¨å°æ•°ç‚¹ã€‚é»˜è®¤çš„ï¼Œå¦‚æœä½¿ç”¨.0æ§åˆ¶ä¸è¾“å‡ºå°æ•°éƒ¨åˆ†ï¼Œåˆ™ä¸è¾“å‡ºå°æ•°ç‚¹ã€‚ typeæ˜¯gã€Gæ—¶ï¼Œå°¾éƒ¨çš„0ä¿ç•™ã€‚ 0 æ•°å­—é›¶ å°†è¾“å‡ºçš„å‰é¢è¡¥ä¸Š0ï¼Œç›´åˆ°å æ»¡æŒ‡å®šåˆ—å®½ä¸ºæ­¢ï¼ˆä¸å¯ä»¥æ­é…ä½¿ç”¨â€œ-â€ï¼‰ example: printf(\"%5d\\n\",1000); //é»˜è®¤å³å¯¹é½,å·¦è¾¹è¡¥ç©ºæ ¼ //output:1000 printf(\"%-5d\\n\",1000); //å·¦å¯¹é½,å³è¾¹è¡¥ç©ºæ ¼ //output:1000 printf(\"%+d %+d\\n\",1000,-1000); //è¾“å‡ºæ­£è´Ÿå· //output:+1000 -1000 printf(\"% d % d\\n\",1000,-1000); //æ­£å·ç”¨ç©ºæ ¼æ›¿ä»£ï¼Œè´Ÿå·è¾“å‡º //output:1000 -1000 printf(\"%x %#x\\n\",1000,1000); //è¾“å‡º0x //output:3e8 0x3e8 printf(\"%.0f %#.0f\\n\",1000.0,1000.0)//å½“å°æ•°ç‚¹åä¸è¾“å‡ºå€¼æ—¶ä¾ç„¶è¾“å‡ºå°æ•°ç‚¹ //output:1000 1000. printf(\"%g %#g\\n\",1000.0,1000.0); //ä¿ç•™å°æ•°ç‚¹ååçš„0 //output:1000 1000.00 printf(\"%05d\\n\",1000); //å‰é¢è¡¥0 //01000 3. width è¾“å‡ºæœ€å°å®½åº¦ width æè¿° ç¤ºä¾‹ æ•°å€¼ åè¿›åˆ¶æ•´æ•° printf(\"%06d\",1000);è¾“å‡º:001000 * æ˜Ÿå·ã€‚ä¸æ˜¾ç¤ºæŒ‡æ˜è¾“å‡ºæœ€å°å®½åº¦ï¼Œè€Œæ˜¯ä»¥æ˜Ÿå·ä»£æ›¿ï¼Œåœ¨printfçš„è¾“å‡ºå‚æ•°åˆ—è¡¨ä¸­ç»™å‡º printf(\"%0*d\",6,1000);è¾“å‡º:001000 4. precision .precision æè¿° .æ•°å€¼ åè¿›åˆ¶æ•´æ•°ã€‚ (1)å¯¹äºæ•´å‹ï¼ˆd,i,o,u,x,Xï¼‰,precisionè¡¨ç¤ºè¾“å‡ºçš„æœ€å°çš„æ•°å­—ä¸ªæ•°ï¼Œä¸è¶³è¡¥å‰å¯¼é›¶ï¼Œè¶…è¿‡ä¸æˆªæ–­ã€‚(2)å¯¹äºæµ®ç‚¹å‹ï¼ˆa, A, e, E, f ï¼‰ï¼Œprecisionè¡¨ç¤ºå°æ•°ç‚¹åæ•°å€¼ä½æ•°ï¼Œé»˜è®¤ä¸ºå…­ä½ï¼Œä¸è¶³è¡¥åç½®0ï¼Œè¶…è¿‡åˆ™æˆªæ–­ã€‚ (3)å¯¹äºç±»å‹è¯´æ˜ç¬¦gæˆ–Gï¼Œè¡¨ç¤ºå¯è¾“å‡ºçš„æœ€å¤§æœ‰æ•ˆæ•°å­—ã€‚ (4)å¯¹äºå­—ç¬¦ä¸²ï¼ˆsï¼‰ï¼Œprecisionè¡¨ç¤ºæœ€å¤§å¯è¾“å‡ºå­—ç¬¦æ•°ï¼Œä¸è¶³æ­£å¸¸è¾“å‡ºï¼Œè¶…è¿‡åˆ™æˆªæ–­ã€‚ precisionä¸æ˜¾ç¤ºæŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸º0 .* ä»¥æ˜Ÿå·ä»£æ›¿æ•°å€¼ï¼Œç±»ä¼¼äºwidthä¸­çš„*ï¼Œåœ¨è¾“å‡ºå‚æ•°åˆ—è¡¨ä¸­æŒ‡å®šç²¾åº¦ã€‚ 5. length ç±»å‹é•¿åº¦æŒ‡æ˜å¾…è¾“å‡ºæ•°æ®çš„é•¿åº¦ã€‚å› ä¸ºç›¸åŒç±»å‹å¯ä»¥æœ‰ä¸åŒçš„é•¿åº¦ï¼Œæ¯”å¦‚æ•´å‹æœ‰16bitsçš„short intï¼Œ32bitsçš„intï¼Œä¹Ÿæœ‰64bitsçš„long intï¼Œæµ®ç‚¹å‹æœ‰32bitsçš„å•ç²¾åº¦floatå’Œ64bitsçš„åŒç²¾åº¦doubleã€‚ä¸ºäº†æŒ‡æ˜åŒä¸€ç±»å‹çš„ä¸åŒé•¿åº¦ï¼Œäºæ˜¯ä¹ï¼Œç±»å‹é•¿åº¦ï¼ˆlengthï¼‰åº”è¿è€Œç”Ÿï¼Œæˆä¸ºæ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚ typeTable ","date":"2019-10-07","objectID":"/20191007_u32/:0:3","tags":["C"],"title":"Various data types in C","uri":"/20191007_u32/"},{"categories":["Technology"],"content":"Article description.","date":"2019-08-25","objectID":"/20190825_struct-size/","tags":["C"],"title":"The size of structure in C","uri":"/20190825_struct-size/"},{"categories":["Technology"],"content":"The sizeof for a struct is not always equal to the sum of sizeof of each individual member. This is because of the padding added by the compiler to avoid alignment issues. Padding is only added when a structure member is followed by a member with a larger size or at the end of the structure. Different compilers might have different alignment constraints as C standards state that alignment of structure totally depends on the implementation. Case 1: struct A { // sizeof(int) = 4 int x; // Padding of 4 bytes // sizeof(double) = 8 double z; // sizeof(short int) = 2 short int y; // Padding of 6 bytes }; Output: â€‹ Size of struct: 24 struct_sizeof_ex1 The red portion represents the padding added for data alignment and the green portion represents the struct members. In this case, x (int) is followed by z (double), which is larger in size as compared to x. Hence padding is added after x. Also, padding is needed at the end for data alignment. Case 2: struct B { // sizeof(double) = 8 double z; // sizeof(int) = 4 int x; // sizeof(short int) = 2 short int y; // Padding of 2 bytes }; Output: â€‹ Size of struct: 16 struct_sizeof_ex2 In this case, the members of the structure are sorted in decreasing order of their sizes. Hence padding is required only at the end. Case 3: struct C { // sizeof(double) = 8 double z; // sizeof(short int) = 2 short int y; // Padding of 2 bytes // sizeof(int) = 4 int x; }; Output: â€‹ Size of struct: 16 struct_sizeof_ex3 In this case, y (short int) is followed by x (int) and hence padding is required after y. No padding is needed at the end in this case for data alignment. C language doesnâ€™t allow the compilers to reorder the struct members to reduce the amount of padding. In order to minimize the amount of padding, the struct members must be sorted in a descending order (similar to the case 2). ","date":"2019-08-25","objectID":"/20190825_struct-size/:0:0","tags":["C"],"title":"The size of structure in C","uri":"/20190825_struct-size/"},{"categories":["Technology"],"content":"Article description.","date":"2019-07-17","objectID":"/20190717_typedef/","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"A typedef is a C keyword that defines a new name for a data type, including internal data types (int, char, etc.) and custom data types (struct, etc.). A typedef is itself a type of stored class keyword that cannot appear in the same expression as the keywords auto, extern, static, register, etc. ","date":"2019-07-17","objectID":"/20190717_typedef/:0:0","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"1. æ¦‚è¿° typedefä¸ºCè¯­è¨€çš„å…³é”®å­—ï¼Œä½œç”¨æ˜¯ä¸ºä¸€ç§æ•°æ®ç±»å‹å®šä¹‰ä¸€ä¸ªæ–°åå­—ï¼Œè¿™é‡Œçš„æ•°æ®ç±»å‹åŒ…æ‹¬å†…éƒ¨æ•°æ®ç±»å‹ï¼ˆintï¼Œcharç­‰ï¼‰å’Œè‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼ˆstructç­‰ï¼‰ã€‚ typedefæœ¬èº«æ˜¯ä¸€ç§å­˜å‚¨ç±»çš„å…³é”®å­—ï¼Œä¸autoã€externã€staticã€registerç­‰å…³é”®å­—ä¸èƒ½å‡ºç°åœ¨åŒä¸€ä¸ªè¡¨è¾¾å¼ä¸­ã€‚ ","date":"2019-07-17","objectID":"/20190717_typedef/:1:0","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"2. ä½œç”¨åŠç”¨æ³• ","date":"2019-07-17","objectID":"/20190717_typedef/:2:0","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"2.1 typedefçš„ç”¨æ³• ä½¿ç”¨typedefå®šä¹‰æ–°ç±»å‹çš„æ–¹æ³•ï¼šåœ¨ä¼ ç»Ÿçš„å˜é‡å£°æ˜è¡¨è¾¾å¼é‡Œç”¨ï¼ˆæ–°çš„ï¼‰ç±»å‹åæ›¿æ¢å˜é‡åï¼Œç„¶åæŠŠå…³é”®å­—typedefåŠ åœ¨è¯¥è¯­å¥çš„å¼€å¤´å°±è¡Œäº†ã€‚ ä¸‹é¢ä»¥ä¸¤ä¸ªç¤ºä¾‹ï¼Œæè¿°typedefçš„ç”¨æ³•æ­¥éª¤ã€‚ ç¤ºä¾‹1ï¼š int a; â€”â€”â€”â€” ä¼ ç»Ÿå˜é‡å£°æ˜è¡¨è¾¾å¼ typedef int myint_t; â€”â€”â€”â€” ä½¿ç”¨æ–°çš„ç±»å‹åmyint_tæ›¿æ¢å˜é‡åaã€‚åœ¨è¯­å¥å¼€å¤´åŠ ä¸Štypedefå…³é”®å­—ï¼Œmyint_tå°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„æ–°ç±»å‹ ç¤ºä¾‹2ï¼š void (*pfunA)(int a); â€”â€”â€”â€” ä¼ ç»Ÿå˜é‡ï¼ˆå‡½æ•°ï¼‰å£°æ˜è¡¨è¾¾å¼ typedef void (*PFUNA)(int a); â€”â€”â€”â€” ä½¿ç”¨æ–°çš„ç±»å‹åPFUNAæ›¿æ¢å˜é‡åpfunAã€‚åœ¨è¯­å¥å¼€å¤´åŠ ä¸Štypedefå…³é”®å­—ï¼ŒPFUNAå°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„æ–°ç±»å‹ ","date":"2019-07-17","objectID":"/20190717_typedef/:2:1","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"2.2 typedefçš„ä½œç”¨ typedefçš„ä½œç”¨æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š 1ï¼‰typedefçš„ä¸€ä¸ªé‡è¦ç”¨é€”æ˜¯å®šä¹‰æœºå™¨æ— å…³çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªå«REALçš„æµ®ç‚¹ç±»å‹ï¼Œè¯¥æµ®ç‚¹ç±»å‹åœ¨ç›®æ ‡æœºå™¨ä¸Šå¯ä»¥è·å¾—æœ€é«˜çš„ç²¾åº¦ï¼š typedef long double REAL; å¦‚æœåœ¨ä¸æ”¯æŒ long double çš„æœºå™¨ä¸Šè¿è¡Œç›¸å…³ä»£ç ï¼Œåªéœ€è¦å¯¹å¯¹åº”çš„typedefè¯­å¥è¿›è¡Œä¿®æ”¹ï¼Œä¾‹å¦‚ï¼š typedef double REAL; æˆ–è€…ï¼š typedef float REAL; 2ï¼‰ä½¿ç”¨typedefä¸ºç°æœ‰ç±»å‹åˆ›å»ºåˆ«åï¼Œç»™å˜é‡å®šä¹‰ä¸€ä¸ªæ˜“äºè®°å¿†ä¸”æ„ä¹‰æ˜ç¡®çš„æ–°åå­—ã€‚ ä¾‹å¦‚: typedef unsigned int UINT 3ï¼‰ä½¿ç”¨typedefç®€åŒ–ä¸€äº›æ¯”è¾ƒå¤æ‚çš„ç±»å‹å£°æ˜ã€‚ ä¾‹å¦‚ï¼š typedef void (*PFunCallBack)(char* pMsg, unsigned int nMsgLen); ä¸Šè¿°å£°æ˜å¼•å…¥äº†PFunCallBackç±»å‹ä½œä¸ºå‡½æ•°æŒ‡é’ˆçš„åŒä¹‰å­—ï¼Œè¯¥å‡½æ•°æœ‰ä¸¤ä¸ªç±»å‹åˆ†åˆ«ä¸ºchar*å’Œunsigned intå‚æ•°ï¼Œä»¥åŠä¸€ä¸ªç±»å‹ä¸ºintçš„è¿”å›å€¼ã€‚é€šå¸¸ï¼Œå½“æŸä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°æ—¶ï¼Œå¯èƒ½ä¼šç”¨åˆ°typedefç®€åŒ–å£°æ˜ã€‚ ä¾‹å¦‚ï¼Œæ‰¿æ¥ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å†åˆ—ä¸¾ä¸‹åˆ—ç¤ºä¾‹ï¼š RedisSubCommand(const string\u0026 strKey, PFunCallBack pFunCallback, bool bOnlyOne); æ³¨æ„ï¼šç±»å‹åPFunCallBackä¸å˜é‡åpFunCallbackçš„å¤§å°å†™åŒºåˆ«ã€‚ RedisSubCommandå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªPFunCallBackç±»å‹çš„å›è°ƒå‡½æ•°ï¼Œè¿”å›æŸä¸ªå‡½æ•°ï¼ˆpFunCallbackï¼‰çš„åœ°å€ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¦‚æœä¸ç”¨typedefï¼ŒRedisSubCommandå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š RedisSubCommand(const string\u0026 strKey, void (*pFunCallback)(char* pMsg, unsigned int nMsgLen), bool bOnlyOne); ä»ä¸Šé¢ä¸¤æ¡å‡½æ•°å£°æ˜å¯ä»¥çœ‹å‡ºï¼Œä¸ä½¿ç”¨typedefçš„æƒ…å†µä¸‹ï¼ŒRedisSubCommandå‡½æ•°çš„å£°æ˜å¤æ‚å¾—å¤šï¼Œä¸åˆ©äºä»£ç çš„ç†è§£ï¼Œå¹¶ä¸”å¢åŠ çš„å‡ºé”™é£é™©ã€‚ æ‰€ä»¥ï¼Œåœ¨æŸäº›å¤æ‚çš„ç±»å‹å£°æ˜ä¸­ï¼Œä½¿ç”¨typedefè¿›è¡Œå£°æ˜çš„ç®€åŒ–æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ ","date":"2019-07-17","objectID":"/20190717_typedef/:2:2","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"3. typedefä¸#define ä¸¤è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š #defineè¿›è¡Œç®€å•çš„è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ã€‚ #defineå®å®šä¹‰å¯ä»¥ä½¿ç”¨#ifdefã€#ifndefç­‰æ¥è¿›è¡Œé€»è¾‘åˆ¤æ–­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨#undefæ¥å–æ¶ˆå®šä¹‰ã€‚ typedefæ˜¯ä¸ºä¸€ä¸ªç±»å‹èµ·æ–°åå­—ã€‚typedefç¬¦åˆï¼ˆCè¯­è¨€ï¼‰èŒƒå›´è§„åˆ™ï¼Œä½¿ç”¨typedefå®šä¹‰çš„å˜é‡ç±»å‹ï¼Œå…¶ä½œç”¨èŒƒå›´é™åˆ¶åœ¨æ‰€å®šä¹‰çš„å‡½æ•°æˆ–è€…æ–‡ä»¶å†…ï¼ˆå–å†³äºæ­¤å˜é‡å®šä¹‰çš„ä½ç½®ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™æ²¡æœ‰è¿™ç§ç‰¹æ€§ã€‚ é€šå¸¸ï¼Œä½¿ç”¨typedefè¦æ¯”ä½¿ç”¨#defineè¦å¥½ï¼Œç‰¹åˆ«æ˜¯åœ¨æœ‰æŒ‡é’ˆçš„åœºåˆé‡Œã€‚ ä¸‹é¢åˆ—ä¸¾å‡ ä¸ªç¤ºä¾‹ã€‚ 3.1 ç¤ºä¾‹1 ä»£ç å¦‚ä¸‹ï¼š typedefã€€char*ã€€pStr1; #defineã€€pStr2ã€€char*ã€€pStr1ã€€s1, s2; pStr2ã€€s3, s4; åœ¨ä¸Šè¿°çš„å˜é‡å®šä¹‰ä¸­ï¼Œs1ã€s2ã€s3éƒ½è¢«å®šä¹‰ä¸ºcharç±»å‹ï¼›ä½†æ˜¯s4åˆ™å®šä¹‰æˆäº†charç±»å‹ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æ‰€é¢„æœŸçš„æŒ‡é’ˆå˜é‡charï¼Œè¿™æ˜¯å› ä¸º#defineåªåšç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ›¿æ¢åçš„ç›¸å…³ä»£ç ç­‰åŒäºä¸ºï¼š char*ã€€s3, s4; è€Œä½¿ç”¨typedefä¸ºchar*å®šä¹‰äº†æ–°ç±»å‹pStr1åï¼Œç›¸å…³ä»£ç ç­‰åŒäºä¸ºï¼š char *s3, *s4; 3.1 ç¤ºä¾‹2 ä»£ç å¦‚ä¸‹ï¼š typedef char *pStr; char string[5]=\"test\"; const char *p1=string; const pStr p2=string; p1++; p2++; error:increment of read-only variable 'p2' æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œèƒ½å¤Ÿçœ‹å‡ºp2ä¸ºåªè¯»çš„å¸¸é‡äº†ï¼Œæ‰€ä»¥p2++å‡ºé”™äº†ã€‚è¿™ä¸ªé—®é¢˜å†ä¸€æ¬¡æé†’æˆ‘ä»¬ï¼štypedefå’Œ#defineä¸åŒï¼Œtypedefä¸æ˜¯ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œä¸Šè¿°ä»£ç ä¸­const pStr p2å¹¶ä¸ç­‰äºconst char * p2ï¼ŒpStræ˜¯ä½œä¸ºä¸€ä¸ªç±»å‹å­˜åœ¨çš„ï¼Œæ‰€ä»¥const pStr p2å®é™…ä¸Šé™åˆ¶äº†pStrç±»å‹çš„p2å˜é‡ï¼Œå¯¹p2å¸¸é‡è¿›è¡Œäº†åªè¯»é™åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œconst pStr p2å’ŒpStr const p2æœ¬è´¨ä¸Šæ²¡æœ‰åŒºåˆ«ï¼ˆå¯ç±»æ¯”const int p2å’Œint const p2ï¼‰ï¼Œéƒ½æ˜¯å¯¹å˜é‡p2è¿›è¡Œåªè¯»é™åˆ¶ï¼Œåªä¸è¿‡æ­¤å¤„å˜é‡p2çš„æ•°æ®ç±»å‹æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ï¼ˆpStrï¼‰ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿå›ºæœ‰ç±»å‹ï¼ˆå¦‚intï¼‰è€Œå·²ã€‚ æ‰€ä»¥ï¼Œconst pStr p2çš„å«ä¹‰æ˜¯ï¼šé™å®šæ•°æ®ç±»å‹ä¸ºchar *çš„å˜é‡p2ä¸ºåªè¯»ï¼Œå› æ­¤p2++é”™è¯¯ã€‚ æ³¨æ„ï¼šåœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œtypedefå®šä¹‰çš„æ–°ç±»å‹ä¸ç¼–è¯‘ç³»ç»Ÿå›ºæœ‰çš„ç±»å‹æ²¡æœ‰å·®åˆ«ã€‚ ","date":"2019-07-17","objectID":"/20190717_typedef/:3:0","tags":["C"],"title":"The descriptions of typedef","uri":"/20190717_typedef/"},{"categories":["Technology"],"content":"Article description.","date":"2019-06-11","objectID":"/20190611_conditional-compilation/","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"Conditional compilation is static compilation of code based on the actual definition of macros (some kind of condition). Compilation conditions can be determined based on the value of an expression or whether a particular macro is defined. C language conditional compilation related precompilation instructions, including #define, #undef, #ifdef, #ifndef, #if, #elif, #else, #endif, defined. ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:0:0","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"é¢„ç¼–è¯‘æŒ‡ä»¤ #define å®šä¹‰ä¸€ä¸ªé¢„å¤„ç†å® #undef å–æ¶ˆå®çš„å®šä¹‰ #if ç¼–è¯‘é¢„å¤„ç†ä¸­çš„æ¡ä»¶å‘½ä»¤ï¼Œç›¸å½“äºCè¯­æ³•ä¸­çš„ifè¯­å¥ #ifdef åˆ¤æ–­æŸä¸ªå®æ˜¯å¦è¢«å®šä¹‰ï¼Œè‹¥å·²å®šä¹‰ï¼Œæ‰§è¡Œéšåçš„è¯­å¥ #ifndef ä¸#ifdefç›¸åï¼Œåˆ¤æ–­æŸä¸ªå®æ˜¯å¦æœªè¢«å®šä¹‰ #elif è‹¥#if, #ifdef, #ifndefæˆ–å‰é¢çš„#elifæ¡ä»¶ä¸æ»¡è¶³ï¼Œåˆ™æ‰§è¡Œ#elifä¹‹åçš„è¯­å¥ï¼Œç›¸å½“äºCè¯­æ³•ä¸­çš„else-if #else ä¸#if, #ifdef, #ifndefå¯¹åº”, è‹¥è¿™äº›æ¡ä»¶ä¸æ»¡è¶³ï¼Œåˆ™æ‰§è¡Œ#elseä¹‹åçš„è¯­å¥ï¼Œç›¸å½“äºCè¯­æ³•ä¸­çš„else #endif #if, #ifdef, #ifndefè¿™äº›æ¡ä»¶å‘½ä»¤çš„ç»“æŸæ ‡å¿—. #defined ä¸#if, #elifé…åˆä½¿ç”¨ï¼Œåˆ¤æ–­æŸä¸ªå®æ˜¯å¦è¢«å®šä¹‰ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:1:0","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"æ¡ä»¶ç¼–è¯‘ æ¡ä»¶ç¼–è¯‘æ˜¯æ ¹æ®å®é™…å®šä¹‰å®ï¼ˆæŸç±»æ¡ä»¶ï¼‰è¿›è¡Œä»£ç é™æ€ç¼–è¯‘çš„æ‰‹æ®µã€‚å¯æ ¹æ®è¡¨è¾¾å¼çš„å€¼æˆ–æŸä¸ªç‰¹å®šå®æ˜¯å¦è¢«å®šä¹‰æ¥ç¡®å®šç¼–è¯‘æ¡ä»¶ã€‚ æœ€å¸¸è§çš„æ¡ä»¶ç¼–è¯‘æ˜¯é˜²æ­¢é‡å¤åŒ…å«å¤´æ–‡ä»¶çš„å®ï¼Œå½¢å¼è·Ÿä¸‹é¢ä»£ç ç±»ä¼¼ï¼š #ifndef ABCD_H #define ABCD_H // ... some declaration codes #endif // #ifndef ABCD_H åœ¨å®ç°æ–‡ä»¶ä¸­é€šå¸¸æœ‰å¦‚ä¸‹ç±»ä¼¼çš„å®šä¹‰ï¼š #ifdef _DEBUG // ... do some operations #endif #ifdef _WIN32 // ... use Win32 API #endif ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:2:0","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"é¢„ç¼–è¯‘æŒ‡ä»¤åº”ç”¨ä¸¾ä¾‹ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:3:0","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"1. #defineã€#undef #defineå‘½ä»¤å®šä¹‰ä¸€ä¸ªå®: #define MACRO_NAME[(args)] [tokens[(opt)]] ä¹‹åå‡ºç°çš„MACRO_NAMEå°†è¢«æ›¿ä»£ä¸ºæ‰€å®šä¹‰çš„æ ‡è®°(tokens)ã€‚å®å¯å¸¦å‚æ•°ï¼Œè€Œåé¢çš„æ ‡è®°ä¹Ÿæ˜¯å¯é€‰çš„ã€‚ å®å®šä¹‰ï¼ŒæŒ‰ç…§æ˜¯å¦å¸¦å‚æ•°é€šå¸¸åˆ†ä¸ºå¯¹è±¡å®ã€å‡½æ•°å®ä¸¤ç§ã€‚ å¯¹è±¡å®: ä¸å¸¦å‚æ•°çš„å®è¢«ç§°ä¸º\"å¯¹è±¡å®(objectlike macro)\"ã€‚å¯¹è±¡å®å¤šç”¨äºå®šä¹‰å¸¸é‡ã€é€šç”¨æ ‡è¯†ã€‚ä¾‹å¦‚ï¼š // å¸¸é‡å®šä¹‰ #define MAX_LENGTH 100 // é€šç”¨æ ‡è¯†ï¼Œæ—¥å¿—è¾“å‡ºå® #define SLog printf // é¢„ç¼–è¯‘å® #define _DEBUG å‡½æ•°å®ï¼šå¸¦å‚æ•°çš„å®ã€‚åˆ©ç”¨å®å¯ä»¥æé«˜ä»£ç çš„è¿è¡Œæ•ˆç‡: å­ç¨‹åºçš„è°ƒç”¨éœ€è¦å‹æ ˆå‡ºæ ˆ, è¿™ä¸€è¿‡ç¨‹å¦‚æœè¿‡äºé¢‘ç¹ä¼šè€—è´¹æ‰å¤§é‡çš„CPUè¿ç®—èµ„æºã€‚ æ‰€ä»¥ä¸€äº›ä»£ç é‡å°ä½†è¿è¡Œé¢‘ç¹çš„ä»£ç å¦‚æœé‡‡ç”¨å¸¦å‚æ•°å®æ¥å®ç°ä¼šæé«˜ä»£ç çš„è¿è¡Œæ•ˆç‡ã€‚ä½†å¤šæ•°c++ç¨‹åºä¸æ¨èä½¿ç”¨å‡½æ•°å®ï¼Œè°ƒè¯•ä¸Šæœ‰ä¸€å®šéš¾åº¦ï¼Œå¯è€ƒè™‘ä½¿ç”¨c++çš„inlineä»£æ›¿ä¹‹ã€‚ä¾‹å¦‚ï¼š // æœ€å°å€¼å‡½æ•° #define MIN(a,b) ((a)\u003e(b)? (a):(b)) // å®‰å…¨é‡Šæ”¾å†…å­˜å‡½æ•° #define SAFE_DELETE(p) {if(NULL!=p){delete p; p = NULL;}} #undefå¯ä»¥å–æ¶ˆå®å®šä¹‰ï¼Œä¸#defineå¯¹åº”ã€‚ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:3:1","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"2. defined definedç”¨æ¥æµ‹è¯•æŸä¸ªå®æ˜¯å¦è¢«å®šä¹‰ã€‚defined(name): è‹¥å®è¢«å®šä¹‰ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚ å®ƒä¸#ifã€#elifã€#elseç»“åˆä½¿ç”¨æ¥åˆ¤æ–­å®æ˜¯å¦è¢«å®šä¹‰ï¼Œä¹ä¸€çœ‹å¥½åƒå®ƒæ˜¾å¾—å¤šä½™, å› ä¸ºå·²ç»æœ‰äº†#ifdefå’Œ#ifndefã€‚definedå¯ç”¨äºåœ¨ä¸€æ¡åˆ¤æ–­è¯­å¥ä¸­å£°æ˜å¤šä¸ªåˆ¤åˆ«æ¡ä»¶ï¼›#ifdefå’Œ#ifndefåˆ™ä»…æ”¯æŒåˆ¤æ–­ä¸€ä¸ªå®æ˜¯å¦å®šä¹‰ã€‚ #if defined(VAX) \u0026\u0026 defined(UNIX) \u0026\u0026 !defined(DEBUG) å’Œ#ifã€#elifã€#elseä¸åŒï¼Œ#ifdefã€#ifndefã€definedæµ‹è¯•çš„å®å¯ä»¥æ˜¯å¯¹è±¡å®ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°å®ã€‚ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:3:2","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"3. #ifdefã€#ifndefã€#elseã€#endif æ¡ä»¶ç¼–è¯‘ä¸­ç›¸å¯¹å¸¸ç”¨çš„é¢„ç¼–è¯‘æŒ‡ä»¤ã€‚æ¨¡å¼å¦‚ä¸‹ï¼š #ifdef ABC // ... codes while definded ABC #elif (CODE_VERSION \u003e 2) // ... codes while CODE_VERSION \u003e 2 #else // ... remained cases #endif #ifdefç”¨äºåˆ¤æ–­æŸä¸ªå®æ˜¯å¦å®šä¹‰ï¼Œå’Œ#ifndefåŠŸèƒ½æ­£å¥½ç›¸åï¼ŒäºŒè€…ä»…æ”¯æŒåˆ¤æ–­å•ä¸ªå®æ˜¯å¦å·²ç»å®šä¹‰ï¼Œä¸Šé¢ä¾‹å­ä¸­äºŒè€…å¯ä»¥äº’æ¢ã€‚å¦‚æœä¸éœ€è¦å¤šæ¡ä»¶é¢„ç¼–è¯‘çš„è¯ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„#elifå’Œ#elseå‡å¯ä»¥ä¸å†™ã€‚ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:3:3","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"4. #ifã€#elifã€#elseã€#endif åœ¨åˆ¤æ–­æŸä¸ªå®æ˜¯å¦è¢«å®šä¹‰æ—¶ï¼Œåº”å½“é¿å…ä½¿ç”¨#ifï¼Œå› ä¸ºè¯¥å®çš„å€¼å¯èƒ½å°±æ˜¯è¢«å®šä¹‰ä¸º0ã€‚è€Œåº”å½“ä½¿ç”¨#ifdefæˆ–#ifndefã€‚ æ³¨æ„: #ifã€#elifä¹‹åçš„å®åªèƒ½æ˜¯å¯¹è±¡å®ã€‚å¦‚æœå®æœªå®šä¹‰ï¼Œæˆ–è€…è¯¥å®æ˜¯å‡½æ•°å®ï¼Œåˆ™ç¼–è¯‘å™¨å¯èƒ½ä¼šæœ‰å¯¹åº”å®æœªå®šä¹‰çš„è­¦å‘Šã€‚ ","date":"2019-06-11","objectID":"/20190611_conditional-compilation/:3:4","tags":["C"],"title":"Conditional compilation directives","uri":"/20190611_conditional-compilation/"},{"categories":["Technology"],"content":"Article description.","date":"2019-05-10","objectID":"/20190510_pythonintroduction/","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"Python is dynamically-typed and garbage-collected. It supports multiple programming paradigms, including structured (particularly, procedural), object-oriented and functional programming. Python is often described as a â€œbatteries includedâ€ language due to its comprehensive standard library. ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:0:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"1. æ•°æ®ç±»å‹è½¬æ¢ æ•´å‹ æµ®ç‚¹ bool å¤æ•° string list tuple set dict æ•´å‹ \\ åŠ .0 int(0) åŠ 0j ä»»æ„ Ã— Ã— Ã— Ã— æµ®ç‚¹ å»å°æ•° \\ 0.0 åŠ 0j æ•°æ® Ã— Ã— Ã— Ã— bool true1 false0 true1.0 false0.0 \\ true1+0j å¯ä»¥ Ã— Ã— Ã— Ã— å¤æ•° Ã— Ã— 0j \\ è½¬æ¢ Ã— Ã— Ã— Ã— string çº¯æ•°å­— çº¯æ•°å­— '' çº¯æ•°\u0026+0j \\ æ¯ä¸ªå­—ç¬¦è½¬æˆæ¯ä¸ªå€¼ æ¯ä¸ªå­—ç¬¦è½¬æˆæ¯ä¸ªå€¼ æ¯ä¸ªå­—ç¬¦è½¬æˆæ¯ä¸ªå€¼+å»é‡ Ã— list Ã— Ã— [] Ã— æˆä¸º \\ å†…å®¹ä¸å˜ éšæœº+å»é‡ æœ‰2ä¸ªæ•°æ®çš„äºŒçº§åˆ—è¡¨ tuple Ã— Ã— () Ã— str å†…å®¹ä¸å˜ \\ éšæœº+å»é‡ æœ‰2ä¸ªæ•°æ®çš„äºŒçº§åˆ—è¡¨ set Ã— Ã— set() Ã— æ ¼å¼ å†…å®¹ä¸å˜+éšæœº å†…å®¹ä¸å˜+éšæœº \\ æœ‰2ä¸ªæ•°æ®çš„äºŒçº§åˆ—è¡¨ dict Ã— Ã— {} Ã— æ•°æ® ä»…ä¿ç•™é”® ä»…ä¿ç•™é”® ä»…ä¿ç•™é”® \\ ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:1:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"2. èº«ä»½è¿ç®— åˆ¤æ–­åœ°å€æ˜¯å¦ç›¸åŒ x is y x is not y 1.å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²å€¼ç›¸åŒï¼ŒIDç›¸åŒã€‚ 2.åˆ—è¡¨ã€å­—å…¸ã€é›†åˆï¼šæ— è®ºä»€ä¹ˆæƒ…å†µIDéƒ½ä¸åŒ ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:2:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"3. æˆå‘˜æ£€æµ‹è¿ç®— val1 in val2 val1 not in val2 //æ£€æµ‹ä¸€ä¸ªæ•°æ®æ˜¯å¦åœ¨å®¹å™¨ä¸­ ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:3:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"4. æµç¨‹æ§åˆ¶ 1. if ___: elif ___: elif ___: else: 2. while ___: else: 3. for x in å®¹å™¨: ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:4:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"5. å‡½æ•° def func( name, sex = â€œmaleâ€, *args, like = â€œä¹’ä¹“â€, **kwargs); â†“ â†“ â†“ â†“ â†“ â†“ func( â€œåˆ˜ä½³é”â€, â€œç”·â€, â€œä¹è‰²â€, â€œåƒåœ¾â€, like = â€œç¾½æ¯›çƒâ€, skin = â€œyellowâ€, hobby = â€œhelloâ€) print(locals()) //è·å–å½“å‰ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ print(globals()) //è·å–å½“å‰ä½œç”¨åŸŸçš„å…¨å±€å˜é‡ ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:5:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"6. è¿­ä»£å™¨ èƒ½è¢«next()å‡½æ•°è°ƒç”¨å¹¶ä¸æ–­è¿”å›ä¸‹ä¸€ä¸ªå€¼çš„å¯¹è±¡ ç‰¹å¾ï¼šè¿­ä»£å™¨ä¼šç”Ÿæˆæƒ°æ€§åºåˆ—ï¼Œé€šè¿‡è®¡ç®—æŠŠå€¼ä¾æ¬¡è¿”å› ä¼˜ç‚¹ï¼šéœ€è¦æ•°æ®çš„æ—¶å€™ï¼Œä¸€æ¬¡å–ä¸€ä¸ªå¯ä»¥å¾ˆå¤§èŠ‚çœå†…å­˜ æ£€æµ‹ï¼š from collections import Iterable, Iterator isinstance()åˆ¤æ–­æ•°æ®ç±»å‹ï¼Œè¿”å›boolå€¼ print(isinstance(list1,list1)) Iterï¼šä½¿ç”¨iterå¯æŠŠè¿­ä»£æ•°æ®å˜ä¸ºè¿­ä»£å™¨ list1 = [1,2,3] result = iter(list1) print(next(result)) ","date":"2019-05-10","objectID":"/20190510_pythonintroduction/:6:0","tags":["Python"],"title":"Python Introduction","uri":"/20190510_pythonintroduction/"},{"categories":["Technology"],"content":"Article description.","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"Performance optimization methods and ideas for large C projects. Performance optimization strategies for x86 projects that encounter performance bottlenecks when porting to low performance processors. ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:0:0","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"é€šå¸¸ä¼˜åŒ–æ–¹æ³• ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:0","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"1. å®å®šä¹‰æˆ–å†…è” çŸ­çš„ã€è°ƒç”¨é¢‘ç¹çš„å‡½æ•°æ”¹ä¸ºå®å®šä¹‰æˆ–å†…è”å‡½æ•°ï¼Œå‡å°‘è°ƒç”¨å±‚çº§ å¯èƒ½ç¼–è¯‘å™¨å·²ç»åšäº†éƒ¨åˆ†ä¼˜åŒ–ï¼Œæ•ˆæœä¸ä¸€å®šæ˜æ˜¾ ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:1","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"2. å›ºå®šæ¬¡æ•°çš„çŸ­å¾ªç¯å±•å¼€ å¾ªç¯è¯­å¥å¦‚æœå¾ªç¯æ¬¡æ•°å·²çŸ¥ï¼Œä¸”æ˜¯çŸ­å¾ªç¯ï¼Œå¯ä»¥å°†è¯­å¥å±•å¼€ ç¼–è¯‘å™¨å¯èƒ½å·²åšä¼˜åŒ–ï¼Œæ•ˆæœä¸ä¸€å®šæ˜æ˜¾ ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:2","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"3. å‡å°‘å†…å­˜åˆ†é…å’Œé‡Šæ”¾çš„æ¬¡æ•° é¢‘ç¹ä½¿ç”¨çš„å˜é‡èƒ½ç”¨å…¨å±€å˜é‡çš„å°½é‡ä¸ç”¨å±€éƒ¨å˜é‡ å‡½æ•°ä½“å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œå¦‚æœå¤§å°ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œå°½é‡ä¸ç”¨åŠ¨æ€åˆ†é…ç©ºé—´ æ•°æ®ç»“æ„ä¸­ï¼Œå°½é‡ä¸ç”¨æŒ‡é’ˆå˜é‡ ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:3","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"4. ç§»ä½ä»£æ›¿ä¹˜é™¤ ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:4","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"5. æ¡ä»¶è¯­å¥ä¼˜åŒ– æ ¹æ®åˆ†æ”¯è¢«æ‰§è¡Œçš„é¢‘ç‡å°†é¢‘ç¹æ‰§è¡Œçš„åˆ†æ”¯æ”¾åœ¨å‰é¢éƒ¨åˆ† ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:5","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"6. æ•°æ®ç»“æ„/ç®—æ³• æ•°æ®ç»“æ„ä¸­å°½é‡å‡å°‘éœ€è¦åŠ¨æ€åˆ†é…ç©ºé—´çš„æŒ‡é’ˆï¼Œæ”¹ç”¨è”åˆã€ç»“æ„ä½“æˆ–å›ºå®šå¤§å°çš„ç¼“å­˜åŒº ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:6","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"7. ä½¿ç”¨å¹¶è¡Œç¨‹åº ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:1:7","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"ä»£ç é‡æ„åŸåˆ™ ç»´æŠ¤ä¸€å¥—ä»£ç ï¼Œä½¿ç”¨å®å®šä¹‰æ§åˆ¶ å°æ­¥å‰è¿›ï¼Œé‡æ„ä¸€éƒ¨åˆ†è¿›è¡Œå……åˆ†æµ‹è¯•åå†é‡æ„ä¸‹ä¸€éƒ¨åˆ† ","date":"2019-04-09","objectID":"/20190409_cperformance-optimization/:2:0","tags":["Tuning","C"],"title":"C Project Performance Tuning","uri":"/20190409_cperformance-optimization/"},{"categories":["Technology"],"content":"Article description.","date":"2019-03-04","objectID":"/20190304_gdb-debug/","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"GDB is a powerful program debugging tool based on command line under UNIX/LINUX operating system released by GNU Source Organization. For a C/C ++ programmer working on Linux, GDB is an essential tool. ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:0:0","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"gdbçš„ä½¿ç”¨ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:0","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"å¯åŠ¨gdb ç¼–è¯‘ä¸€ä¸ªæµ‹è¯•ç¨‹åºï¼Œ-gè¡¨ç¤ºå¯ä»¥è°ƒè¯• gcc -g demo.c -o demo å¯åŠ¨gdb gdb test æˆ–è€… gdb -q test //è¡¨ç¤ºä¸æ‰“å°gdbç‰ˆæœ¬ä¿¡æ¯ï¼Œç•Œé¢è¾ƒä¸ºå¹²å‡€ï¼› ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:1","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"æŸ¥çœ‹æºç  list ï¼šç®€è®°ä¸º l ï¼Œå…¶ä½œç”¨å°±æ˜¯åˆ—å‡ºç¨‹åºçš„æºä»£ç ï¼Œé»˜è®¤æ¯æ¬¡æ˜¾ç¤º10è¡Œã€‚ list è¡Œå·ï¼šå°†æ˜¾ç¤ºå½“å‰æ–‡ä»¶ä»¥â€œè¡Œå·â€ä¸ºä¸­å¿ƒçš„å‰å10è¡Œä»£ç ï¼Œå¦‚ï¼šlist 12 list å‡½æ•°åï¼šå°†æ˜¾ç¤ºâ€œå‡½æ•°åâ€æ‰€åœ¨å‡½æ•°çš„æºä»£ç ï¼Œå¦‚ï¼šlist main list ï¼šä¸å¸¦å‚æ•°ï¼Œå°†æ¥ç€ä¸Šä¸€æ¬¡ list å‘½ä»¤çš„ï¼Œè¾“å‡ºä¸‹è¾¹çš„å†…å®¹ã€‚ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:2","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"è¿è¡Œç¨‹åº runï¼šç®€è®°ä¸º r ï¼Œå…¶ä½œç”¨æ˜¯è¿è¡Œç¨‹åºï¼Œå½“é‡åˆ°æ–­ç‚¹åï¼Œç¨‹åºä¼šåœ¨æ–­ç‚¹å¤„åœæ­¢è¿è¡Œï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸‹ä¸€æ­¥çš„å‘½ä»¤ã€‚ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:3","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"è®¾ç½®å‚æ•° set args å‚æ•°1 å‚æ•°2 ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:4","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"è®¾ç½®æ–­ç‚¹ break n ï¼ˆç®€å†™b nï¼‰:åœ¨ç¬¬nè¡Œå¤„è®¾ç½®æ–­ç‚¹.å¯ä»¥å¸¦ä¸Šä»£ç è·¯å¾„å’Œä»£ç åç§°ï¼š b demo.cpp:578 b fn1 if aï¼bï¼šæ¡ä»¶æ–­ç‚¹è®¾ç½® break funcï¼ˆbreakç¼©å†™ä¸ºbï¼‰ï¼šåœ¨å‡½æ•°func()çš„å…¥å£å¤„è®¾ç½®æ–­ç‚¹ï¼Œå¦‚ï¼šbreak cb_button delete æ–­ç‚¹å·nï¼šåˆ é™¤ç¬¬nä¸ªæ–­ç‚¹ disable æ–­ç‚¹å·nï¼šæš‚åœç¬¬nä¸ªæ–­ç‚¹ enable æ–­ç‚¹å·nï¼šå¼€å¯ç¬¬nä¸ªæ–­ç‚¹ clear è¡Œå·nï¼šæ¸…é™¤ç¬¬nè¡Œçš„æ–­ç‚¹ info b ï¼ˆinfo breakpointsï¼‰ï¼šæ˜¾ç¤ºå½“å‰ç¨‹åºçš„æ–­ç‚¹è®¾ç½®æƒ…å†µ delete breakpointsï¼šæ¸…é™¤æ‰€æœ‰æ–­ç‚¹ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:5","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"å•æ­¥æ‰§è¡Œ continue ï¼ˆç®€å†™c ï¼‰ï¼šç»§ç»­æ‰§è¡Œï¼Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ï¼ˆæˆ–è¿è¡Œç»“æŸï¼‰ nextï¼šï¼ˆç®€å†™ nï¼‰ï¼Œå•æ­¥è·Ÿè¸ªç¨‹åºï¼Œå½“é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¹Ÿä¸è¿›å…¥æ­¤å‡½æ•°ä½“ï¼›æ­¤å‘½ä»¤åŒ step çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œstep é‡åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œå°†æ­¥è¿›åˆ°å‡½æ•°ä¸­å»è¿è¡Œï¼Œè€Œ next åˆ™ç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œä¸ä¼šè¿›å…¥åˆ°å‡½æ•°ä½“å†…ã€‚ step ï¼ˆç®€å†™sï¼‰ï¼šå•æ­¥è°ƒè¯•å¦‚æœæœ‰å‡½æ•°è°ƒç”¨ï¼Œåˆ™è¿›å…¥å‡½æ•°ï¼›ä¸å‘½ä»¤nä¸åŒï¼Œnæ˜¯ä¸è¿›å…¥è°ƒç”¨çš„å‡½æ•°çš„ untilï¼šå½“ä½ åŒå€¦äº†åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…å•æ­¥è·Ÿè¸ªæ—¶ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥è¿è¡Œç¨‹åºç›´åˆ°é€€å‡ºå¾ªç¯ä½“ã€‚ until+è¡Œå·ï¼š è¿è¡Œè‡³æŸè¡Œï¼Œä¸ä»…ä»…ç”¨æ¥è·³å‡ºå¾ªç¯ finishï¼š è¿è¡Œç¨‹åºï¼Œç›´åˆ°å½“å‰å‡½æ•°å®Œæˆè¿”å›ï¼Œå¹¶æ‰“å°å‡½æ•°è¿”å›æ—¶çš„å †æ ˆåœ°å€å’Œè¿”å›å€¼åŠå‚æ•°å€¼ç­‰ä¿¡æ¯ã€‚ call å‡½æ•°(å‚æ•°)ï¼šè°ƒç”¨ç¨‹åºä¸­å¯è§çš„å‡½æ•°ï¼Œå¹¶ä¼ é€’â€œå‚æ•°â€ï¼Œå¦‚ï¼šcall gdb_test(55) ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:6","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"æŸ¥çœ‹å˜é‡ print è¡¨è¾¾å¼ï¼šç®€è®°ä¸º p ï¼Œå…¶ä¸­â€œè¡¨è¾¾å¼â€å¯ä»¥æ˜¯ä»»ä½•å½“å‰æ­£åœ¨è¢«æµ‹è¯•ç¨‹åºçš„æœ‰æ•ˆè¡¨è¾¾å¼ï¼Œæ¯”å¦‚å½“å‰æ­£åœ¨è°ƒè¯•Cè¯­è¨€çš„ç¨‹åºï¼Œé‚£ä¹ˆâ€œè¡¨è¾¾å¼â€å¯ä»¥æ˜¯ä»»ä½•Cè¯­è¨€çš„æœ‰æ•ˆè¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬æ•°å­—ï¼Œå˜é‡ç”šè‡³æ˜¯å‡½æ•°è°ƒç”¨ã€‚ print aï¼šå°†æ˜¾ç¤ºæ•´æ•° a çš„å€¼ print ++aï¼šå°†æŠŠ a ä¸­çš„å€¼åŠ 1,å¹¶æ˜¾ç¤ºå‡ºæ¥ print nameï¼šå°†æ˜¾ç¤ºå­—ç¬¦ä¸² name çš„å€¼ print gdb_test(22)ï¼šå°†ä»¥æ•´æ•°22ä½œä¸ºå‚æ•°è°ƒç”¨ gdb_test() å‡½æ•° print gdb_test(a)ï¼šå°†ä»¥å˜é‡ a ä½œä¸ºå‚æ•°è°ƒç”¨ gdb_test() å‡½æ•° display è¡¨è¾¾å¼ï¼šåœ¨å•æ­¥è¿è¡Œæ—¶å°†éå¸¸æœ‰ç”¨ï¼Œä½¿ç”¨displayå‘½ä»¤è®¾ç½®ä¸€ä¸ªè¡¨è¾¾å¼åï¼Œå®ƒå°†åœ¨æ¯æ¬¡å•æ­¥è¿›è¡ŒæŒ‡ä»¤åï¼Œç´§æ¥ç€è¾“å‡ºè¢«è®¾ç½®çš„è¡¨è¾¾å¼åŠå€¼ã€‚å¦‚ï¼š display a watch è¡¨è¾¾å¼ï¼šè®¾ç½®ä¸€ä¸ªç›‘è§†ç‚¹ï¼Œä¸€æ—¦è¢«ç›‘è§†çš„â€œè¡¨è¾¾å¼â€çš„å€¼æ”¹å˜ï¼Œgdbå°†å¼ºè¡Œç»ˆæ­¢æ­£åœ¨è¢«è°ƒè¯•çš„ç¨‹åºã€‚å¦‚ï¼š watch a whatis ï¼šæŸ¥è¯¢å˜é‡æˆ–å‡½æ•° info functionï¼š æŸ¥è¯¢å‡½æ•° æ‰©å±•info localsï¼š æ˜¾ç¤ºå½“å‰å †æ ˆé¡µçš„æ‰€æœ‰å˜é‡ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:7","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"æŸ¥çœ‹è¿è¡Œä¿¡æ¯ where/bt ï¼šå½“å‰è¿è¡Œçš„å †æ ˆåˆ—è¡¨ bt backtrace æ˜¾ç¤ºå½“å‰è°ƒç”¨å †æ ˆ up/down æ”¹å˜å †æ ˆæ˜¾ç¤ºçš„æ·±åº¦ set args å‚æ•°:æŒ‡å®šè¿è¡Œæ—¶çš„å‚æ•° show argsï¼šæŸ¥çœ‹è®¾ç½®å¥½çš„å‚æ•° info programï¼š æ¥æŸ¥çœ‹ç¨‹åºçš„æ˜¯å¦åœ¨è¿è¡Œï¼Œè¿›ç¨‹å·ï¼Œè¢«æš‚åœçš„åŸå› ã€‚ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:8","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"åˆ†å‰²çª—å£ layoutï¼šç”¨äºåˆ†å‰²çª—å£ï¼Œå¯ä»¥ä¸€è¾¹æŸ¥çœ‹ä»£ç ï¼Œä¸€è¾¹æµ‹è¯• layout srcï¼šæ˜¾ç¤ºæºä»£ç çª—å£ layout asmï¼šæ˜¾ç¤ºåæ±‡ç¼–çª—å£ layout regsï¼šæ˜¾ç¤ºæºä»£ç /åæ±‡ç¼–å’ŒCPUå¯„å­˜å™¨çª—å£ layout splitï¼šæ˜¾ç¤ºæºä»£ç å’Œåæ±‡ç¼–çª—å£ Ctrl + Lï¼šåˆ·æ–°çª—å£ ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:9","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"é€€å‡ºgdb quitï¼šç®€è®°ä¸º q ï¼Œé€€å‡ºgdb ","date":"2019-03-04","objectID":"/20190304_gdb-debug/:1:10","tags":["Linux","C"],"title":"GDB debug guide","uri":"/20190304_gdb-debug/"},{"categories":["Technology"],"content":"Article description.","date":"2019-02-03","objectID":"/20190203_huge-pages/","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"Reduce page tables by increasing the size of operating system pages to avoid fast table misses. Large page memory optimizer is designed for malloc mechanism, which means allocating large pages to increase TLB hit ratio. ","date":"2019-02-03","objectID":"/20190203_huge-pages/:0:0","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"åŸç† å¤§é¡µå†…å­˜çš„åŸç†æ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢è¿‡ç¨‹ã€‚æ“ä½œç³»ç»Ÿä¸ºäº†èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œä¼šä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªè™šæ‹Ÿçš„è¿›ç¨‹ç©ºé—´ï¼Œåœ¨32ä½æ“ä½œç³»ç»Ÿä¸Šï¼Œè¿›ç¨‹ç©ºé—´å¤§å°ä¸º4Gï¼Œ64ä½ç³»ç»Ÿä¸º2^64ï¼ˆå®é™…å¯èƒ½å°äºè¿™ä¸ªå€¼ï¼‰ã€‚äº‹å®ä¸Šï¼Œæ¯ä¸ªè¿›ç¨‹çš„è¿›ç¨‹ç©ºé—´éƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œè¿™å’Œç‰©ç†åœ°å€è¿˜ä¸ä¸€æ ·ã€‚ä¸¤ä¸ªè¿›è¡Œè®¿é—®ç›¸åŒçš„è™šæ‹Ÿåœ°å€ï¼Œä½†æ˜¯è½¬æ¢åˆ°ç‰©ç†åœ°å€ä¹‹åæ˜¯ä¸åŒçš„ã€‚è¿™ä¸ªè½¬æ¢å°±é€šè¿‡é¡µè¡¨æ¥å®ç°ï¼Œæ¶‰åŠçš„çŸ¥è¯†æ˜¯æ“ä½œç³»ç»Ÿçš„åˆ†é¡µå­˜å‚¨ç®¡ç†ã€‚ åˆ†é¡µå­˜å‚¨ç®¡ç†å°†è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œåˆ†æˆè‹¥å¹²ä¸ªé¡µï¼Œå¹¶ä¸ºå„é¡µåŠ ä»¥ç¼–å·ã€‚ç›¸åº”åœ°ï¼Œç‰©ç†å†…å­˜ç©ºé—´ä¹Ÿåˆ†æˆè‹¥å¹²ä¸ªå—ï¼ŒåŒæ ·åŠ ä»¥ç¼–å·ã€‚é¡µå’Œå—çš„å¤§å°ç›¸åŒã€‚ åœ¨æ“ä½œç³»ç»Ÿä¸­è®¾ç½®æœ‰ä¸€ä¸ªé¡µè¡¨å¯„å­˜å™¨ï¼Œå…¶ä¸­å­˜æ”¾äº†é¡µè¡¨åœ¨å†…å­˜çš„å§‹å€å’Œé¡µè¡¨çš„é•¿åº¦ã€‚è¿›ç¨‹æœªæ‰§è¡Œæ—¶ï¼Œé¡µè¡¨çš„å§‹å€å’Œé¡µè¡¨é•¿åº¦æ”¾åœ¨æœ¬è¿›ç¨‹çš„PCBä¸­ï¼›å½“è°ƒåº¦ç¨‹åºè°ƒåº¦è¯¥è¿›ç¨‹æ—¶ï¼Œæ‰å°†è¿™ä¸¤ä¸ªæ•°æ®è£…å…¥é¡µè¡¨å¯„å­˜å™¨ã€‚ å½“è¿›ç¨‹è¦è®¿é—®æŸä¸ªè™šæ‹Ÿåœ°å€ä¸­çš„æ•°æ®æ—¶ï¼Œåˆ†é¡µåœ°å€å˜æ¢æœºæ„ä¼šè‡ªåŠ¨åœ°å°†æœ‰æ•ˆåœ°å€ï¼ˆç›¸å¯¹åœ°å€ï¼‰åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ä¸¤éƒ¨åˆ†ï¼Œå†ä»¥é¡µå·ä¸ºç´¢å¼•å»æ£€ç´¢é¡µè¡¨ï¼ŒæŸ¥æ‰¾æ“ä½œç”±ç¡¬ä»¶æ‰§è¡Œã€‚è‹¥ç»™å®šçš„é¡µå·æ²¡æœ‰è¶…å‡ºé¡µè¡¨é•¿åº¦ï¼Œåˆ™å°†é¡µè¡¨å§‹å€ä¸é¡µå·å’Œé¡µè¡¨é¡¹é•¿åº¦çš„ä¹˜ç§¯ç›¸åŠ ï¼Œå¾—åˆ°è¯¥è¡¨é¡¹åœ¨é¡µè¡¨ä¸­çš„ä½ç½®ï¼Œäºæ˜¯å¯ä»¥ä»ä¸­å¾—åˆ°è¯¥é¡µçš„ç‰©ç†å—åœ°å€ï¼Œå°†ä¹‹è£…å…¥ç‰©ç†åœ°å€å¯„å­˜å™¨ä¸­ã€‚ä¸æ­¤åŒæ—¶ï¼Œå†å°†æœ‰æ•ˆåœ°å€å¯„å­˜å™¨ä¸­çš„é¡µå†…åœ°å€é€å…¥ç‰©ç†åœ°å€å¯„å­˜å™¨çš„å—å†…åœ°å€å­—æ®µä¸­ã€‚è¿™æ ·ä¾¿å®Œæˆäº†ä»è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢ã€‚ ç”±äºé¡µè¡¨æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™ä½¿CPUåœ¨æ¯å­˜å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œéƒ½è¦ä¸¤æ¬¡è®¿é—®å†…å­˜ã€‚ç¬¬ä¸€æ¬¡æ—¶è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ï¼Œä»ä¸­æ‰¾åˆ°æŒ‡å®šé¡µçš„ç‰©ç†å—å·ï¼Œå†å°†å—å·ä¸é¡µå†…åç§»æ‹¼æ¥ï¼Œä»¥å½¢æˆç‰©ç†åœ°å€ã€‚ç¬¬äºŒæ¬¡è®¿é—®å†…å­˜æ—¶ï¼Œæ‰æ˜¯ä»ç¬¬ä¸€æ¬¡æ‰€å¾—åœ°å€ä¸­è·å¾—æ‰€éœ€æ•°æ®ã€‚å› æ­¤ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼å°†ä½¿è®¡ç®—æœºçš„å¤„ç†é€Ÿåº¦é™ä½è¿‘1/2ã€‚ ä¸ºäº†æé«˜åœ°å€å˜æ¢é€Ÿåº¦ï¼Œå¯åœ¨åœ°å€å˜æ¢æœºæ„ä¸­ï¼Œå¢è®¾ä¸€ä¸ªå…·æœ‰å¹¶è¡ŒæŸ¥æ‰¾èƒ½åŠ›çš„ç‰¹æ®Šé«˜é€Ÿç¼“å­˜ï¼Œä¹Ÿå³å¿«è¡¨ï¼ˆTLBï¼‰ï¼Œç”¨ä»¥å­˜æ”¾å½“å‰è®¿é—®çš„é‚£äº›é¡µè¡¨é¡¹ã€‚å…·æœ‰å¿«è¡¨çš„åœ°å€å˜æ¢æœºæ„å¦‚å›¾å››æ‰€ç¤ºã€‚ç”±äºæˆæœ¬çš„å…³ç³»ï¼Œå¿«è¡¨ä¸å¯èƒ½åšå¾—å¾ˆå¤§ï¼Œé€šå¸¸åªå­˜æ”¾16~512ä¸ªé¡µè¡¨é¡¹ã€‚ ","date":"2019-02-03","objectID":"/20190203_huge-pages/:1:0","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"å¤§é¡µå†…å­˜çš„é…ç½®å’Œä½¿ç”¨ ","date":"2019-02-03","objectID":"/20190203_huge-pages/:2:0","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"1. å®‰è£…libhugetlbfsåº“ libhugetlbfsåº“å®ç°äº†å¤§é¡µå†…å­˜çš„è®¿é—®ã€‚å®‰è£…å¯ä»¥é€šè¿‡apt-getæˆ–è€…yumå‘½ä»¤å®Œæˆï¼Œå¦‚æœç³»ç»Ÿæ²¡æœ‰è¯¥å‘½ä»¤ï¼Œè¿˜å¯ä»¥git clone, ç„¶åmakeç”Ÿæˆlibhugetlbfs.soæ–‡ä»¶. ç›´æ¥ä½¿ç”¨makefileè¿›è¡Œç¼–è¯‘ï¼šmake BUILDTYPE=NATIVEONLYä¸€å®šè¦åŠ æœ€åçš„å‚æ•° BUILDTYPE=NATIVEONLYå¦åˆ™ä¼šé‡è§å„ç§é”™è¯¯ ","date":"2019-02-03","objectID":"/20190203_huge-pages/:2:1","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"2. é…ç½®grubå¯åŠ¨æ–‡ä»¶ å…·ä½“å°±æ˜¯åœ¨kernelé€‰é¡¹çš„æœ€åæ·»åŠ å‡ ä¸ªå¯åŠ¨å‚æ•°ï¼štransparent_hugepage=never default_hugepagesz=1G hugepagesz=1Ghugepages=123 è¿™å››ä¸ªå‚æ•°ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯åä¸¤ä¸ªï¼Œhugepageszç”¨æ¥è®¾ç½®æ¯é¡µçš„å¤§å°ï¼Œæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸º1Gï¼Œå…¶ä»–å¯é€‰çš„é…ç½®æœ‰4Kï¼Œ2Mï¼ˆå…¶ä¸­2Mæ˜¯é»˜è®¤ï¼‰ã€‚ vim /boot/grub/grub.cfg ä¿®æ”¹å®Œgrub.confåï¼Œé‡å¯ç³»ç»Ÿã€‚ç„¶åè¿è¡Œå‘½ä»¤æŸ¥çœ‹å¤§é¡µè®¾ç½®æ˜¯å¦ç”Ÿæ•ˆ cat /proc/meminfo|grep Huge ","date":"2019-02-03","objectID":"/20190203_huge-pages/:2:2","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"3. mount æ‰§è¡Œmountï¼Œå°†å¤§é¡µå†…å­˜æ˜ åƒåˆ°ä¸€ä¸ªç©ºç›®å½•ã€‚å¯ä»¥æ‰§è¡Œä¸‹è¿°å‘½ä»¤ï¼š mount -t hugetlbfs hugetlbfs /mnt/huge ","date":"2019-02-03","objectID":"/20190203_huge-pages/:2:3","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"4. è¿è¡Œåº”ç”¨ç¨‹åº ä¸ºäº†èƒ½å¯ç”¨å¤§é¡µï¼Œä¸èƒ½æŒ‰ç…§å¸¸è§„çš„æ–¹æ³•å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œéœ€è¦æŒ‰ç…§ä¸‹é¢çš„æ ¼å¼å¯åŠ¨ï¼š HUGETLB_MORECORE=yes LD_PRELOAD=libhugetlbfs.so ./your_program è¿™ç§æ–¹æ³•ä¼šåŠ è½½libhugetlbfsåº“ï¼Œç”¨æ¥æ›¿æ¢æ ‡å‡†åº“ã€‚å…·ä½“çš„æ“ä½œå°±æ˜¯æ›¿æ¢æ ‡å‡†çš„mallocä¸ºå¤§é¡µçš„mallocã€‚æ­¤æ—¶ï¼Œç¨‹åºç”³è¯·å†…å­˜å°±æ˜¯å¤§é¡µå†…å­˜äº†ã€‚ ","date":"2019-02-03","objectID":"/20190203_huge-pages/:2:4","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"å¤§é¡µå†…å­˜çš„ä½¿ç”¨åœºæ™¯ ä»»ä½•ä¼˜åŒ–æ‰‹æ®µéƒ½æœ‰å®ƒé€‚ç”¨çš„èŒƒå›´ï¼Œå¤§é¡µå†…å­˜ä¹Ÿä¸ä¾‹å¤–ã€‚åªæœ‰è€—è´¹çš„å†…å­˜å·¨å¤§ã€è®¿å­˜éšæœºè€Œä¸”è®¿å­˜æ˜¯ç“¶é¢ˆçš„ç¨‹åºå¤§é¡µå†…å­˜æ‰ä¼šå¸¦æ¥å¾ˆæ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚ ","date":"2019-02-03","objectID":"/20190203_huge-pages/:3:0","tags":["Linux","C"],"title":"HugePages","uri":"/20190203_huge-pages/"},{"categories":["Technology"],"content":"Article description.","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"In development, we just need to know that lib is needed at compile time and DLL is needed at run time. If you want to compile source code, lib is all you need. If you want dynamically connected programs to run, you need only a DLL. This article will more clearly understand the difference, generation, use of the two. ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:0:0","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"libå’ŒdllåŒºåˆ« é¦–å…ˆä»‹ç»é™æ€åº“ï¼ˆé™æ€é“¾æ¥åº“ï¼‰ã€åŠ¨æ€åº“ï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰çš„æ¦‚å¿µï¼Œé¦–å…ˆä¸¤è€…éƒ½æ˜¯ä»£ç å…±äº«çš„æ–¹å¼ã€‚ é™æ€åº“ï¼šåœ¨é“¾æ¥æ­¥éª¤ä¸­ï¼Œè¿æ¥å™¨å°†ä»åº“æ–‡ä»¶å–å¾—æ‰€éœ€çš„ä»£ç ï¼Œå¤åˆ¶åˆ°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œè¿™ç§åº“ç§°ä¸ºé™æ€åº“ï¼Œå…¶ç‰¹ç‚¹æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«äº†åº“ä»£ç çš„ä¸€ä»½å®Œæ•´æ‹·è´ï¼›ç¼ºç‚¹å°±æ˜¯è¢«å¤šæ¬¡ä½¿ç”¨å°±ä¼šæœ‰å¤šä»½å†—ä½™æ‹·è´ã€‚å³é™æ€åº“ä¸­çš„æŒ‡ä»¤éƒ½å…¨éƒ¨è¢«ç›´æ¥åŒ…å«åœ¨æœ€ç»ˆç”Ÿæˆçš„ EXE æ–‡ä»¶ä¸­äº†ã€‚åœ¨vsä¸­æ–°å»ºç”Ÿæˆé™æ€åº“çš„å·¥ç¨‹ï¼Œç¼–è¯‘ç”ŸæˆæˆåŠŸåï¼Œåªäº§ç”Ÿä¸€ä¸ª.libæ–‡ä»¶ã€‚ åŠ¨æ€åº“ï¼šåŠ¨æ€é“¾æ¥åº“æ˜¯ä¸€ä¸ªåŒ…å«å¯ç”±å¤šä¸ªç¨‹åºåŒæ—¶ä½¿ç”¨çš„ä»£ç å’Œæ•°æ®çš„åº“ï¼ŒDLLä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€‚åŠ¨æ€é“¾æ¥æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œä½¿è¿›ç¨‹å¯ä»¥è°ƒç”¨ä¸å±äºå…¶å¯æ‰§è¡Œä»£ç çš„å‡½æ•°ã€‚å‡½æ•°çš„å¯æ‰§è¡Œä»£ç ä½äºä¸€ä¸ª DLL ä¸­ï¼Œè¯¥ DLL åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå·²è¢«ç¼–è¯‘ã€é“¾æ¥å¹¶ä¸ä½¿ç”¨å®ƒä»¬çš„è¿›ç¨‹åˆ†å¼€å­˜å‚¨çš„å‡½æ•°ã€‚åœ¨vsä¸­æ–°å»ºç”ŸæˆåŠ¨æ€åº“çš„å·¥ç¨‹ï¼Œç¼–è¯‘æˆåŠŸåï¼Œäº§ç”Ÿä¸€ä¸ª.libæ–‡ä»¶å’Œä¸€ä¸ª.dllæ–‡ä»¶ã€‚ é™æ€åº“å’ŒåŠ¨æ€åº“ä¸­çš„libæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ é™æ€åº“ä¸­çš„libï¼šè¯¥LIBåŒ…å«å‡½æ•°ä»£ç æœ¬èº«ï¼ˆå³åŒ…æ‹¬å‡½æ•°çš„ç´¢å¼•ï¼Œä¹ŸåŒ…æ‹¬å®ç°ï¼‰ï¼Œåœ¨ç¼–è¯‘æ—¶ç›´æ¥å°†ä»£ç åŠ å…¥ç¨‹åºå½“ä¸­ã€‚ åŠ¨æ€åº“ä¸­çš„libï¼šè¯¥LIBåŒ…å«äº†å‡½æ•°æ‰€åœ¨çš„DLLæ–‡ä»¶å’Œæ–‡ä»¶ä¸­å‡½æ•°ä½ç½®çš„ä¿¡æ¯ï¼ˆç´¢å¼•ï¼‰ï¼Œå‡½æ•°å®ç°ä»£ç ç”±è¿è¡Œæ—¶åŠ è½½åœ¨è¿›ç¨‹ç©ºé—´ä¸­çš„DLLæä¾›ã€‚ æ€»ä¹‹ï¼Œlibæ˜¯ç¼–è¯‘æ—¶ç”¨åˆ°çš„ï¼Œdllæ˜¯è¿è¡Œæ—¶ç”¨åˆ°çš„ã€‚å¦‚æœè¦å®Œæˆæºä»£ç çš„ç¼–è¯‘ï¼Œåªéœ€è¦libï¼›å¦‚æœè¦ä½¿åŠ¨æ€é“¾æ¥çš„ç¨‹åºè¿è¡Œèµ·æ¥ï¼Œåªéœ€è¦dllã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:1:0","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"é™æ€é“¾æ¥ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:2:0","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"1. ä¸ºä»€ä¹ˆè¿›è¡Œé™æ€é“¾æ¥ åœ¨æˆ‘ä»¬çš„å®é™…å¼€å‘ä¸­ï¼Œä¸å¯èƒ½å°†æ‰€æœ‰ä»£ç æ”¾åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ä¼šå‡ºç°å¤šä¸ªæºæ–‡ä»¶ï¼Œè€Œä¸”å¤šä¸ªæºæ–‡ä»¶ä¹‹é—´ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œä¼šå­˜åœ¨å¤šç§ä¾èµ–å…³ç³»ï¼Œå¦‚ä¸€ä¸ªæºæ–‡ä»¶å¯èƒ½è¦è°ƒç”¨å¦ä¸€ä¸ªæºæ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œä½†æ˜¯æ¯ä¸ªæºæ–‡ä»¶éƒ½æ˜¯ç‹¬ç«‹ç¼–è¯‘çš„ï¼Œå³æ¯ä¸ª*.cæ–‡ä»¶ä¼šå½¢æˆä¸€ä¸ª*.oæ–‡ä»¶ï¼Œä¸ºäº†æ»¡è¶³å‰é¢è¯´çš„ä¾èµ–å…³ç³»ï¼Œåˆ™éœ€è¦å°†è¿™äº›æºæ–‡ä»¶äº§ç”Ÿçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„ç¨‹åºã€‚è¿™ä¸ªé“¾æ¥çš„è¿‡ç¨‹å°±æ˜¯é™æ€é“¾æ¥ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:2:1","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"2. é™æ€é“¾æ¥çš„åŸç† ç”±å¾ˆå¤šç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥å½¢æˆçš„æ˜¯é™æ€åº“ï¼Œåä¹‹é™æ€åº“ä¹Ÿå¯ä»¥ç®€å•åœ°çœ‹æˆæ˜¯ä¸€ç»„ç›®æ ‡æ–‡ä»¶çš„é›†åˆï¼Œå³å¾ˆå¤šç›®æ ‡æ–‡ä»¶ç»è¿‡å‹ç¼©æ‰“åŒ…åå½¢æˆçš„ä¸€ä¸ªæ–‡ä»¶ã€‚ ä»¥ä¸‹é¢è¿™ä¸ªå›¾æ¥ç®€å•è¯´æ˜ä¸€ä¸‹ä»é™æ€é“¾æ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ï¼Œæ ¹æ®åœ¨æºæ–‡ä»¶ä¸­åŒ…å«çš„å¤´æ–‡ä»¶å’Œç¨‹åºä¸­ä½¿ç”¨åˆ°çš„åº“å‡½æ•°ï¼Œå¦‚stdio.hä¸­å®šä¹‰çš„printf()å‡½æ•°ï¼Œåœ¨libc.aä¸­æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶printf.o(è¿™é‡Œæš‚ä¸”ä¸è€ƒè™‘printf()å‡½æ•°çš„ä¾èµ–å…³ç³»)ï¼Œç„¶åå°†è¿™ä¸ªç›®æ ‡æ–‡ä»¶å’Œæˆ‘ä»¬hello.oè¿™ä¸ªæ–‡ä»¶è¿›è¡Œé“¾æ¥å½¢æˆæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ é“¾æ¥å™¨åœ¨é“¾æ¥é™æ€é“¾æ¥åº“çš„æ—¶å€™æ˜¯ä»¥ç›®æ ‡æ–‡ä»¶ä¸ºå•ä½çš„ã€‚æ¯”å¦‚æˆ‘ä»¬å¼•ç”¨äº†é™æ€åº“ä¸­çš„printf()å‡½æ•°ï¼Œé‚£ä¹ˆé“¾æ¥å™¨å°±ä¼šæŠŠåº“ä¸­åŒ…å«printf()å‡½æ•°çš„é‚£ä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥è¿›æ¥ï¼Œå¦‚æœå¾ˆå¤šå‡½æ•°éƒ½æ”¾åœ¨ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ä¸­ï¼Œå¾ˆå¯èƒ½å¾ˆå¤šæ²¡ç”¨çš„å‡½æ•°éƒ½è¢«ä¸€èµ·é“¾æ¥è¿›äº†è¾“å‡ºç»“æœä¸­ã€‚ç”±äºè¿è¡Œåº“æœ‰æˆç™¾ä¸Šåƒä¸ªå‡½æ•°ï¼Œæ•°é‡éå¸¸åºå¤§ï¼Œæ¯ä¸ªå‡½æ•°ç‹¬ç«‹åœ°æ”¾åœ¨ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ä¸­å¯ä»¥å°½é‡å‡å°‘ç©ºé—´çš„æµªè´¹ï¼Œé‚£äº›æ²¡æœ‰è¢«ç”¨åˆ°çš„ç›®æ ‡æ–‡ä»¶å°±ä¸è¦é“¾æ¥åˆ°æœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ä¸­ã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:2:2","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"3. é™æ€é“¾æ¥çš„ä¼˜ç¼ºç‚¹ é™æ€é“¾æ¥çš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œä¸€æ˜¯æµªè´¹ç©ºé—´ï¼Œå› ä¸ºæ¯ä¸ªå¯æ‰§è¡Œç¨‹åºä¸­å¯¹æ‰€æœ‰éœ€è¦çš„ç›®æ ‡æ–‡ä»¶éƒ½è¦æœ‰ä¸€ä»½å‰¯æœ¬ï¼Œæ‰€ä»¥å¦‚æœå¤šä¸ªç¨‹åºå¯¹åŒä¸€ä¸ªç›®æ ‡æ–‡ä»¶éƒ½æœ‰ä¾èµ–ï¼Œå¦‚å¤šä¸ªç¨‹åºä¸­éƒ½è°ƒç”¨äº†printf()å‡½æ•°ï¼Œåˆ™è¿™å¤šä¸ªç¨‹åºä¸­éƒ½å«æœ‰printf.oï¼Œæ‰€ä»¥åŒä¸€ä¸ªç›®æ ‡æ–‡ä»¶éƒ½åœ¨å†…å­˜å­˜åœ¨å¤šä¸ªå‰¯æœ¬ï¼›å¦ä¸€æ–¹é¢å°±æ˜¯æ›´æ–°æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºæ¯å½“åº“å‡½æ•°çš„ä»£ç ä¿®æ”¹äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦é‡æ–°è¿›è¡Œç¼–è¯‘é“¾æ¥å½¢æˆå¯æ‰§è¡Œç¨‹åºã€‚ä½†æ˜¯é™æ€é“¾æ¥çš„ä¼˜ç‚¹å°±æ˜¯ï¼Œåœ¨å¯æ‰§è¡Œç¨‹åºä¸­å·²ç»å…·å¤‡äº†æ‰€æœ‰æ‰§è¡Œç¨‹åºæ‰€éœ€è¦çš„ä»»ä½•ä¸œè¥¿ï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™è¿è¡Œé€Ÿåº¦å¿«ã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:2:3","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"åŠ¨æ€é“¾æ¥ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:3:0","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"1. ä¸ºä»€ä¹ˆè¿›è¡ŒåŠ¨æ€é“¾æ¥ åŠ¨æ€é“¾æ¥å‡ºç°çš„åŸå› å°±æ˜¯ä¸ºäº†è§£å†³é™æ€é“¾æ¥ä¸­æåˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ–¹é¢æ˜¯ç©ºé—´æµªè´¹ï¼Œå¦å¤–ä¸€æ–¹é¢æ˜¯æ›´æ–°å›°éš¾ã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:3:1","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"2. åŠ¨æ€é“¾æ¥çš„åŸç† åŠ¨æ€é“¾æ¥çš„åŸºæœ¬æ€æƒ³æ˜¯æŠŠç¨‹åºæŒ‰ç…§æ¨¡å—æ‹†åˆ†æˆå„ä¸ªç›¸å¯¹ç‹¬ç«‹éƒ¨åˆ†ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å°†å®ƒä»¬é“¾æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ç¨‹åºï¼Œè€Œä¸æ˜¯åƒé™æ€é“¾æ¥ä¸€æ ·æŠŠæ‰€æœ‰ç¨‹åºæ¨¡å—éƒ½é“¾æ¥æˆä¸€ä¸ªå•ç‹¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸‹é¢ç®€å•ä»‹ç»åŠ¨æ€é“¾æ¥çš„è¿‡ç¨‹ï¼š å‡è®¾ç°åœ¨æœ‰ä¸¤ä¸ªç¨‹åºprogram1.oå’Œprogram2.oï¼Œè¿™ä¸¤è€…å…±ç”¨åŒä¸€ä¸ªåº“lib.o,å‡è®¾é¦–å…ˆè¿è¡Œç¨‹åºprogram1ï¼Œç³»ç»Ÿé¦–å…ˆåŠ è½½program1.oï¼Œå½“ç³»ç»Ÿå‘ç°program1.oä¸­ç”¨åˆ°äº†lib.oï¼Œå³program1.oä¾èµ–äºlib.oï¼Œé‚£ä¹ˆç³»ç»Ÿæ¥ç€åŠ è½½lib.oï¼Œå¦‚æœprogram1.oå’Œlib.oè¿˜ä¾èµ–äºå…¶ä»–ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ä¾æ¬¡å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å½“program2è¿è¡Œæ—¶ï¼ŒåŒæ ·çš„åŠ è½½program2.oï¼Œç„¶åå‘ç°program2.oä¾èµ–äºlib.oï¼Œä½†æ˜¯æ­¤æ—¶lib.oå·²ç»å­˜åœ¨äºå†…å­˜ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸å†è¿›è¡Œé‡æ–°åŠ è½½ï¼Œè€Œæ˜¯å°†å†…å­˜ä¸­å·²ç»å­˜åœ¨çš„lib.oæ˜ å°„åˆ°program2çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼Œä»è€Œè¿›è¡Œé“¾æ¥ï¼ˆè¿™ä¸ªé“¾æ¥è¿‡ç¨‹å’Œé™æ€é“¾æ¥ç±»ä¼¼ï¼‰å½¢æˆå¯æ‰§è¡Œç¨‹åºã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:3:2","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"3. åŠ¨æ€é“¾æ¥çš„ä¼˜ç¼ºç‚¹ åŠ¨æ€é“¾æ¥çš„ä¼˜ç‚¹æ˜¾è€Œæ˜“è§ï¼Œå°±æ˜¯å³ä½¿éœ€è¦æ¯ä¸ªç¨‹åºéƒ½ä¾èµ–åŒä¸€ä¸ªåº“ï¼Œä½†æ˜¯è¯¥åº“ä¸ä¼šåƒé™æ€é“¾æ¥é‚£æ ·åœ¨å†…å­˜ä¸­å­˜åœ¨å¤šåˆ†ï¼Œå‰¯æœ¬ï¼Œè€Œæ˜¯è¿™å¤šä¸ªç¨‹åºåœ¨æ‰§è¡Œæ—¶å…±äº«åŒä¸€ä»½å‰¯æœ¬ï¼›å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œæ›´æ–°ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œæ›´æ–°æ—¶åªéœ€è¦æ›¿æ¢åŸæ¥çš„ç›®æ ‡æ–‡ä»¶ï¼Œè€Œæ— éœ€å°†æ‰€æœ‰çš„ç¨‹åºå†é‡æ–°é“¾æ¥ä¸€éã€‚å½“ç¨‹åºä¸‹ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œæ–°ç‰ˆæœ¬çš„ç›®æ ‡æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨åŠ è½½åˆ°å†…å­˜å¹¶ä¸”é“¾æ¥èµ·æ¥ï¼Œç¨‹åºå°±å®Œæˆäº†å‡çº§çš„ç›®æ ‡ã€‚ä½†æ˜¯åŠ¨æ€é“¾æ¥ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œå› ä¸ºæŠŠé“¾æ¥æ¨è¿Ÿåˆ°äº†ç¨‹åºè¿è¡Œæ—¶ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰§è¡Œç¨‹åºéƒ½éœ€è¦è¿›è¡Œé“¾æ¥ï¼Œæ‰€ä»¥æ€§èƒ½ä¼šæœ‰ä¸€å®šæŸå¤±ã€‚ â€‹ æ®ä¼°ç®—ï¼ŒåŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥ç›¸æ¯”ï¼Œæ€§èƒ½æŸå¤±å¤§çº¦åœ¨5%ä»¥ä¸‹ã€‚ç»è¿‡å®è·µè¯æ˜ï¼Œè¿™ç‚¹æ€§èƒ½æŸå¤±ç”¨æ¥æ¢åŒºç¨‹åºåœ¨ç©ºé—´ä¸Šçš„èŠ‚çœå’Œç¨‹åºæ„å»ºå’Œå‡çº§æ—¶çš„çµæ´»æ€§æ˜¯å€¼å¾—çš„ã€‚ ","date":"2019-01-25","objectID":"/20190125_dynamic-static-link-library/:3:3","tags":["C","C++"],"title":"Dynamic link library and static link library","uri":"/20190125_dynamic-static-link-library/"},{"categories":["Technology"],"content":"read binary file to char *bytes in c.","date":"2018-12-20","objectID":"/20181220_read-binary-file/","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"Read the binary file (any file will do; this article uses binary as an example) and read the entire contents of the binary file into a char* string. With fseek() and fread() functions to achieve file reading advanced methods. éœ€æ±‚ ä½¿ç”¨fwrite(dbdata, dblength, 1,fp)æŠŠå­—èŠ‚æµå†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åœ¨æ–°ç¨‹åºè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶é‡åˆ°é—®é¢˜ï¼šäºŒè¿›åˆ¶å†…å®¹ä¸èƒ½å‘æ–‡æœ¬ä¸€æ ·è¡Œè¯»å–ï¼Œä¹Ÿä¸çŸ¥é“äºŒè¿›åˆ¶æ–‡ä»¶é•¿åº¦ï¼Œåœ¨fread()å‡½æ•°ä¸­æ— ä»ä¸‹æ‰‹ã€‚ ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:0:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"1.creat FILE pointer and set mode as â€˜rbâ€™ FILE *f = fopen(inputFN, \"rb\"); ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:1:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"2.check the FILE pointer is not null if (!f) { fprintf(stderr, \"ERROR: unable to open file \\\"%s\\\": %s\\n\", inputFN,strerror(errno)); return NULL; } ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:2:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"3.use fseek/ftell to get data length fseek(f,0,SEEK_END) put the pointer to the end of the file. ftell(f) can get the current offset. then use fseek(f,0,SEEK_SET) put the pointer to the start of file. if (fseek(f, 0, SEEK_END) != 0) { fprintf(stderr, \"ERROR: unable to seek file \\\"%s\\\": %s\\n\", inputFN, strerror(errno)); fclose(f); return NULL; } long datalen = ftell(f); if (dataLen \u003c 0) { fprintf(stderr, \"ERROR: ftell() failed: %s\\n\", strerror(errno)); fclose(f); return NULL; } if (fseek(f, 0, SEEK_SET) != 0) { fprintf(stderr, \"ERROR: unable to seek file \\\"%s\\\": %s\\n\", inputFN, strerror(errno)); fclose(f); return NULL; } ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:3:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"4.check the datalen if ((unsigned long)dataLen \u003e UINT_MAX) { dataLen = UINT_MAX; printf(\"WARNING: clipping data to %ld bytes\\n\", dataLen); } else if (dataLen == 0) { fprintf(stderr, \"ERROR: input file \\\"%s\\\" is empty\\n\", inputFN); fclose(f); return NULL; } ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:4:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"5.malloc memory to char *inputData char *inputData = static_cast\u003cchar *\u003e(malloc(dataLen)); if (!inputData) { fprintf(stderr, \"ERROR: unable to malloc %ld bytes\\n\", dataLen); fclose(f); return NULL; } ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:5:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"6.read the bin data // create a pointer p to point the begin of the inputData char *p = inputData; // create a bytesLeft to record the moving of offset size_t bytesLeft = dataLen; while (bytesLeft) { //fread will return the bytes of read size_t bytesRead = fread(p, 1, bytesLeft, f); bytesLeft -= bytesRead; p += bytesRead; if (ferror(f) != 0) { fprintf(stderr, \"ERROR: fread() failed\\n\"); free(inputData); fclose(f); return NULL; } } ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:6:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"7.close the File stream fclose(f); ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:7:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"8.return length \u0026 inputData //change the parameter of \u0026length *length = (unsigned int)dataLen; return inputData; ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:8:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"9.å®Œæ•´ä»£ç  FILE *f = fopen(inputFN, \"rb\"); if (!f) { fprintf(stderr, \"ERROR: unable to open file \\\"%s\\\": %s\\n\", inputFN,strerror(errno)); return NULL; } if (fseek(f, 0, SEEK_END) != 0) { fprintf(stderr, \"ERROR: unable to seek file \\\"%s\\\": %s\\n\", inputFN, strerror(errno)); fclose(f); return NULL; } long dataLen = ftell(f); if (dataLen \u003c 0) { fprintf(stderr, \"ERROR: ftell() failed: %s\\n\", strerror(errno)); fclose(f); return NULL; } if (fseek(f, 0, SEEK_SET) != 0) { fprintf(stderr, \"ERROR: unable to seek file \\\"%s\\\": %s\\n\", inputFN, strerror(errno)); fclose(f); return NULL; } if ((unsigned long)dataLen \u003e UINT_MAX) { dataLen = UINT_MAX; printf(\"WARNING: clipping data to %ld bytes\\n\", dataLen); } else if (dataLen == 0) { fprintf(stderr, \"ERROR: input file \\\"%s\\\" is empty\\n\", inputFN); fclose(f); return NULL; } char *inputData = static_cast\u003cchar *\u003e(malloc(dataLen)); if (!inputData) { fprintf(stderr, \"ERROR: unable to malloc %ld bytes\\n\", dataLen); fclose(f); return NULL; } char *p = inputData; size_t bytesLeft = dataLen; while (bytesLeft) { size_t bytesRead = fread(p, 1, bytesLeft, f); bytesLeft -= bytesRead; p += bytesRead; if (ferror(f) != 0) { fprintf(stderr, \"ERROR: fread() failed\\n\"); free(inputData); fclose(f); return NULL; } } fclose(f); *length = (unsigned int)dataLen; ","date":"2018-12-20","objectID":"/20181220_read-binary-file/:9:0","tags":["C","File"],"title":"The Advanced method of reading files","uri":"/20181220_read-binary-file/"},{"categories":["Technology"],"content":"Article description.","date":"2018-11-18","objectID":"/20181118_sqlcipher/","tags":["SQL","C"],"title":"SQLcipher Guide","uri":"/20181118_sqlcipher/"},{"categories":["Technology"],"content":"SQLCipher is based on SQLite, and thus, the majority of the accessible API is identical to the C/C++ interface for SQLite 3. However, SQLCipher does add a number of security specific extensions in the form of PRAGMAs, SQL Functions and C Functions. ","date":"2018-11-18","objectID":"/20181118_sqlcipher/:0:0","tags":["SQL","C"],"title":"SQLcipher Guide","uri":"/20181118_sqlcipher/"},{"categories":["Technology"],"content":"1. Build SQLcipher from source $ git clone https://github.com/sqlcipher/sqlcipher.git $ cd sqlcipher $ ./configure â€“enable-tempstore=yes CFLAGS=\"-DSQLITE_HAS_CODEC -DSQLITE_TEMP_STORE=2\" LDFLAGS=\"-lcrypto\" $ make $ make install #if you want to do a system wide install of SQLCipher Mark the output of make install, especially the following lines: libtool: install: /usr/bin/install -c .libs/libsqlcipher.a /usr/local/lib/libsqlcipher.a /usr/bin/install -c -m 0644 sqlite3.h /usr/local/include/sqlcipher these are the folders of SQLcipher headers and the library necessary when building proper C project. ","date":"2018-11-18","objectID":"/20181118_sqlcipher/:1:0","tags":["SQL","C"],"title":"SQLcipher Guide","uri":"/20181118_sqlcipher/"},{"categories":["Technology"],"content":"2. Building minimal C project example In SQLite_example.c put the following lines: #include \"sqlite3.h\" //We want to SQLCipher extension, rather then a system wide SQLite header rc = sqlite3_open(\"test.db\",\u0026db); //open SQLite database test.db rc = sqlite3_key(db,\"1q2w3e4r\",8); //apply encryption to previously opened database Build you example: $gcc SQLite_example.c -o SQLtest -I /path/to/local/folder/with/sqlcipher/header/files/ -L /path/to/local/folder/with/sqlcipher/library.a -l sqlcipher e.g. with paths extracted from the output of $make install $gcc SQLite_example.c -o SQLtest -I /usr/local/include/sqlcipher -L /usr/local/lib/libsqlcipher.a -lsqlcipher Finally, make sure that your SQLCipher library is in the system wide library path e.g. for (Arch)Linux: $ export LD_LIBRARY_PATH=/usr/local/lib/ Run your test code ((Arch)Linux): $ ./SQLtest ","date":"2018-11-18","objectID":"/20181118_sqlcipher/:2:0","tags":["SQL","C"],"title":"SQLcipher Guide","uri":"/20181118_sqlcipher/"},{"categories":["Technology"],"content":"Article description.","date":"2018-10-17","objectID":"/20181017_sql-introduction/","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"In computer programming, create, read, update, and delete (CRUD) are the four basic functions of persistent storage. Alternate words are sometimes used when defining the four basic functions of CRUD, such as retrieve instead of read, modify instead of update, or destroy instead of delete. CRUD is also sometimes used to describe user interface conventions that facilitate viewing, searching, and changing information, often using computer-based forms and reports. ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:0","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"1. æŸ¥è¯¢è¯­å¥ select â€¦ from â€¦ where â€¦ group by â€¦ having â€¦ order by â€¦ limit â€¦ æ¬¡åº 4 1 2 3 5 6 7 ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:1","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"2. Group by GROUP BY è¯­å¥ç”¨äºç»“åˆèšåˆå‡½æ•°ï¼Œæ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„ã€‚ å®ä¾‹ï¼š mysql\u003e SELECT * FROM access_log; +-----+---------+-------+------------+ | aid | site_id | count | date | +-----+---------+-------+------------+ | 1 | 1 | 45 | 2016-05-10 | | 2 | 3 | 100 | 2016-05-13 | | 3 | 1 | 230 | 2016-05-14 | | 4 | 2 | 10 | 2016-05-14 | | 5 | 5 | 205 | 2016-05-14 | | 6 | 4 | 13 | 2016-05-15 | | 7 | 3 | 220 | 2016-05-15 | | 8 | 5 | 545 | 2016-05-16 | | 9 | 3 | 201 | 2016-05-17 | +-----+---------+-------+------------+ 9 rows in set (0.00 sec) SELECT site_id, SUM(access_log.count) AS nums FROM access_log GROUP BY site_id; +---------+------+ | site_id | nums | +---------+------+ | 1 | 275 | | 2 | 10 | | 3 | 521 | | 4 | 13 | | 5 | 750 | +---------+------+ ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:2","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"3. èšé›†å‡½æ•° 1 2 3 4 5 6 count sum max min avg group_concat ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:3","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"4. Having HAVING å­å¥å¯ä»¥è®©æˆ‘ä»¬ç­›é€‰åˆ†ç»„åçš„å„ç»„æ•°æ®ã€‚ æŸ¥è¯¢æ¯ä¸ªç­ä¸­äººæ•°å¤§äº2çš„ç­çº§å·ï¼š select count(1) as n, classid from stu group by classid having n\u003e2; or select classid from stu group by classid having count(1)\u003e2; ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:4","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"5. Order by ... order by n, classid; 1.å…ˆæŒ‰næ’åº 2.åœ¨ä¸æ”¹næ’åºçš„æƒ…å†µä¸‹æ’classid ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:5","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"6. Limit ... limit 1, 10; # æ£€ç´¢è®°å½•è¡Œ 2-10 ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:6","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"7. Join stu join class on classid = class.id # join ä¼šæŠŠå·¦è¡¨çš„æ¯ä¸€è¡Œåˆ†åˆ«ä¸å³è¡¨æ¯ä¸€è¡Œæ‹¼æ¥ # on åšç­›é€‰ ","date":"2018-10-17","objectID":"/20181017_sql-introduction/:0:7","tags":["SQL"],"title":"SQL Introduction","uri":"/20181017_sql-introduction/"},{"categories":["Technology"],"content":"Article description.","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Makefiles define a set of rules that specify which files need to be compiled first, which files need to be compiled later, which files need to be recompiled, and even more complex functional operations, because makefiles are like Shell scripts that also execute operating system commands. One of the benefits of Makefiles is that they are â€œautomatically compiledâ€. The entire project is automatically compiled, greatly improving the efficiency of software development. ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:0:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"å…³äºç¨‹åºçš„ç¼–è¯‘å’Œé“¾æ¥ æ— è®ºæ˜¯Cè¿˜æ˜¯C++ï¼Œé¦–å…ˆè¦æŠŠæºæ–‡ä»¶ç¼–è¯‘æˆä¸­é—´ä»£ç æ–‡ä»¶ï¼Œåœ¨Windowsä¸‹ä¹Ÿå°±æ˜¯ .obj æ–‡ä»¶ï¼ŒUNIXä¸‹æ˜¯ .o æ–‡ä»¶ï¼Œå³ Object Fileï¼Œè¿™ä¸ªåŠ¨ä½œå«åšç¼–è¯‘ï¼ˆcompileï¼‰ã€‚ç„¶åå†æŠŠå¤§é‡çš„Object Fileåˆæˆæ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸ªåŠ¨ä½œå«ä½œé“¾æ¥ï¼ˆlinkï¼‰ã€‚ ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨éœ€è¦çš„æ˜¯è¯­æ³•çš„æ­£ç¡®ï¼Œå‡½æ•°ä¸å˜é‡çš„å£°æ˜çš„æ­£ç¡®ã€‚å¯¹äºåè€…ï¼Œé€šå¸¸éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨å¤´æ–‡ä»¶çš„æ‰€åœ¨ä½ç½®ï¼ˆå¤´æ–‡ä»¶ä¸­åº”è¯¥åªæ˜¯å£°æ˜ï¼Œè€Œå®šä¹‰åº”è¯¥æ”¾åœ¨C/C++æ–‡ä»¶ä¸­ï¼‰ï¼Œåªè¦æ‰€æœ‰çš„è¯­æ³•æ­£ç¡®ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥ç¼–è¯‘å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæºæ–‡ä»¶éƒ½åº”è¯¥å¯¹åº”äºä¸€ä¸ªä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–æ˜¯OBJæ–‡ä»¶ï¼‰ã€‚ é“¾æ¥æ—¶ï¼Œä¸»è¦æ˜¯é“¾æ¥å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–æ˜¯OBJæ–‡ä»¶ï¼‰æ¥é“¾æ¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚é“¾æ¥å™¨å¹¶ä¸ç®¡å‡½æ•°æ‰€åœ¨çš„æºæ–‡ä»¶ï¼Œåªç®¡å‡½æ•°çš„ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆObject Fileï¼‰ï¼Œåœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œç”±äºæºæ–‡ä»¶å¤ªå¤šï¼Œç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´ç›®æ ‡æ–‡ä»¶å¤ªå¤šï¼Œè€Œåœ¨é“¾æ¥æ—¶éœ€è¦æ˜æ˜¾åœ°æŒ‡å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶åï¼Œè¿™å¯¹äºç¼–è¯‘å¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ç»™ä¸­é—´ç›®æ ‡æ–‡ä»¶æ‰“ä¸ªåŒ…ï¼Œåœ¨Windowsä¸‹è¿™ç§åŒ…å«â€œåº“æ–‡ä»¶â€ï¼ˆLibrary File)ï¼Œä¹Ÿå°±æ˜¯ .lib æ–‡ä»¶ï¼Œåœ¨UNIXä¸‹ï¼Œæ˜¯Archive Fileï¼Œä¹Ÿå°±æ˜¯ .a æ–‡ä»¶ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œæºæ–‡ä»¶é¦–å…ˆä¼šç”Ÿæˆä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼Œå†ç”±ä¸­é—´ç›®æ ‡æ–‡ä»¶ç”Ÿæˆæ‰§è¡Œæ–‡ä»¶ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨åªæ£€æµ‹ç¨‹åºè¯­æ³•ï¼Œå’Œå‡½æ•°ã€å˜é‡æ˜¯å¦è¢«å£°æ˜ã€‚å¦‚æœå‡½æ•°æœªè¢«å£°æ˜ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œä½†å¯ä»¥ç”ŸæˆObject Fileã€‚è€Œåœ¨é“¾æ¥ç¨‹åºæ—¶ï¼Œé“¾æ¥å™¨ä¼šåœ¨æ‰€æœ‰çš„Object Fileä¸­æ‰¾å¯»å‡½æ•°çš„å®ç°ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£åˆ°å°±ä¼šæŠ¥é“¾æ¥é”™è¯¯ç ï¼ˆLinker Errorï¼‰ï¼Œåœ¨VCä¸‹ï¼Œè¿™ç§é”™è¯¯ä¸€èˆ¬æ˜¯ï¼šLink 2001é”™è¯¯ï¼Œæ„æ€è¯´æ˜¯è¯´ï¼Œé“¾æ¥å™¨æœªèƒ½æ‰¾åˆ°å‡½æ•°çš„å®ç°ã€‚éœ€è¦æŒ‡å®šå‡½æ•°çš„ObjectFile. ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:1:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Makefile ä»‹ç» makeå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œéœ€è¦ä¸€ä¸ª Makefile æ–‡ä»¶ï¼Œä»¥å‘Šè¯‰makeå‘½ä»¤éœ€è¦æ€ä¹ˆæ ·çš„å»ç¼–è¯‘å’Œé“¾æ¥ç¨‹åºã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜Makefileçš„ä¹¦å†™è§„åˆ™ã€‚ä»¥ä¾¿ç»™å¤§å®¶ä¸€ä¸ªæ„Ÿå…´è®¤è¯†ã€‚è¿™ä¸ªç¤ºä¾‹æ¥æºäºGNUçš„makeä½¿ç”¨æ‰‹å†Œï¼Œåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹æœ‰8ä¸ªCæ–‡ä»¶ï¼Œå’Œ3ä¸ªå¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦å†™ä¸€ä¸ªMakefileæ¥å‘Šè¯‰makeå‘½ä»¤å¦‚ä½•ç¼–è¯‘å’Œé“¾æ¥è¿™å‡ ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬çš„è§„åˆ™æ˜¯ï¼š å¦‚æœè¿™ä¸ªå·¥ç¨‹æ²¡æœ‰ç¼–è¯‘è¿‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ‰€æœ‰Cæ–‡ä»¶éƒ½è¦ç¼–è¯‘å¹¶è¢«é“¾æ¥ã€‚ å¦‚æœè¿™ä¸ªå·¥ç¨‹çš„æŸå‡ ä¸ªCæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªç¼–è¯‘è¢«ä¿®æ”¹çš„Cæ–‡ä»¶ï¼Œå¹¶é“¾æ¥ç›®æ ‡ç¨‹åºã€‚ å¦‚æœè¿™ä¸ªå·¥ç¨‹çš„å¤´æ–‡ä»¶è¢«æ”¹å˜äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç¼–è¯‘å¼•ç”¨äº†è¿™å‡ ä¸ªå¤´æ–‡ä»¶çš„Cæ–‡ä»¶ï¼Œå¹¶é“¾æ¥ç›®æ ‡ç¨‹åºã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"1. Makefile è§„åˆ™ target... : prerequisites ... command ... targetä¹Ÿå°±æ˜¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯Object Fileï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ˆLabelï¼‰ prerequisiteså°±æ˜¯ï¼Œè¦ç”Ÿæˆé‚£ä¸ªtargetæ‰€éœ€çš„æ–‡ä»¶æˆ–æ˜¯ç›®æ ‡ã€‚ commandä¹Ÿå°±æ˜¯makeéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚(ä»»æ„çš„shellå‘½ä»¤) è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œtargetè¿™ä¸€ä¸ªæˆ–å¤šä¸ªçš„ç›®æ ‡æ–‡ä»¶ä¾èµ–äºprerequisitesä¸­çš„æ–‡ä»¶ï¼Œå…¶ç”Ÿæˆè§„åˆ™å®šä¹‰åœ¨commandä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œprerequisitesä¸­å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æ¯”targetæ–‡ä»¶è¦æ–°çš„è¯ï¼Œcommandæ‰€å®šä¹‰çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:1","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"2. $@, $^, $\u003c å«ä¹‰ $@â€“ç›®æ ‡æ–‡ä»¶ $^â€“æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶ $\u003câ€“ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶ ä¸€ä¸ªç¤ºä¾‹ å¦‚æœä¸€ä¸ªå·¥ç¨‹æœ‰3ä¸ªå¤´æ–‡ä»¶ï¼Œå’Œ8ä¸ªCæ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸ºäº†å®Œæˆå‰é¢æ‰€è¿°çš„é‚£ä¸‰ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬çš„Makefileåº”è¯¥æ˜¯ä¸‹é¢çš„è¿™ä¸ªæ ·å­çš„ã€‚ edit : main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o cc -o edit main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o main.o : main.c defs.h cc -c main.c kbd.o : kbd.c defs.h command.h cc -c kbd.c command.o : command.c defs.h command.h cc -c command.c display.o : display.c defs.h buffer.h cc -c display.c insert.o : insert.c defs.h buffer.h cc -c insert.c search.o : search.c defs.h buffer.h cc -c search.c files.o : files.c defs.h buffer.h command.h cc -c files.c utils.o : utils.c defs.h cc -c utils.c clean : rm edit main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o åæ–œæ ï¼ˆ\\ï¼‰æ˜¯æ¢è¡Œç¬¦çš„æ„æ€ã€‚è¿™æ ·æ¯”è¾ƒä¾¿äºMakefileçš„æ˜“è¯»ã€‚ åœ¨è¿™ä¸ªmakefileä¸­ï¼Œç›®æ ‡æ–‡ä»¶ï¼ˆtargetï¼‰åŒ…å«ï¼šæ‰§è¡Œæ–‡ä»¶editå’Œä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆ*.oï¼‰ï¼Œä¾èµ–æ–‡ä»¶ï¼ˆprerequisitesï¼‰å°±æ˜¯å†’å·åé¢çš„é‚£äº› .c æ–‡ä»¶å’Œ .hæ–‡ä»¶ã€‚æ¯ä¸€ä¸ª .o æ–‡ä»¶éƒ½æœ‰ä¸€ç»„ä¾èµ–æ–‡ä»¶ï¼Œè€Œè¿™äº› .o æ–‡ä»¶åˆæ˜¯æ‰§è¡Œæ–‡ä»¶ edit çš„ä¾èµ–æ–‡ä»¶ã€‚ä¾èµ–å…³ç³»çš„å®è´¨ä¸Šå°±æ˜¯è¯´æ˜äº†ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å“ªäº›æ–‡ä»¶ç”Ÿæˆçš„ï¼Œæ¢è¨€ä¹‹ï¼Œç›®æ ‡æ–‡ä»¶æ˜¯å“ªäº›æ–‡ä»¶æ›´æ–°çš„ã€‚ åœ¨å®šä¹‰å¥½ä¾èµ–å…³ç³»åï¼Œåç»­çš„é‚£ä¸€è¡Œå®šä¹‰äº†å¦‚ä½•ç”Ÿæˆç›®æ ‡æ–‡ä»¶çš„æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼Œä¸€å®šè¦ä»¥ä¸€ä¸ªTabé”®ä½œä¸ºå¼€å¤´ã€‚è®°ä½ï¼Œmakeå¹¶ä¸ç®¡å‘½ä»¤æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œä»–åªç®¡æ‰§è¡Œæ‰€å®šä¹‰çš„å‘½ä»¤ã€‚makeä¼šæ¯”è¾ƒtargetsæ–‡ä»¶å’Œprerequisitesæ–‡ä»¶çš„ä¿®æ”¹æ—¥æœŸï¼Œå¦‚æœprerequisitesæ–‡ä»¶çš„æ—¥æœŸè¦æ¯”targetsæ–‡ä»¶çš„æ—¥æœŸè¦æ–°ï¼Œæˆ–è€…targetä¸å­˜åœ¨çš„è¯ï¼Œé‚£ä¹ˆï¼Œmakeå°±ä¼šæ‰§è¡Œåç»­å®šä¹‰çš„å‘½ä»¤ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:2","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"3. makeæ˜¯å¦‚ä½•å·¥ä½œçš„ åœ¨é»˜è®¤çš„æ–¹å¼ä¸‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªè¾“å…¥makeå‘½ä»¤ã€‚é‚£ä¹ˆï¼Œ makeä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰¾åå­—å«â€œMakefileâ€æˆ–â€œmakefileâ€çš„æ–‡ä»¶ã€‚ å¦‚æœæ‰¾åˆ°ï¼Œå®ƒä¼šæ‰¾æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼ˆtargetï¼‰ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä»–ä¼šæ‰¾åˆ°â€œeditâ€è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æŠŠè¿™ä¸ªæ–‡ä»¶ä½œä¸ºæœ€ç»ˆçš„ç›®æ ‡æ–‡ä»¶ã€‚ å¦‚æœeditæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–æ˜¯editæ‰€ä¾èµ–çš„åé¢çš„ .o æ–‡ä»¶çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´è¦æ¯”editè¿™ä¸ªæ–‡ä»¶æ–°ï¼Œé‚£ä¹ˆï¼Œä»–å°±ä¼šæ‰§è¡Œåé¢æ‰€å®šä¹‰çš„å‘½ä»¤æ¥ç”Ÿæˆeditè¿™ä¸ªæ–‡ä»¶ã€‚ å¦‚æœeditæ‰€ä¾èµ–çš„.oæ–‡ä»¶ä¹Ÿå­˜åœ¨ï¼Œé‚£ä¹ˆmakeä¼šåœ¨å½“å‰æ–‡ä»¶ä¸­æ‰¾ç›®æ ‡ä¸º.oæ–‡ä»¶çš„ä¾èµ–æ€§ï¼Œå¦‚æœæ‰¾åˆ°åˆ™å†æ ¹æ®é‚£ä¸€ä¸ªè§„åˆ™ç”Ÿæˆ.oæ–‡ä»¶ã€‚ å½“ç„¶ï¼ŒCæ–‡ä»¶å’ŒHæ–‡ä»¶æ˜¯å­˜åœ¨çš„å•¦ï¼Œäºæ˜¯makeä¼šç”Ÿæˆ .o æ–‡ä»¶ï¼Œç„¶åå†ç”¨ .o æ–‡ä»¶å£°æ˜makeçš„ç»ˆæä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ–‡ä»¶editäº†ã€‚ è¿™å°±æ˜¯æ•´ä¸ªmakeçš„ä¾èµ–æ€§ï¼Œmakeä¼šä¸€å±‚åˆä¸€å±‚åœ°å»æ‰¾æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œç›´åˆ°æœ€ç»ˆç¼–è¯‘å‡ºç¬¬ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ã€‚åœ¨æ‰¾å¯»çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚æœ€åè¢«ä¾èµ–çš„æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆmakeå°±ä¼šç›´æ¥é€€å‡ºï¼Œå¹¶æŠ¥é”™ï¼Œè€Œå¯¹äºæ‰€å®šä¹‰çš„å‘½ä»¤çš„é”™è¯¯ï¼Œæˆ–æ˜¯ç¼–è¯‘ä¸æˆåŠŸï¼Œmakeæ ¹æœ¬ä¸ç†ã€‚makeåªç®¡æ–‡ä»¶çš„ä¾èµ–æ€§ äºæ˜¯åœ¨æˆ‘ä»¬ç¼–ç¨‹ä¸­ï¼Œå¦‚æœè¿™ä¸ªå·¥ç¨‹å·²è¢«ç¼–è¯‘è¿‡äº†ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†å…¶ä¸­ä¸€ä¸ªæºæ–‡ä»¶ï¼Œæ¯”å¦‚file.cï¼Œé‚£ä¹ˆæ ¹æ®æˆ‘ä»¬çš„ä¾èµ–æ€§ï¼Œæˆ‘ä»¬çš„ç›®æ ‡file.oä¼šè¢«é‡ç¼–è¯‘ï¼ˆä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªä¾æ€§å…³ç³»åé¢æ‰€å®šä¹‰çš„å‘½ä»¤ï¼‰ï¼Œäºæ˜¯file.oçš„æ–‡ä»¶ä¹Ÿæ˜¯æœ€æ–°çš„å•¦ï¼Œäºæ˜¯file.oçš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´è¦æ¯”editè¦æ–°ï¼Œæ‰€ä»¥editä¹Ÿä¼šè¢«é‡æ–°é“¾æ¥äº†ï¼ˆè¯¦è§editç›®æ ‡æ–‡ä»¶åå®šä¹‰çš„å‘½ä»¤ï¼‰ã€‚ è€Œå¦‚æœæˆ‘ä»¬æ”¹å˜äº†â€œcommand.hâ€ï¼Œé‚£ä¹ˆï¼Œkdb.oã€command.oå’Œfiles.oéƒ½ä¼šè¢«é‡ç¼–è¯‘ï¼Œå¹¶ä¸”ï¼Œeditä¼šè¢«é‡é“¾æ¥ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:3","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"4. makefileä¸­ä½¿ç”¨å˜é‡ ä»¥editçš„è§„åˆ™ä¸ºä¾‹ï¼š edit:main.o kbd.o command.o display.o \\ insert.o search.o files.o utills.o cc -o edit main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o çœ‹åˆ°[.o]æ–‡ä»¶çš„å­—ç¬¦ä¸²è¢«é‡å¤äº†ä¸¤æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬çš„å·¥ç¨‹éœ€è¦åŠ å…¥æ–°çš„[.o]æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦åœ¨ä¸¤ä¸ªåœ°æ–¹åŠ ã€‚å› ä¸ºæ­¤æ—¶çš„makefileå¹¶ä¸å¤æ‚ã€‚å½“makefileå˜å¾—å¤æ‚æˆ‘ä»¬å°±æœ‰å¯èƒ½å¿˜æ‰æŸä¸ªåœ°æ–¹ï¼Œè€Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚æ‰€ä»¥ä¸ºäº†makefileçš„æ˜“ç»´æŠ¤ï¼Œåœ¨makefileä¸­å¯ä»¥ä½¿ç”¨å˜é‡ã€‚ æ¯”å¦‚æˆ‘ä»¬å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œobjects, OBJECTS,objs,OBJS,æˆ–OBJï¼Œè¡¨ç¤ºobjæ–‡ä»¶ã€‚åœ¨makefileä¸€å¼€å§‹å°±å®šä¹‰ objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o äºæ˜¯ï¼Œå°±å¯ä»¥æ–¹ä¾¿çš„åœ¨makefileä¸­ä»¥\"$(objects)â€œçš„æ–¹å¼æ¥ä½¿ç”¨è¿™ä¸ªå˜é‡äº†ã€‚æ”¹è‰¯åçš„makefileå¦‚ä¸‹ï¼š objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $(objects) cc -o edit $(objects) main.o : main.c defs.h cc -c main.c command.o : command.c defs.h command.h cc -c command.c display.o : display.c defs.h buffer.h cc -c display.c insert.o : insert.c defs.h buffer.h cc -c insert.c search.o : search.c defs.h buffer.h cc -c search.c files.o : files.c defs.h buffer.h command.h cc -c files.c utils.o : utils.c defs.h cc -c utils.c clean : rm edit $(objects) äºæ˜¯å¦‚æœæœ‰æ–°çš„ .o æ–‡ä»¶åŠ å…¥ï¼Œåªéœ€ä¿®æ”¹ä¸€ä¸‹ objects å˜é‡å°±å¯ä»¥äº†ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:4","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"5. makeè‡ªåŠ¨æ¨å¯¼ GNUçš„makeå¾ˆå¼ºå¤§ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æ¨å¯¼æ–‡ä»¶ä»¥åŠæ–‡ä»¶ä¾èµ–å…³ç³»åé¢çš„å‘½ä»¤ï¼Œäºæ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦åœ¨æ¯ä¸ª[.o]æ–‡ä»¶å†™ä¸Šä¾èµ–å…³ç³»ã€‚makeä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œå¹¶è‡ªå·±æ¨å¯¼å‘½ä»¤ã€‚ åªè¦makeæ‰¾åˆ°ä¸€ä¸ª[.o]æ–‡ä»¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨çš„æŠŠ[.c]æ–‡ä»¶åŠ åœ¨ä¾èµ–å…³ç³»ä¸­ï¼Œå¦‚æœmakeæ‰¾åˆ°ä¸€ä¸ªwhatever.oï¼Œé‚£ä¹ˆwhatever.cç­‰whatever.oçš„ä¾èµ–æ–‡ä»¶ï¼Œå¹¶ä¸”cc -c whatever.cä¹Ÿä¼šè¢«æ¨å¯¼å‡ºæ¥ã€‚äºæ˜¯makefileå¯ä»¥åˆä¸€æ¬¡ç®€åŒ–ã€‚ objects = main.o kbd.o command.o display.o \\ insert.o seaerch.o files.o utils.o edit : $(objects) cc -o edit $(objects) main.o : defs.h kbd.o : defs.h command.h command.o : defs.h command.h display.o : defs.h buffer.h insert.o : defs.h buffer.h search.o : defs.h buffer.h files.o : defs.h buffer.h command.h utils.o : defs.h .PHONY : clean clean : rm edit $(objects) è¿™å°±æ˜¯makeçš„â€œéšæ™¦è§„åˆ™â€ã€‚ .PHONYè¡¨ç¤ºï¼Œcleanæ˜¯ä¸ªä¼ªç›®æ ‡æ–‡ä»¶ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:5","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"6. makefileçš„æ”¶ç¼© æ”¶æ‹¢èµ·æ¥ objects = main.o kbd.o command.o display.o \\ insert.o search.o files.o utils.o edit : $(objects) cc -o edit $(objects) $(objects) : defs.h kbd.o command.o files.o : command.h display.o insert.o search.o files.o : buffer.h .PHONY : clean clean: rm edit $(objects) è™½ç„¶makefileå˜å¾—å¾ˆç®€å•ï¼Œä½†æˆ‘ä»¬çš„æ–‡ä»¶ä¾èµ–å…³ç³»ä¼šæ˜¾å¾—å‡Œä¹±ï¼Œæ–°å¢.oæ–‡ä»¶ä¸å¥½ç®¡ç† ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:6","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"7. æ¸…ç©ºç›®æ ‡æ–‡ä»¶çš„è§„åˆ™ æ¯ä¸ªMakefileä¸­éƒ½åº”è¯¥å†™ä¸€ä¸ªæ¸…ç©ºç›®æ ‡æ–‡ä»¶(.oå’Œæ‰§è¡Œæ–‡ä»¶)çš„è§„åˆ™ã€‚ ä¸€èˆ¬çš„é£æ ¼æ˜¯ï¼š clean: rm edit $(objects) æ›´ç¨³å¥çš„åšæ³•æ˜¯ï¼š .PHONY: clean clean: -rm edit $(objects) .PHONYè¡¨ç¤ºcleanæ˜¯ä¸€ä¸ªâ€œä¼ªç›®æ ‡â€ï¼Œå‘makeè¯´æ˜ï¼Œä¸ç®¡æ˜¯å¦æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªç›®æ ‡å°±æ˜¯â€œä¼ªç›®æ ‡â€ã€‚åªè¦æœ‰è¿™ä¸ªå£°æ˜ï¼Œä¸ç®¡æ˜¯å¦æœ‰â€œcleanâ€æ–‡ä»¶ï¼Œè¦è¿è¡Œâ€œcleanâ€è¿™ä¸ªç›®æ ‡ï¼Œåªæœ‰â€œmake cleanâ€è¿™æ ·ã€‚ è€Œåœ¨rmå‘½ä»¤å‰é¢åŠ äº†ä¸€ä¸ªå‡å·è¡¨ç¤ºä¹Ÿè®¸æŸäº›æ–‡ä»¶å‡ºç°é—®é¢˜ï¼Œä½†ä¸ç”¨ç®¡ï¼Œç»§ç»­å¾€åæ‰§è¡Œã€‚ å½“ç„¶ï¼Œcleançš„è§„åˆ™ä¸è¦æ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œä¸ç„¶ï¼Œè¿™å°±ä¼šå˜æˆmakeçš„é»˜è®¤ç›®æ ‡ã€‚ â€œcleanä»æ¥éƒ½æ˜¯æ”¾åœ¨æ–‡ä»¶çš„æœ€åâ€ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:2:7","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Makefileæ€»è¿° ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"1. Makefileé‡Œæœ‰ä»€ä¹ˆ Makefileä¸»è¦åŒ…å«äº†äº”ä¸ªä¸œè¥¿ï¼šæ˜¾ç¤ºè§„åˆ™ï¼Œéšæ™¦è§„åˆ™ï¼Œå˜é‡å®šä¹‰ï¼Œæ–‡ä»¶æŒ‡ç¤ºå’Œæ³¨é‡Šã€‚ æ˜¾ç¤ºè§„åˆ™ï¼šæ˜¾ç¤ºè§„åˆ™è¯´æ˜äº†å¦‚ä½•ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªçš„ç›®æ ‡æ–‡ä»¶ã€‚è¿™æ˜¯ç”±Makefileä¹¦å†™è€…æ˜æ˜¾æŒ‡å‡ºè¦ç”Ÿæˆçš„æ–‡ä»¶ã€æ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶ã€ç”Ÿæˆçš„å‘½ä»¤ã€‚ éšæ™¦è§„åˆ™ï¼šç”±äºæˆ‘ä»¬çš„makeæœ‰è‡ªåŠ¨æ¨å¯¼åŠŸèƒ½ï¼Œæ‰€ä»¥éšæ™¦çš„è§„åˆ™å¯ä»¥è®©æˆ‘ä»¬æ¯”è¾ƒç²—ç³™åœ°ç®€ç•¥ä¹¦å†™Makefileï¼Œè¿™æ˜¯makeæ”¯æŒçš„ã€‚ å˜é‡çš„å®šä¹‰ï¼šåœ¨Makefileä¸­æˆ‘ä»¬è¦å®šä¹‰ä¸€ç³»åˆ—çš„å˜é‡ï¼Œå˜é‡ä¸€èˆ¬éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæœ‰ç‚¹åƒCè¯­è¨€ä¸­çš„å®ï¼Œå½“Makefileè¢«æ‰§è¡Œæ—¶ï¼Œå…¶ä¸­çš„å˜é‡éƒ½ä¼šè¢«æ‰©å±•åˆ°ç›¸åº”çš„å¼•ç”¨ä½ç½®ä¸Šã€‚ æ–‡ä»¶æŒ‡ç¤ºï¼šå…¶ä¸­åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨Makefileä¸­å¼•ç”¨å¦ä¸€ä¸ªMakefileï¼Œå°±åƒCä¸­çš„#includeä¸€æ ·ï¼›å¦ä¸€ä¸ªæ˜¯æŒ‡æ ¹æ®æŸäº›æƒ…å†µæŒ‡å®šMakefileä¸­çš„æœ‰æ•ˆéƒ¨åˆ†ï¼Œå°±åƒCè¯­è¨€ä¸­çš„é¢„ç¼–è¯‘#ifä¸€æ ·ï¼›è¿˜æœ‰å°±æ˜¯å®šä¹‰ä¸€ä¸ªå¤šè¡Œçš„å‘½ä»¤ã€‚ æ³¨é‡Šï¼šMakefileä¸­åªæœ‰è¡Œæ³¨é‡Šï¼Œå’ŒUNIXçš„Shellè„šæœ¬ä¸€æ ·ï¼Œå…¶æ³¨é‡Šæ˜¯ç”¨â€œ#â€å­—ç¬¦ï¼Œè¿™ä¸ªå°±åƒC/C++ä¸­çš„â€œ//â€ä¸€æ ·ã€‚å¦‚æœè¦åœ¨Makefileä¸­ä½¿ç”¨â€œ#â€å­—ç¬¦ï¼Œå¯ä»¥ç”¨åæ–œæ¡†è¿›è¡Œè½¬ä¹‰ï¼Œå¦‚ï¼šâ€œ#â€ã€‚ æœ€åï¼Œåœ¨Makefileä¸­çš„å‘½ä»¤ï¼Œå¿…é¡»è¦ä»¥[Tab]é”®å¼€å§‹ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:1","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"2. Makefileçš„æ–‡ä»¶å é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œmakeå‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æŒ‰é¡ºåºæ‰¾å¯»æ–‡ä»¶åä¸º**â€œGNUmakefileâ€ã€â€œmakefileâ€ã€â€œMakefileâ€**çš„æ–‡ä»¶ï¼Œæ‰¾åˆ°äº†è§£é‡Šè¿™ä¸ªæ–‡ä»¶ã€‚åœ¨è¿™ä¸‰ä¸ªæ–‡ä»¶åä¸­ï¼Œæœ€å¥½ä½¿ç”¨â€œMakefileâ€è¿™ä¸ªæ–‡ä»¶åï¼Œå› ä¸ºï¼Œè¿™ä¸ªæ–‡ä»¶åç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå¤§å†™ï¼Œè¿™æ ·æœ‰ä¸€ç§æ˜¾ç›®çš„æ„Ÿè§‰ã€‚æœ€å¥½ä¸è¦ç”¨â€œGNUmakefileâ€ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯GNUçš„makeè¯†åˆ«çš„ã€‚æœ‰å¦å¤–ä¸€äº›makeåªå¯¹å…¨å°å†™çš„â€œmakefileâ€æ–‡ä»¶åæ•æ„Ÿï¼Œä½†æ˜¯åŸºæœ¬ä¸Šæ¥è¯´ï¼Œå¤§å¤šæ•°çš„makeéƒ½æ”¯æŒâ€œ**makefileâ€å’Œâ€œMakefileâ€**è¿™ä¸¤ç§é»˜è®¤æ–‡ä»¶åã€‚ å½“ç„¶ï¼Œå¯ä»¥ä½¿ç”¨åˆ«çš„æ–‡ä»¶åæ¥ä¹¦å†™Makefileï¼Œæ¯”å¦‚ï¼šâ€œMake.Linuxâ€ï¼Œâ€œMake.Solarisâ€ï¼Œâ€œMake.AIXâ€ç­‰ï¼Œå¦‚æœè¦****æŒ‡å®šç‰¹å®šçš„Makefileï¼Œå¯ä»¥ä½¿ç”¨makeçš„â€œ-fâ€å’Œâ€œâ€“fileâ€å‚æ•°****ï¼Œå¦‚ï¼šmake -f Make.Linuxæˆ–make â€“file Make.AIXã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:2","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"3. å¼•ç”¨å…¶ä»–çš„Makefile åœ¨Makefileä½¿ç”¨includeå…³é”®å­—å¯ä»¥æŠŠåˆ«çš„MakefileåŒ…å«è¿›æ¥ï¼Œè¿™å¾ˆåƒCè¯­è¨€çš„#includeï¼Œè¢«åŒ…å«çš„æ–‡ä»¶ä¼šåŸæ¨¡åŸæ ·çš„æ”¾åœ¨å½“å‰æ–‡ä»¶çš„åŒ…å«ä½ç½®ã€‚includeçš„è¯­æ³•æ˜¯ï¼š include filename #filenameå¯ä»¥æ˜¯å½“å‰æ“ä½œç³»ç»ŸShellçš„æ–‡ä»¶æ¨¡å¼ï¼ˆå¯ä»¥ä¿å«è·¯å¾„å’Œé€šé…ç¬¦ï¼‰ åœ¨includeå‰é¢å¯ä»¥æœ‰ä¸€äº›ç©ºå­—ç¬¦ï¼Œä½†æ˜¯ç»ä¸èƒ½æ˜¯[Tab]é”®å¼€å§‹ã€‚includeå’Œå¯ä»¥ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼éš”å¼€ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰è¿™æ ·å‡ ä¸ªMakefileï¼ša.mkã€b.mkã€c.mkï¼Œè¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶å«foo.makeï¼Œä»¥åŠä¸€ä¸ªå˜é‡$(bar)ï¼Œå…¶åŒ…å«äº†e.mkå’Œf.mkï¼Œé‚£ä¹ˆï¼Œä¸‹é¢çš„è¯­å¥ï¼š include foo.make *.mk $(bar) #ç­‰ä»·äºï¼š include foo.make a.mk b.mk c.mk e.mk f.mk makeå‘½ä»¤å¼€å§‹æ—¶ï¼Œä¼šæŠŠæ‰¾å¯»includeæ‰€æŒ‡å‡ºçš„å…¶å®ƒMakefileï¼Œå¹¶æŠŠå…¶å†…å®¹å®‰ç½®åœ¨å½“å‰çš„ä½ç½®ã€‚å°±å¥½åƒC/C++çš„#includeæŒ‡ä»¤ä¸€æ ·ã€‚å¦‚æœæ–‡ä»¶éƒ½æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„æˆ–æ˜¯ç›¸å¯¹è·¯å¾„çš„è¯ï¼Œmakeä¼šåœ¨å½“å‰ç›®å½•ä¸‹é¦–å…ˆå¯»æ‰¾ï¼Œå¦‚æœå½“å‰ç›®å½•ä¸‹æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆï¼Œmakeè¿˜ä¼šåœ¨ä¸‹é¢çš„å‡ ä¸ªç›®å½•ä¸‹æ‰¾ï¼š å¦‚æœmakeæ‰§è¡Œæ—¶ï¼Œæœ‰â€œ-Iâ€æˆ–â€œâ€“include-dirâ€å‚æ•°ï¼Œé‚£ä¹ˆmakeå°±ä¼šåœ¨è¿™ä¸ªå‚æ•°æ‰€æŒ‡å®šçš„ç›®å½•ä¸‹å»å¯»æ‰¾ã€‚ å¦‚æœç›®å½•/includeï¼ˆä¸€èˆ¬æ˜¯ï¼š/usr/local/binæˆ–/usr/includeï¼‰å­˜åœ¨çš„è¯ï¼Œmakeä¹Ÿä¼šå»æ‰¾ã€‚ å¦‚æœæœ‰æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œmakeä¼šç”Ÿæˆä¸€æ¡è­¦å‘Šä¿¡æ¯ï¼Œä½†ä¸ä¼šé©¬ä¸Šå‡ºç°è‡´å‘½é”™è¯¯ã€‚å®ƒä¼šç»§ç»­è½½å…¥å…¶å®ƒçš„æ–‡ä»¶ï¼Œä¸€æ—¦å®Œæˆmakefileçš„è¯»å–ï¼Œmakeä¼šå†é‡è¯•è¿™äº›æ²¡æœ‰æ‰¾åˆ°ï¼Œæˆ–æ˜¯ä¸èƒ½è¯»å–çš„æ–‡ä»¶ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œmakeæ‰ä¼šå‡ºç°ä¸€æ¡è‡´å‘½ä¿¡æ¯ã€‚å¦‚æœæƒ³è®©makeä¸ç†é‚£äº›æ— æ³•è¯»å–çš„æ–‡ä»¶ï¼Œè€Œç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥åœ¨includeå‰åŠ ä¸€ä¸ªå‡å·â€œ-â€ã€‚å¦‚ï¼š -include\u003cfilename\u003e å…¶è¡¨ç¤ºï¼Œæ— è®ºincludeè¿‡ç¨‹ä¸­å‡ºç°ä»€ä¹ˆé”™è¯¯ï¼Œéƒ½ä¸è¦æŠ¥é”™ç»§ç»­æ‰§è¡Œã€‚å’Œå…¶å®ƒç‰ˆæœ¬makeå…¼å®¹çš„ç›¸å…³å‘½ä»¤æ˜¯sincludeï¼Œå…¶ä½œç”¨å’Œè¿™ä¸€ä¸ªæ˜¯ä¸€æ ·çš„ã€‚è¿™ä¸ªå˜é‡ä¸­çš„å€¼æ˜¯å…¶å®ƒçš„Makefileï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚åªæ˜¯ï¼Œå®ƒå’Œincludeä¸åŒçš„æ˜¯ï¼Œä»è¿™ä¸ªç¯å¢ƒå˜é‡ä¸­å¼•å…¥çš„Makefileçš„â€œç›®æ ‡â€ä¸ä¼šèµ·ä½œç”¨ï¼Œå¦‚æœç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„æ–‡ä»¶å‘ç°é”™è¯¯ï¼Œmakeä¹Ÿä¼šä¸ç†ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:3","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"4. ç¯å¢ƒå˜é‡Makefiles å¦‚æœå½“å‰ç¯å¢ƒä¸­å®šä¹‰äº†ç¯å¢ƒå˜é‡Makefilesï¼Œé‚£ä¹ˆmakeä¼šæŠŠè¿™ä¸ªå˜é‡ä¸­çš„å€¼åšä¸€ä¸ªç±»ä¼¼äºincludeçš„åŠ¨ä½œã€‚è¿™ä¸ªå˜é‡ä¸­çš„å€¼æ˜¯å…¶å®ƒçš„Makefileï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚åªæ˜¯ï¼Œå®ƒå’Œincludeä¸åŒçš„æ˜¯ï¼Œä»è¿™ä¸ªç¯å¢ƒå˜ä¸­å¼•å…¥çš„Makefileçš„â€œç›®æ ‡â€ä¸ä¼šèµ·ä½œç”¨ï¼Œå¦‚æœç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„æ–‡ä»¶å‘ç°é”™è¯¯ï¼Œmakeä¹Ÿä¼šä¸ç†ã€‚ ä½†è¿˜æ˜¯å»ºè®®ä¸è¦ä½¿ç”¨è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå› ä¸ºåªè¦è¿™ä¸ªå˜é‡ä¸€æ—¦è¢«å®šä¹‰ï¼Œé‚£ä¹ˆå½“ä½¿ç”¨makeæ—¶ï¼Œæ‰€æœ‰çš„Makefileéƒ½ä¼šå—åˆ°å®ƒçš„å½±å“ï¼Œè¿™ç»ä¸æ˜¯æƒ³çœ‹åˆ°çš„ã€‚åœ¨è¿™é‡Œæè¿™ä¸ªäº‹ï¼Œåªæ˜¯ä¸ºäº†å‘Šè¯‰å¤§å®¶ï¼Œä¹Ÿè®¸æœ‰æ—¶å€™Makefileå‡ºç°äº†æ€ªäº‹ï¼Œé‚£ä¹ˆå¯ä»¥çœ‹çœ‹å½“å‰ç¯å¢ƒä¸­æœ‰æ²¡æœ‰å®šä¹‰è¿™ä¸ªå˜é‡ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:4","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"5. makeçš„å·¥ä½œæ–¹å¼ GNUçš„makeå·¥ä½œæ—¶æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š è¯»å…¥æ‰€æœ‰çš„makefile è¯»å…¥è¢«includeçš„å…¶ä»–makefile åˆå§‹åŒ–æ–‡ä»¶ä¸­çš„å˜é‡ æ¨å¯¼éšæ™¦è§„åˆ™ï¼Œå¹¶åˆ†ææ‰€æœ‰è§„åˆ™ ä¸ºæ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶åˆ›å»ºä¾èµ–å…³ç³»é“¾ æ ¹æ®ä¾èµ–å…³ç³»ï¼Œå†³å®šå“ªäº›ç›®æ ‡æ–‡ä»¶é‡æ–°ç”Ÿæˆ æ‰§è¡Œç”Ÿæˆå‘½ä»¤ 1-5æ­¥ä¸ºç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œ6-7ä¸ºç¬¬äºŒä¸ªé˜¶æ®µã€‚ ç¬¬ä¸€ä¸ªé˜¶æ®µä¸­ï¼Œå¦‚æœå®šä¹‰è¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆmakeä¼šæŠŠå…¶å±•å¼€åœ¨ä½¿ç”¨çš„ä½ç½®ã€‚ä½†makeå¹¶ä¸ä¼šå®Œå…¨é©¬ä¸Šå±•å¼€ï¼Œå¦‚æœå˜é‡å‡ºç°åœ¨ä¾èµ–å…³ç³»çš„è§„åˆ™ä¸­ï¼Œé‚£ä¹ˆä»…å½“è¿™æ¡ä¾èµ–è¢«å†³å®šè¦ä½¿ç”¨äº†ï¼Œå˜é‡æ‰ä¼šåœ¨å†…éƒ¨å±•å¼€ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:3:5","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Makefileä¹¦å†™è§„åˆ™ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:4:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"1. Makefileè§„åˆ™ è§„åˆ™åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ä¾èµ–å…³ç³»ï¼Œä¸€ä¸ªæ˜¯ç”Ÿæˆç›®æ ‡çš„æ–¹æ³•ã€‚ åœ¨Makefileä¸­ï¼Œè§„åˆ™çš„é¡ºåºæ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºï¼ŒMakefileä¸­åªåº”è¯¥æœ‰ä¸€ä¸ªæœ€ç»ˆç›®æ ‡ï¼Œå…¶å®ƒçš„ç›®æ ‡éƒ½æ˜¯è¢«è¿™ä¸ªç›®æ ‡æ‰€è¿å¸¦å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦è®©makeçŸ¥é“ä½ çš„æœ€ç»ˆç›®æ ‡æ˜¯ä»€ä¹ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®šä¹‰åœ¨Makefileä¸­çš„ç›®æ ‡å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼Œä½†æ˜¯ç¬¬ä¸€æ¡è§„åˆ™ä¸­çš„ç›®æ ‡å°†è¢«ç¡®ç«‹ä¸ºæœ€ç»ˆçš„ç›®æ ‡ã€‚å¦‚æœç¬¬ä¸€æ¡è§„åˆ™ä¸­çš„ç›®æ ‡æœ‰å¾ˆå¤šä¸ªï¼Œé‚£ä¹ˆï¼Œç¬¬ä¸€ä¸ªç›®æ ‡ä¼šæˆä¸ºæœ€ç»ˆçš„ç›®æ ‡ã€‚makeæ‰€å®Œæˆçš„ä¹Ÿå°±æ˜¯è¿™ä¸ªç›®æ ‡ã€‚ è§„åˆ™ä¸¾ä¾‹ foo.o: foo.c defs.h # fooæ¨¡å— cc -c -g foo.c foo.oæ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œfoo.cå’Œdefs.hæ˜¯ç›®æ ‡æ‰€ä¾èµ–çš„æºæ–‡ä»¶ï¼Œè€Œåªæœ‰ä¸€ä¸ªå‘½ä»¤â€œcc -c -g foo.câ€ï¼ˆä»¥Tabé”®å¼€å¤´ï¼‰ æ–‡ä»¶çš„ä¾èµ–å…³ç³»ï¼Œfoo.oä¾èµ–äºfoo.cå’Œdefs.hçš„æ–‡ä»¶ï¼Œå¦‚æœfoo.cå’Œdefs.hçš„æ–‡ä»¶æ—¥æœŸè¦æ¯”foo.oæ–‡ä»¶æ—¥æœŸè¦æ–°ï¼Œæˆ–æ˜¯foo.oä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¾èµ–å…³ç³»å‘ç”Ÿã€‚ å¦‚æœç”Ÿæˆï¼ˆæˆ–æ›´æ–°ï¼‰foo.oæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯é‚£ä¸ªccå‘½ä»¤ï¼Œå…¶è¯´æ˜äº†ï¼Œå¦‚ä½•ç”Ÿæˆfoo.oè¿™ä¸ªæ–‡ä»¶ã€‚ï¼ˆå½“ç„¶foo.cæ–‡ä»¶includeäº†defs.hæ–‡ä»¶ï¼‰ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:4:1","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"2. è§„åˆ™çš„è¯­æ³• targets : prerequisites command #æˆ–ï¼š targets : prerequisites ; command command targetsæ˜¯æ–‡ä»¶åï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„ç›®æ ‡åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†ä¹Ÿæœ‰å¯èƒ½æ˜¯å¤šä¸ªæ–‡ä»¶ã€‚ commandæ˜¯å‘½ä»¤è¡Œï¼Œå¦‚æœå…¶ä¸ä¸â€œtarget:prerequisitesâ€åœ¨ä¸€è¡Œï¼Œé‚£ä¹ˆï¼Œå¿…é¡»ä»¥[Tabé”®]å¼€å¤´ï¼Œå¦‚æœå’Œprerequisitesåœ¨ä¸€è¡Œï¼Œé‚£ä¹ˆå¯ä»¥ç”¨åˆ†å·åšä¸ºåˆ†éš” prerequisitesä¹Ÿå°±æ˜¯ç›®æ ‡æ‰€ä¾èµ–çš„æ–‡ä»¶ï¼ˆæˆ–ä¾èµ–ç›®æ ‡ï¼‰ã€‚å¦‚æœå…¶ä¸­çš„æŸä¸ªæ–‡ä»¶è¦æ¯”ç›®æ ‡æ–‡ä»¶è¦æ–°ï¼Œé‚£ä¹ˆï¼Œç›®æ ‡å°±è¢«è®¤ä¸ºæ˜¯â€œè¿‡æ—¶çš„â€ï¼Œè¢«è®¤ä¸ºæ˜¯éœ€è¦é‡ç”Ÿæˆçš„ã€‚ å¦‚æœå‘½ä»¤å¤ªé•¿ï¼Œä½ å¯ä»¥ä½¿ç”¨åæ–œæ¡†ï¼ˆâ€˜\\â€™ï¼‰ä½œä¸ºæ¢è¡Œç¬¦ã€‚makeå¯¹ä¸€è¡Œä¸Šæœ‰å¤šå°‘ä¸ªå­—ç¬¦æ²¡æœ‰é™åˆ¶ã€‚è§„åˆ™å‘Šè¯‰makeä¸¤ä»¶äº‹ï¼Œæ–‡ä»¶çš„ä¾èµ–å…³ç³»å’Œå¦‚ä½•æˆæˆç›®æ ‡æ–‡ä»¶ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œmakeä¼šä»¥UNIXçš„æ ‡å‡†Shellï¼Œä¹Ÿå°±æ˜¯/bin/shæ¥æ‰§è¡Œå‘½ä»¤ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:4:2","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"3. åœ¨è§„åˆ™ä¸­ä½¿ç”¨é€šé…ç¬¦ makeæ”¯æŒä¸‰å„é€šé…ç¬¦ï¼šâ€œ*â€ï¼Œâ€œ?â€å’Œâ€œ[â€¦]â€ã€‚è¿™æ˜¯å’ŒUnixçš„B-Shellæ˜¯ç›¸åŒçš„ã€‚ â€œ~â€ï¼šæ³¢æµªå·ï¼ˆâ€œ~â€ï¼‰å­—ç¬¦åœ¨æ–‡ä»¶åä¸­ä¹Ÿæœ‰æ¯”è¾ƒç‰¹æ®Šçš„ç”¨é€”ã€‚å¦‚æœæ˜¯â€œ~/testâ€ï¼Œè¿™å°±è¡¨ç¤ºå½“å‰ç”¨æˆ·çš„$HOMEç›®å½•ä¸‹çš„testç›®å½•ã€‚è€Œâ€œ~hchen/testâ€åˆ™è¡¨ç¤ºç”¨æˆ·hchençš„å®¿ä¸»ç›®å½•ä¸‹çš„testç›®å½•ã€‚ï¼ˆè¿™äº›éƒ½æ˜¯Unixä¸‹çš„å°çŸ¥è¯†äº†ï¼Œmakeä¹Ÿæ”¯æŒï¼‰è€Œåœ¨Windowsæˆ–æ˜¯MS-DOSä¸‹ï¼Œç”¨æˆ·æ²¡æœ‰å®¿ä¸»ç›®å½•ï¼Œé‚£ä¹ˆæ³¢æµªå·æ‰€æŒ‡çš„ç›®å½•åˆ™æ ¹æ®ç¯å¢ƒå˜é‡â€œHOMEâ€è€Œå®šã€‚ â€œ*â€ï¼šé€šé…ç¬¦ä»£æ›¿äº†ä½ ä¸€ç³»åˆ—çš„æ–‡ä»¶ï¼Œå¦‚â€œ.câ€è¡¨ç¤ºæ‰€ä»¥åç¼€ä¸ºcçš„æ–‡ä»¶ã€‚ä¸€ä¸ªéœ€è¦æˆ‘ä»¬æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶åä¸­æœ‰é€šé…ç¬¦ï¼Œå¦‚ï¼šâ€œâ€ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è½¬ä¹‰å­—ç¬¦â€œ\\â€ï¼Œå¦‚â€œ*â€æ¥è¡¨ç¤ºçœŸå®çš„â€œ*â€å­—ç¬¦ï¼Œè€Œä¸æ˜¯ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:4:3","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"4. é™æ€æ¨¡å¼ é™æ€æ¨¡å¼å¯ä»¥æ›´åŠ å®¹æ˜“åœ°å®šä¹‰å¤šç›®æ ‡çš„è§„åˆ™ï¼Œå¯ä»¥è®©æˆ‘ä»¬çš„è§„åˆ™å˜å¾—æ›´åŠ çš„æœ‰å¼¹æ€§å’Œçµæ´»ã€‚è¯­æ³•ï¼š \u003ctargets...\u003e: \u003ctarget-pattern\u003e: \u003cprereq-patterns ...\u003e \u003ccommands\u003e targetså®šä¹‰äº†ä¸€ç³»åˆ—çš„ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æœ‰é€šé…ç¬¦ã€‚æ˜¯ç›®æ ‡çš„ä¸€ä¸ªé›†åˆã€‚ target-parrternæ˜¯æŒ‡æ˜äº†targetsçš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯çš„ç›®æ ‡é›†æ¨¡å¼ã€‚ prereq-parrternsæ˜¯ç›®æ ‡çš„ä¾èµ–æ¨¡å¼ï¼Œå®ƒå¯¹target-parrternå½¢æˆçš„æ¨¡å¼å†è¿›è¡Œä¸€æ¬¡ä¾èµ–ç›®æ ‡çš„å®šä¹‰ã€‚ è¯´æ˜: å¦‚æœæˆ‘ä»¬çš„å®šä¹‰æˆâ€œ%.oâ€ï¼Œæ„æ€æ˜¯æˆ‘ä»¬çš„é›†åˆä¸­éƒ½æ˜¯ä»¥â€œ.oâ€ç»“å°¾çš„ã€‚ è€Œå¦‚æœæˆ‘ä»¬çš„å®šä¹‰æˆâ€œ%.câ€ï¼Œæ„æ€æ˜¯å¯¹æ‰€å½¢æˆçš„ç›®æ ‡é›†è¿›è¡ŒäºŒæ¬¡å®šä¹‰ï¼Œå…¶è®¡ç®—æ–¹æ³•æ˜¯ï¼Œå–æ¨¡å¼ä¸­çš„â€œ%â€ï¼ˆä¹Ÿå°±æ˜¯å»æ‰äº†[.o]è¿™ä¸ªç»“å°¾ï¼‰ï¼Œå¹¶ä¸ºå…¶åŠ ä¸Š[.c]è¿™ä¸ªç»“å°¾ï¼Œå½¢æˆçš„æ–°é›†åˆã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„â€œç›®æ ‡æ¨¡å¼â€æˆ–æ˜¯â€œä¾èµ–æ¨¡å¼â€ä¸­éƒ½åº”è¯¥æœ‰â€œ%â€è¿™ä¸ªå­—ç¬¦ å®ä¾‹ï¼š objects = foo.o bar.o all: $(objects) $(objects): %.o: %.c $(CC) -c $(CFLAGS) $\u003c -o $@ ä¾‹å­ä¸­ï¼ŒæŒ‡æ˜äº†ç›®æ ‡ä»$objectsä¸­è·å– â€œ%.oâ€è¡¨æ˜è¦æ‰€æœ‰ä»¥â€œ.oâ€ç»“å°¾çš„ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯\"foo.o bar.oâ€ï¼Œä¹Ÿå°±æ˜¯å˜é‡$objecté›†åˆçš„æ¨¡å¼ è€Œä¾èµ–æ¨¡å¼â€œ%.câ€åˆ™å–æ¨¡å¼â€œ%.oâ€çš„â€œ%â€ï¼Œä¹Ÿå°±æ˜¯â€œfoobarâ€ï¼Œå¹¶ä¸ºå…¶åŠ ä¸‹â€œ.câ€çš„åç¼€ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬çš„ä¾èµ–ç›®æ ‡å°±æ˜¯â€œfoo.c bar.câ€ è€Œå‘½ä»¤ä¸­çš„â€œ$\u003câ€å’Œâ€œ$@â€åˆ™æ˜¯è‡ªåŠ¨åŒ–å˜é‡ï¼Œâ€œ$\u003câ€è¡¨ç¤ºæ‰€æœ‰çš„ä¾èµ–ç›®æ ‡é›†ï¼ˆä¹Ÿå°±æ˜¯â€œfoo.c bar.câ€ï¼‰ï¼Œâ€œ$@â€è¡¨ç¤ºç›®æ ‡é›†ï¼ˆä¹Ÿè¤ªæ°ç™´oo.o bar.oâ€ï¼‰ ä¸Šé¢çš„è§„åˆ™å±•å¼€åç­‰ä»·äºï¼š foo.o : foo.c $(CC) -c $(CFLAGS) foo.c -o foo.o bar.o : bar.c $(CC) -c $(CFLAGS) bar.c -o bar.o ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:4:4","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Makefileä¹¦å†™å‘½ä»¤ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:5:0","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"1. æ˜¾ç¤ºå‘½ä»¤ é€šå¸¸ï¼Œmakeä¼šæŠŠå…¶è¦æ‰§è¡Œçš„å‘½ä»¤è¡Œåœ¨å‘½ä»¤æ‰§è¡Œå‰è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚å½“æˆ‘ä»¬ç”¨â€œ@â€å­—ç¬¦åœ¨å‘½ä»¤è¡Œå‰ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªå‘½ä»¤å°†ä¸è¢«makeæ˜¾ç¤ºå‡ºæ¥ï¼Œæœ€å…·ä»£è¡¨æ€§çš„ä¾‹å­æ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªåŠŸèƒ½æ¥åƒå±å¹•æ˜¾ç¤ºä¸€äº›ä¿¡æ¯ã€‚å¦‚ï¼š @echo æ­£åœ¨ç¼–è¯‘XXXæ¨¡å—â€¦â€¦ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:5:1","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"2.èµ‹å€¼å‘½ä»¤ # = æ˜¯æœ€åŸºæœ¬çš„èµ‹å€¼ # := æ˜¯è¦†ç›–ä¹‹å‰çš„å€¼ # ?= æ˜¯å¦‚æœæ²¡æœ‰è¢«èµ‹å€¼è¿‡å°±èµ‹äºˆç­‰å·åé¢çš„å€¼ # += æ˜¯æ·»åŠ ç­‰å·åé¢çš„å€¼ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:5:2","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"3. æŒ‡å®šç›®æ ‡ 1. â€œallâ€ è¿™ä¸ªä¼ªç›®æ ‡æ˜¯æ‰€æœ‰ç›®æ ‡çš„ç›®æ ‡ï¼Œå…¶åŠŸèƒ½ä¸€èˆ¬æ˜¯ç¼–è¯‘æ‰€æœ‰çš„ç›®æ ‡ã€‚ 2. â€œcleanâ€ è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯åˆ é™¤æ‰€æœ‰è¢«makeåˆ›å»ºçš„æ–‡ä»¶ã€‚ 3. â€œinstallâ€ è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯å®‰è£…å·²ç¼–è¯‘å¥½çš„ç¨‹åºï¼Œå…¶å®å°±æ˜¯æŠŠç›®æ ‡æ‰§è¡Œæ–‡ä»¶æ‹·è´åˆ°æŒ‡å®šçš„ç›®æ ‡ä¸­å»ã€‚ 4. â€œprintâ€ è¿™ä¸ªä¼ªç›®æ ‡çš„åŠŸèƒ½æ˜¯ä¾‹å‡ºæ”¹å˜è¿‡çš„æºæ–‡ä»¶ã€‚ 5. â€œtarâ€ è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯æŠŠæºç¨‹åºæ‰“åŒ…å¤‡ä»½ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªtaræ–‡ä»¶ã€‚ 6. â€œdistâ€ è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯æŠŠtaræ–‡ä»¶å‹æˆZæ–‡ä»¶ã€‚æˆ–æ˜¯gzæ–‡ä»¶ã€‚ 7. â€œTAGSâ€ è¿™ä¸ªä¼ªç›®æ ‡åŠŸèƒ½æ˜¯æ›´æ–°æ‰€æœ‰çš„ç›®æ ‡ï¼Œä»¥å¤‡å®Œæ•´åœ°é‡ç¼–è¯‘ä½¿ç”¨ã€‚ 8. â€œcheckâ€å’Œâ€œtestâ€ è¿™ä¸¤ä¸ªä¼ªç›®æ ‡ä¸€èˆ¬ç”¨æ¥æµ‹è¯•makefileçš„æµç¨‹ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:5:3","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"4. è‡ªåŠ¨åŒ–å˜é‡ $@è¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æ–‡ä»¶é›†ã€‚åœ¨æ¨¡å¼è§„åˆ™ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªç›®æ ‡ï¼Œé‚£ä¹ˆï¼Œ\"$@â€œå°±æ˜¯åŒ¹é…äºç›®æ ‡ä¸­æ¨¡å¼å®šä¹‰çš„é›†åˆã€‚ $%ä»…å½“ç›®æ ‡æ˜¯å‡½æ•°åº“æ–‡ä»¶ä¸­ï¼Œè¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æˆå‘˜åã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç›®æ ‡æ˜¯\"foo.a(bar.o)\"ï¼Œé‚£ä¹ˆï¼Œ\"$%â€œå°±æ˜¯\"bar.oâ€ï¼Œ\"$@â€œå°±æ˜¯\"foo.aâ€ã€‚å¦‚æœç›®æ ‡ä¸æ˜¯å‡½æ•°åº“æ–‡ä»¶ï¼ˆUnixä¸‹æ˜¯ [.a]ï¼ŒWindowsä¸‹æ˜¯[.lib]ï¼‰ï¼Œé‚£ä¹ˆï¼Œå…¶å€¼ä¸ºç©ºã€‚ $\u003cä¾èµ–ç›®æ ‡ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡åå­—ã€‚å¦‚æœä¾èµ–ç›®æ ‡æ˜¯ä»¥æ¨¡å¼ï¼ˆå³â€%\"ï¼‰å®šä¹‰çš„ï¼Œé‚£ä¹ˆ\"$\u003câ€œå°†æ˜¯ç¬¦åˆæ¨¡å¼çš„ä¸€ç³»åˆ—çš„æ–‡ä»¶é›†ã€‚æ³¨æ„ï¼Œå…¶æ˜¯ä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥çš„ã€‚ $?æ‰€æœ‰æ¯”ç›®æ ‡æ–°çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚ $^æ‰€æœ‰çš„ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚å¦‚æœåœ¨ä¾èµ–ç›®æ ‡ä¸­æœ‰å¤šä¸ªé‡å¤çš„ï¼Œé‚£ä¸ªè¿™ä¸ªå˜é‡ä¼šå»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ï¼Œåªä¿ç•™ä¸€ä»½ã€‚ $+è¿™ä¸ªå˜é‡å¾ˆåƒâ€$^\"ï¼Œä¹Ÿæ˜¯æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„é›†åˆã€‚åªæ˜¯å®ƒä¸å»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡ã€‚ $*è¿™ä¸ªå˜é‡è¡¨ç¤ºç›®æ ‡æ¨¡å¼ä¸­\"%â€œåŠå…¶ä¹‹å‰çš„éƒ¨åˆ†ã€‚å¦‚æœç›®æ ‡æ˜¯\"dir/a.foo.bâ€ï¼Œå¹¶ä¸”ç›®æ ‡çš„æ¨¡å¼æ˜¯\"a.%.b\"ï¼Œé‚£ä¹ˆï¼Œ\"$*â€œçš„å€¼å°±æ˜¯\"dir /a.fooâ€ã€‚è¿™ä¸ªå˜é‡å¯¹äºæ„é€ æœ‰å…³è”çš„æ–‡ä»¶åæ˜¯æ¯” è¾ƒæœ‰è¾ƒã€‚å¦‚æœç›®æ ‡ä¸­æ²¡æœ‰æ¨¡å¼çš„å®šä¹‰ï¼Œé‚£ä¹ˆ\"$*â€œä¹Ÿå°±ä¸èƒ½è¢«æ¨å¯¼å‡ºï¼Œä½†æ˜¯ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶çš„åç¼€æ˜¯ makeæ‰€è¯†åˆ«çš„ï¼Œé‚£ä¹ˆâ€$*â€œå°±æ˜¯é™¤äº†åç¼€çš„é‚£ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼šå¦‚æœç›®æ ‡æ˜¯\"foo.câ€ ï¼Œå› ä¸º\".c\"æ˜¯makeæ‰€èƒ½è¯†åˆ«çš„åç¼€åï¼Œæ‰€ä»¥ï¼Œ\"$*â€œçš„å€¼å°±æ˜¯\"fooâ€ã€‚è¿™ä¸ªç‰¹æ€§æ˜¯GNU makeçš„ï¼Œå¾ˆæœ‰å¯èƒ½ä¸å…¼å®¹äºå…¶å®ƒç‰ˆæœ¬çš„makeï¼Œæ‰€ä»¥ï¼Œä½ åº”è¯¥å°½é‡é¿å…ä½¿ç”¨\"$*\"ï¼Œé™¤éæ˜¯åœ¨éšå«è§„åˆ™æˆ–æ˜¯é™æ€æ¨¡å¼ä¸­ã€‚å¦‚æœç›®æ ‡ä¸­çš„åç¼€æ˜¯makeæ‰€ä¸èƒ½è¯†åˆ«çš„ï¼Œé‚£ä¹ˆ\"$*â€œå°±æ˜¯ç©ºå€¼ã€‚ ","date":"2018-09-15","objectID":"/20180915_makefile-cmakelist/:5:4","tags":["C","C++"],"title":"Makefile Guide","uri":"/20180915_makefile-cmakelist/"},{"categories":["Technology"],"content":"Article description.","date":"2018-08-12","objectID":"/20180812_hyperscan/","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"Hyperscan is a high-performance regular expression matching library from Intel. It is based on the X86 platform based on PCRE prototype development. While supporting most of the syntax of PCRE, Hyperscan adds specific syntax and working modes to ensure its usefulness in real-world network scenarios. ","date":"2018-08-12","objectID":"/20180812_hyperscan/:0:0","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"1. æ¦‚è¿° Hyperscan demoä¸­ä½¿ç”¨libpcapä»pcapæ–‡ä»¶ä¸­è¯»å–æ•°æ®åŒ…ï¼Œå¹¶æ ¹æ®ä¸€ä¸ªè§„åˆ™æ–‡ä»¶ä¸­æŒ‡å®šçš„å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹æŠ¥æ–‡è¿›è¡ŒåŒ¹é…ï¼Œå¹¶è¾“å‡ºåŒ¹é…ç»“æœå’Œä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚Hyperscanå¢åŠ äº†ç‰¹å®šçš„è¯­æ³•å’Œå·¥ä½œæ¨¡å¼æ¥ä¿è¯å…¶åœ¨çœŸå®ç½‘ç»œåœºæ™¯ä¸‹çš„å®ç”¨æ€§ã€‚ä¸æ­¤åŒæ—¶ï¼Œå¤§é‡é«˜æ•ˆç®—æ³•åŠIntelSIMD*æŒ‡ä»¤çš„ä½¿ç”¨å®ç°äº†Hyperscançš„é«˜æ€§èƒ½åŒ¹é…ã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:1:0","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"2. KeyWords \u0026 KeyFunc Patterns: è§„åˆ™ï¼Œç”¨æ¥åŒ¹é…å…³é”®è¯çš„è§„åˆ™ï¼Œæ”¯æŒPCREçš„å¤§éƒ¨åˆ†è¯­æ³•ï¼ˆæ­£åˆ™è¡¨è¾¾å¼cåå…­è¿›åˆ¶.etcï¼‰ id: ä¸è§„åˆ™ç»‘å®š,ä¸€ä¸ªè§„åˆ™å¯¹åº”ä¸€ä¸ªä¸åŒçš„idï¼ŒåŒ¹é…å‘½ä¸­æ—¶è¿”å›patternå¯¹åº”çš„id flags: ä¸è§„åˆ™ç»‘å®š,å¯¹patternè¿›è¡Œç‰¹æ®Šæ“ä½œï¼Œå¦‚ï¼šä¸æˆ–éé€»è¾‘è¿ç®—(ç»‘å®šå¤šä¸ªpattern),å¿½ç•¥å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ï¼Œå•æ¬¡åŒ¹é….etc hs_compile_*(): å°†patternsç”Ÿæˆæ— å‘è¿é€šå›¾(database)ï¼ŒåŒ¹é…æ—¶æŠŠæ•°æ®å¾€è¿é€šå›¾é‡Œè¿­ä»£éå† Scratch()ï¼šåœ¨æ‰«ææ•°æ®æ—¶ï¼ŒHyperscanéœ€è¦å°‘é‡çš„ä¸´æ—¶å†…å­˜æ¥å­˜å‚¨åŠ¨æ€å†…éƒ¨æ•°æ®ã€‚ä½†databaseçš„æ•°é‡å¤ªå¤§äº†ï¼Œæ— æ³•è£…å…¥å †æ ˆï¼Œç‰¹åˆ«æ˜¯å¯¹äºåµŒå…¥å¼åº”ç”¨ç¨‹åºï¼Œè€Œä¸”åŠ¨æ€åˆ†é…å†…å­˜è¿‡äºæ˜‚è´µï¼Œå› æ­¤å¿…é¡»ä¸ºæ‰«æå‡½æ•°æä¾›é¢„å…ˆåˆ†é…çš„â€œScratchâ€ç©ºé—´ã€‚ Serialization(): å°†ç”Ÿæˆçš„databaseåºåˆ—åŒ–æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå†ç”±å‡¡åºåˆ—åŒ–æ‹¿åˆ°databseã€‚ Scan(): åŒ¹é…ï¼Œå°†éœ€è¦åŒ¹é…çš„æ•°æ®æ”¾å…¥databaseæ— å‘è¿é€šå›¾ä¸­åŒ¹é…ï¼Œå‘½ä¸­åè°ƒç”¨å›è°ƒå‡½æ•°ã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:2:0","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"3. åŸç† Hyperscanä»¥è‡ªåŠ¨æœºç†è®ºä¸ºåŸºç¡€ï¼Œå…¶å·¥ä½œæµç¨‹ä¸»è¦åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç¼–è¯‘æœŸ(compiletime)å’Œè¿è¡ŒæœŸ(run-time)ã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:3:0","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"3.1ç¼–è¯‘æœŸ Hyperscan è‡ªå¸¦C++ç¼–å†™çš„æ­£åˆ™è¡¨è¾¾å¼ç¼–è¯‘å™¨ã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œå®ƒå°†æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºè¾“å…¥ï¼Œé’ˆå¯¹ä¸åŒçš„å¹³å°ï¼Œç”¨æˆ·å®šä¹‰çš„æ¨¡å¼åŠç‰¹æ®Šè¯­æ³•ï¼Œç»è¿‡å¤æ‚çš„å›¾åˆ†æåŠä¼˜åŒ–è¿‡ç¨‹ï¼Œç”Ÿæˆå¯¹åº”çš„æ•°æ®åº“ã€‚å¦å¤–ï¼Œç”Ÿæˆçš„æ•°æ®åº“å¯ä»¥è¢«åºåˆ—åŒ–åä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»¥ä¾›è¿è¡ŒæœŸæå–ä½¿ç”¨ã€‚ Hyperscan-fig-1 ","date":"2018-08-12","objectID":"/20180812_hyperscan/:3:1","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"3.2è¿è¡ŒæœŸ Hyperscançš„è¿è¡ŒæœŸæ˜¯é€šè¿‡Cè¯­è¨€æ¥å¼€å‘çš„ã€‚å›¾2å±•ç¤ºäº†Hyperscanåœ¨è¿è¡ŒæœŸçš„ä¸»è¦æµç¨‹ã€‚ç”¨æˆ·éœ€è¦é¢„å…ˆåˆ†é…ä¸€æ®µå†…å­˜æ¥å­˜å‚¨ä¸´æ—¶åŒ¹é…çŠ¶æ€ä¿¡æ¯ï¼Œä¹‹ååˆ©ç”¨ç¼–è¯‘ç”Ÿæˆçš„æ•°æ®åº“è°ƒç”¨Hyperscanå†…éƒ¨çš„åŒ¹é…å¼•æ“(NFA, DFAç­‰)æ¥å¯¹è¾“å…¥è¿›è¡Œæ¨¡å¼åŒ¹é…ã€‚Hyperscanåœ¨å¼•æ“ä¸­ä½¿ç”¨Intelå¤„ç†å™¨æ‰€å…·æœ‰çš„SIMDæŒ‡ä»¤è¿›è¡ŒåŠ é€Ÿã€‚åŒæ—¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å›è°ƒå‡½æ•°æ¥è‡ªå®šä¹‰åŒ¹é…å‘ç”Ÿåé‡‡å–çš„è¡Œä¸ºã€‚ç”±äºç”Ÿæˆçš„æ•°æ®åº“æ˜¯åªè¯»çš„ï¼Œç”¨æˆ·å¯ä»¥åœ¨å¤šä¸ªCPUæ ¸æˆ–å¤šçº¿ç¨‹åœºæ™¯ä¸‹å…±äº«æ•°æ®åº“æ¥æå‡åŒ¹é…æ‰©å±•æ€§ã€‚ Hyperscan-fig-2 ","date":"2018-08-12","objectID":"/20180812_hyperscan/:3:2","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"4. Hyperscanä¼ªä»£ç  ","date":"2018-08-12","objectID":"/20180812_hyperscan/:4:0","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"4.1 ç¼–è¯‘ å‡½æ•°buildDatabaseç”¨æ¥ç¼–è¯‘è§„åˆ™æ–‡ä»¶ä¸­çš„å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå‚æ•°modeæŒ‡å®šäº†æ˜¯BLOCK,STREAM,æˆ–è€…å‘é‡æ¨¡å¼ã€‚ static hs_database_t *buildDatabase(const vector\u003cconst char *\u003e \u0026expressions, const vector\u003cunsigned\u003e flags, const vector\u003cunsigned\u003e ids, unsigned int mode) { hs_database_t *db; hs_compile_error_t *compileErr; hs_error_t err; Clock clock; clock.start(); err = hs_compile_multi(expressions.data(), flags.data(), ids.data(), expressions.size(), mode, nullptr, \u0026db, \u0026compileErr); clock.stop(); if (err != HS_SUCCESS) { if (compileErr-\u003eexpression \u003c 0) { // The error does not refer to a particular expression. cerr \u003c\u003c \"ERROR: \" \u003c\u003c compileErr-\u003emessage \u003c\u003c endl; } else { cerr \u003c\u003c \"ERROR: Pattern '\" \u003c\u003c expressions[compileErr-\u003eexpression] \u003c\u003c \"' failed compilation with error: \" \u003c\u003c compileErr-\u003emessage \u003c\u003c endl; } // As the compileErr pointer points to dynamically allocated memory, if // we get an error, we must be sure to release it. This is not // necessary when no error is detected. hs_free_compile_error(compileErr); exit(-1); } //... } å…¶ä¸­çš„æ ¸å¿ƒä»£ç æ˜¯hs_compile_multiçš„è°ƒç”¨ï¼Œæ­¤å‡½æ•°ç”¨æ¥ç¼–è¯‘å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä»ä»£ç å¯è§é™¤äº†modeå‚æ•°ï¼ŒBLOCKå’ŒSTREAMæ¨¡å¼éƒ½ä½¿ç”¨è¿™ä¸€APIã€‚å®ƒçš„åŸå‹æ˜¯ hs_error_t hs_compile_multi(const char *const * expressions, const unsigned int * flags, const unsigned int * ids, unsigned int elements, unsigned int mode, const hs_platform_info_t * platform, hs_database_t ** db, hs_compile_error_t ** error) å…¶ä¸­ï¼Œexpressionsæ˜¯å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œflagså’Œidsåˆ†åˆ«æ˜¯expressionså¯¹åº”çš„flagå’Œidæ•°ç»„ï¼›elementsæ˜¯è¡¨è¾¾å¼å­—ç¬¦ä¸²çš„ä¸ªæ•°ï¼›å…¶ä½™å‚æ•°ä¸ä¸Šä¸€ä¸ªä¾‹å­ä¸­æåˆ°çš„hs_compileçš„å‚æ•°æ¶µä¹‰ç›¸åŒã€‚ è¿™é‡Œè¦æ³¨æ„çš„ä¸€ä¸ªäº‹æƒ…æ˜¯å‚æ•°idsï¼Œå®ƒæ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„IDæ•°ç»„ã€‚æ¯ä¸ªè¡¨è¾¾å¼éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€IDï¼Œè¿™æ ·å‘½ä¸­çš„æ—¶å€™åŒ¹é…å›è°ƒå‡½æ•°å¯ä»¥å¾—åˆ°æ­¤IDï¼Œå‘Šè¯‰è°ƒç”¨è€…å“ªä¸ªè¡¨è¾¾å¼å‘½ä¸­äº†ã€‚å¦‚æœidsä¼ å…¥NULLï¼Œåˆ™æ‰€æœ‰è¡¨è¾¾å¼çš„IDéƒ½ä¸º0ã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:4:1","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"4.2 å‡†å¤‡åŒ¹é…ä¸´æ—¶æ•°æ® ä¸ºæ¥ä¸‹æ¥çš„åŒ¹é…åˆ†é…è¶³å¤Ÿçš„ä¸´æ—¶æ•°æ®ç©ºé—´(scratch spaceï¼‰ public: Benchmark(const hs_database_t *streaming, const hs_database_t *block) : db_streaming(streaming), db_block(block), scratch(nullptr), matchCount(0) { // Allocate enough scratch space to handle either streaming or block // mode, so we only need the one scratch region. hs_error_t err = hs_alloc_scratch(db_streaming, \u0026scratch); if (err != HS_SUCCESS) { cerr \u003c\u003c \"ERROR: could not allocate scratch space. Exiting.\" \u003c\u003c endl; exit(-1); } // This second call will increase the scratch size if more is required // for block mode. err = hs_alloc_scratch(db_block, \u0026scratch); if (err != HS_SUCCESS) { cerr \u003c\u003c \"ERROR: could not allocate scratch space. Exiting.\" \u003c\u003c endl; exit(-1); } } ","date":"2018-08-12","objectID":"/20180812_hyperscan/:4:2","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"4.3 åŒ¹é… 4.3.1 BLOCKæ¨¡å¼ // Scan each packet (in the ordering given in the PCAP file) through // Hyperscan using the block-mode interface. void scanBlock() { for (size_t i = 0; i != packets.size(); ++i) { const std::string \u0026pkt = packets[i]; hs_error_t err = hs_scan(db_block, pkt.c_str(), pkt.length(), 0, scratch, onMatch, \u0026matchCount); if (err != HS_SUCCESS) { cerr \u003c\u003c \"ERROR: Unable to scan packet. Exiting.\" \u003c\u003c endl; exit(-1); } } } å…¶ä¸­ï¼Œdbå°±æ˜¯ä¸Šä¸€æ­¥ç¼–è¯‘çš„databasï¼›dataå’Œlengthåˆ†åˆ«æ˜¯è¦åŒ¹é…çš„æ•°æ®å’Œæ•°æ®é•¿åº¦ï¼›flagsç”¨æ¥åœ¨æœªæ¥ç‰ˆæœ¬ä¸­æ§åˆ¶å‡½æ•°è¡Œä¸ºï¼Œç›®å‰æœªä½¿ç”¨ï¼›scratchæ˜¯åŒ¹é…æ—¶è¦ç”¨çš„ä¸´æ—¶æ•°æ®ï¼Œä¹‹å‰å·²ç»åˆ†é…å¥½ï¼›onEventéå¸¸å…³é”®ï¼Œå³åŒ¹é…æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œç”±ç”¨æˆ·æŒ‡å®šï¼›contextæ˜¯ç”¨æˆ·è‡ªå®šä¹‰æŒ‡é’ˆã€‚ 4.3.2 åŒ¹é…å›è°ƒå‡½æ•° åŒ¹é…å›è°ƒå‡½æ•°çš„åŸå‹æ˜¯ typedef (* match_event_handler)(unsigned int id, unsigned long long from, unsigned long long to, unsigned int flags, void *context) å…¶ä¸­ï¼Œidæ˜¯å‘½ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼çš„IDï¼Œå¯¹äºä½¿ç”¨hs_compileç¼–è¯‘çš„å”¯ä¸€è¡¨è¾¾å¼æ¥è¯´ï¼Œæ­¤å€¼ä¸º0ï¼›å¦‚æœåœ¨ç¼–è¯‘æ—¶æŒ‡å®šäº†ç›¸å…³æ¨¡å¼é€‰é¡¹(hs_compileä¸­çš„modeå‚æ•°ï¼‰ï¼Œåˆ™æ­¤å€¼å°†ä¼šè®¾ä¸ºåŒ¹é…ç‰¹å¾çš„èµ·å§‹ä½ç½®ï¼Œå¦åˆ™ä¼šè®¾ä¸º0ï¼›toæ˜¯å‘½ä¸­æ•°æ®çš„ä¸‹ä¸€ä¸ªå­—èŠ‚çš„åç§»ï¼›flagsç›®å‰æœªç”¨ï¼›contextæ˜¯ç”¨æˆ·è‡ªå®šä¹‰æŒ‡é’ˆã€‚ è¿”å›å€¼ä¸ºé0è¡¨ç¤ºåœæ­¢åŒ¹é…ï¼Œå¦åˆ™ç»§ç»­ï¼›åœ¨åŒ¹é…çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡å‘½ä¸­æ—¶éƒ½å°†åŒæ­¥è°ƒç”¨åŒ¹é…å›è°ƒå‡½æ•°ï¼Œç›´åˆ°åŒ¹é…ç»“æŸã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:4:3","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"4.4 æ¸…ç†èµ„æº åŒ…æ‹¬å…³é—­æµï¼ˆhs_close_streamï¼‰ã€é‡Šæ”¾databaseç­‰ã€‚ ","date":"2018-08-12","objectID":"/20180812_hyperscan/:4:4","tags":["C","C++","Hyperscan"],"title":"Hyperscan: high-performance multiple regex matching library","uri":"/20180812_hyperscan/"},{"categories":["Technology"],"content":"Article description.","date":"2018-06-10","objectID":"/20180610_c-getline/","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"Getline ()/get()/read() will read one more line. The cause may be a problem with the file itself or the getline() function. You can judge getLine ()/get()/read() while checking, and then process the data if you get it. Insert Lead paragraph here. ","date":"2018-06-10","objectID":"/20180610_c-getline/:0:0","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"1. é—®é¢˜åŸå›  ","date":"2018-06-10","objectID":"/20180610_c-getline/:1:0","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"1. é—®é¢˜1: æ–‡ä»¶æœ«å°¾å­˜åœ¨å›è½¦ while (!feof(fp)) { fgets(buffer,256,fp); j++; } feofï¼ˆï¼‰è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥åˆ¤æ–­æŒ‡é’ˆæ˜¯å¦å·²ç»åˆ°è¾¾æ–‡ä»¶å°¾éƒ¨çš„ã€‚è‹¥fpå·²ç»æŒ‡å‘æ–‡ä»¶æœ«å°¾ï¼Œåˆ™feofï¼ˆfpï¼‰å‡½æ•°å€¼ä¸ºâ€œçœŸâ€ï¼Œå³è¿”å›éé›¶å€¼ï¼›å¦åˆ™è¿”å›0ã€‚ å¦‚æœæ–‡ä»¶è¿˜æœ‰æ¢è¡Œæˆ–è€…ç©ºæ ¼çš„æ—¶å€™ï¼Œ ä»–ä¼šç»§ç»­å¾ªç¯ã€‚ ","date":"2018-06-10","objectID":"/20180610_c-getline/:1:1","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"2.é—®é¢˜2: getline(s,1024,â€™\\nâ€™)å‡½æ•° while(!feof(s)) { infile.getline(s,1024,'\\n'); } æœ€åè¯­å¥infile.getline(s,1024,â€™\\nâ€™)æœªè¯»åˆ°å†…å®¹ï¼Œå‡ºé”™åï¼Œå˜é‡sçš„å†…å®¹å¹¶æ²¡æ”¹å˜ï¼Œç¨‹åºä»å¯ç»§ç»­æ‰§è¡Œï¼Œä½¿sä¸­çš„åŸæ•°æ®å†ä½¿ç”¨äº†ä¸€æ¬¡ã€‚ ","date":"2018-06-10","objectID":"/20180610_c-getline/:1:2","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"2. è§£å†³æ–¹æ³• ","date":"2018-06-10","objectID":"/20180610_c-getline/:2:0","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"1. fgetsæ”¾åˆ°whileé‡Œåˆ¤æ–­ while (fgets(buffer,256,fp)) { j++; } ","date":"2018-06-10","objectID":"/20180610_c-getline/:2:1","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"2.getlineæ”¾åˆ°whileé‡Œåˆ¤æ–­ while(infile.getline(s,1024,'\\n')) { ....... } å³infile.getline(s,1024,â€™\\nâ€™)æ­£ç¡®è¯»åˆ°æ•°æ®åå†å¤„ç†ã€‚ åŒç†ï¼Œå¯¹get()/read()ç­‰éƒ½ç±»ä¼¼å¤„ç†ã€‚ ","date":"2018-06-10","objectID":"/20180610_c-getline/:2:2","tags":["C","File"],"title":"The problem about file reading one more line","uri":"/20180610_c-getline/"},{"categories":["Technology"],"content":"Article description.","date":"2018-05-07","objectID":"/20180507_mxml/","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"MXML (Minimal XML) is a small, fast and versatile library that reads a whole XML file and puts it in a DOM tree. ","date":"2018-05-07","objectID":"/20180507_mxml/:0:0","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"1.XML XMLç‰¹ç‚¹å’Œä½œç”¨ : XML æŒ‡å¯æ‰©å±•æ ‡è¯†è¯­è¨€ï¼ˆ eXtensible Markup Languageï¼‰ XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œ è€Œéæ˜¾ç¤ºæ•°æ® XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚ æ‚¨éœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ã€‚ ä½œä¸ºä¸€ç§é€šç”¨çš„æ•°æ®å­˜å‚¨å’Œé€šä¿¡æ ¼å¼è¢«å¹¿æ³›åº”ç”¨ã€‚ æè¿°çš„æ•°æ®ä½œä¸ºä¸€æ£µæ ‘å‹çš„ç»“æ„è€Œå­˜åœ¨ã€‚ \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cbooks\u003e \u003cbook id=\"001\"\u003e \u003cauthor\u003ewanger\u003c/author\u003e \u003c/book\u003e \u003c/books\u003e ","date":"2018-05-07","objectID":"/20180507_mxml/:1:0","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"2.mxmlå†™å…¥æ“ä½œ mxmlæ—¢å¯ä»¥åˆ›å»ºå†™å…¥xmlæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è§£æxmlæ–‡ä»¶æ•°æ® å†™å…¥ç¤ºä¾‹: #include\"mxml.h\" int main() { // create a new xml mxml_node_t *xml = mxmlNewXML(\"1.0\"); //add a node name books mxml_node_t *books = mxmlNewElement(xml,\"books\"); //add a node under books name book mxml_node_t *book = mxmlNewElement(books,\"book\"); //set attr mxmlElementSetAttr(book,\"id\",\"001\"); mxml_node_t *author = mxmlNewElement(book,\"author\"); mxmlNewText(author,0,\"wanger\"); FILE* fp = fopen(\"book.xml\",\"wb\"); mxmlSaveFile(xml,fp,MXML_NO_CALLBACK); fclose(fp); mxmlDelete(xml); return 0; } ","date":"2018-05-07","objectID":"/20180507_mxml/:2:0","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"3.mxmlè§£ææ“ä½œ è§£ææ­¥éª¤ï¼š æ­¥éª¤ï¼š æ‰“å¼€ä¸€ä¸ªxmlæ–‡ä»¶ æŠŠæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œmxml_node_t mxmlLoadFile(mxml_node_t *top, FILE *fp,mxml_type_t (*cb)(mxml_node_t )); æŸ¥æ‰¾å¾…æå–çš„èŠ‚ç‚¹æ ‡ç­¾ï¼šmxml_node_t *mxmlFindElement(mxml_node_t *node, mxml_node_t *top,const char *name, const char *attr,const char *value, int descend); è·å–æ ‡ç­¾å±æ€§ï¼šconst char *mxmlElementGetAttr(mxml_node_t *node, const char *name); è·å–æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹ï¼š const char *mxmlGetText(mxml_node_t *node, int *whitespace); é‡Šæ”¾èŠ‚ç‚¹ï¼Œå…³é—­æ–‡ä»¶ ç¤ºä¾‹ï¼š è§£æçš„æ–‡æœ¬ï¼š \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cbooks\u003e \u003cbook id=\"001\"\u003e \u003cauthor\u003ewanger\u003c/author\u003e \u003c/book\u003e \u003c/books\u003e ä»£ç ï¼š #include\"mxml.h\" #include\u003cstdio.h\u003e int main() { FILE* fp = fopen(\"book.xml\",\"r\"); // jiazai xml mxml_node_t* xml = mxmlLoadFile(NULL,fp,MXML_NO_CALLBACK); mxml_node_t* book = NULL; mxml_node_t* author = NULL; // find note book = mxmlFindElement(xml,xml,\"book\",\"id\",NULL,MXML_DESCEND); //get attr author = mxmlFindElement(book,xml,\"author\",NULL,NULL,MXML_DESCEND); if(author == NULL) { printf(\"author error\\n\"); } else { printf(\"book id is:%s\\n\",mxmlElementGetAttr(book,\"id\")); printf(\"author is:%s\\n\",mxmlGetText(author,NULL)); book = mxmlFindElement(xml,xml,\"book\",\"id\",NULL,MXML_DESCEND); } mxmlDelete(xml); fclose(fp); return 0; } ç»“æœï¼š book id is:001 author is:wanger ","date":"2018-05-07","objectID":"/20180507_mxml/:3:0","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"4.mxml forå¾ªç¯è§£æé•¿æ–‡ä»¶ xmlæ–‡ä»¶: \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cproto-meta-dump\u003e \u003cproto name=\"AH\"\u003e \u003cproto-class\u003ecrypto\u003c/proto-class\u003e \u003cproto-suit\u003eTCP/IP\u003c/proto-suit\u003e \u003cproto-desc\u003e\u003c/proto-desc\u003e \u003cdump-name\u003e\u003c/dump-name\u003e \u003cmeta-data name=\"\"\u003e \u003cdump-on\u003e\u003c/dump-on\u003e \u003cdump-format\u003e\u003c/dump-format\u003e \u003cdump-name\u003etotMeta\u003c/dump-name\u003e \u003c/meta-data\u003e \u003cmeta-data name=\"ah.spi\"\u003e \u003cdump-on\u003e\u003c/dump-on\u003e \u003cdump-format\u003e\u003c/dump-format\u003e \u003cdump-name\u003eSPI\u003c/dump-name\u003e \u003c/meta-data\u003e \u003cmeta-data name=\"ah.sequence\"\u003e \u003cdump-on\u003e\u003c/dump-on\u003e \u003cdump-format\u003e\u003c/dump-format\u003e \u003cdump-name\u003eseqNum\u003c/dump-name\u003e \u003c/meta-data\u003e \u003cmeta-data name=\"ah.length\"\u003e \u003cdump-on\u003e\u003c/dump-on\u003e \u003cdump-format\u003e\u003c/dump-format\u003e \u003cdump-name\u003epayLen\u003c/dump-name\u003e \u003c/meta-data\u003e \u003cmeta-data name=\"ah.icv\"\u003e \u003cdump-on\u003e\u003c/dump-on\u003e \u003cdump-format\u003e\u003c/dump-format\u003e \u003cdump-name\u003eICV\u003c/dump-name\u003e \u003c/meta-data\u003e \u003c/proto\u003e ... \u003c/proto-meta-dump\u003e è§£æä»£ç ï¼š //open xml file FILE* fp = fopen(fileName,\"r\"); //create mxml tree head node mxml_node_t* tree = mxmlLoadFile(NULL,fp,MXML_NO_CALLBACK); //build head node:proto_meta_dump //ç¬¬ä¸€å±‚ mxml_node_t* proto = NULL; //ç¬¬äºŒå±‚ mxml_node_t* class = NULL; mxml_node_t* suit = NULL; mxml_node_t* desc = NULL; mxml_node_t* name = NULL; //ç¬¬ä¸‰å±‚ mxml_node_t* meta_data = NULL; mxml_node_t* dump_on = NULL; mxml_node_t* dump_format = NULL; mxml_node_t* dump_name = NULL; //éå†ç¬¬ä¸€å±‚protoï¼ŒmxmlFindElementå‡½æ•°ï¼šå¯»æ‰¾ä¸‹ä¸€ä¸ªprotoèŠ‚ç‚¹ for(proto = mxmlFindElement(tree,tree,\"proto\",\"name\",NULL,MXML_DESCEND);proto!=NULL;proto = mxmlFindElement(proto,tree,\"proto\",\"name\",NULL,MXML_DESCEND)){ class = mxmlFindElement(proto,tree,\"proto-class\",NULL,NULL,MXML_DESCEND); suit = mxmlFindElement(proto,tree,\"proto-suit\",NULL,NULL,MXML_DESCEND); desc = mxmlFindElement(proto,tree,\"proto-desc\",NULL,NULL,MXML_DESCEND); name = mxmlFindElement(proto,tree,\"dump-name\",NULL,NULL,MXML_DESCEND); //æ‹¿åˆ°ç¬¬ä¸€å±‚æ•°æ® printf(\"|proto:%s\\n\",mxmlElementGetAttr(proto,\"name\")); printf(\" |----class:%s\\n\",mxmlGetText(class,NULL)); printf(\" |----suit:%s\\n\",mxmlGetText(suit,NULL)); printf(\" |----desc:%s\\n\",mxmlGetText(desc,NULL)); printf(\" |----name:%s\\n\",mxmlGetText(name,NULL)); //éå†ç¬¬äºŒå±‚meta-data for(meta_data = mxmlFindElement(proto,proto,\"meta-data\",\"name\",NULL,MXML_DESCEND);meta_data!=NULL;meta_data = mxmlFindElement(meta_data,proto,\"meta-data\",\"name\",NULL,MXML_DESCEND)){ //æ‹¿åˆ°ç¬¬äºŒå±‚æ•°æ® dump_on = mxmlFindElement(meta_data,proto,\"dump-on\",NULL,NULL,MXML_DESCEND); dump_id = mxmlFindElement(meta_data,proto,\"dump-id\",NULL,NULL,MXML_DESCEND); dump_format = mxmlFindElement(meta_data,proto,\"dump-format\",NULL,NULL,MXML_DESCEND); dump_name = mxmlFindElement(meta_data,proto,\"dump-name\",NULL,NULL,MXML_DESCEND); printf(...,mxmlGetText(...)); ... } } mxmlDelete(tree); fclose(fp); ","date":"2018-05-07","objectID":"/20180507_mxml/:4:0","tags":["C"],"title":"The realization of the MXML","uri":"/20180507_mxml/"},{"categories":["Technology"],"content":"Article description.","date":"2018-04-05","objectID":"/20180405_hashcode/","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"Hash table is a very important data structure, which is useful in many application scenarios. This paper will simply analyze the principle of hash table, and use C language to achieve a complete HashMap. ","date":"2018-04-05","objectID":"/20180405_hashcode/:0:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"1. ä»€ä¹ˆæ˜¯HashMapï¼Ÿ å­˜å‚¨æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§çº¿æ€§å­˜å‚¨å’Œé“¾å¼å­˜å‚¨ï¼Œå¸¸è§çš„çº¿æ€§å­˜å‚¨ä¾‹å¦‚æ•°ç»„ï¼Œå¸¸è§çš„é“¾å¼å­˜å‚¨å¦‚é“¾è¡¨ã€äºŒå‰æ ‘ç­‰ã€‚å“ˆå¸Œè¡¨çš„å­˜å‚¨ä¸»å¹²ä¸ºçº¿æ€§å­˜å‚¨ï¼Œè¿™ä¹Ÿæ˜¯å®ƒåœ¨ç†æƒ³çŠ¶æ€(æ— å†²çª)ä¸‹æ—¶é—´å¤æ‚åº¦ä¸ºO(1)çš„å…³é”®æ‰€åœ¨ã€‚æ™®é€šçº¿æ€§å­˜å‚¨çš„å­˜å‚¨å†…å®¹ä¸ç´¢å¼•åœ°å€ä¹‹é—´æ²¡æœ‰ä»»ä½•çš„è”ç³»ï¼Œåªèƒ½é€šè¿‡ç´¢å¼•åœ°å€æ¨ç®—å‡ºå­˜å‚¨å†…å®¹ï¼Œä¸èƒ½ä»å­˜å‚¨å†…å®¹æ¨ç®—å‡ºç´¢å¼•åœ°å€ï¼Œæ˜¯ä¸€ä¸ªå•å‘ä¸å¯é€†çš„è¿‡ç¨‹ï¼Œè€ŒHashMapå­˜å‚¨çš„æ˜¯ä¸€ä¸ª\u003ckey, value\u003eçš„é”®å€¼å¯¹ï¼Œé€šè¿‡keyå’Œç´¢å¼•åœ°å€å»ºç«‹äº†ä¸€å±‚å…³ç³»ï¼Œè¿™å±‚å…³ç³»ç§°ä¹‹ä¸ºå“ˆå¸Œå‡½æ•°(æˆ–æ•£åˆ—å‡½æ•°)ï¼Œè¿™æ ·æ—¢å¯ä»¥é€šè¿‡keyæ¨ç®—å‡ºç´¢å¼•åœ°å€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¨ç®—å‡ºçš„ç´¢å¼•åœ°å€ç›´æ¥å®šä½åˆ°é”®å€¼å¯¹ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒå‘å¯é€†çš„è¿‡ç¨‹ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯HashMapå¹¶ä¸ç›´æ¥æš´éœ²å‡ºé”®å€¼å¯¹çš„ç´¢å¼•åœ°å€ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å“ˆå¸Œå‡½æ•°æ¨ç®—å‡ºHashCodeï¼Œå…¶å®HashCodeå°±æ˜¯çœŸå®çš„ç´¢å¼•åœ°å€ã€‚ ","date":"2018-04-05","objectID":"/20180405_hashcode/:1:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"2. å®šä¹‰é”®å€¼å¯¹ç»“æ„ typedef struct entry { void * key; // é”® void * value; // å€¼ struct entry * next; // å†²çªé“¾è¡¨ }*Entry; #define newEntry() NEW(struct entry) #define newEntryList(length) (Entry)malloc(length * sizeof(struct entry)) å“ˆå¸Œå†²çªæ˜¯æŒ‡ä¸¤ä¸ªä¸åŒçš„keyå€¼å¾—åˆ°äº†ä¸€ä¸ªç›¸åŒçš„HashCodeï¼Œè¿™ç§æƒ…å†µç§°ä¹‹ä¸ºå“ˆå¸Œå†²çªï¼Œä¸€ä¸ªå¥½çš„å“ˆå¸Œå‡½æ•°å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†å“ˆå¸Œè¡¨çš„æ€§èƒ½ï¼Œä¸å­˜åœ¨ä¸€ç§é€‚åˆæ‰€æœ‰å“ˆå¸Œè¡¨çš„å“ˆå¸Œå‡½æ•°ï¼Œåœ¨å¾ˆå¤šç‰¹å®šçš„æƒ…æ™¯ä¸‹ï¼Œéœ€è¦æœ‰é’ˆå¯¹æ€§çš„è®¾è®¡å“ˆå¸Œå‡½æ•°æ‰èƒ½è¾¾åˆ°ç†æƒ³çš„æ•ˆæœã€‚å½“ç„¶å•¦ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›ä¼˜ç§€çš„å“ˆå¸Œå‡½æ•°å¯ä»¥åº”å¯¹å¤§å¤šæ•°æƒ…å†µçš„ï¼Œå¯¹äºæ€§èƒ½è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„åœºæ™¯ç”¨è¿™äº›å°±å¯ä»¥äº†ã€‚ä½¿ç”¨HashMapçš„æ—¶å€™éš¾å…ä¼šå‘ç”Ÿå†²çªï¼Œå¸¸ç”¨çš„æ–¹æ³•ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šå†æ•£åˆ—æ³•å’Œé“¾åœ°å€æ³•ã€‚å†æ•£åˆ—æ³•å°±æ˜¯å‘ç”Ÿå†²çªæ—¶ä½¿ç”¨å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°é‡æ–°æ¨ç®—ï¼Œä¸€ç›´åˆ°ä¸å†²çªä¸ºæ­¢ï¼Œè¿™ç§æ–¹æ³•æœ‰æ—¶å€™ä¼šé€ æˆæ•°æ®å †ç§¯ï¼Œå°±æ˜¯å…ƒç´ æœ¬æ¥çš„HashCodeè¢«å…¶å®ƒå…ƒç´ å†æ•£åˆ—çš„HashCodeå ç”¨ï¼Œè¢«è¿«å†æ•£åˆ—ï¼Œå¦‚æ­¤æ¶æ€§å¾ªç¯ã€‚é“¾åœ°å€æ³•å°±æ˜¯åœ¨å†²çªçš„ä½ç½®å»ºç«‹ä¸€ä¸ªé“¾è¡¨ï¼Œå°†å†²çªå€¼æ”¾åœ¨é“¾è¡¨ä¸­ï¼Œæ£€ç´¢çš„æ—¶å€™éœ€è¦é¢å¤–çš„éå†å†²çªé“¾è¡¨ï¼Œæœ¬æ–‡é‡‡ç”¨çš„å°±æ˜¯é“¾åœ°å€æ³•ã€‚ ","date":"2018-04-05","objectID":"/20180405_hashcode/:2:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"3. å®šä¹‰HashMapç»“æ„ä½“ HashMapç»“æ„çš„å­˜å‚¨æœ¬ä½“æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå»ºç«‹ä¸€ä¸ªEntryæ•°ç»„ä½œä¸ºå­˜å‚¨ç©ºé—´ï¼Œç„¶åæ ¹æ®ä¼ å…¥çš„keyè®¡ç®—å‡ºHashCodeï¼Œå½“åšæ•°ç»„çš„ç´¢å¼•å­˜å…¥æ•°æ®ï¼Œè¯»å–çš„æ—¶å€™é€šè¿‡è®¡ç®—å‡ºçš„HashCodeå¯ä»¥åœ¨æ•°ç»„ä¸­ç›´æ¥å–å‡ºå€¼ã€‚ sizeæ˜¯å½“å‰å­˜å‚¨é”®å€¼å¯¹çš„æ•°é‡ï¼Œè€ŒlistSizeæ˜¯å½“å‰æ•°ç»„çš„å¤§å°ï¼Œä»”ç»†è§‚å¯Ÿé”®å€¼å¯¹ç»“æ„ä¼šå‘ç°ï¼Œæ•°ç»„çš„æ¯ä¸€é¡¹å…¶å®éƒ½æ˜¯å†²çªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚å› ä¸ºå†²çªçš„å­˜åœ¨ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´sizeå¤§äºlistSizeï¼Œå½“sizeå¤§äºlistSizeçš„æ—¶å€™ä¸€å®šå‘ç”Ÿäº†å†²çªï¼Œè¿™æ—¶å€™å°±ä¼šæ‰©å®¹ã€‚ åœ¨ç»“æ„ä½“ä¸­æ”¾äº†ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ï¼Œå› ä¸ºCè¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œä¸ºäº†ä¾¿äºå†…éƒ¨å°è£…(ç»å¸¸ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™)ï¼Œå¯ä»¥è®©ç”¨æˆ·è‡ªå®šä¹‰ä¸€ä¸ªæ–¹æ³•è€Œä¸å½±å“å…¶å®ƒæ–¹æ³•çš„è°ƒç”¨ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œputæ–¹æ³•ä¸­è°ƒç”¨äº†hashCodeå‡½æ•°ï¼Œå¦‚æœæƒ³è‡ªå®šä¹‰ä¸€ä¸ªhashCodeæ–¹æ³•ï¼Œè¿«ä¸å¾—å·²è¿˜è¦å†å®ç°ä¸€ä¸ªputæ–¹æ³•ï¼Œå“ªæ€•putä¸­åªæ”¹äº†ä¸€è¡Œä»£ç ã€‚ ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š // å“ˆå¸Œç»“æ„ typedef struct hashMap *HashMap; #define newHashMap() NEW(struct hashMap) // å“ˆå¸Œå‡½æ•°ç±»å‹ typedef int(*HashCode)(HashMap, void * key); // åˆ¤ç­‰å‡½æ•°ç±»å‹ typedef Boolean(*Equal)(void * key1, void * key2); // æ·»åŠ é”®å‡½æ•°ç±»å‹ typedef void(*Put)(HashMap hashMap, void * key, void * value); // è·å–é”®å¯¹åº”å€¼çš„å‡½æ•°ç±»å‹ typedef void * (*Get)(HashMap hashMap, void * key); // åˆ é™¤é”®çš„å‡½æ•°ç±»å‹ typedef Boolean(*Remove)(HashMap hashMap, void * key); // æ¸…ç©ºMapçš„å‡½æ•°ç±»å‹ typedef void(*Clear)(HashMap hashMap); // åˆ¤æ–­é”®å€¼æ˜¯å¦å­˜åœ¨çš„å‡½æ•°ç±»å‹ typedef Boolean(*Exists)(HashMap hashMap, void * key); typedef struct hashMap { int size; // å½“å‰å¤§å° int listSize; // æœ‰æ•ˆç©ºé—´å¤§å° HashCode hashCode; // å“ˆå¸Œå‡½æ•° Equal equal; // åˆ¤ç­‰å‡½æ•° Entry list; // å­˜å‚¨åŒºåŸŸ Put put; // æ·»åŠ é”®çš„å‡½æ•° Get get; // è·å–é”®å¯¹åº”å€¼çš„å‡½æ•° Remove remove; // åˆ é™¤é”® Clear clear; // æ¸…ç©ºMap Exists exists; // åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ Boolean autoAssign; // è®¾å®šæ˜¯å¦æ ¹æ®å½“å‰æ•°æ®é‡åŠ¨æ€è°ƒæ•´å†…å­˜å¤§å°ï¼Œé»˜è®¤å¼€å¯ }*HashMap; // é»˜è®¤å“ˆå¸Œå‡½æ•° static int defaultHashCode(HashMap hashMap, void * key); // é»˜è®¤åˆ¤æ–­é”®å€¼æ˜¯å¦ç›¸ç­‰ static Boolean defaultEqual(void * key1, void * key2); // é»˜è®¤æ·»åŠ é”®å€¼å¯¹ static void defaultPut(HashMap hashMap, void * key, void * value); // é»˜è®¤è·å–é”®å¯¹åº”å€¼ static void * defaultGet(HashMap hashMap, void * key); // é»˜è®¤åˆ é™¤é”® static Boolean defaultRemove(HashMap hashMap, void * key); // é»˜è®¤åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ static Boolean defaultExists(HashMap hashMap, void * key); // é»˜è®¤æ¸…ç©ºMap static void defaultClear(HashMap hashMap); // åˆ›å»ºä¸€ä¸ªå“ˆå¸Œç»“æ„ HashMap createHashMap(HashCode hashCode, Equal equal); // é‡æ–°æ„å»º static void resetHashMap(HashMap hashMap, int listSize); HashMapçš„æ‰€æœ‰å±æ€§æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼Œåˆ›å»ºHashMapæ—¶å¯ä»¥æŒ‡å®šå“ˆå¸Œå‡½æ•°å’Œåˆ¤ç­‰å‡½æ•°(ç”¨äºæ¯”è¾ƒä¸¤ä¸ªkeyæ˜¯å¦ç›¸ç­‰)ï¼Œä¼ å…¥NULLæ—¶å°†ä½¿ç”¨é»˜è®¤å‡½æ•°ã€‚è¿™äº›å‡½æ•°éƒ½è¢«è®¾ç½®ä¸ºäº†staticï¼Œåœ¨æ–‡ä»¶å¤–ä¸å¯è®¿é—®ã€‚ ","date":"2018-04-05","objectID":"/20180405_hashcode/:3:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"4. å“ˆå¸Œå‡½æ•° int defaultHashCode(HashMap hashMap, let key) { IN_STACK; string k = (string)key; unsigned long h = 0; while (*k) { h = (h \u003c\u003c 4) + *k++; unsigned long g = h \u0026 0xF0000000L; if (g) { h ^= g \u003e\u003e 24; } h \u0026= ~g; } OUT_STACK; return h % hashMap-\u003elistSize; } keyçš„ç±»å‹ä¸ºvoid *ï¼Œæ˜¯ä¸€ä¸ªä»»æ„ç±»å‹ï¼ŒHashMapæœ¬èº«ä¹Ÿæ²¡æœ‰è§„å®škeyå€¼ä¸€å®šæ˜¯stringç±»å‹ï¼Œä¸Šé¢çš„å“ˆå¸Œå‡½æ•°åªé’ˆå¯¹stringç±»å‹ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€è¦æ›¿æ¢æˆå…¶ä»–ã€‚ ","date":"2018-04-05","objectID":"/20180405_hashcode/:4:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"5. putå‡½æ•° ç”¨äºåœ¨å“ˆå¸Œè¡¨ä¸­å­˜å…¥ä¸€ä¸ªé”®å€¼å¯¹ï¼Œé¦–å…ˆå…ˆæ¨ç®—å‡ºHashCodeï¼Œç„¶ååˆ¤æ–­è¯¥åœ°å€æ˜¯å¦å·²ç»æœ‰æ•°æ®ï¼Œå¦‚æœå·²æœ‰çš„keyå€¼å’Œå­˜å…¥çš„keyå€¼ç›¸åŒï¼Œæ”¹å˜valueå³å¯ï¼Œå¦åˆ™ä¸ºå†²çªï¼Œéœ€è¦æŒ‚åˆ°å†²çªé“¾å°¾éƒ¨ï¼Œè¯¥åœ°å€æ²¡æœ‰æ•°æ®æ—¶ç›´æ¥å­˜å‚¨ã€‚å®ç°å¦‚ä¸‹ï¼š void resetHashMap(HashMap hashMap, int listSize) { if (listSize \u003c 8) return; // é”®å€¼å¯¹ä¸´æ—¶å­˜å‚¨ç©ºé—´ Entry tempList = newEntryList(hashMap-\u003esize); HashMapIterator iterator = createHashMapIterator(hashMap); int length = hashMap-\u003esize; for (int index = 0; hasNextHashMapIterator(iterator); index++) { // è¿­ä»£å–å‡ºæ‰€æœ‰é”®å€¼å¯¹ iterator = nextHashMapIterator(iterator); tempList[index].key = iterator-\u003eentry-\u003ekey; tempList[index].value = iterator-\u003eentry-\u003evalue; tempList[index].next = NULL; } freeHashMapIterator(\u0026iterator); // æ¸…é™¤åŸæœ‰é”®å€¼å¯¹æ•°æ® hashMap-\u003esize = 0; for (int i = 0; i \u003c hashMap-\u003elistSize; i++) { Entry current = \u0026hashMap-\u003elist[i]; current-\u003ekey = NULL; current-\u003evalue = NULL; if (current-\u003enext != NULL) { while (current-\u003enext != NULL) { Entry temp = current-\u003enext-\u003enext; free(current-\u003enext); current-\u003enext = temp; } } } // æ›´æ”¹å†…å­˜å¤§å° hashMap-\u003elistSize = listSize; Entry relist = (Entry)realloc(hashMap-\u003elist, hashMap-\u003elistSize * sizeof(struct entry)); if (relist != NULL) { hashMap-\u003elist = relist; relist = NULL; } // åˆå§‹åŒ–æ•°æ® for (int i = 0; i \u003c hashMap-\u003elistSize; i++) { hashMap-\u003elist[i].key = NULL; hashMap-\u003elist[i].value = NULL; hashMap-\u003elist[i].next = NULL; } // å°†æ‰€æœ‰é”®å€¼å¯¹é‡æ–°å†™å…¥å†…å­˜ for (int i = 0; i \u003c length; i++) { Array x = tempList[i].value; hashMap-\u003eput(hashMap, tempList[i].key, tempList[i].value); } free(tempList); } void defaultPut(HashMap hashMap, let key, let value) { if (hashMap-\u003eautoAssign \u0026\u0026 hashMap-\u003esize \u003e= hashMap-\u003elistSize) { // å†…å­˜æ‰©å……è‡³åŸæ¥çš„ä¸¤å€ // *æ³¨: æ‰©å……æ—¶è€ƒè™‘çš„æ˜¯å½“å‰å­˜å‚¨å…ƒç´ æ•°é‡ä¸å­˜å‚¨ç©ºé—´çš„å¤§å°å…³ç³»ï¼Œè€Œä¸æ˜¯å­˜å‚¨ç©ºé—´æ˜¯å¦å·²ç»å­˜æ»¡ï¼Œ // ä¾‹å¦‚: å­˜å‚¨ç©ºé—´ä¸º10ï¼Œå­˜å…¥äº†10ä¸ªé”®å€¼å¯¹ï¼Œä½†æ˜¯å…¨éƒ¨å†²çªäº†ï¼Œæ‰€ä»¥å­˜å‚¨ç©ºé—´ç©ºç€9ä¸ªï¼Œå…¶ä½™çš„å…¨éƒ¨æŒ‚åœ¨ä¸€ä¸ªä¸Šé¢ï¼Œ // è¿™æ ·æ£€ç´¢çš„æ—¶å€™å’Œéå†æŸ¥è¯¢æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†ï¼Œå¯ä»¥ç®€å•è¿™æ ·ç†è§£ï¼Œå½“æˆ‘å­˜å…¥ç¬¬11ä¸ªé”®å€¼å¯¹çš„æ—¶å€™ä¸€å®šä¼šå‘ç”Ÿå†²çªï¼Œ // è¿™æ˜¯ç”±å“ˆå¸Œå‡½æ•°æœ¬èº«çš„ç‰¹æ€§(å–æ¨¡)å†³å®šçš„ï¼Œå†²çªå°±ä¼šå¯¼è‡´æ£€ç´¢å˜æ…¢ï¼Œæ‰€ä»¥è¿™æ—¶å€™æ‰©å……å­˜å‚¨ç©ºé—´ï¼Œå¯¹åŸæœ‰é”®å€¼å¯¹è¿›è¡Œ // å†æ¬¡æ•£åˆ—ï¼Œä¼šæŠŠå†²çªçš„æ•°æ®å†æ¬¡åˆ†æ•£å¼€ï¼ŒåŠ å¿«ç´¢å¼•å®šä½é€Ÿåº¦ã€‚ resetHashMap(hashMap, hashMap-\u003elistSize * 2); } int index = hashMap-\u003ehashCode(hashMap, key); if (hashMap-\u003elist[index].key == NULL) { hashMap-\u003esize++; // è¯¥åœ°å€ä¸ºç©ºæ—¶ç›´æ¥å­˜å‚¨ Array x = value; hashMap-\u003elist[index].key = key; hashMap-\u003elist[index].value = value; } else { Entry current = \u0026hashMap-\u003elist[index]; while (current != NULL) { if (hashMap-\u003eequal(key, current-\u003ekey)) { // å¯¹äºé”®å€¼å·²ç»å­˜åœ¨çš„ç›´æ¥è¦†ç›– current-\u003evalue = value; return; } current = current-\u003enext; }; // å‘ç”Ÿå†²çªåˆ™åˆ›å»ºèŠ‚ç‚¹æŒ‚åˆ°ç›¸åº”ä½ç½®çš„nextä¸Š Entry entry = newEntry(); entry-\u003ekey = key; entry-\u003evalue = value; entry-\u003enext = hashMap-\u003elist[index].next; hashMap-\u003elist[index].next = entry; hashMap-\u003esize++; } } putå‡½æ•°è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŠŸèƒ½ï¼Œå½“sizeå¤§äºlistSizeæ—¶è¦ä¸»åŠ¨æ‰©å®¹ï¼Œè¿™ä¸ªåˆ¤å®šæ¡ä»¶çœ‹ä¼¼æœ‰äº›ä¸åˆç†ï¼Œå½“sizeå¤§äºlistSizeçš„æ—¶å€™å¯èƒ½å› ä¸ºå†²çªçš„å­˜åœ¨ï¼Œæ•°ç»„å¹¶æ²¡æœ‰å­˜æ»¡ï¼Œè¿™æ—¶å€™å°±æ‰©å®¹ä¸æ˜¯æµªè´¹å­˜å‚¨ç©ºé—´å—ï¼Ÿäº‹å®ç¡®å®å¦‚æ­¤ï¼Œä½†è¿™å…¶å®æ˜¯ä¸ºäº†åŠ å¿«æ£€ç´¢é€Ÿåº¦ä¸€ç§å¦¥åçš„åŠæ³•ï¼Œä¸Šæ–‡æåˆ°è¿‡ï¼Œå½“sizeå¤§äºlistSizeæ—¶ä¸€å®šä¼šå‘ç”Ÿå†²çªï¼Œå› ä¸ºå“ˆå¸Œå‡½æ•°ä¸ºäº†ä¸è¶Šç•Œï¼Œéƒ½ä¼šå°†è®¡ç®—å‡ºçš„HashCodeè¿›è¡Œå–ä½™æ“ä½œï¼Œè¿™å°±å¯¼è‡´HashCodeçš„ä¸ªæ•°ä¸€å…±å°±listSizeä¸ªï¼Œè¶…è¿‡è¿™ä¸ªä¸ªæ•°å°±ä¸€å®šä¼šå†²çªï¼Œå†²çªçš„è¶Šå¤šï¼Œæ£€ç´¢é€Ÿåº¦å°±è¶Šå‘O(n)é æ‹¢ï¼Œä¸ºäº†ä¿è¯ç´¢å¼•é€Ÿåº¦æ¶ˆè€—ä¸€å®šçš„ç©ºé—´è¿˜æ˜¯æ¯”è¾ƒåˆ’ç®—çš„ï¼Œæ‰©å®¹æ—¶ç›´æ¥å°†å®¹é‡å˜ä¸ºäº†å½“å‰çš„ä¸¤å€ï¼Œè¿™æ˜¯è€ƒè™‘åˆ°æ‰©å®¹æ—¶éœ€è¦å°†æ‰€æœ‰é‡æ–°è®¡ç®—æ‰€æœ‰å…ƒç´ çš„HashCodeï¼Œè¾ƒä¸ºæ¶ˆè€—æ—¶é—´ï¼Œæ‰€ä»¥åº”è¯¥å°½é‡çš„å‡å°‘æ‰©å®¹æ¬¡æ•°ã€‚ ","date":"2018-04-05","objectID":"/20180405_hashcode/:5:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"6. å…¶å®ƒå‡½æ•° let defaultGet(HashMap hashMap, let key) { int index = hashMap-\u003ehashCode(hashMap, key); Entry entry = \u0026hashMap-\u003elist[index]; while (entry-\u003ekey != NULL \u0026\u0026 !hashMap-\u003eequal(entry-\u003ekey, key)) { entry = entry-\u003enext; } return entry-\u003evalue; } Boolean defaultRemove(HashMap hashMap, let key) { int index = hashMap-\u003ehashCode(hashMap, key); Entry entry = \u0026hashMap-\u003elist[index]; if (entry-\u003ekey == NULL) { return False; } Boolean result = False; if (hashMap-\u003eequal(entry-\u003ekey, key)) { hashMap-\u003esize--; if (entry-\u003enext != NULL) { Entry temp = entry-\u003enext; entry-\u003ekey = temp-\u003ekey; entry-\u003evalue = temp-\u003evalue; entry-\u003enext = temp-\u003enext; free(temp); } else { entry-\u003ekey = entry-\u003evalue = NULL; } result = True; } else { Entry p = entry; entry = entry-\u003enext; while (entry != NULL) { if (hashMap-\u003eequal(entry-\u003ekey, key)) { hashMap-\u003esize--; p-\u003enext = entry-\u003enext; free(entry); result = True; break; } p = entry; entry = entry-\u003enext; }; } // å¦‚æœç©ºé—´å ç”¨ä¸è¶³ä¸€åŠï¼Œåˆ™é‡Šæ”¾å¤šä½™å†…å­˜ if (result \u0026\u0026 hashMap-\u003eautoAssign \u0026\u0026 hashMap-\u003esize \u003c hashMap-\u003elistSize / 2) { resetHashMap(hashMap, hashMap-\u003elistSize / 2); } return result; } Boolean defaultExists(HashMap hashMap, let key) { int index = hashMap-\u003ehashCode(hashMap, key); Entry entry = \u0026hashMap-\u003elist[index]; if (entry-\u003ekey == NULL) { return False; } if (hashMap-\u003eequal(entry-\u003ekey, key)) { return True; } if (entry-\u003enext != NULL) { do { if (hashMap-\u003eequal(entry-\u003ekey, key)) { return True; } entry = entry-\u003enext; } while (entry != NULL); return False; } else { return False; } } void defaultClear(HashMap hashMap) { for (int i = 0; i \u003c hashMap-\u003elistSize; i++) { // é‡Šæ”¾å†²çªå€¼å†…å­˜ Entry entry = hashMap-\u003elist[i].next; while (entry != NULL) { Entry next = entry-\u003enext; free(entry); entry = next; } hashMap-\u003elist[i].next = NULL; } // é‡Šæ”¾å­˜å‚¨ç©ºé—´ free(hashMap-\u003elist); hashMap-\u003elist = NULL; hashMap-\u003esize = -1; hashMap-\u003elistSize = 0; } HashMap createHashMap(HashCode hashCode, Equal equal) { HashMap hashMap = newHashMap(); hashMap-\u003esize = 0; hashMap-\u003elistSize = 8; hashMap-\u003ehashCode = hashCode == NULL ? defaultHashCode : hashCode; hashMap-\u003eequal = equal == NULL ? defaultEqual : equal; hashMap-\u003eexists = defaultExists; hashMap-\u003eget = defaultGet; hashMap-\u003eput = defaultPut; hashMap-\u003eremove = defaultRemove; hashMap-\u003eclear = defaultClear; hashMap-\u003eautoAssign = True; // èµ·å§‹åˆ†é…8ä¸ªå†…å­˜ç©ºé—´ï¼Œæº¢å‡ºæ—¶ä¼šè‡ªåŠ¨æ‰©å…… hashMap-\u003elist = newEntryList(hashMap-\u003elistSize); Entry p = hashMap-\u003elist; for (int i = 0; i \u003c hashMap-\u003elistSize; i++) { p[i].key = p[i].value = p[i].next = NULL; } return hashMap; } ","date":"2018-04-05","objectID":"/20180405_hashcode/:6:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"7. Iteratoræ¥å£ Iteratoræ¥å£æä¾›äº†éå†HashMapç»“æ„çš„æ–¹æ³•ï¼ŒåŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š // è¿­ä»£å™¨ç»“æ„ typedef struct hashMapIterator { Entry entry; // è¿­ä»£å™¨å½“å‰æŒ‡å‘ int count; // è¿­ä»£æ¬¡æ•° int hashCode; // é”®å€¼å¯¹çš„å“ˆå¸Œå€¼ HashMap hashMap; }*HashMapIterator; #define newHashMapIterator() NEW(struct hashMapIterator) // åˆ›å»ºä¸€ä¸ªå“ˆå¸Œç»“æ„ HashMap createHashMap(HashCode hashCode, Equal equal); // åˆ›å»ºå“ˆå¸Œç»“æ„è¿­ä»£å™¨ HashMapIterator createHashMapIterator(HashMap hashMap); // è¿­ä»£å™¨æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ª Boolean hasNextHashMapIterator(HashMapIterator iterator); // è¿­ä»£åˆ°ä¸‹ä¸€æ¬¡ HashMapIterator nextHashMapIterator(HashMapIterator iterator); // é‡Šæ”¾è¿­ä»£å™¨å†…å­˜ void freeHashMapIterator(HashMapIterator * iterator); å®ç°å¦‚ä¸‹: HashMapIterator createHashMapIterator(HashMap hashMap) { HashMapIterator iterator = newHashMapIterator(); iterator-\u003ehashMap = hashMap; iterator-\u003ecount = 0; iterator-\u003ehashCode = -1; iterator-\u003eentry = NULL; return iterator; } Boolean hasNextHashMapIterator(HashMapIterator iterator) { return iterator-\u003ecount \u003c iterator-\u003ehashMap-\u003esize ? True : False; } HashMapIterator nextHashMapIterator(HashMapIterator iterator) { if (hasNextHashMapIterator(iterator)) { if (iterator-\u003eentry != NULL \u0026\u0026 iterator-\u003eentry-\u003enext != NULL) { iterator-\u003ecount++; iterator-\u003eentry = iterator-\u003eentry-\u003enext; return iterator; } while (++iterator-\u003ehashCode \u003c iterator-\u003ehashMap-\u003elistSize) { Entry entry = \u0026iterator-\u003ehashMap-\u003elist[iterator-\u003ehashCode]; if (entry-\u003ekey != NULL) { iterator-\u003ecount++; iterator-\u003eentry = entry; break; } } } return iterator; } void freeHashMapIterator(HashMapIterator * iterator) { free(*iterator); *iterator = NULL; } ","date":"2018-04-05","objectID":"/20180405_hashcode/:7:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Technology"],"content":"8. ä½¿ç”¨æµ‹è¯• #define Put(map, key, value) map-\u003eput(map, (void *)key, (void *)value); #define Get(map, key) (char *)map-\u003eget(map, (void *)key) #define Remove(map, key) map-\u003eremove(map, (void *)key) #define Existe(map, key) map-\u003eexists(map, (void *)key) int main() { HashMap map = createHashMap(NULL, NULL); Put(map, \"asdfasdf\", \"asdfasdfds\"); Put(map, \"sasdasd\", \"asdfasdfds\"); Put(map, \"asdhfgh\", \"asdfasdfds\"); Put(map, \"4545\", \"asdfasdfds\"); Put(map, \"asdfaasdasdsdf\", \"asdfasdfds\"); Put(map, \"asdasg\", \"asdfasdfds\"); Put(map, \"qweqeqwe\", \"asdfasdfds\"); printf(\"key: 4545, exists: %s\\n\", Existe(map, \"4545\") ? \"true\" : \"false\"); printf(\"4545: %s\\n\", Get(map, \"4545\")); printf(\"remove 4545 %s\\n\", Remove(map, \"4545\") ? \"true\" : \"false\"); printf(\"remove 4545 %s\\n\", Remove(map, \"4545\") ? \"true\" : \"false\"); printf(\"key: 4545, exists: %s\\n\", Existe(map, \"4545\") ? \"true\" : \"false\"); HashMapIterator iterator = createHashMapIterator(map); while (hasNextHashMapIterator(iterator)) { iterator = nextHashMapIterator(iterator); printf(\"{ key: %s, value: %s, hashcode: %d }\\n\", (char *)iterator-\u003eentry-\u003ekey, (char *)iterator-\u003eentry-\u003evalue, iterator-\u003ehashCode); } map-\u003eclear(map); freeHashMapIterator(\u0026iterator); return 0; } è¿è¡Œç»“æœï¼š key: 4545, exists: true 4545: asdfasdfds remove 4545 true remove 4545 false key: 4545, exists: false { key: asdfasdf, value: asdfasdfds, hashcode: 2 } { key: asdhfgh, value: asdfasdfds, hashcode: 2 } { key: sasdasd, value: asdfasdfds, hashcode: 2 } { key: asdfaasdasdsdf, value: asdfasdfds, hashcode: 6 } { key: asdasg, value: asdfasdfds, hashcode: 7 } { key: qweqeqwe, value: asdfasdfds, hashcode: 9 } ","date":"2018-04-05","objectID":"/20180405_hashcode/:8:0","tags":["C","HashCode"],"title":"C language realize HashMap","uri":"/20180405_hashcode/"},{"categories":["Life"],"content":"Multiple shortcodes on top of built-in ones in Hugo. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:0:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"1 style Note Hugo extended version is necessary for style shortcode. style is a shortcode to insert custom style in your post. The style shortcode has two positional parameters. The first one is the custom style content, which supports nesting syntax in :(fab fa-sass fa-fw): SASS and \u0026 referring to this parent HTML element. And the second one is the tag name of the HTML element wrapping the content you want to change style, and whose default value is div. Example style input: {{\u003c style \"text-align:right; strong{color:#00b1ff;}\" \u003e}} This is a **right-aligned** paragraph. {{\u003c /style \u003e}} The rendered output looks like this: This is a right-aligned paragraph. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:1:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"2 link link shortcode is an alternative to Markdown link syntax. link shortcode can provide some other features and can be used in code blocks. The complete usage of local resource references is supported. The link shortcode has the following named parameters: href [required] (first positional parameter) Destination of the link. content [optional] (second positional parameter) Content of the link, default value is the value of href parameter. Markdown or HTML format is supported. title [optional] (third positional parameter) title attribute of the HTML a tag, which will be shown when hovering on the link. class [optional] class attribute of the HTML a tag. rel [optional] Additional rel attributes of the HTML a tag. Example link input: {{\u003c link \"https://assemble.io\" \u003e}} Or {{\u003c link href=\"https://assemble.io\" \u003e}} {{\u003c link \"mailto:contact@revolunet.com\" \u003e}} Or {{\u003c link href=\"mailto:contact@revolunet.com\" \u003e}} {{\u003c link \"https://assemble.io\" Assemble \u003e}} Or {{\u003c link href=\"https://assemble.io\" content=Assemble \u003e}} The rendered output looks like this: https://assemble.io mailto:contact@revolunet.com Assemble Example link input with a title: {{\u003c link \"https://github.com/upstage/\" Upstage \"Visit Upstage!\" \u003e}} Or {{\u003c link href=\"https://github.com/upstage/\" content=Upstage title=\"Visit Upstage!\" \u003e}} The rendered output looks like this (hover over the link, there should be a tooltip): Upstage ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:2:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"3 image image shortcode is an alternative to figure shortcode. image shortcode can take full advantage of the dependent libraries of lazysizes and lightGallery. The complete usage of local resource references is supported. The image shortcode has the following named parameters: src [required] (first positional parameter) URL of the image to be displayed. alt [optional] (second positional parameter) Alternate text for the image if the image cannot be displayed, default value is the value of src parameter. Markdown or HTML format is supported. caption [optional] (third positional parameter) Image caption. Markdown or HTML format is supported. title [optional] Image title that will be shown when hovering on the image. class [optional] class attribute of the HTML figure tag. src_s [optional] URL of the image thumbnail, used for lightgallery, default value is the value of src parameter. src_l [optional] URL of the HD image, used for lightgallery, default value is the value of src parameter. height [optional] height attribute of the image. width [optional] width attribute of the image. linked [optional] Whether the image needs to be hyperlinked, default value is true. rel [optional] Additional rel attributes of the HTML a tag, if linked parameter is set to true. Example image input: {{\u003c image src=\"/images/lighthouse.jpg\" caption=\"Lighthouse (`image`)\" src_s=\"/images/lighthouse-small.jpg\" src_l=\"/images/lighthouse-large.jpg\" \u003e}} The rendered output looks like this: ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:3:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"4 admonition The admonition shortcode supports 12 types of banners to help you put notice in your page. Markdown or HTML format in the content is supported. Note A note banner Abstract An abstract banner Info A info banner Tip A tip banner Success A success banner Question A question banner Warning A warning banner Failure A failure banner Danger A danger banner Bug A bug banner Example An example banner Quote A quote banner The admonition shortcode has the following named parameters: type [optional] (first positional parameter) Type of the admonition banner, default value is note. title [optional] (second positional parameter) Title of the admonition banner, default value is the value of type parameter. open [optional] (third positional parameter) Whether the content will be expandable by default, default value is true. Example admonition input: {{\u003c admonition type=tip title=\"This is a tip\" open=false \u003e}} A **tip** banner {{\u003c /admonition \u003e}} Or {{\u003c admonition tip \"This is a tip\" false \u003e}} A **tip** banner {{\u003c /admonition \u003e}} The rendered output looks like this: This is a tip A tip banner ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:4:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"5 mermaid The mermaid shortcode supports diagrams in Hugo with Mermaid library. The full documentation is provided in Theme Documentation - mermaid Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:5:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"6 echarts The echarts shortcode supports data visualization in Hugo with ECharts library. The full documentation is provided in Theme Documentation - echarts Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:6:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"7 mapbox The mapbox shortcode supports interactive maps in Hugo with Mapbox GL JS library. The full documentation is provided in Theme Documentation - mapbox Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:7:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"8 music The music shortcode embeds a responsive music player based on APlayer and MetingJS library. The full documentation is provided in Theme Documentation - music Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:8:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"9 bilibili The bilibili shortcode embeds a responsive video player for bilibili videos. The full documentation is provided in Theme Documentation - bilibili Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:9:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"10 typeit The typeit shortcode provides typing animation based on TypeIt library. The full documentation is provided in Theme Documentation - typeit Shortcode. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:10:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"11 script script is a shortcode to insert custom :(fab fa-js fa-fw): Javascript in your post. Note The script content can be guaranteed to be executed in order after all third-party libraries are loaded. So you are free to use third-party libraries. Example script input: {{\u003c script \u003e}} console.log('Hello'); {{\u003c /script \u003e}} You can see the output in the console of the developer tool. ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:11:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"12 raw raw is a shortcode to insert raw :(fab fa-html5 fa-fw): HTML content in your post. This is useful when you want to include some Markdown content to avoid being rendered or escaped by Hugo. Example raw input: Inline Formula: {{\u003c raw \u003e}}\\(\\mathbf{E}=\\sum_{i} \\mathbf{E}_{i}=\\mathbf{E}_{1}+\\mathbf{E}_{2}+\\mathbf{E}_{3}+\\cdots\\){{\u003c /raw \u003e}} Block Formula: {{\u003c raw \u003e}} \\[ a=b+c \\\\ d+e=f \\] {{\u003c /raw \u003e}} Raw content using Markdown syntax: {{\u003c raw \u003e}}**Hello**{{\u003c /raw \u003e}} The rendered output looks like this: Inline Formula: Block Formula: Raw content using Markdown syntax: ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:12:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"},{"categories":["Life"],"content":"13 person person is a shortcode to insert a link to a personal webpage marked up as h-card. The person shortcode has the following named parameters: url [required] (first positional parameter) URL of the personal page. name [required] (second positional parameter) Name of the person. text [optional] (third positional parameter) Text to display as hover tooltip of the link. picture [optional] (fourth positional parameter) A picture to use as personâ€™s avatar. nick [optional] Nickame of the person. Example person input: {{\u003c person url=\"https://evgenykuznetsov.org\" name=\"Evgeny Kuznetsov\" nick=\"nekr0z\" text=\"author of this shortcode\" picture=\"https://evgenykuznetsov.org/img/avatar.jpg\" \u003e}} This renders as â€‰Evgeny Kuznetsov (nekr0z). Without an explicitly given picture, a generic icon is used. This input: ","date":"2018-03-02","objectID":"/20180302_markdown-extended/:13:0","tags":["Markdown"],"title":"Documentation - Extended Shortcodes","uri":"/20180302_markdown-extended/"}]