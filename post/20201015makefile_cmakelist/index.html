
<!DOCTYPE html>
<html lang="en" data-figures="true" class="page" data-mode="dim">
  <head>
<title>Makefile Guide | JerrysBlog</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script async src="https://www.googletagmanager.com/gtag/js?id=XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'XXXXXXXXXX');
</script>
<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?XXXXXXXX";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>
<script async defer data-domain="Jerrysmd.github.io" 
src='https://plausible.io/js/plausible.js'>
</script>
<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="Article description.">
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@0x4c2">
<meta name="twitter:title" content="Makefile Guide" />
<meta property="og:url" content="https://Jerrysmd.github.io/post/20201015makefile_cmakelist/" />
<meta property="og:title" content="Makefile Guide" />
<meta property="og:description" content="Article description." />
<meta property="og:image" content="https://Jerrysmd.github.io/images/6.png" />

<link rel="apple-touch-icon" sizes="180x180" href="https://Jerrysmd.github.io/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Jerrysmd.github.io/icons/favicon-32x32.png">
<link rel="manifest" href="https://Jerrysmd.github.io/icons/site.webmanifest">

<link rel="canonical" href="https://Jerrysmd.github.io/post/20201015makefile_cmakelist/">

    

    
    
    <link rel="preload" href="https://Jerrysmd.github.io/css/styles.19822ef8d57c281b0ee1aa50d42585c2400da8137a121dec28cd58f48a7fec71bf92e0e20f91751c5622f183b719a2663b3c1766d877cd46e764de699307df61.css" integrity = "sha512-GYIu&#43;NV8KBsO4apQ1CWFwkANqBN6Eh3sKM1Y9Ip/7HG/kuDiD5F1HFYi8YO3GaJmOzwXZth3zUbnZN5pkwffYQ==" as="style" crossorigin="anonymous">
    <link rel="preload" href="https://Jerrysmd.github.io/js/bundle.min.9ca7b3d7715f2d4c918b1f94a57a8deb4983dfbd453f3a73fd1e213e11fbc2380f43e7d0e6c4e73fb59c199ecfc108ef8c4737fab7b04b71eab59766ac444ff7.js" as="script" integrity=
    "sha512-nKez13FfLUyRix&#43;UpXqN60mD371FPzpz/R4hPhH7wjgPQ&#43;fQ5sTnP7WcGZ7PwQjvjEc3&#43;rewS3HqtZdmrERP9w==" crossorigin="anonymous">

    
    <link rel="stylesheet" type="text/css" href="https://Jerrysmd.github.io/css/styles.19822ef8d57c281b0ee1aa50d42585c2400da8137a121dec28cd58f48a7fec71bf92e0e20f91751c5622f183b719a2663b3c1766d877cd46e764de699307df61.css" integrity="sha512-GYIu&#43;NV8KBsO4apQ1CWFwkANqBN6Eh3sKM1Y9Ip/7HG/kuDiD5F1HFYi8YO3GaJmOzwXZth3zUbnZN5pkwffYQ==" crossorigin="anonymous">
    
  </head>
  
  
  
    
  <body data-code="40" data-lines="true" id="documentTop">

<header class="nav_header" >
  <nav class="nav"><a href='https://Jerrysmd.github.io/' class="nav_brand nav_item" title="JerrysBlog">
  <img src="https://Jerrysmd.github.io/logos/logo.png" class="logo" alt="JerrysBlog">
  <div class="nav_close">
    <div><svg class="icon">
  <use xlink:href="#open-menu"></use>
</svg><svg class="icon">
  <use xlink:href="#closeme"></use>
</svg></div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://Jerrysmd.github.io/" class="nav_item" title="Home">Home </a>
  </div>
  <div class="nav_parent">
    <a href="https://Jerrysmd.github.io/about/" class="nav_item" title="About">About </a>
  </div>
      
<div class='follow'>
    
    
  <a href="https://github.com/Jerrysmd#">
    <svg class="icon">
  <use xlink:href="#github"></use>
</svg>
  </a>
    
    
  <a href="https://twitter.com/ZJ1IFlOSupZnr7W#">
    <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
  </a>
    
    
  <a href="https://www.linkedin.com/in/#">
    <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
  </a>
    
    
  <a href="https://www.instagram.com/0x4c2/#">
    <svg class="icon">
  <use xlink:href="#instagram"></use>
</svg>
  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">Makefile Guide</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <use xlink:href="#calendar"></use>
</svg></span>
    <span class="post_date">
      Oct 15, 2020</span>
    <span class="post_time"> · 4 min read</span><span>&nbsp;· <a href='https://Jerrysmd.github.io/tags/c' title="c" class="post_tag button button_translucent">c
        </a><a href='https://Jerrysmd.github.io/tags/c&#43;&#43;' title="c&#43;&#43;" class="post_tag button button_translucent">c&#43;&#43;
        </a>
    </span>
    <span class="page_only">&nbsp;·
  <div class="post_share">
    Share on:
    <a href="https://twitter.com/intent/tweet?text=Makefile%20Guide&url=https%3a%2f%2fJerrysmd.github.io%2fpost%2f20201015makefile_cmakelist%2f&tw_p=tweetbutton" class="twitter" title="Share on Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fJerrysmd.github.io%2fpost%2f20201015makefile_cmakelist%2f&t=Makefile%20Guide" class="facebook" title="Share on Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#facebook"></use>
</svg>
    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="Share on LinkedIn" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
    </a>
    <a href="https://Jerrysmd.github.io/post/20201015makefile_cmakelist/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <use xlink:href="#copy"></use>
</svg>
    </a>
  </div>
  </span>
  </div>

    
    
    <h2>Overview</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#关于程序的编译和链接">关于程序的编译和链接</a></li>
    <li><a href="#makefile-介绍">Makefile 介绍</a>
      <ul>
        <li><a href="#1-makefile-规则">1. Makefile 规则</a></li>
        <li><a href="#2----含义">2. $@, $^, $&lt; 含义</a></li>
        <li><a href="#3-make是如何工作的">3. make是如何工作的</a></li>
        <li><a href="#4-makefile中使用变量">4. makefile中使用变量</a></li>
        <li><a href="#5-make自动推导">5. make自动推导</a></li>
        <li><a href="#6-makefile的收缩">6. makefile的收缩</a></li>
        <li><a href="#7-清空目标文件的规则">7. 清空目标文件的规则</a></li>
      </ul>
    </li>
    <li><a href="#makefile总述">Makefile总述</a>
      <ul>
        <li><a href="#1-makefile里有什么">1. Makefile里有什么</a></li>
        <li><a href="#2-makefile的文件名">2. Makefile的文件名</a></li>
        <li><a href="#3-引用其他的makefile">3. 引用其他的Makefile</a></li>
        <li><a href="#4-环境变量makefiles">4. 环境变量Makefiles</a></li>
        <li><a href="#5-make的工作方式">5. make的工作方式</a></li>
      </ul>
    </li>
    <li><a href="#makefile书写规则">Makefile书写规则</a>
      <ul>
        <li><a href="#1-makefile规则">1. Makefile规则</a></li>
        <li><a href="#2-规则的语法">2. 规则的语法</a></li>
        <li><a href="#3-在规则中使用通配符">3. 在规则中使用通配符</a></li>
        <li><a href="#4-静态模式">4. 静态模式</a></li>
      </ul>
    </li>
    <li><a href="#makefile书写命令">Makefile书写命令</a>
      <ul>
        <li><a href="#1-显示命令">1. 显示命令</a></li>
        <li><a href="#2赋值命令">2.赋值命令</a></li>
        <li><a href="#3-指定目标">3. 指定目标</a></li>
        <li><a href="#4-自动化变量">4. 自动化变量</a></li>
      </ul>
    </li>
  </ul>
</nav>
    <p>Makefile定义了一系列的规则来指定，哪些文件需要先编译，哪些文件需要后编译，哪些文件需要重新编译，甚至于进行更复杂的功能操作，因为makefile就像一个Shell脚本一样，其中也可以执行操作系统的命令。makefile带来的好处就是——“自动化编译”，整个工程完全自动编译，极大的提高了软件开发的效率。</p>
<h2 id="关于程序的编译和链接">关于程序的编译和链接</h2>
<p>无论是C还是C++，首先要把源文件编译成中间代码文件，在Windows下也就是 .obj 文件，UNIX下是 .o 文件，即 Object File，这个动作叫做<!-- raw HTML omitted -->编译（compile）<!-- raw HTML omitted -->。然后再把大量的Object File合成执行文件，这个动作叫作<!-- raw HTML omitted -->链接（link）。<!-- raw HTML omitted --></p>
<p>编译时，编译器需要的是语法的正确，函数与变量的声明的正确。对于后者，通常需要告诉编译器头文件的所在位置（头文件中应该只是声明，而定义应该放在C/C++文件中），只要所有的语法正确，编译器就可以编译出中间目标文件。一般来说，每个源文件都应该对应于一个中间目标文件（O文件或是OBJ文件）。</p>
<p>链接时，主要是链接函数和全局变量，所以，我们可以使用这些中间目标文件（O文件或是OBJ文件）来链接我们的应用程序。链接器并不管函数所在的源文件，只管函数的中间目标文件（Object File），在大多数时候，由于源文件太多，编译生成的中间目标文件太多，而在链接时需要明显地指出中间目标文件名，这对于编译很不方便，所以，我们要给中间目标文件打个包，在Windows下这种包叫“库文件”（Library File)，也就是 .lib 文件，在UNIX下，是Archive File，也就是 .a 文件。</p>
<p>总结一下，源文件首先会生成中间目标文件，再由中间目标文件生成执行文件。在编译时，编译器只检测程序语法，和函数、变量是否被声明。如果函数未被声明，编译器会给出一个警告，但可以生成Object File。而在链接程序时，链接器会在所有的Object File中找寻函数的实现，如果找不到，那到就会报链接错误码（Linker Error），在VC下，这种错误一般是：Link 2001错误，意思说是说，链接器未能找到函数的实现。需要指定函数的ObjectFile.</p>
<h2 id="makefile-介绍">Makefile 介绍</h2>
<p>make命令执行时，需要一个 Makefile 文件，以告诉make命令需要怎么样的去编译和链接程序。</p>
<p>首先，我们用一个示例来说明Makefile的书写规则。以便给大家一个感兴认识。这个示例来源于GNU的make使用手册，在这个示例中，我们的工程有8个C文件，和3个头文件，我们要写一个Makefile来告诉make命令如何编译和链接这几个文件。我们的规则是：</p>
<ol>
<li>如果这个工程没有编译过，那么我们的所有C文件都要编译并被链接。</li>
<li>如果这个工程的某几个C文件被修改，那么我们只编译被修改的C文件，并链接目标程序。</li>
<li>如果这个工程的头文件被改变了，那么我们需要编译引用了这几个头文件的C文件，并链接目标程序。</li>
</ol>
<h3 id="1-makefile-规则">1. Makefile 规则</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">target... </span><span style="color:#f92672">:</span> prerequisites ...
	command
<span style="color:#960050;background-color:#1e0010">...</span>
</code></pre></div><p>target也就是一个目标文件，可以是Object File，也可以是执行文件。还可以是一个标签（Label）</p>
<p>prerequisites就是，要生成那个target所需的文件或是目标。</p>
<p>command也就是make需要执行的命令。(任意的shell命令)</p>
<p>这是一个文件的依赖关系，也就是说，target这一个或多个的目标文件依赖于prerequisites中的文件，其生成规则定义在command中。也就是说，prerequisites中如果有一个以上的文件比target文件要新的话，command所定义的命令就会被执行。</p>
<h3 id="2----含义">2. $@, $^, $&lt; 含义</h3>
<ol>
<li>$@&ndash;目标文件</li>
<li>$^&ndash;所有的依赖文件</li>
<li>$&lt;&ndash;第一个依赖文件</li>
</ol>
<p>一个示例
如果一个工程有3个头文件，和8个C文件，我们为了完成前面所述的那三个规则，我们的Makefile应该是下面的这个样子的。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">edit </span><span style="color:#f92672">:</span> main.o kbd.o command.o display.o \
       insert.o search.o files.o utils.o
       cc -o edit main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>           insert.o search.o files.o utils.o

<span style="color:#a6e22e">main.o </span><span style="color:#f92672">:</span> main.c defs.h
         cc -c main.c

<span style="color:#a6e22e">kbd.o </span><span style="color:#f92672">:</span> kbd.c defs.h command.h
        cc -c kbd.c

<span style="color:#a6e22e">command.o </span><span style="color:#f92672">:</span> command.c defs.h command.h
            cc -c command.c

<span style="color:#a6e22e">display.o </span><span style="color:#f92672">:</span> display.c defs.h buffer.h
            cc -c display.c

<span style="color:#a6e22e">insert.o </span><span style="color:#f92672">:</span> insert.c defs.h buffer.h
           cc -c insert.c

<span style="color:#a6e22e">search.o </span><span style="color:#f92672">:</span> search.c defs.h buffer.h
           cc -c search.c

<span style="color:#a6e22e">files.o </span><span style="color:#f92672">:</span> files.c defs.h buffer.h command.h
          cc -c files.c

<span style="color:#a6e22e">utils.o </span><span style="color:#f92672">:</span> utils.c defs.h
          cc -c utils.c

<span style="color:#a6e22e">clean </span><span style="color:#f92672">:</span>
           rm edit main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>              insert.o search.o files.o utils.o
</code></pre></div><p>反斜杠（\）是换行符的意思。这样比较便于Makefile的易读。</p>
<p>在这个makefile中，目标文件（target）包含：执行文件edit和中间目标文件（*.o），依赖文件（prerequisites）就是冒号后面的那些 .c 文件和 .h文件。每一个 .o 文件都有一组依赖文件，而这些 .o 文件又是执行文件 edit 的依赖文件。依赖关系的实质上就是说明了目标文件是由哪些文件生成的，换言之，目标文件是哪些文件更新的。</p>
<p>在定义好依赖关系后，后续的那一行定义了如何生成目标文件的操作系统命令，一定要以一个Tab键作为开头。记住，make并不管命令是怎么工作的，他只管执行所定义的命令。make会比较targets文件和prerequisites文件的修改日期，如果prerequisites文件的日期要比targets文件的日期要新，或者target不存在的话，那么，make就会执行后续定义的命令。</p>
<h3 id="3-make是如何工作的">3. make是如何工作的</h3>
<p>在默认的方式下，也就是我们只输入make命令。那么，</p>
<ol>
<li>
<p>make会在当前目录下找名字叫“Makefile”或“makefile”的文件。</p>
</li>
<li>
<p>如果找到，它会找文件中的第一个目标文件（target），在上面的例子中，他会找到“edit”这个文件，并把这个文件作为最终的目标文件。</p>
</li>
<li>
<p>如果edit文件不存在，或是edit所依赖的后面的 .o 文件的文件修改时间要比edit这个文件新，那么，他就会执行后面所定义的命令来生成edit这个文件。</p>
</li>
<li>
<p>如果edit所依赖的.o文件也存在，那么make会在当前文件中找目标为.o文件的依赖性，如果找到则再根据那一个规则生成.o文件。</p>
</li>
<li>
<p>当然，C文件和H文件是存在的啦，于是make会生成 .o 文件，然后再用 .o 文件声明make的终极任务，也就是执行文件edit了。</p>
<p>这就是整个make的依赖性，make会一层又一层地去找文件的依赖关系，直到最终编译出第一个目标文件。在找寻的过程中，如果出现错误，比如最后被依赖的文件找不到，那么make就会直接退出，并报错，而对于所定义的命令的错误，或是编译不成功，make根本不理。make只管文件的依赖性</p>
<p>于是在我们编程中，如果这个工程已被编译过了，当我们修改了其中一个源文件，比如file.c，那么根据我们的依赖性，我们的目标file.o会被重编译（也就是在这个依性关系后面所定义的命令），于是file.o的文件也是最新的啦，于是file.o的文件修改时间要比edit要新，所以edit也会被重新链接了（详见edit目标文件后定义的命令）。</p>
<p>而如果我们改变了“command.h”，那么，kdb.o、command.o和files.o都会被重编译，并且，edit会被重链接。</p>
</li>
</ol>
<h3 id="4-makefile中使用变量">4. makefile中使用变量</h3>
<p>以edit的规则为例：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">edit</span><span style="color:#f92672">:</span>main.o kbd.o command.o display.o \
	 insert.o search.o files.o utills.o
<span style="color:#960050;background-color:#1e0010">cc</span> <span style="color:#960050;background-color:#1e0010">-o</span> <span style="color:#960050;background-color:#1e0010">edit</span> <span style="color:#960050;background-color:#1e0010">main.o</span> <span style="color:#960050;background-color:#1e0010">kbd.o</span> <span style="color:#960050;background-color:#1e0010">command.o</span> <span style="color:#960050;background-color:#1e0010">display.o</span> <span style="color:#960050;background-color:#1e0010">\</span>
		   <span style="color:#960050;background-color:#1e0010">insert.o</span> <span style="color:#960050;background-color:#1e0010">search.o</span> <span style="color:#960050;background-color:#1e0010">files.o</span> <span style="color:#960050;background-color:#1e0010">utils.o</span>
</code></pre></div><p>看到[.o]文件的字符串被重复了两次，如果我们的工程需要加入新的[.o]文件，那么需要在两个地方加。因为此时的makefile并不复杂。当makefile变得复杂我们就有可能忘掉某个地方，而导致编译失败。所以为了makefile的易维护，在makefile中可以使用变量。</p>
<p>比如我们声明一个变量，objects, OBJECTS,objs,OBJS,或OBJ，表示obj文件。在makefile一开始就定义</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile">objects <span style="color:#f92672">=</span> main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>		  insert.o search.o files.o utils.o
</code></pre></div><p>于是，就可以方便的在makefile中以&quot;$(objects)&ldquo;的方式来使用这个变量了。改良后的makefile如下：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile">objects <span style="color:#f92672">=</span> main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>		insert.o search.o files.o utils.o
<span style="color:#a6e22e">edit </span><span style="color:#f92672">:</span> <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
		cc -o edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
<span style="color:#a6e22e">main.o </span><span style="color:#f92672">:</span> main.c defs.h
		cc -c main.c
<span style="color:#a6e22e">command.o </span><span style="color:#f92672">:</span> command.c defs.h command.h
			cc -c command.c
<span style="color:#a6e22e">display.o </span><span style="color:#f92672">:</span> display.c defs.h buffer.h
           cc -c display.c
<span style="color:#a6e22e">insert.o </span><span style="color:#f92672">:</span> insert.c defs.h buffer.h
           cc -c insert.c
<span style="color:#a6e22e">search.o </span><span style="color:#f92672">:</span> search.c defs.h buffer.h
           cc -c search.c
<span style="color:#a6e22e">files.o </span><span style="color:#f92672">:</span> files.c defs.h buffer.h command.h
           cc -c files.c
<span style="color:#a6e22e">utils.o </span><span style="color:#f92672">:</span> utils.c defs.h
           cc -c utils.c
<span style="color:#a6e22e">clean </span><span style="color:#f92672">:</span>
	rm edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
</code></pre></div><p>于是如果有新的 .o 文件加入，只需修改一下 objects 变量就可以了。</p>
<h3 id="5-make自动推导">5. make自动推导</h3>
<p>GNU的make很强大，它可以自动推导文件以及文件依赖关系后面的命令，于是我们没有必要在每个[.o]文件写上依赖关系。make会自动识别，并自己推导命令。</p>
<p>只要make找到一个[.o]文件，它就会自动的把[.c]文件加在依赖关系中，如果make找到一个whatever.o，那么whatever.c等whatever.o的依赖文件，并且cc -c whatever.c也会被推导出来。于是makefile可以又一次简化。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile">objects <span style="color:#f92672">=</span> main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>		insert.o seaerch.o files.o utils.o
<span style="color:#a6e22e">edit </span><span style="color:#f92672">:</span> <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
	cc -o edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
<span style="color:#a6e22e">main.o </span><span style="color:#f92672">:</span> defs.h
<span style="color:#a6e22e">kbd.o </span><span style="color:#f92672">:</span> defs.h command.h
<span style="color:#a6e22e">command.o </span><span style="color:#f92672">:</span> defs.h command.h
<span style="color:#a6e22e">display.o </span><span style="color:#f92672">:</span> defs.h buffer.h
<span style="color:#a6e22e">insert.o </span><span style="color:#f92672">:</span> defs.h buffer.h
<span style="color:#a6e22e">search.o </span><span style="color:#f92672">:</span> defs.h buffer.h
<span style="color:#a6e22e">files.o </span><span style="color:#f92672">:</span> defs.h buffer.h command.h
<span style="color:#a6e22e">utils.o </span><span style="color:#f92672">:</span> defs.h

<span style="color:#a6e22e">.PHONY </span><span style="color:#f92672">:</span> clean
<span style="color:#a6e22e">clean </span><span style="color:#f92672">:</span>
		rm edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
</code></pre></div><p>这就是make的“隐晦规则”。</p>
<p>.PHONY表示，clean是个伪目标文件</p>
<h3 id="6-makefile的收缩">6. makefile的收缩</h3>
<p>收拢起来</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile">objects <span style="color:#f92672">=</span> main.o kbd.o command.o display.o <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    	insert.o search.o files.o utils.o
<span style="color:#a6e22e">edit </span><span style="color:#f92672">:</span> <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
		cc -o edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
<span style="color:#a6e22e">$(objects) </span><span style="color:#f92672">:</span> defs.h
<span style="color:#a6e22e">kbd.o command.o files.o </span><span style="color:#f92672">:</span> command.h
<span style="color:#a6e22e">display.o insert.o search.o files.o </span><span style="color:#f92672">:</span> buffer.h

<span style="color:#a6e22e">.PHONY </span><span style="color:#f92672">:</span> clean
<span style="color:#a6e22e">clean</span><span style="color:#f92672">:</span>
	rm edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
</code></pre></div><p>虽然makefile变得很简单，但我们的文件依赖关系会显得凌乱，新增.o文件不好管理</p>
<h3 id="7-清空目标文件的规则">7. 清空目标文件的规则</h3>
<p>每个Makefile中都应该写一个清空目标文件(.o和执行文件)的规则。</p>
<p>一般的风格是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">clean</span><span style="color:#f92672">:</span>
	rm edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
</code></pre></div><p>更稳健的做法是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">.PHONY</span><span style="color:#f92672">:</span> clean
<span style="color:#a6e22e">clean</span><span style="color:#f92672">:</span>
	-rm edit <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
</code></pre></div><p>.PHONY表示clean是一个“伪目标”，向make说明，不管是否有这个文件，这个目标就是“伪目标”。只要有这个声明，不管是否有“clean”文件，要运行“clean”这个目标，只有“make clean”这样。</p>
<p>而在rm命令前面加了一个减号表示也许某些文件出现问题，但不用管，继续往后执行。</p>
<p>当然，clean的规则不要放在文件的开头，不然，这就会变成make的默认目标。</p>
<p>“clean从来都是放在文件的最后”</p>
<h2 id="makefile总述">Makefile总述</h2>
<h3 id="1-makefile里有什么">1. Makefile里有什么</h3>
<p>Makefile主要包含了五个东西：<strong><!-- raw HTML omitted -->显示规则，隐晦规则，变量定义，文件指示和注释。<!-- raw HTML omitted --></strong></p>
<ol>
<li>显示规则：显示规则说明了如何生成一个或多个的目标文件。这是由Makefile书写者明显指出要生成的文件、文件的依赖文件、生成的命令。</li>
<li>隐晦规则：由于我们的make有自动推导功能，所以隐晦的规则可以让我们比较粗糙地简略书写Makefile，这是make支持的。</li>
<li>变量的定义：在Makefile中我们要定义一系列的变量，变量一般都是字符串，这个有点像C语言中的宏，当Makefile被执行时，其中的变量都会被扩展到相应的引用位置上。</li>
<li>文件指示：其中包括三个部分，一个是在Makefile中引用另一个Makefile，就像C中的#include一样；另一个是指根据某些情况指定Makefile中的有效部分，就像C语言中的预编译#if一样；还有就是定义一个多行的命令。</li>
<li>注释：Makefile中只有行注释，和UNIX的Shell脚本一样，其注释是用“#”字符，这个就像C/C++中的“//”一样。如果要在Makefile中使用“#”字符，可以用反斜框进行转义，如：“#”。</li>
</ol>
<p>最后，在Makefile中的命令，必须要以[Tab]键开始。</p>
<h3 id="2-makefile的文件名">2. Makefile的文件名</h3>
<p>默认的情况下，make命令会在当前目录下按顺序找寻文件名为**“GNUmakefile”、“makefile”、“Makefile”**的文件，找到了解释这个文件。在这三个文件名中，最好使用“Makefile”这个文件名，因为，这个文件名第一个字符为大写，这样有一种显目的感觉。最好不要用“GNUmakefile”，这个文件是GNU的make识别的。有另外一些make只对全小写的“makefile”文件名敏感，但是基本上来说，大多数的make都支持“**makefile”和“Makefile”**这两种默认文件名。</p>
<p>当然，可以使用别的文件名来书写Makefile，比如：“Make.Linux”，“Make.Solaris”，“Make.AIX”等，如果要****指定特定的Makefile，可以使用make的“-f”和“&ndash;file”参数****，如：make -f Make.Linux或make &ndash;file Make.AIX。</p>
<h3 id="3-引用其他的makefile">3. 引用其他的Makefile</h3>
<p>在Makefile使用include关键字可以把别的Makefile包含进来，这很像C语言的#include，被包含的文件会原模原样的放在当前文件的包含位置。include的语法是：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"> include filename
 <span style="color:#75715e">#filename可以是当前操作系统Shell的文件模式（可以保含路径和通配符）</span>
</code></pre></div><p><strong>在include前面可以有一些空字符，但是绝不能是[Tab]键开始。include和可以用一个或多个空格隔开。</strong></p>
<p>举个例子，有这样几个Makefile：a.mk、b.mk、c.mk，还有一个文件叫foo.make，以及一个变量$(bar)，其包含了e.mk和f.mk，那么，下面的语句：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#960050;background-color:#1e0010">include</span> <span style="color:#960050;background-color:#1e0010">foo.make</span> <span style="color:#960050;background-color:#1e0010">*.mk</span> <span style="color:#66d9ef">$(</span>bar<span style="color:#66d9ef">)</span>
<span style="color:#75715e">#等价于：
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">include</span> <span style="color:#960050;background-color:#1e0010">foo.make</span> <span style="color:#960050;background-color:#1e0010">a.mk</span> <span style="color:#960050;background-color:#1e0010">b.mk</span> <span style="color:#960050;background-color:#1e0010">c.mk</span> <span style="color:#960050;background-color:#1e0010">e.mk</span> <span style="color:#960050;background-color:#1e0010">f.mk</span>
</code></pre></div><p>make命令开始时，会把找寻include所指出的其它Makefile，并把其内容安置在当前的位置。就好像C/C++的#include指令一样。如果文件都没有指定绝对路径或是相对路径的话，make会在当前目录下首先寻找，如果当前目录下没有找到，那么，make还会在下面的几个目录下找：</p>
<ol>
<li>如果make执行时，有“-I”或“&ndash;include-dir”参数，那么make就会在这个参数所指定的目录下去寻找。</li>
<li>如果目录/include（一般是：/usr/local/bin或/usr/include）存在的话，make也会去找。</li>
</ol>
<p>如果有文件没有找到的话，make会生成一条警告信息，但不会马上出现致命错误。它会继续载入其它的文件，一旦完成makefile的读取，make会再重试这些没有找到，或是不能读取的文件，如果还是不行，make才会出现一条致命信息。如果想让make不理那些无法读取的文件，而继续执行，可以在include前加一个减号“-”。如：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#960050;background-color:#1e0010">-include&lt;filename&gt;</span>
</code></pre></div><p>其表示，无论include过程中出现什么错误，都不要报错继续执行。和其它版本make兼容的相关命令是sinclude，其作用和这一个是一样的。这个变量中的值是其它的Makefile，用空格分隔。只是，它和include不同的是，从这个环境变量中引入的Makefile的“目标”不会起作用，如果环境变量中定义的文件发现错误，make也会不理。</p>
<h3 id="4-环境变量makefiles">4. 环境变量Makefiles</h3>
<p>如果当前环境中定义了环境变量Makefiles，那么make会把这个变量中的值做一个类似于include的动作。这个变量中的值是其它的Makefile，用空格分隔。只是，它和include不同的是，从这个环境变中引入的Makefile的“目标”不会起作用，如果环境变量中定义的文件发现错误，make也会不理。</p>
<p>但还是建议不要使用这个环境变量，因为只要这个变量一旦被定义，那么当使用make时，所有的Makefile都会受到它的影响，这绝不是想看到的。在这里提这个事，只是为了告诉大家，也许有时候Makefile出现了怪事，那么可以看看当前环境中有没有定义这个变量。</p>
<h3 id="5-make的工作方式">5. make的工作方式</h3>
<p>GNU的make工作时执行步骤如下：</p>
<ol>
<li>读入所有的makefile</li>
<li>读入被include的其他makefile</li>
<li>初始化文件中的变量</li>
<li>推导隐晦规则，并分析所有规则</li>
<li>为所有的目标文件创建依赖关系链</li>
<li>根据依赖关系，决定哪些目标文件重新生成</li>
<li>执行生成命令</li>
</ol>
<p>1-5步为第一个阶段，6-7为第二个阶段。</p>
<p>第一个阶段中，如果定义被使用了，那么make会把其展开在使用的位置。但make并不会完全马上展开，如果变量出现在依赖关系的规则中，那么仅当这条依赖被决定要使用了，变量才会在内部展开</p>
<h2 id="makefile书写规则">Makefile书写规则</h2>
<h3 id="1-makefile规则">1. Makefile规则</h3>
<p>规则包含两个部分，一个是<strong>依赖关系</strong>，一个是<strong>生成目标的方法</strong>。</p>
<p><strong>在Makefile中，规则的顺序是很重要的</strong>，因为，<strong>Makefile中只应该有一个最终目标</strong>，其它的目标都是被这个目标所连带出来的，所以一定要让make知道你的最终目标是什么。一般来说，定义在Makefile中的目标可能会有很多，但是第一条规则中的目标将被确立为最终的目标。如果第一条规则中的目标有很多个，那么，第一个目标会成为最终的目标。make所完成的也就是这个目标。</p>
<p>规则举例</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"> foo.o: foo.c defs.h       <span style="color:#75715e"># foo模块</span>
        cc -c -g foo.c
</code></pre></div><p>foo.o是我们的目标，foo.c和defs.h是目标所依赖的源文件，而只有一个命令“cc -c -g foo.c”（以Tab键开头）</p>
<ol>
<li>文件的依赖关系，foo.o依赖于foo.c和defs.h的文件，如果foo.c和defs.h的文件日期要比foo.o文件日期要新，或是foo.o不存在，那么依赖关系发生。</li>
<li>如果生成（或更新）foo.o文件。也就是那个cc命令，其说明了，如何生成foo.o这个文件。（当然foo.c文件include了defs.h文件）</li>
</ol>
<h3 id="2-规则的语法">2. 规则的语法</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">targets </span><span style="color:#f92672">:</span> prerequisites
		command
<span style="color:#75715e">#或：
</span><span style="color:#75715e"></span><span style="color:#a6e22e">targets </span><span style="color:#f92672">:</span> prerequisites ; command
		command
</code></pre></div><ul>
<li>
<p>targets是文件名，以空格分开，可以使用通配符。一般来说，我们的目标基本上是一个文件，但也有可能是多个文件。</p>
</li>
<li>
<p>command是命令行，如果其不与“target:prerequisites”在一行，那么，必须以[Tab键]开头，如果和prerequisites在一行，那么可以用分号做为分隔</p>
</li>
<li>
<p>prerequisites也就是目标所依赖的文件（或依赖目标）。如果其中的某个文件要比目标文件要新，那么，目标就被认为是“过时的”，被认为是需要重生成的。</p>
</li>
<li>
<p>如果命令太长，你可以使用反斜框（‘\’）作为换行符。make对一行上有多少个字符没有限制。规则告诉make两件事，文件的依赖关系和如何成成目标文件。</p>
</li>
<li>
<p>一般来说，make会以UNIX的标准Shell，也就是/bin/sh来执行命令。</p>
</li>
</ul>
<h3 id="3-在规则中使用通配符">3. 在规则中使用通配符</h3>
<p>make支持三各通配符：“*”，“?”和“[&hellip;]”。这是和Unix的B-Shell是相同的。</p>
<ol>
<li>“~”：波浪号（“~”）字符在文件名中也有比较特殊的用途。如果是“~/test”，这就表示当前用户的$HOME目录下的test目录。而“~hchen/test”则表示用户hchen的宿主目录下的test目录。（这些都是Unix下的小知识了，make也支持）而在Windows或是MS-DOS下，用户没有宿主目录，那么波浪号所指的目录则根据环境变量“HOME”而定。</li>
<li>“*”：通配符代替了你一系列的文件，如“<em>.c”表示所以后缀为c的文件。一个需要我们注意的是，如果我们的文件名中有通配符，如：“</em>”，那么可以用转义字符“\”，如“*”来表示真实的“*”字符，而不是任意长度的字符串。</li>
</ol>
<h3 id="4-静态模式">4. 静态模式</h3>
<p>静态模式可以更加容易地定义多目标的规则，可以让我们的规则变得更加的有弹性和灵活。语法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">&lt;targets...&gt;</span><span style="color:#f92672">:</span> &lt;target-pattern&gt;: &lt;prereq-patterns ...&gt;
	&lt;commands&gt;
</code></pre></div><p>targets定义了一系列的目标文件，可以有通配符。是目标的一个集合。</p>
<p>target-parrtern是指明了targets的模式，也就是的目标集模式。</p>
<p>prereq-parrterns是目标的依赖模式，它对target-parrtern形成的模式再进行一次依赖目标的定义。</p>
<p>说明:</p>
<p>如果我们的<!-- raw HTML omitted -->定义成“%.o”，意思是我们的集合中都是以“.o”结尾的。</p>
<p>而如果我们的<!-- raw HTML omitted -->定义成“%.c”，意思是对<!-- raw HTML omitted -->所形成的目标集进行二次定义，其计算方法是，取<!-- raw HTML omitted -->模式中的“%”（也就是去掉了[.o]这个结尾），并为其加上[.c]这个结尾，形成的新集合。</p>
<p>所以，我们的“目标模式”或是“依赖模式”中都应该有“%”这个字符</p>
<p>实例：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile">objects <span style="color:#f92672">=</span> foo.o bar.o
<span style="color:#a6e22e">all</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">$(</span>objects<span style="color:#66d9ef">)</span>
<span style="color:#a6e22e">$(objects)</span><span style="color:#f92672">:</span> %.o: %.c
	<span style="color:#66d9ef">$(</span>CC<span style="color:#66d9ef">)</span> -c <span style="color:#66d9ef">$(</span>CFLAGS<span style="color:#66d9ef">)</span> $&lt; -o $@
</code></pre></div><p>例子中，指明了目标从$objects中获取</p>
<p>“%.o”表明要所有以“.o”结尾的目标，也就是&quot;foo.o bar.o&rdquo;，也就是变量$object集合的模式</p>
<p>而依赖模式“%.c”则取模式“%.o”的“%”，也就是“foobar”，并为其加下“.c”的后缀，于是，我们的依赖目标就是“foo.c bar.c”</p>
<p>而命令中的“$&lt;”和“$@”则是自动化变量，“$&lt;”表示所有的依赖目标集（也就是“foo.c bar.c”），“$@”表示目标集（也褪恰癴oo.o bar.o”）</p>
<p>上面的规则展开后等价于：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#a6e22e">foo.o </span><span style="color:#f92672">:</span> foo.c
	<span style="color:#66d9ef">$(</span>CC<span style="color:#66d9ef">)</span> -c <span style="color:#66d9ef">$(</span>CFLAGS<span style="color:#66d9ef">)</span> foo.c -o foo.o
<span style="color:#a6e22e">bar.o </span><span style="color:#f92672">:</span> bar.c
	<span style="color:#66d9ef">$(</span>CC<span style="color:#66d9ef">)</span> -c <span style="color:#66d9ef">$(</span>CFLAGS<span style="color:#66d9ef">)</span> bar.c -o bar.o
</code></pre></div><h2 id="makefile书写命令">Makefile书写命令</h2>
<h3 id="1-显示命令">1. 显示命令</h3>
<p>通常，make会把其要执行的命令行在命令执行前输出到屏幕上。当我们用“@”字符在命令行前，那么，这个命令将不被make显示出来，最具代表性的例子是，我们用这个功能来像屏幕显示一些信息。如：</p>
<p>@echo 正在编译XXX模块&hellip;&hellip;</p>
<h3 id="2赋值命令">2.赋值命令</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#75715e">#  = 是最基本的赋值
</span><span style="color:#75715e"># := 是覆盖之前的值
</span><span style="color:#75715e"># ?= 是如果没有被赋值过就赋予等号后面的值
</span><span style="color:#75715e"># += 是添加等号后面的值
</span></code></pre></div><h3 id="3-指定目标">3. 指定目标</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-makefile" data-lang="makefile"><span style="color:#960050;background-color:#1e0010">1.</span> <span style="color:#960050;background-color:#1e0010">“all”</span>       <span style="color:#960050;background-color:#1e0010">这个伪目标是所有目标的目标，其功能一般是编译所有的目标。</span>
<span style="color:#960050;background-color:#1e0010">2.</span> <span style="color:#960050;background-color:#1e0010">“clean”</span>     <span style="color:#960050;background-color:#1e0010">这个伪目标功能是删除所有被make创建的文件。</span>
<span style="color:#960050;background-color:#1e0010">3.</span> <span style="color:#960050;background-color:#1e0010">“install”</span>   <span style="color:#960050;background-color:#1e0010">这个伪目标功能是安装已编译好的程序，其实就是把目标执行文件拷贝到指定的目标中去。</span>
<span style="color:#960050;background-color:#1e0010">4.</span> <span style="color:#960050;background-color:#1e0010">“print”</span>     <span style="color:#960050;background-color:#1e0010">这个伪目标的功能是例出改变过的源文件。</span>
<span style="color:#960050;background-color:#1e0010">5.</span> <span style="color:#960050;background-color:#1e0010">“tar”</span>       <span style="color:#960050;background-color:#1e0010">这个伪目标功能是把源程序打包备份。也就是一个tar文件。</span>
<span style="color:#960050;background-color:#1e0010">6.</span> <span style="color:#960050;background-color:#1e0010">“dist”</span>      <span style="color:#960050;background-color:#1e0010">这个伪目标功能是创建一个压缩文件，一般是把tar文件压成Z文件。或是gz文件。</span>
<span style="color:#960050;background-color:#1e0010">7.</span> <span style="color:#960050;background-color:#1e0010">“TAGS”</span>      <span style="color:#960050;background-color:#1e0010">这个伪目标功能是更新所有的目标，以备完整地重编译使用。</span>
<span style="color:#960050;background-color:#1e0010">8.</span> <span style="color:#960050;background-color:#1e0010">“check”和“test”</span>   <span style="color:#960050;background-color:#1e0010">这两个伪目标一般用来测试makefile的流程。</span>
</code></pre></div><h3 id="4-自动化变量">4. 自动化变量</h3>
<ol>
<li>$@表示规则中的目标文件集。在模式规则中，如果有多个目标，那么，&quot;$@&ldquo;就是匹配于目标中模式定义的集合。</li>
<li>$%仅当目标是函数库文件中，表示规则中的目标成员名。例如，如果一个目标是&quot;foo.a(bar.o)&quot;，那么，&quot;$%&ldquo;就是&quot;bar.o&rdquo;，&quot;$@&ldquo;就是&quot;foo.a&rdquo;。如果目标不是函数库文件（Unix下是
[.a]，Windows下是[.lib]），那么，其值为空。</li>
<li>$&lt;依赖目标中的第一个目标名字。如果依赖目标是以模式（即&rdquo;%&quot;）定义的，那么&quot;$&lt;&ldquo;将是符合模式的一系列的文件集。注意，其是一个一个取出来的。</li>
<li>$?所有比目标新的依赖目标的集合。以空格分隔。</li>
<li>$^所有的依赖目标的集合。以空格分隔。如果在依赖目标中有多个重复的，那个这个变量会去除重复的依赖目标，只保留一份。</li>
<li>$+这个变量很像&rdquo;$^&quot;，也是所有依赖目标的集合。只是它不去除重复的依赖目标。</li>
<li>$*这个变量表示目标模式中&quot;%&ldquo;及其之前的部分。如果目标是&quot;dir/a.foo.b&rdquo;，并且目标的模式是&quot;a.%.b&quot;，那么，&quot;$*&ldquo;的值就是&quot;dir /a.foo&rdquo;。这个变量对于构造有关联的文件名是比
较有较。如果目标中没有模式的定义，那么&quot;$*&ldquo;也就不能被推导出，但是，如果目标文件的后缀是 make所识别的，那么&rdquo;$*&ldquo;就是除了后缀的那一部分。例如：如果目标是&quot;foo.c&rdquo;
，因为&quot;.c&quot;是make所能识别的后缀名，所以，&quot;$*&ldquo;的值就是&quot;foo&rdquo;。这个特性是GNU make的，很有可能不兼容于其它版本的make，所以，你应该尽量避免使用&quot;$*&quot;，除非是在隐含规则或是静态模式中。如果目标中的后缀是make所不能识别的，那么&quot;$*&ldquo;就是空值。</li>
</ol>

  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
        <h2>刘佳锐</h2>
      <div class="author_bio">
        Technologist, perpetual student, continual incremental improvement.
      </div>
      <a href='https://Jerrysmd.github.io/about/' class="button mt-1" role="button" title='Read More'>Read More</a>
    <h2 class="mt-4">Featured Posts</h2>
    <ul>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210331spark/" class="nav-link" title="Spark 简介: Spark Guide">Spark 简介: Spark Guide</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210308scalaintroduction/" class="nav-link" title="Scala 简介: Scala Introduction">Scala 简介: Scala Introduction</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201109cperformanceoptimization/" class="nav-link" title="C项目性能优化: C Project performance optimization">C项目性能优化: C Project performance optimization</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201020read_binary_file/" class="nav-link" title="文件读取的高级方法：Advanced method of reading files">文件读取的高级方法：Advanced method of reading files</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201012hyperscan/" class="nav-link" title="Hyperscan: high-performance multiple regex matching library">Hyperscan: high-performance multiple regex matching library</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201005hashcode/" class="nav-link" title="C语言实现HashMap: C language realize HashMap">C语言实现HashMap: C language realize HashMap</a>
      </li>
    </ul>
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://Jerrysmd.github.io/post/20210331spark/" class="nav-link" title="Spark 简介: Spark Guide">Spark 简介: Spark Guide</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210326hdfsnfs/" class="nav-link" title="HDFS &amp; NFS">HDFS &amp; NFS</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210308scalaintroduction/" class="nav-link" title="Scala 简介: Scala Introduction">Scala 简介: Scala Introduction</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210222javastatic/" class="nav-link" title="Static Keyword in Java">Static Keyword in Java</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210129copyinjava/" class="nav-link" title="Shallow Copy and Deep Copy in JAVA">Shallow Copy and Deep Copy in JAVA</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20210126gitcontribution/" class="nav-link" title="Git Contribution">Git Contribution</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201207u32/" class="nav-link" title="Various data types in C">Various data types in C</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201125structsize/" class="nav-link" title="The size of structure in C">The size of structure in C</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201117typedef/" class="nav-link" title="Typedef介绍: The descriptions of typedef">Typedef介绍: The descriptions of typedef</a>
      </li>
      <li>
        <a href="https://Jerrysmd.github.io/post/20201111conditionalcompilation/" class="nav-link" title="条件编译指令: Conditional compilation directives">条件编译指令: Conditional compilation directives</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">Categories</h2>
      <nav class="tags_nav">
        <a href='https://Jerrysmd.github.io/categories/technology/' class="post_tag button button_translucent" title="technology">
          TECHNOLOGY
          <span class="button_tally">23</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://Jerrysmd.github.io/tags/c/' class="post_tag button button_translucent" title="c">
          C
          <span class="button_tally">15</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/c&#43;&#43;/' class="post_tag button button_translucent" title="c&#43;&#43;">
          C&#43;&#43;
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/file/' class="post_tag button button_translucent" title="file">
          FILE
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/java/' class="post_tag button button_translucent" title="java">
          JAVA
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/linux/' class="post_tag button button_translucent" title="linux">
          LINUX
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/sql/' class="post_tag button button_translucent" title="sql">
          SQL
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/git/' class="post_tag button button_translucent" title="git">
          GIT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/hash/' class="post_tag button button_translucent" title="hash">
          HASH
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/hdfs/' class="post_tag button button_translucent" title="hdfs">
          HDFS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/hyperscan/' class="post_tag button button_translucent" title="hyperscan">
          HYPERSCAN
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/nfs/' class="post_tag button button_translucent" title="nfs">
          NFS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/python/' class="post_tag button button_translucent" title="python">
          PYTHON
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/scala/' class="post_tag button button_translucent" title="scala">
          SCALA
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://Jerrysmd.github.io/tags/spark/' class="post_tag button button_translucent" title="spark">
          SPARK
          <span class="button_tally">1</span>
        </a>
        
        
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/> 
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
</svg>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://Jerrysmd.github.io/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="JerrysBlog">
    <p>Copyright&nbsp;<span class="year"></span>&nbsp;JERRYSBLOG. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <use xlink:href="#arrow"></use>
</svg>
</a>

  </div>
</footer>

    <script type="text/javascript" src="https://Jerrysmd.github.io/js/bundle.min.9ca7b3d7715f2d4c918b1f94a57a8deb4983dfbd453f3a73fd1e213e11fbc2380f43e7d0e6c4e73fb59c199ecfc108ef8c4737fab7b04b71eab59766ac444ff7.js" integrity="sha512-nKez13FfLUyRix&#43;UpXqN60mD371FPzpz/R4hPhH7wjgPQ&#43;fQ5sTnP7WcGZ7PwQjvjEc3&#43;rewS3HqtZdmrERP9w==" crossorigin="anonymous"></script>
    
  </body>
</html>
